(function(){var t=this;t.N2_=t.N2_||{r:[],d:[]},t.N2R=t.N2R||function(){t.N2_.r.push(arguments)},t.N2D=t.N2D||function(){t.N2_.d.push(arguments)}}).call(window),N2R("$",function(s,t,n){window.nextend=window.nextend||{},s.extend(window.nextend,{animationManager:null,browse:null}),window.n2_=function(t){return nextend.localization[t]!==n?nextend.localization[t]:t},window.n2_sprintf=function(t){var e=arguments,i=1;return t.replace(/%s/g,function(){return e[i++]})},window.nextendtime=s.now(),window.nextend.roundTo=5,window.nextend.roundHelper=function(t){return window.nextend.roundTo<=1?t:Math.round(t/window.nextend.roundTo)*window.nextend.roundTo},s.fn.n2opener=function(){return this.each(function(){console.error("deprecated $.fn.n2opener");var e=s(this).on("click",function(t){e.toggleClass("n2-active")});e.siblings("span").on("click",function(t){e.toggleClass("n2-active")}),e.parent().on("mouseleave",function(){e.removeClass("n2-active")}),e.find(".n2-button-menu").on("click",function(t){t.stopPropagation(),e.removeClass("n2-active")})})},jQuery!==n&&jQuery(document).on("wp-collapse-menu",function(){s(window).trigger("resize")}),nextend.deepDiff={map:function(t,e){if(this.isValue(t))return t!==n&&t!=e?t:n;for(var i in e)this.isFunction(e[i])||(t[i]=this.map(t[i],e[i]),(t[i]===n||s.isPlainObject(t[i])&&s.isEmptyObject(t[i])||this.isArray(t[i])&&0==t[i].length)&&delete t[i]);return t},isFunction:function(t){return"[object Function]"==={}.toString.apply(t)},isArray:function(t){return"[object Array]"==={}.toString.apply(t)},isObject:function(t){return"[object Object]"==={}.toString.apply(t)},isValue:function(t){return!this.isObject(t)&&!this.isArray(t)}},nextend.UnicodeToHTMLEntity=function(e){try{var t,i=/(?:[\uD800-\uDBFF][\uDC00-\uDFFF])/g;for(;t=i.exec(e);)e=e.substr(0,t.index)+function(t){for(var e,i=[],s=0;s<t.length;)55296==(63488&(e=t.charCodeAt(s)))?i.push(((1023&e)<<10)+(1023&t.charCodeAt(++s))+65536):i.push(e),++s;return"&#"+i+";"}(e.substr(t.index,i.lastIndex-t.index))+e.substr(i.lastIndex)}catch(t){return console.error(t),e}return e}}),N2D("Popover",function(s){function e(t){this.$container=t,this.$content=t.find(".n2_popover_content"),this.$exit=this.$content.find(".n2_popover_content_exit").on("click",this.hide.bind(this)),this.positionCallback=this.position.bind(this),this.$trigger=t.find(".n2_popover__trigger").on("click",this.show.bind(this))}return e.prototype.lazyLoad=function(){this.options=s.extend({horizontal:"right",vertical:"below",relatedclass:!1},this.$container.data()),this.$content.appendTo("body"),this.$inner=this.$content.find(".n2_popover_content_inner"),this.$content.find(".n2_floating_menu__item").on("click",function(t){s(t.currentTarget).data("stay-open")||this.hide(t)}.bind(this)),this.lazyLoad=function(){}},e.prototype.position=function(){var t=this.$trigger[0].getBoundingClientRect(),e=this.$inner[0].getBoundingClientRect(),i=0,s=0,n=1;"left"===this.options.horizontal?(i=this.getXLeft(t,e))<0&&(i=this.getXRight(t,e)):(i=this.getXRight(t,e))<0&&(i=this.getXLeft(t,e)),"above"===this.options.vertical?(s=this.getYAbove(t,e))<0?s=this.getYBelow(t,e):n=3:(s=this.getYBelow(t,e))+e.height>window.innerHeight&&(s=this.getYAbove(t,e),n=3),this.$content.css({transform:"translate("+Math.round(i)+"px, "+Math.round(s)+"px)"}),this.$exit.css({order:n,height:t.height+5+"px"})},e.prototype.getXLeft=function(t,e){return t.x},e.prototype.getXRight=function(t,e){return t.x-e.width+t.width},e.prototype.getYAbove=function(t,e){return t.y-e.height-5},e.prototype.getYBelow=function(t,e){return t.y},e.prototype.show=function(t){t&&t.preventDefault(),this.lazyLoad(),this.options.relatedclass&&(this.$related=this.$container.closest("."+this.options.relatedclass),this.$related.addClass(this.options.relatedclass+"--popover-visible")),this.$content.addClass("n2_popover_content--visible").on("mouseleave",this.hide.bind(this)),this.position(),window.addEventListener("scroll",this.positionCallback,{capture:!0,passive:!0})},e.prototype.hide=function(t){this.$related&&(this.$related.removeClass(this.options.relatedclass+"--popover-visible"),delete this.$related),this.$content.off("mouseleave").removeClass("n2_popover_content--visible"),window.removeEventListener("scroll",this.positionCallback,{capture:!0,passive:!0})},e.prototype.setStates=function(i){this.$content.find("a[data-state]").each(function(){var t=s(this),e=t.data("state").match(/^(!)?(.*)$/);"!"===e[1]?t.toggleClass("n2_floating_menu__item--has-state",!i[e[2]]):t.toggleClass("n2_floating_menu__item--has-state",i[e[2]])})},s.fn.nextendPopover=function(){return this.each(function(){var t=s(this);t.data("popover",new e(t))})},e}),N2D("NextendHeadingPane",function(o,t){function e(t,e,i,s){this.$node=t.data("pane",this),this.headings=e,this.contents=i,this.tabNames=[],this.headings.each(function(t,e){this.tabNames.push(o(e).data("tab"))}.bind(this)),this.identifier=s,this._active=e.index(e.filter(".n2-active"));for(var n=0;n<e.length;n++)e.eq(n).on("click",this.switchToPane.bind(this,n));if(s){s=localStorage.getItem(this.identifier+"-pane")||-1;if(-1!=s)return void this.switchToPane(s)}this.hideAndShow()}return e.prototype.switchToPane=function(t,e){e&&e.preventDefault(),this.headings.eq(this._active).removeClass("n2-active"),this.headings.eq(t).addClass("n2-active"),this._active=t,this.hideAndShow(),this.store(this._active),this.$node.triggerHandler("changetab")},e.prototype.hideAndShow=function(){o(this.contents[this._active]).css("display","block").trigger("activate");for(var t=0;t<this.contents.length;t++)t!=this._active&&o(this.contents[t]).css("display","none")},e.prototype.store=function(t){this.identifier&&localStorage.setItem(this.identifier+"-pane",t)},e.prototype.showTabs=function(t){for(var e=!1,i=0;i<this.tabNames.length;i++)"-1"!=t.indexOf(this.tabNames[i])?(this.headings.eq(i).css("display",""),o(this.contents[i]).css("display",""),i!=this._active&&!1!==e||(e=i)):(this.headings.eq(i).css("display","none"),o(this.contents[i]).css("display","none"));this.switchToPane(e)},e}),N2D("Window",function(t,e){var i=!1;function s(){return i=t("#wpadminbar").height(),n.getTopOffset=function(){return i},i}var n={getTopOffset:s,getBottomOffset:function(){return 0},getHeight:function(){return(window.innerHeight||document.documentElement.clientHeight)-n.getTopOffset()},getWidth:function(){return window.innerWidth||document.documentElement.clientWidth}};return N2R("documentReady",function(){s()}),n}),N2D("WindowManager",function(t,e){var i=["main"],s={};return{addWindow:function(t){i.push(t)},removeWindow:function(){i.pop()},getCurrentWindow:function(){return i[i.length-1]},actionPrevent:function(t){this.actionCancelPreventRelease(t),s[t]=requestAnimationFrame(this.actionPreventRelease.bind(this,t))},actionPreventFunction:function(t){return this.actionPrevent.bind(this,t)},actionCancelPreventRelease:function(t){s[t]!==e&&(cancelAnimationFrame(s[t]),delete s[t])},actionPreventRelease:function(t){delete s[t]},isActionPrevented:function(t){return s[t]!==e}}}),N2D("LoadingScreen",function(e,t){var i,s,n;N2R("documentReady",function(){i=e('<div class="n2_loading_screen"><div class="n2_loading_screen__circle"></div></div>').appendTo("body")});var o={startLoading:function(){s&&clearTimeout(s),n=e.now(),i.addClass("n2_loading_screen--visible")},stopLoading:function(){var t=e.now()-n;300<=t?i.removeClass("n2_loading_screen--visible"):s=setTimeout(function(){i.removeClass("n2_loading_screen--visible")},300-t)}};return o}),N2D("AjaxHelper",function(e,n){function o(){}o.query={};var i={};return o.addAdminUrl=function(t,e){i[t]=e},o.getAdminUrl=function(t){return i[t]},o.addAjaxArray=function(t){for(var e in t)o.query[e]=t[e]},o.makeAjaxUrl=function(t,e){t=t.split("?");t.length<2&&(t[1]="");var i=N2Classes.N2QueryString.parse(t[1]);if(e!==n)for(var s in e)i[s]=e[s];for(s in o.query)i[s]=o.query[s];return N2Classes.N2QueryString.add_query_arg(i,t[0])},o.ajax=function(t){return N2Classes.LoadingScreen.startLoading(),e.ajax(t).always(function(e,t){N2Classes.LoadingScreen.stopLoading();try{if("success"!==t?e=JSON.parse(e.responseText):"string"==typeof e&&(e=JSON.parse(e)),e.redirect!==n)return N2Classes.LoadingScreen.startLoading(),void(window.location.href=e.redirect);o.notification(e)}catch(t){var i=/<body[^>]*>((.|[\n\r])*)<\/body>/im.exec(e.responseText);i?N2Classes.ModalSafeHTML(i[1]):console.error(e.responseText,e)}})},o.notification=function(t){if(t.notification!==n&&t.notification)for(var e in t.notification)for(var i=0;i<t.notification[e].length;i++)N2Classes.Notification[e](t.notification[e][i][0],t.notification[e][i][1])},o.getJSON=function(t){return N2Classes.LoadingScreen.startLoading(),e.getJSON(t).always(function(){N2Classes.LoadingScreen.stopLoading()})},o}),N2D("Esc",function(e,t){function i(){this.FiLo=[],this.doc=e(document),this.isListening=!1}return i.prototype.add=function(t){this.FiLo.push(t),this.isListening||(this.doc.on("keydown.n2-esc",function(t){27!==t.keyCode&&8!==t.keyCode||(e(t.target).is("input, textarea")?27===t.keyCode&&(t.preventDefault(),e(t.target).blur()):(t.preventDefault(),this.onClose()))}.bind(this)).on("n2Close.n2-esc",function(t){this.onClose()}.bind(this)),this.isListening=!0)},i.prototype.pop=function(){this.FiLo.pop(),0===this.FiLo.length&&(this.doc.off(".n2-esc"),this.isListening=!1)},i.prototype.onClose=function(){this.FiLo[this.FiLo.length-1]()&&this.pop()},new i}),N2D("tooltip",function(e,s){function t(){this.$element=e('<div class="n2_tooltip"></div>'),this.timeout=null,this.$tipFor=null,e(window).ready(this.ready.bind(this))}function i(){this.isVisible=!1,this.$body=e("body"),this.$element=e('<div class="n2_tooltip"></div>').appendTo(this.$body)}return t.prototype.ready=function(){this.$element.appendTo("body"),this.add(e("body"))},t.prototype.add=function(t){t.find("[data-n2tip]").off(".n2hastip").on({"mouseenter.n2hastip":this.onEnter.bind(this)})},t.prototype.addElement=function(t,e,i,s){t.data({n2tip:e,n2tipv:s,n2tiph:i}).off(".n2hastip").on({"mouseenter.n2hastip":this.onEnter.bind(this)})},t.prototype.removeElement=function(t){t.off(".n2hastip")},t.prototype.hide=function(){this.onLeave()},t.prototype.onEnter=function(t){this.lastE=t,this.timeout&&clearTimeout(this.timeout),this.$tipFor=e(t.currentTarget).on({"mousemove.n2tip":this.onMove.bind(this),"mouseleave.n2tip":this.onLeave.bind(this)}),this.timeout=setTimeout(function(){var t=this.$tipFor.data("n2tipv"),e=this.$tipFor.data("n2tiph");t===s&&(t=10),e===s&&(e=10);var i=this.$tipFor.data("n2tip");"function"==typeof i&&(i=i.call()),this.$element.css({margin:t+"px "+e+"px"}).html(i).addClass("n2_tooltip--active"),this.onMove(this.lastE)}.bind(this),500)},t.prototype.onMove=function(t){this.lastE=t,this.$element.css({left:Math.min(t.clientX,window.innerWidth-this.$element.outerWidth()-30),top:Math.min(t.clientY,window.innerHeight-this.$element.height()-20)})},t.prototype.onLeave=function(){this.timeout&&clearTimeout(this.timeout),this.$tipFor&&(this.$tipFor.off(".n2tip"),this.$tipFor=null,this.$element.removeClass("n2_tooltip--active").css("margin",""))},i.prototype.show=function(t,e){this.isVisible?this.$element.html(t):(this.isVisible=!0,this.$body.on("mousemove.tooltipMouse",this.mouseMove.bind(this)),this.mouseMove(e),this.$element.html(t).addClass("n2_tooltip--active"))},i.prototype.mouseMove=function(t){this.$element.css({left:Math.min(t.clientX+10,window.innerWidth-this.$element.outerWidth()-32),top:Math.min(t.clientY+10,window.innerHeight-this.$element.height()-40)})},i.prototype.hide=function(){this.$body.off("mousemove.tooltipMouse"),this.$element.removeClass("n2_tooltip--active").html(""),this.isVisible=!1},nextend.tooltip=new t,e(window).ready(function(){nextend.tooltipMouse=new i}),nextend.tooltip}),N2D("FormTipManager",function(e,t){var i=1;function s(t){this.$el=t,this.id=i++,this.isVisible=!1,this.$tip=!1,this.ui="el",this.$el.on({"mouseenter.formTip":this.onMouseEnter.bind(this),"mouseleave.formTip":this.onMouseLeave.bind(this)})}s.prototype.onMouseEnter=function(){this.mouseLeaveTimeout&&clearTimeout(this.mouseLeaveTimeout),this.mouseEnterTimeout=setTimeout(this.onMouseEnterTimeout.bind(this),300)},s.prototype.onMouseEnterTimeout=function(){delete this.mouseEnterTimeout,this.isVisible||(this.ui="el",this.show(),this.isVisible=!0)},s.prototype.onMouseLeave=function(){this.mouseEnterTimeout&&clearTimeout(this.mouseEnterTimeout),this.mouseLeaveTimeout=setTimeout(this.onMouseLeaveTimeout.bind(this),300)},s.prototype.onMouseLeaveTimeout=function(){delete this.mouseLeaveTimeout,this.isVisible&&"el"===this.ui&&this.hide()},s.prototype.show=function(){!1===this.$tip&&this.buildTip(),this.$tip.addClass("n2_form_tip--visible"),e(window).on("scroll.formTip"+this.id,this.positionTip.bind(this)).on("resize.formTip"+this.id,this.positionTip.bind(this)),this.positionTip()},s.prototype.hide=function(){e(window).off(".formTip"+this.id),this.$tip.removeClass("n2_form_tip--visible"),this.isVisible=!1},s.prototype.stopPropagation=function(t){t.stopPropagation()},s.prototype.buildTip=function(){this.$tip=e('<div class="n2_form_tip"></div>').on({mouseenter:this.onTipMouseEnter.bind(this),mouseleave:this.onTipMouseLeave.bind(this),mousedown:this.stopPropagation.bind(this),mouseup:this.stopPropagation.bind(this),click:this.stopPropagation.bind(this)}).appendTo("body"),e('<div class="n2_form_tip__overlay"></div>').appendTo(this.$tip);var t=e('<div class="n2_form_tip__content"></div>').appendTo(this.$tip);this.$el.data("tip-label")&&e('<div class="n2_form_tip__label"></div>').text(this.$el.data("tip-label")).appendTo(t),this.$description=e('<div class="n2_form_tip__description"></div>').html(this.$el.data("tip-description")).appendTo(t),this.$el.data("tip-link")&&e('<a class="n2_form_tip__link" href="'+this.$el.data("tip-link")+'" target="_blank">'+n2_("Open docs")+"</a>").appendTo(t)},s.prototype.setDescription=function(t){this.$description?this.$description.html(t):this.$el.data("tip-description",t)},s.prototype.onTipMouseEnter=function(){this.ui="tip"},s.prototype.onTipMouseLeave=function(){this.hide()},s.prototype.positionTip=function(){this.$tip.css({left:0,top:0});var t,e,i=window.innerWidth,s=(window.innerHeight,this.$el[0].getBoundingClientRect()),n=this.$tip[0].getBoundingClientRect(),o={left:0,top:0},i=n2const.rtl.isRtl?s.left>n.width:i-s.left<n.width;i?(t="right",o.left=s.left+s.width-n.width):(t="left",o.left=s.left),s.top>n.height?(e="bottom",o.top=s.top-n.height):(e="top",o.top=s.top+s.height),this.$tip.attr("data-position-horizontal",t).attr("data-position-vertical",e).css(o)};var n={add:function(t){t.find("[data-tip-description]").each(function(){var t=e(this);t.data("formTip")||t.data("formTip",new s(t))})}};return N2R("windowLoad",function(){n.add(e("body"))}),n}),window.N2Color={hex2rgba:function(t){6===t.length&&(t+="ff");t=parseInt(t,16);return[t>>24&255,t>>16&255,t>>8&255,(255&t)/255]},hex2rgbaCSS:function(t){return"RGBA("+N2Color.hex2rgba(t).join(",")+")"},hexdec:function(t){return t=(t+"").replace(/[^a-f0-9]/gi,""),parseInt(t,16)},hex2alpha:function(t){return 8!==t.length?1:((255&parseInt(t,16))/255).toFixed(3)},colorizeSVG:function(t,e){var i=t.split("base64,");return 1===i.length?t:(i[1]=N2Classes.Base64.encode(N2Classes.Base64.decode(i[1]).replace('fill="#FFF"','fill="#'+e.substr(0,6)+'"').replace('opacity="1"','opacity="'+N2Color.hex2alpha(e)+'"')),i.join("base64,"))},colorToSVG:function(t){var e=parseInt(t,16);return[t.substr(0,6),(255&e)/255]}},N2D("N2QueryString",function(t,s){"use strict";return{parse:function(t){return"string"==typeof t&&(t=t.trim().replace(/^(\?|#)/,""))?t.trim().split("&").reduce(function(t,e){var i=e.replace(/\+/g," ").split("="),e=i[0],i=i[1],e=decodeURIComponent(e),i=i===s?null:decodeURIComponent(i);return t.hasOwnProperty(e)?Array.isArray(t[e])?t[e].push(i):t[e]=[t[e],i]:t[e]=i,t},{}):{}},stringify:function(i){return i?Object.keys(i).map(function(e){var t=i[e];return Array.isArray(t)?t.map(function(t){return encodeURIComponent(e)+"[]="+encodeURIComponent(t)}).join("&"):encodeURIComponent(e)+"="+encodeURIComponent(t)}).join("&"):""},add_query_arg:function(t,e){e=e.split("?");e.length<2&&(e[1]="");var i,s=this.parse(e[1]);for(i in t)t.hasOwnProperty(i)&&(s[i]=t[i]);return e[0]+"?"+this.stringify(s)}}}),function(t){var s=[],n=[],o=[],a=[],r="0123456789abcdef".split(""),l=[],d=[],h=!1,p=0,c=0,u=[];if(t.Int32Array)n=new Int32Array(16),o=new Int32Array(16),a=new Int32Array(4),l=new Int32Array(4),d=new Int32Array(4),u=new Int32Array(4);else{for(var e=0;e<16;e++)n[e]=o[e]=0;for(e=0;e<4;e++)a[e]=l[e]=d[e]=u[e]=0}function f(t){for(var e=16;e--;){var i=e<<2;o[e]=t.charCodeAt(i)+(t.charCodeAt(1+i)<<8)+(t.charCodeAt(2+i)<<16)+(t.charCodeAt(3+i)<<24)}}function m(t,e,i,s,n,o,a){return((e+=t+s+a)<<n|e>>>o)+i<<0}function g(t){i(0,0,0,0,t),d[0]=u[0]+1732584193<<0,d[1]=u[1]-271733879<<0,d[2]=u[2]-1732584194<<0,d[3]=u[3]+271733878<<0}function y(t){i(d[0],d[1],d[2],d[3],t),d[0]=u[0]+d[0]<<0,d[1]=u[1]+d[1]<<0,d[2]=u[2]+d[2]<<0,d[3]=u[3]+d[3]<<0}function i(t,e,i,s,n){var o,a;e=h?(t=m((i^s)&e^s,t,e,n[0],7,25,-680876936),s=m((e^i)&t^i,s,t,n[1],12,20,-389564586),i=m((t^e)&s^e,i,s,n[2],17,15,606105819),m((s^t)&i^t,e,i,n[3],22,10,-1044525330)):(t=((t=n[0]-680876937)<<7|t>>>25)-271733879<<0,s=((s=n[1]-117830708+(2004318071&t^-1732584194))<<12|s>>>20)+t<<0,i=((i=n[2]-1126478375+((-271733879^t)&s^-271733879))<<17|i>>>15)+s<<0,((e=n[3]-1316259209+((s^t)&i^t))<<22|e>>>10)+i<<0),t=m((i^s)&e^s,t,e,n[4],7,25,-176418897),s=m((e^i)&t^i,s,t,n[5],12,20,1200080426),i=m((t^e)&s^e,i,s,n[6],17,15,-1473231341),e=m((s^t)&i^t,e,i,n[7],22,10,-45705983),t=m((i^s)&e^s,t,e,n[8],7,25,1770035416),s=m((e^i)&t^i,s,t,n[9],12,20,-1958414417),i=m((t^e)&s^e,i,s,n[10],17,15,-42063),e=m((s^t)&i^t,e,i,n[11],22,10,-1990404162),t=m((i^s)&e^s,t,e,n[12],7,25,1804603682),s=m((e^i)&t^i,s,t,n[13],12,20,-40341101),i=m((t^e)&s^e,i,s,n[14],17,15,-1502002290),e=m((s^t)&i^t,e,i,n[15],22,10,1236535329),t=m((e^i)&s^i,t,e,n[1],5,27,-165796510),s=m((t^e)&i^e,s,t,n[6],9,23,-1069501632),i=m((s^t)&e^t,i,s,n[11],14,18,643717713),e=m((i^s)&t^s,e,i,n[0],20,12,-373897302),t=m((e^i)&s^i,t,e,n[5],5,27,-701558691),s=m((t^e)&i^e,s,t,n[10],9,23,38016083),i=m((s^t)&e^t,i,s,n[15],14,18,-660478335),e=m((i^s)&t^s,e,i,n[4],20,12,-405537848),t=m((e^i)&s^i,t,e,n[9],5,27,568446438),s=m((t^e)&i^e,s,t,n[14],9,23,-1019803690),i=m((s^t)&e^t,i,s,n[3],14,18,-187363961),e=m((i^s)&t^s,e,i,n[8],20,12,1163531501),t=m((e^i)&s^i,t,e,n[13],5,27,-1444681467),s=m((t^e)&i^e,s,t,n[2],9,23,-51403784),i=m((s^t)&e^t,i,s,n[7],14,18,1735328473),e=m((i^s)&t^s,e,i,n[12],20,12,-1926607734),t=m((o=e^i)^s,t,e,n[5],4,28,-378558),s=m(o^t,s,t,n[8],11,21,-2022574463),i=m((a=s^t)^e,i,s,n[11],16,16,1839030562),e=m(a^i,e,i,n[14],23,9,-35309556),t=m((o=e^i)^s,t,e,n[1],4,28,-1530992060),s=m(o^t,s,t,n[4],11,21,1272893353),i=m((a=s^t)^e,i,s,n[7],16,16,-155497632),e=m(a^i,e,i,n[10],23,9,-1094730640),t=m((o=e^i)^s,t,e,n[13],4,28,681279174),s=m(o^t,s,t,n[0],11,21,-358537222),i=m((a=s^t)^e,i,s,n[3],16,16,-722521979),e=m(a^i,e,i,n[6],23,9,76029189),t=m((o=e^i)^s,t,e,n[9],4,28,-640364487),s=m(o^t,s,t,n[12],11,21,-421815835),i=m((a=s^t)^e,i,s,n[15],16,16,530742520),e=m(a^i,e,i,n[2],23,9,-995338651),t=m(i^(e|~s),t,e,n[0],6,26,-198630844),s=m(e^(t|~i),s,t,n[7],10,22,1126891415),i=m(t^(s|~e),i,s,n[14],15,17,-1416354905),e=m(s^(i|~t),e,i,n[5],21,11,-57434055),t=m(i^(e|~s),t,e,n[12],6,26,1700485571),s=m(e^(t|~i),s,t,n[3],10,22,-1894986606),i=m(t^(s|~e),i,s,n[10],15,17,-1051523),e=m(s^(i|~t),e,i,n[1],21,11,-2054922799),t=m(i^(e|~s),t,e,n[8],6,26,1873313359),s=m(e^(t|~i),s,t,n[15],10,22,-30611744),i=m(t^(s|~e),i,s,n[6],15,17,-1560198380),e=m(s^(i|~t),e,i,n[13],21,11,1309151649),t=m(i^(e|~s),t,e,n[4],6,26,-145523070),s=m(e^(t|~i),s,t,n[11],10,22,-1120210379),i=m(t^(s|~e),i,s,n[2],15,17,718787259),e=m(s^(i|~t),e,i,n[9],21,11,-343485551),u[0]=t,u[1]=e,u[2]=i,u[3]=s}a[0]=128,a[1]=32768,a[2]=8388608,a[3]=-2147483648,l[0]=0,l[1]=8,l[2]=16,l[3]=24,t.md5=t.md5||function(t,e,i){return function(t){var e,i;if(h=!1,p=c=(t+="").length,63<c){for(f(t.substring(0,64)),g(o),h=!0,e=128;e<=c;e+=64)f(t.substring(e-64,e)),y(o);t=t.substring(e-64),c=t.length}for(n[0]=0,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,e=n[15]=0;e<c;e++)0==(i=e%4)?n[e>>2]=t.charCodeAt(e):n[e>>2]|=t.charCodeAt(e)<<l[i];if(n[e>>2]|=a[e%4],55<e)return h?y(n):(g(n),h=!0),y([0,0,0,0,0,0,0,0,0,0,0,0,0,0,p<<3,0]);n[14]=p<<3,(h?y:g)(n)}(e?t:function(t){for(var e=enc="",i=end=0,s=0,n=t.length;s<n;s++){var o=t.charCodeAt(s);o<128?end++:(enc=127<o&&o<2048?String.fromCharCode(o>>6|192,63&o|128):String.fromCharCode(o>>12|224,o>>6&63|128,63&o|128),end>i&&(e+=t.slice(i,end)),e+=enc,i=end=s+1)}return end>i&&(e+=t.slice(i,n)),e}(t)),t=d[0],s[1]=r[15&t],s[0]=r[15&(t>>=4)],s[3]=r[15&(t>>=4)],s[2]=r[15&(t>>=4)],s[5]=r[15&(t>>=4)],s[4]=r[15&(t>>=4)],s[7]=r[15&(t>>=4)],s[6]=r[15&(t>>=4)],t=d[1],s[9]=r[15&t],s[8]=r[15&(t>>=4)],s[11]=r[15&(t>>=4)],s[10]=r[15&(t>>=4)],s[13]=r[15&(t>>=4)],s[12]=r[15&(t>>=4)],s[15]=r[15&(t>>=4)],s[14]=r[15&(t>>=4)],t=d[2],s[17]=r[15&t],s[16]=r[15&(t>>=4)],s[19]=r[15&(t>>=4)],s[18]=r[15&(t>>=4)],s[21]=r[15&(t>>=4)],s[20]=r[15&(t>>=4)],s[23]=r[15&(t>>=4)],s[22]=r[15&(t>>=4)],t=d[3],s[25]=r[15&t],s[24]=r[15&(t>>=4)],s[27]=r[15&(t>>=4)],s[26]=r[15&(t>>=4)],s[29]=r[15&(t>>=4)],s[28]=r[15&(t>>=4)],s[31]=r[15&(t>>=4)],s[30]=r[15&(t>>=4)],i?s:s.join("")}}(window),N2D("CssInjection",function(t,e){function i(t,e){this.baseClassName=t;var i=document.body;this.style=document.createElement("style"),this.style.setAttribute("data-base-class-name",t),this.style.setAttribute("type","text/css"),this.style.styleSheet?this.style.styleSheet.cssText=e:this.style.appendChild(document.createTextNode(e)),i.appendChild(this.style)}return i.prototype.getBaseClassName=function(){return this.baseClassName},i.prototype.destroy=function(){this.style.parentNode.removeChild(this.style)},i}),N2D("NextendCSS",function(t,e){function i(){this.style=""}return i.prototype.add=function(t,e){return new N2Classes.CssInjection(t,e)},i.prototype.deleteRule=function(t){for(var e=t.toLowerCase(),i=e.replace(".","\\."),s=document.styleSheets.length-1;0<=s;s--)for(var n,o=this._getRulesArray(s),a=0;o&&a<o.length;a++)o[a].selectorText&&((n=o[a].selectorText.toLowerCase())!=e&&n!=i||(document.styleSheets[s].cssRules?document.styleSheets[s].deleteRule(a):document.styleSheets[s].removeRule(a)));return!0},i.prototype._getRulesArray=function(t){var e=null;try{document.styleSheets[t].cssRules?e=document.styleSheets[t].cssRules:document.styleSheets[t].rules&&(e=document.styleSheets[t].rules)}catch(t){}return e},window.nextend.css=new i,window.nextend.css}),N2D("ImageHelper",function(e,t){function i(t){(nextend.imageHelper=this).parameters=e.extend({siteKeywords:[],imageUrls:[],wordpressUrl:"",placeholderImage:"",placeholderRepeatedImage:"",protocolRelative:1},t)}return i.prototype.protocolRelative=function(t){return this.parameters.protocolRelative?t.replace(/^http(s)?:\/\//,"//"):t},i.prototype.dynamic=function(t){for(var e=this.parameters.imageUrls,i=this.parameters.siteKeywords,s=this.protocolRelative(t),n=0;n<i.length;n++)if(0===s.indexOf(e[n])){t=i[n]+s.slice(e[n].length);break}return t},i.prototype.fixed=function(t){if("string"==typeof t)for(var e=this.parameters.imageUrls,i=this.parameters.siteKeywords,s=0;s<i.length;s++)if(0===t.indexOf(i[s])){t=e[s]+t.slice(i[s].length);break}return t},i.prototype.openLightbox=function(t){N2Classes.PlatformImageChooser.single(t)},i.prototype.openMultipleLightbox=function(t){N2Classes.PlatformImageChooser.multiple(t)},i.prototype.getPlaceholder=function(){return this.fixed(this.parameters.placeholderImage)},i.prototype.getRepeatedPlaceholder=function(){return this.fixed(this.parameters.placeholderRepeatedImage)},i}),N2D("PlatformImageChooser",function(t,s){function e(){}return e.single=function(e){N2Classes.WindowManager.addWindow("imagechooser");var t={states:[new wp.media.controller.Library({filterable:"all",priority:20})]};wp.media.controller.EditImage!==s&&t.states.push(new wp.media.controller.EditImage);var i=wp.media(t);i.on("content:render:edit-image",function(){var t=this.state().get("image"),t=new wp.media.view.EditImage({model:t,controller:this}).render();this.content.set(t),t.loadEditor()},i),i.on("select",function(){var t=i.state().get("selection").first().toJSON();e(nextend.imageHelper.dynamic(t.url),{alt:t.alt})}.bind(this)),i.on("close",function(){N2Classes.WindowManager.removeWindow(),setTimeout(function(){N2Classes.Esc.pop()},50)}),N2Classes.Esc.add(function(){return!1}),i.open()},e.multiple=function(n){N2Classes.WindowManager.addWindow("imagechooser");var t={states:[new wp.media.controller.Library({filterable:"all",multiple:"add",priority:20})]};wp.media.controller.EditImage!==s&&t.states.push(new wp.media.controller.EditImage);var o=wp.media(t);o.on("content:render:edit-image",function(){var t=this.state().get("image"),t=new wp.media.view.EditImage({model:t,controller:this}).render();this.content.set(t),t.loadEditor()},o),o.on("select",function(){for(var t=o.state().get("selection").toJSON(),e=[],i=0;i<t.length;i++){var s=t[i];e.push({title:s.title,description:s.description,image:nextend.imageHelper.dynamic(s.url),alt:s.alt})}n(e)}.bind(this)),o.on("close",function(){N2Classes.WindowManager.removeWindow(),setTimeout(function(){N2Classes.Esc.pop()},50)}),o.open(),N2Classes.Esc.add(function(){return!1})},e}),N2D("AbstractModal",function(i,t){function s(t,e){s.counter++,this.id=s.counter,this.type=t,this.buttons=[],this.options=i.extend({hasClose:!0,width:!1,destroyOnHide:!1},e),this.$modal=i('<div class="n2 n2_modal" data-modal-type="'+this.type+'"></div>').appendTo("body"),this.options.hasClose&&i('<div class="n2_modal__overlay"></div>').on("click",this.hide.bind(this)).appendTo(this.$modal),this.$modalWindow=i('<div class="n2_modal__window"></div>').appendTo(this.$modal),!1!==this.options.width&&this.$modalWindow.css("width",this.options.width),this.renderModal()}return s.counter=0,s.prototype.renderModal=function(){},s.prototype.show=function(){document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur(),N2Classes.WindowManager.addWindow("modal"),this.options.hasClose&&N2Classes.Esc.add(function(){return this.hide("esc"),!0}.bind(this)),this.$modal.addClass("n2_modal--visible")},s.prototype.hide=function(t){N2Classes.WindowManager.removeWindow(),"esc"!==t&&(N2Classes.Esc.pop(),t&&t.preventDefault()),this.$modal.removeClass("n2_modal--visible"),this.options.destroyOnHide&&this.$modal.remove(),document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur()},s.prototype.getBody=function(){return this.$modalBody},s.prototype.addContent=function(t){t.appendTo(this.$modalBody)},s.prototype.clearButtons=function(){for(var t in this.buttons)this.buttons[t].remove();this.buttons=[],this.$modalButtons.html("").attr("data-buttons",0)},s.prototype.addButton=function(t,e){e=e||!1;t=i('<div class="n2_modal__button"></div>').append(t);return e?t.prependTo(this.$modalButtons):t.appendTo(this.$modalButtons),this.buttons.push(t),this.$modalButtons.attr("data-buttons",this.buttons.length),t},s}),N2D("ModalDeleteConfirm",function(s,t){function n(t,e){var i=new N2Classes.ModalSimple("delete",{destroyOnHide:!0});i.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--delete","red")),i.addContent(N2Classes.UI.modalHeading(n2_("Are you sure?"))),i.addContent(N2Classes.UI.modalParagraphHTML(n2_sprintf("You're about to %s. ",t)+n2_sprintf("The deletion is irreversible, and it's not possible to recover %s.",t)).css("margin-bottom","19px"));t=N2Classes.UI.modalButton(n2_("Cancel"),"grey").on("click",function(t){t.preventDefault(),i.hide()});i.addButton(t);t=N2Classes.UI.modalButton(n2_("Delete"),"red").on("click",function(t){t.preventDefault(),e(),i.hide(t)});i.addButton(t),i.show()}return n.href=function(t,e,i){t.preventDefault(),n(i,function(){window.location.href=s(e).attr("href")})},n}),N2D("ModalIframe","AbstractModal",function(i,t){function e(t,e){N2Classes.AbstractModal.prototype.constructor.call(this,t,i.extend({},e))}return((e.prototype=Object.create(N2Classes.AbstractModal.prototype)).constructor=e).prototype.renderModal=function(){this.$modal.addClass("n2_modal--iframe"),this.$frame=i('<iframe name="'+this.type+'" src="about:blank" style="width: 100%;height:100%;" allowfullscreen></iframe>').appendTo(this.$modalWindow)},e.prototype.setSrc=function(t){this.$frame.attr("src",t)},e.prototype.hide=function(t){N2Classes.AbstractModal.prototype.hide.call(this,t),this.$frame.attr("src","about:blank")},e}),N2D("ModalLightbox","AbstractModal",function(s,t){function e(t,e,i){this.title=t,N2Classes.AbstractModal.prototype.constructor.call(this,e,s.extend({},i))}return((e.prototype=Object.create(N2Classes.AbstractModal.prototype)).constructor=e).prototype.renderModal=function(){var t;this.$modal.addClass("n2_modal--lightbox"),this.$modalTopBar=s('<div class="n2_modal__top_bar"></div>').appendTo(this.$modalWindow),this.$title=s('<div class="n2_modal__top_bar_title"></div>').text(this.title).appendTo(this.$modalTopBar),this.$modalButtons=s('<div class="n2_modal__top_bar_buttons" data-buttons="0"></div>').appendTo(this.$modalTopBar),this.options.hasClose&&(t=N2Classes.UI.modalButton(n2_("Close"),"grey-dark").on("click",this.hide.bind(this)),this.addButton(t)),this.$modalBody=s('<div class="n2_modal__body"></div>').appendTo(this.$modalWindow)},e.prototype.setTitle=function(t){this.title=t,this.$title.text(t)},e}),N2D("ModalSimple","AbstractModal",function(i,t){function e(t,e){N2Classes.AbstractModal.prototype.constructor.call(this,t,i.extend({width:500},e))}return((e.prototype=Object.create(N2Classes.AbstractModal.prototype)).constructor=e).prototype.renderModal=function(){var t;this.$modal.addClass("n2_modal--simple"),this.$modalBodyOuter=i('<div class="n2_modal__body_outer"></div>').appendTo(this.$modalWindow),this.options.hasClose&&(t=i('<div class="n2_modal__close_wrap"></div>').appendTo(this.$modalBodyOuter),i('<div class="n2_modal__close"><i class="ssi_16 ssi_16--remove"></i></div>').on("click",this.hide.bind(this)).appendTo(t)),this.$modalBody=i('<div class="n2_modal__body"></div>').appendTo(this.$modalBodyOuter),this.$modalButtons=i('<div class="n2_modal__buttons" data-buttons="0"></div>').appendTo(this.$modalWindow)},e}),N2D("PreviewPopup",function(t,e){return function(t,e){var i=["height="+screen.availHeight,"width="+screen.availWidth,"toolbar=yes,scrollbars=yes,resizable=yes"].join(",");return(i=window.open(t,e,i)).moveTo(0,0),i.resizeTo(screen.availWidth,screen.availHeight),i}}),N2D("ModalCreateGroup",function(s,i){var n,o={manager:!1,ajaxUrl:""};var t={};return t.init=function(t,e){n===i&&(o.manager=t,o.ajaxUrl=e,function(){(n=new N2Classes.ModalSimple("create-group",{width:440})).addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--group","green")),n.addContent(N2Classes.UI.modalHeading(n2_("Create group")));var t=N2Classes.UI.modalFormRow(!0);n.addContent(t);var i=N2Classes.UI.modalFieldText(t,"group-name",n2_("Group name"),""),t=N2Classes.UI.modalButton(n2_("Create group"),"green");n.addButton(t),t.on("click",function(e){e.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(o.ajaxUrl,{nextendaction:"createGroup"}),data:{title:i.val()},dataType:"json"}).done(function(t){0===parseInt(o.manager.groupID)&&(t=s(t.data).insertBefore(o.manager.slidersContainer.find(s(".n2_slider_box")).first()),new N2Classes.Slider(o.manager,t),o.manager.initSliders(),console.log("We should refresh the Add to group list too")),n.hide(e),N2Classes.Notification.success(n2_("Group created"))})})}())},t.show=function(){n.show()},t}),N2D("ModalGeneratorRecordViewer",function(a,t){return function(t,e){this.createRecordModal=new N2Classes.ModalSimple("generator-record-viewer",{width:1e3,destroyOnHide:!0}),this.createRecordModal.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--data","blue")),this.createRecordModal.addContent(N2Classes.UI.modalHeading(n2_("Records"))),function(t,e,i){var s=a('<div class="n2_generator_records_table"></div>').css("grid-template-columns","40px repeat("+(e.length-1)+", auto)").appendTo(t),n=0;for(a('<div class="n2_generator_records_table__heading" data-col="1"></div>').text(e[n]).appendTo(s),n=1;n<e.length;n++)a('<div class="n2_generator_records_table__heading"></div>').text(e[n]).appendTo(s);for(n=0;n<i.length;n++){var o=0;for(a('<div class="n2_generator_records_table__heading" data-col="1"></div>').text(i[n][o]).appendTo(s),o=1;o<i[n].length;o++)a('<div class="n2_generator_records_table__cell"></div>').html(i[n][o]).appendTo(s)}}(this.createRecordModal.getBody(),t,e),this.createRecordModal.show()}}),N2D("ModalHotkey",function(m,t){function e(){var t=this.getHotkeys();this.modal=new N2Classes.ModalSimple("hotkey",{width:800}),this.modal.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--keyboard","blue")),this.modal.addContent(N2Classes.UI.modalHeading(n2_("Keyboard shortcuts")));var e=m('<div class="n2_modal__hotkey"></div>');this.modal.addContent(e);for(var i=0;i<t.length;i++)for(var s=m('<div class="n2_modal__hotkey_column"></div>').appendTo(e),n=0;n<t[i].length;n++){var o=t[i][n][0],a=t[i][n][1],r=m('<div class="n2_modal__hotkey_group"></div>').appendTo(s);m('<div class="n2_modal__hotkey_title">'+o+"</div>").appendTo(r);for(var l=0;l<a.length;l++){var d=m('<div class="n2_modal__hotkey_row"></div>').appendTo(r),h=a[l][0];m('<div class="n2_modal__hotkey_text">'+h+"</div>").appendTo(d);for(var p=m('<div class="n2_modal__hotkey_keys"></div>').appendTo(d),c=a[l][1],u=0;u<c.length;u++)m('<div class="n2_modal__hotkey_key">'+c[u]+"</div>").appendTo(p)}}var f=N2Classes.UI.modalButton(n2_("Got it"),"blue");this.modal.addButton(f),f.on("click",function(t){this.modal.hide()}.bind(this))}e.prototype.getHotkeys=function(){var t="ctrl",e=[],i=[];this.isMac()&&(t="cmd");var s=[n2_("General"),[[n2_("Content tab"),["q"]],[n2_("Style tab"),["w"]]]];e.push(s),s[1].push([n2_("Animation tab"),["e"]]),s[1].push([n2_("Add Layer"),["a"]],[n2_("Layer List"),["s"]]),s[1].push([n2_("Timeline"),["d"]]);s=[n2_("View"),[[n2_("Preview"),[t,"1"]],[n2_("Desktop"),[t,"2"]],[n2_("Tablet"),[t,"3"]],[n2_("Mobile"),[t,"4"]]]];e.push(s);s=[n2_("Adjust"),[[n2_("Move (Absolute)"),[n2_("Arrows")]],[n2_("Align (Absolute)"),[n2_("Numeric keys")]]]];e.push(s);t=[n2_("Action"),[[n2_("Delete"),["del"]],[n2_("Duplicate"),[t,"d"]],[n2_("Copy"),[t,"c"]],[n2_("Paste"),[t,"v"]],[n2_("Undo"),[t,"z"]],[n2_("Redo"),[t,"shift","z"]],[n2_("Save"),[t,"s"]]]];t[1].push([n2_("Play animations"),["space"]]),i.push(t);t=[n2_("Clear device specific settings"),[[n2_("Current layer, current device"),["shift","e"]],[n2_("Current layer, all devices"),["shift","alt","e"]],[n2_("All layers, current device"),["shift","r"]],[n2_("All layers, all devices"),["shift","alt","r"]]]];return i.push(t),[e,i]},e.prototype.isMac=function(){return 0<=navigator.platform.toUpperCase().indexOf("MAC")};var i=!(e.prototype.show=function(){this.modal.show()});function s(){}return s.show=function(){(i=i||new e).show()},s}),N2D("ModalSafeHTML",function(s,t){return function(t){var i=new N2Classes.ModalSimple("safe-html",{destroyOnHide:!1,width:440});i.addContent(N2Classes.UI.modalHeading(n2_("Unexpected response"))),t=s(t.replace(/document\.write/g,"n2Write")),window.n2Write=function(t){i.addContent(s("<span></span>").html(t))},t.each(function(t,e){i.addContent(s(e))}),delete window.n2Write,i.show()}}),N2D("ModalUrlTabAction",function(t,s){function e(t){var e=N2Classes.UI.modalFormRow(!0).appendTo(t);this.$select=N2Classes.UI.modalSelect(e,"action",n2_("Action"),{ScrollTo:n2_("Scroll to"),ScrollToAlias:n2_("Scroll to alias"),ToSlide:n2_("Go to slide"),ToSlideID:n2_("Go to slide ID"),PreviousSlide:n2_("Previous slide"),NextSlide:n2_("Next slide"),SlideEvent:n2_("Slide event")},"ScrollTo").on("nextendChange",function(){this.changeActive(this.$select.val())}.bind(this)),this.actions={ScrollTo:new n(t),ScrollToAlias:new o(t),ToSlide:new a(t),ToSlideID:new r(t),PreviousSlide:new l(t),NextSlide:new d(t),SlideEvent:new h(t)}}function i(t){this.$container=N2Classes.UI.modalHiddenContainer(t)}function n(t){i.prototype.constructor.apply(this,arguments);var e=N2Classes.UI.modalFormRow(!0).appendTo(this.$container);this.$scrollToField=N2Classes.UI.modalFieldText(e,"scroll-to",n2_("Scroll to"),""),e.find(".n2_field__element").addClass("n2_field_autocomplete").addClass("n2_autocomplete_position_to"),N2Classes.AutocompleteSimple("modal-field-scroll-to",["top","bottom","beforeSlider","afterSlider","previousSlider","nextSlider"]);e=N2Classes.UI.modalFormRow(!0).appendTo(this.$container);N2Classes.UI.modalTable(e,"scroll-to-examples",n2_("Examples"),[["top",n2_("Scrolls to the top of the page.")],["bottom",n2_("Scrolls to the bottom of the page.")],["jQuery selector",n2_('You can use any jQuery selector to scroll to a specific element on the page. Example: "#pricing" scrolls to the element with the id of "pricing".')]])}function o(t){i.prototype.constructor.apply(this,arguments);var e=N2Classes.UI.modalFormRow(!0).appendTo(this.$container);this.$aliasField=N2Classes.UI.modalFieldText(e,"scroll-to-alias",n2_("Slider alias"),"");e=N2Classes.UI.modalFormRow(!0).appendTo(this.$container);N2Classes.UI.modalTable(e,"scroll-to-alias-examples",n2_("Examples"),[["myslider",n2_("Slider alias set at Slider settings > General")]])}function a(t){i.prototype.constructor.apply(this,arguments);var e=N2Classes.UI.modalFormRow().appendTo(this.$container);this.$toSlideField=N2Classes.UI.modalNumber(e,"to-slide",n2_("Slide index"),1),this.$toDirectionField=N2Classes.UI.modalSelect(e,"to-slide-direction",n2_("Direction"),{auto:n2_("Auto"),backward:n2_("Backward"),forward:n2_("Forward")},"auto");e=N2Classes.UI.modalFormRow(!0).appendTo(this.$container);N2Classes.UI.modalTable(e,"to-slide-examples",n2_("Examples"),[[n2_sprintf(n2_("slide index: 2 %s direction: backward"),"<br>"),n2_("Switches to the second slide as if the previous arrow was pressed")],[n2_sprintf(n2_("slide index: 5 %s direction: forward"),"<br>"),n2_("Switches to the fifth slide as if the next arrow was pressed")]])}function r(t){i.prototype.constructor.apply(this,arguments);var e=N2Classes.UI.modalFormRow().appendTo(this.$container);this.$toSlideIDField=N2Classes.UI.modalNumber(e,"to-slide-id",n2_("Slide ID"),1,{min:1,wide:6}),this.$toSlideIDDirectionField=N2Classes.UI.modalSelect(e,"to-slide-id-direction",n2_("Direction"),{auto:n2_("Auto"),backward:n2_("Backward"),forward:n2_("Forward")},"auto");e=N2Classes.UI.modalFormRow(!0).appendTo(this.$container);N2Classes.UI.modalTable(e,"to-slide-id-examples",n2_("Examples"),[[n2_sprintf(n2_("slide index: 2 %s direction: backward"),"<br>"),n2_("Switches to the slide with the #2 ID as if the previous arrow was pressed")],[n2_sprintf(n2_("slide index: 5 %s direction: forward"),"<br>"),n2_("Switches to the slide with the #5 ID as if the next arrow was pressed")]])}function l(t){i.prototype.constructor.apply(this,arguments)}function d(t){i.prototype.constructor.apply(this,arguments)}function h(t){i.prototype.constructor.apply(this,arguments);var e=N2Classes.UI.modalFormRow(!0).appendTo(this.$container);this.$slideEventField=N2Classes.UI.modalFieldText(e,"slide-event",n2_("Event name"),"");e=N2Classes.UI.modalFormRow(!0).appendTo(this.$container);N2Classes.UI.modalTable(e,"slide-event-examples",n2_("Examples"),[["myevent",n2_("An event you use to trigger layer animation(s) with")]])}return e.prototype.changeActive=function(t,e){e=e||[],this.active&&this.actions[this.active]&&this.actions[this.active].hide(),this.active=t,this.actions[t].show.apply(this.actions[t],e)},e.prototype.show=function(t){var e="ScrollTo",i=[""],t=t.match(/([a-zA-Z]+)\[(.*?)\]/);t&&this.actions[t[1]]!==s&&(e=t[1],i=t[2].split(",")),this.$select.val(e).trigger("change"),this.changeActive(e,i)},e.prototype.getResult=function(){return this.active+"["+this.actions[this.active].getArgs().join(",")+"]"},i.prototype.show=function(){this.$container.addClass("n2_modal__container_hidden--visible")},i.prototype.hide=function(){this.$container.removeClass("n2_modal__container_hidden--visible")},i.prototype.getArgs=function(){return[]},((n.prototype=Object.create(i.prototype)).constructor=n).prototype.show=function(t){i.prototype.show.call(this),this.$scrollToField.val(t||"")},n.prototype.getArgs=function(){return[this.$scrollToField.val()]},((o.prototype=Object.create(i.prototype)).constructor=o).prototype.show=function(t){i.prototype.show.call(this),this.$aliasField.val(t||"")},o.prototype.getArgs=function(){return[this.$aliasField.val()]},((a.prototype=Object.create(i.prototype)).constructor=a).prototype.show=function(t,e){switch(i.prototype.show.call(this),this.$toSlideField.val(t||1),e){case"0":e="backward";break;case"1":e="forward";break;default:e="auto"}this.$toDirectionField.val(e).trigger("change")},a.prototype.getArgs=function(){var t=[this.$toSlideField.val()];switch(this.$toDirectionField.val()){case"backward":t.push(0);break;case"forward":t.push(1)}return t},((r.prototype=Object.create(i.prototype)).constructor=r).prototype.show=function(t,e){switch(i.prototype.show.call(this),this.$toSlideIDField.val(t||1),e){case"0":e="backward";break;case"1":e="forward";break;default:e="auto"}this.$toSlideIDDirectionField.val(e).trigger("change")},r.prototype.getArgs=function(){var t=[this.$toSlideIDField.val()];switch(this.$toSlideIDDirectionField.val()){case"backward":t.push(0);break;case"forward":t.push(1)}return t},(l.prototype=Object.create(i.prototype)).constructor=l,(d.prototype=Object.create(i.prototype)).constructor=d,((h.prototype=Object.create(i.prototype)).constructor=h).prototype.show=function(t){i.prototype.show.call(this),this.$slideEventField.val(t||"")},h.prototype.getArgs=function(){return[this.$slideEventField.val()]},e}),N2D("ModalUrlTabLightbox",function(t,e){function i(t){var e=N2Classes.UI.modalFormRow(!0).appendTo(t);this.$contentList=N2Classes.UI.modalTextarea(e,"content-list",n2_("Content List - One Per Line")),N2Classes.UI.modalButton(n2_("Choose images"),"green","small").css("margin-bottom","20px").on("click",function(t){t.preventDefault(),nextend.imageHelper.openMultipleLightbox(function(t){for(var e=this.$contentList.val().replace(/\n$/,""),i=0;i<t.length;i++)e+="\n"+t[i].image;this.$contentList.val(e.replace(/^\n/,""))}.bind(this))}.bind(this)).appendTo(t);e=N2Classes.UI.modalFormRow(!0).appendTo(t);N2Classes.UI.modalTable(e,"lightbox-examples",n2_("Examples"),[["Image","https://smartslider3.com/image.jpg"],["YouTube","https://www.youtube.com/watch?v=3PPtkRU7D74"],["Vimeo","https://vimeo.com/144598279"],["Iframe","https://smartslider3.com"]]);e=N2Classes.UI.modalFormRow(!0).appendTo(t);this.$titleList=N2Classes.UI.modalTextarea(e,"title-list",n2_("Titles - One Per Line"));t=N2Classes.UI.modalFormRow().appendTo(t);this.$autoplayDuration=N2Classes.UI.modalNumber(t,"autoplay-duration",n2_("Autoplay duration"),0,{wide:3,unit:"ms"})}return i.prototype.show=function(t){var e=t.match(/lightbox\[(.+)\]/);if(e&&2===e.length)if("{"===e[1][0])try{var i=JSON.parse(e[1]);this.$contentList.val(i.urls.join("\n")),this.$titleList.val(i.titles.join("\n")),this.$autoplayDuration.val(i.autoplay)}catch(t){}else{t=e[1].split(",");0<parseInt(t[t.length-1])&&(this.$autoplayDuration.val(parseInt(t[t.length-1])),t.pop()),this.$contentList.val(t.join("\n"))}else this.$contentList.val(""),this.$titleList.val(""),this.$autoplayDuration.val(0)},i.prototype.getResult=function(){return"lightbox["+JSON.stringify({urls:this.$contentList.val().split("\n"),titles:this.$titleList.val().split("\n"),autoplay:Math.max(0,parseInt(this.$autoplayDuration.val()))})+"]"},i}),N2D("ModalUrlTabUrl",function(e,i){function t(t,e){this.modalManager=e,this.cache={};e=N2Classes.UI.modalFormRow(!0).appendTo(t);this.$url=N2Classes.UI.modalFieldText(e,"url",n2_("URL"),"");e=N2Classes.UI.modalFormRow(!0).appendTo(t);this.$searchKeyword=N2Classes.UI.modalFieldText(e,"search-keyword",n2_("Search keyword"),"").on("keyup",this.search.bind(this)).focus();t=N2Classes.UI.modalFormRow(!0).appendTo(t);this.$postSelector=N2Classes.UI.modalSelectList(t,"url-post",n2_("Posts"),function(t){this.$url.val(t.link)}.bind(this),{mode:"insert"})}return t.prototype.show=function(t){this.$url.val(t),this.$searchKeyword.val(""),this.search()},t.prototype.search=function(){this.searchString=this.$searchKeyword.val(),this.getAjaxSearchResult(this.searchString).done(function(t){if(this.$searchKeyword.val()===this.searchString){this.$postSelector.removeOptions();for(var e=t.data,i=0;i<e.length;i++)this.$postSelector.addOption(e[i].title,e[i].info,e[i])}}.bind(this))},t.prototype.getAjaxSearchResult=function(t){return this.cache[t]===i&&(this.cache[t]=e.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.modalManager.ajaxUrl),data:{keyword:t},dataType:"json"})),this.cache[t]},t.prototype.getResult=function(){return this.$url.val()},t}),N2D("ModalUrl",function(t,e){function s(t){this.ajaxUrl=t,this.activeTab="",this.modal=new N2Classes.ModalSimple("url-modal"),this.modal.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--link","green").css("margin-bottom","20px")),this.uiTabs=N2Classes.UI.modalTabs(this.modal.getBody(),"url-tabs",{url:n2_("URL"),lightbox:n2_("Lightbox"),action:n2_("Action")},this.onTabActiveChange.bind(this)),this.tabs={},this.tabs.url=new N2Classes.ModalUrlTabUrl(this.uiTabs.tabs.url.$content,this),this.tabs.lightbox=new N2Classes.ModalUrlTabLightbox(this.uiTabs.tabs.lightbox.$content),this.tabs.action=new N2Classes.ModalUrlTabAction(this.uiTabs.tabs.action.$content);t=N2Classes.UI.modalButton(n2_("Insert"),"green");this.modal.addButton(t),t.on("click",function(t){t.preventDefault(),this.setCallback(this.tabs[this.activeTab].getResult()),this.modal.hide()}.bind(this))}s.prototype.onTabActiveChange=function(t){this.activeTab=t,this.tabs[t].show(this.originalValue)};var n=!(s.prototype.show=function(t,e){this.originalValue=t,this.setCallback=e,t.match(/lightbox\[(.+)\]/)?this.uiTabs.setActiveTab("lightbox"):t.match(/ScrollTo|ScrollToAlias|SlideEvent|ToSlide|ToSlideID|\[(.+)\]/)||t.match(/PreviousSlide|NextSlide|\[\]/)?this.uiTabs.setActiveTab("action"):this.uiTabs.setActiveTab("url"),this.modal.show()});function i(){}return i.show=function(t,e,i){(n=n||new s(e)).show(t,i)},i}),N2D("UI",function(c,n){var l={modalButton:function(t,e,i){return c('<a class="n2_button n2_button--'+(i=i||"big")+" n2_button--"+e+'" href="#"><span class="n2_button__label">'+t+"</span></a>")},modalIcon:function(t,e){return c('<div class="n2_modal__icon n2_modal__icon--'+e+'"><i class="'+t+'"></i></div>')},modalHeading:function(t){return c('<div class="n2_modal__heading"></div>').text(t)},modalSubHeading:function(t){return c('<div class="n2_modal__subheading"></div>').text(t)},modalParagraph:function(t){return c('<div class="n2_modal__paragraph"></div>').text(t)},modalParagraphHTML:function(t){return c('<div class="n2_modal__paragraph"></div>').html(t)},modalInput:function(t,e,i,s){return c('<input class="n2_modal__input" type="'+e+'" id="'+t+'" name="'+t+'" value="'+i+'" '+(s!==n?'placeholder="'+s+'"':"")+"/>")},modalFormTable:function(t){var e=c('<div class="n2_form__table"></div>');return c('<div class="n2_form__table_label"></div>').append(c('<div class="n2_form__table_label_title"></div>').text(t)).appendTo(e),{$table:e,$content:c('<div class="n2_form__table_preview"></div>').appendTo(e)}},modalFormContainer:function(t,e){return c('<div class="n2_modal__form_container" data-field="'+e+'"></div>').appendTo(t)},modalHiddenContainer:function(t){return c('<div class="n2_modal__container_hidden"></div>').appendTo(t)},modalFormRow:function(t){return c('<div class="n2_modal__form_row"></div>').toggleClass("n2_modal__form_row--fullwidth",!0===t)},modalFormRowLarge:function(t){return c('<div class="n2_modal__form_row n2_modal__form_row--large"></div>').toggleClass("n2_modal__form_row--fullwidth",!0===t)},modalFieldWrapper:function(t,e,i){t=c('<div class="n2_field" data-field="'+e+'"></div>').appendTo(t);return!1===i?t.addClass("n2_field--label-none"):""===i&&t.addClass("n2_field--label-placeholder"),i&&c('<div class="n2_field__label"><label for="modal-field-'+e+'">'+i+"</label></div>").appendTo(t),{$field:t,$element:c('<div class="n2_field__element"></div>').appendTo(t)}},modalFieldText:function(t,e,i,s){i=l.modalFieldWrapper(t,e,i),i=c('<div class="n2_field_text"></div>').appendTo(i.$element),i=c('<input type="text" id="modal-field-'+e+'" name="'+e+'" autocomplete="off">').val(s).appendTo(i);return new N2Classes.FormElementText("modal-field-"+e),i},modalOnOff:function(t,e,i,s,n){i=l.modalFieldWrapper(t,e,i),i=c('<div class="n2_field_onoff"><div class="n2_field_onoff__slider"><div class="n2_field_onoff__slider_bullet"></div></div><div class="n2_field_onoff__labels"><div class="n2_field_onoff__label n2_field_onoff__label_off">'+n2_("Off")+'</div><div class="n2_field_onoff__label n2_field_onoff__label_on">'+n2_("On")+"</div></div></div>").appendTo(i.$element),i=c('<input id="modal-field-'+e+'" name="'+e+'" value="'+s+'" type="hidden" autocomplete="off">').val(s).appendTo(i);return new N2Classes.FormElementOnoff("modal-field-"+e,n),i},modalSelect:function(t,e,i,s,n,o){o=c.extend({isMultiple:!1},o);var a,t=l.modalFieldWrapper(t,e,i),i=c('<input id="modal-field-'+e+'" name="'+e+'" value="'+n+'" type="hidden" autocomplete="off">').appendTo(t.$element),r=c('<select id="modal-field-'+e+'_select" name="select'+e+'" autocomplete="off"></select>');for(a in o.isMultiple&&r.attr("multiple","multiple").attr("size","8"),s)r.append('<option value="'+a+'">'+s[a]+"</option>");return c('<div class="n2_field_select"></div>').append(r).appendTo(t.$element),new N2Classes.FormElementList("modal-field-"+e).insideChange(n),i},modalNumber:function(t,e,i,s,n){var o=100;switch((n=c.extend({unit:!1,min:-Number.MAX_VALUE,max:Number.MAX_VALUE,wide:4,sublabel:""},n)).wide){case 2:o=20;break;case 3:o=26;break;case 4:o=32;break;case 5:o=44;break;case 6:o=60}i=l.modalFieldWrapper(t,e,i),i=c('<div class="n2_field_text n2_field_number"></div>').appendTo(i.$element);""!==n.sublabel&&c('<div class="n2_field_number__unit"></div>').text(n.sublabel).appendTo(i);s=c('<input id="modal-field-'+e+'" name="'+e+'" value="'+s+'" type="text" autocomplete="off">').css("width",o).appendTo(i);return n.unit&&c('<div class="n2_field_number__unit"></div>').text(n.unit).appendTo(i),new N2Classes.FormElementNumber("modal-field-"+e,n.min,n.max),s},modalTextarea:function(t,e,i){i=l.modalFieldWrapper(t,e,i),i=c('<div class="n2_field_textarea"></div>').appendTo(i.$element);return c('<textarea name="'+e+'" autocomplete="off"></textarea>').appendTo(i)},modalTable:function(t,e,i,s){i=l.modalFieldWrapper(t,e,i);i.$field.addClass("n2_field_table");for(var n=c('<div class="n2_field_table__content"></div>').css("grid-template-columns","repeat("+s[0].length+", auto)").appendTo(i.$element),o=0;o<s.length;o++)for(var a=0;a<s[o].length;a++)c('<div class="n2_field_table__cell">'+s[o][a]+"</div>").appendTo(n);return n},modalSelectList:function(t,e,i,s,n){n=c.extend({mode:"select"},n);var o=l.modalFieldWrapper(t,e,i),a=c('<div class="n2_field_select_list"></div>').appendTo(o.$element);return{getField:function(){return o.$field},addOption:function(t,e,i){c('<div class="n2_field_select_list__option"></div>').on("click",function(t,e){"select"===n.mode&&(o.$field.find(".n2_field_select_list__option--selected").removeClass("n2_field_select_list__option--selected"),c(e.currentTarget).addClass("n2_field_select_list__option--selected")),s(t)}.bind(this,i)).append(c('<div class="n2_field_select_list__option_primary"></div>').text(t)).append(c('<div class="n2_field_select_list__option_secondary"></div>').text(e)).appendTo(a)},removeOptions:function(){a.html("")}}},modalGeneratorVariableList:function(t,e,i,s,n,o){t.addContent(this.modalHeading(n2_(i)));i=N2Classes.UI.modalFormRow(!0);t.addContent(i);var a,r,n=N2Classes.UI.modalFieldWrapper(i,s,n),l=c('<div class="n2_generator_variables"></div>').appendTo(n.$element),d=[];if(Number.isInteger(e))for(var h=1;h<=e;h++)d[h]=h;else d=e;for(r in d){var p=c('<div class="n2_generator_variables__variable"></div>');p.text(r).on("click",function(t){a.removeClass("n2_generator_variables__variable--selected"),this.addClass("n2_generator_variables__variable--selected"),o(t)}.bind(p,r)).appendTo(l)}(a=l.find(".n2_generator_variables__variable")).eq(0).addClass("n2_generator_variables__variable--selected")},modalTabs:function(t,e,i,s){var n,t=c('<div class="n2_modal_tab"></div>').appendTo(t),o=c('<div class="n2_modal_tab__tabs"></div>').appendTo(t),a=c('<div class="n2_modal_tab__tabs_contents"></div>').appendTo(t),r=!1,l={};function d(t){r&&r!==t&&(l[r].$button.removeClass("n2_modal_tab__tabs_button--active"),l[r].$content.removeClass("n2_modal_tab__tabs_content--active")),l[r=t].$button.addClass("n2_modal_tab__tabs_button--active"),l[r].$content.addClass("n2_modal_tab__tabs_content--active"),s(r)}for(n in i)l[n]={$button:c('<div class="n2_modal_tab__tabs_button" data-tab="'+n+'">'+i[n]+"</div>").on("click",d.bind(this,n)).appendTo(o),$content:c('<div class="n2_modal_tab__tabs_content" data-tab="'+n+'"></div>').appendTo(a)};return{tabs:l,setActiveTab:d}},modalFieldSelectIcon:function(t,e,i,s,n,o){var a,i=l.modalFieldWrapper(t,e,i),r=c('<div class="n2_field_select_icon"></div>').appendTo(i.$element);for(a in s)c('<div class="n2_field_select_icon__option"></div>').attr("data-value",a).toggleClass("n2_field_select_icon__option--selected",a===n).append('<div class="n2_field_select_icon__option_icon"><i class="'+s[a].icon+'"></i></div>').append('<div class="n2_field_select_icon__option_label">'+s[a].label+"</div>").append('<div class="n2_field_select_icon__selected_marker"><i class="ssi_16 ssi_16--check"></i></div>').appendTo(r);i=c('<input id="modal-field-'+e+'" name="'+e+'" value="'+n+'" type="hidden" />').appendTo(i.$element);return new N2Classes.FormElementSelectIcon("modal-field-"+e,o),i},modalNotice:function(t,e,i){t=l.modalFieldWrapper(t,"notice",n2_("Notice"));return c('<div class="n2_field_message n2_field_message--'+i+'"></div>').html(n2_(e)).appendTo(t.$element)}};return l}),N2D("AutocompleteSimple",function(s,t){return function(t,e){var i=s("#"+t);new N2Classes.UIAutocomplete(i,{positionTo:".n2_autocomplete_position_to",y:-2,appendTo:function(){return i.closest(".n2_container_scrollable, body")},source:function(){return e},select:function(t,e){s(this).val(e.value).trigger("change")}})}}),N2D("Spectrum",function(Ct,wt){var t,xt=null,Nt={beforeShow:i,move:i,change:i,show:i,hide:i,color:!1,flat:!1,showInput:!1,showButtons:!0,clickoutFiresChange:!1,showInitial:!1,showPalette:!1,showPaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",preferredFormat:!1,className:"",showAlpha:!1,theme:"n2-sp-light",palette:["fff","000"],selectionPalette:[],disabled:!1},St=[],kt=!!/msie/i.exec(window.navigator.userAgent),Tt=((t=document.createElement("div").style).cssText="background-color:rgba(0,0,0,.5)",e(t.backgroundColor,"rgba")||e(t.backgroundColor,"hsla")),Dt=["<div class='n2-sp-replacer'>","<div class='n2-sp-preview'></div>","</div>"].join(""),It=function(){var t="";if(kt)for(var e=1;e<=6;e++)t+="<div class='n2-sp-"+e+"'></div>";return["<div class='n2-sp-container'>","<div class='n2-sp-palette-container'>","<div class='n2-sp-palette n2-sp-thumb n2-sp-cf'></div>","</div>","<div class='n2-sp-picker-container'>","<div class='n2-sp-top n2-sp-cf'>","<div class='n2-sp-fill'></div>","<div class='n2-sp-top-inner'>","<div class='n2-sp-color'>","<div class='n2-sp-sat'>","<div class='n2-sp-val'>","<div class='n2-sp-dragger'></div>","</div>","</div>","</div>","<div class='n2-sp-hue'>","<div class='n2-sp-slider'></div>",t,"</div>","</div>","<div class='n2-sp-alpha'><div class='n2-sp-alpha-inner'><div class='n2-sp-alpha-handle'></div></div></div>","</div>","<div class='n2-sp-input-container n2-sp-cf'>","<input class='n2-sp-input' type='text' spellcheck='false'  />","</div>","<div class='n2-sp-initial n2-sp-thumb n2-sp-cf'></div>","<div class='n2-sp-button-container n2-sp-cf'>","<a class='n2-sp-cancel' href='#'></a>","<button class='n2-sp-choose'></button>","</div>","</div>","</div>"].join("")}();function e(t,e){return!!~(""+t).indexOf(e)}function Pt(t,e,i){for(var s=[],n=0;n<t.length;n++){var o=xt(t[n]),a=o.toHsl().l<.5?"n2-sp-thumb-el n2-sp-thumb-dark":"n2-sp-thumb-el n2-sp-thumb-light";a+=xt.equals(e,t[n])?" n2-sp-thumb-active":"";var r="background-color:"+o.toRgbString();s.push('<span title="'+o.toRgbString()+'" data-color="'+o.toRgbString()+'" class="'+a+'"><span class="n2-sp-thumb-inner" style="'+r+';"></span></span>')}return"<div class='n2-sp-cf "+i+"'>"+s.join("")+"</div>"}function o(t,e){var i,s,n,o,a,r=(a=e,e=t,(a=Ct.extend({},Nt,a)).callbacks={move:At(a.move,e),change:At(a.change,e),show:At(a.show,e),hide:At(a.hide,e),beforeShow:At(a.beforeShow,e)},a),l=r.flat,d=r.showSelectionPalette,h=r.localStorageKey,p=r.theme,c=r.callbacks,u=(i=vt,function(){var t=this,e=arguments;n&&clearTimeout(o),!n&&o||(o=setTimeout(function(){o=null,i.apply(t,e)},s))}),f=!(s=10),m=0,g=0,y=0,v=0,_=0,b=0,C=0,w=0,x=0,N=0,S=1,a=r.palette.slice(0),k=Ct.isArray(a[0])?a:[a],T=r.selectionPalette.slice(0),D="n2-sp-dragging",I=t.ownerDocument,P=I.body,$=Ct(t),A=!1,E=Ct(It,I).addClass(p),F=E.find(".n2-sp-color"),M=E.find(".n2-sp-dragger"),L=E.find(".n2-sp-hue"),R=E.find(".n2-sp-slider"),O=E.find(".n2-sp-alpha-inner"),z=E.find(".n2-sp-alpha"),H=E.find(".n2-sp-alpha-handle"),U=E.find(".n2-sp-input"),j=E.find(".n2-sp-palette"),B=E.find(".n2-sp-initial"),V=E.find(".n2-sp-cancel"),W=E.find(".n2-sp-choose"),G=$.is("input"),X=G&&!l,K=null,q=null,Y=null,Z=r.color||G&&$.val(),J=!1,Q=r.preferredFormat,tt=Q,et=!r.showButtons||r.clickoutFiresChange;function it(t){E.toggleClass("n2-sp-flat",l),E.toggleClass("n2-sp-input-disabled",!r.showInput),E.toggleClass("n2-sp-alpha-enabled",r.showAlpha),E.toggleClass("n2-sp-buttons-disabled",!r.showButtons||l),E.toggleClass("n2-sp-palette-disabled",!r.showPalette),E.toggleClass("n2-sp-palette-only",r.showPaletteOnly),E.toggleClass("n2-sp-initial-disabled",!r.showInitial),E.addClass(r.className),t===wt&&vt()}function st(t){if(d){t=xt(t).toRgbString();if(-1===T.indexOf(t)&&T.push(t),h&&window.localStorage)try{window.localStorage[h]=T.join(";")}catch(t){}}}function nt(){var i=ut(),t=Ct.map(k,function(t,e){return Pt(t,i,"n2-sp-palette-row n2-sp-palette-row-"+e)});T&&t.push(Pt(function(){var t,e=[],i=T,s={};if(r.showPalette){for(var n,o=0;o<k.length;o++)for(var a=0;a<k[o].length;a++)s[t=xt(k[o][a]).toRgbString()]=!0;for(o=0;o<i.length;o++)!r.showAlpha&&i[o].startsWith("rgba")&&((n=i[o].split(","))[0]=n[0].replace("rgba","rgb"),n.pop(),i[o]=n.join(",")+")"),t=xt(i[o]).toRgbString(),s.hasOwnProperty(t)||(e.push(i[o]),s[t]=!0)}return r.showAlpha||(r.maxSelectionSize=5),e.reverse().slice(0,r.maxSelectionSize)}(),i,"n2-sp-palette-row n2-sp-palette-row-selection")),j.html(t.join(""))}function ot(){var t,e;r.showInitial&&(t=J,e=ut(),B.html(Pt([t,e],e,"n2-sp-palette-row-initial")))}function at(){0!==g&&0!==m&&0!==v||vt(),E.addClass(D)}function rt(){E.removeClass(D)}function lt(){var t=xt(U.val());t.ok?ct(t):U.addClass("n2-sp-validation-error")}function dt(){(f?pt:ht)()}function ht(){f?vt():!1!==c.beforeShow(ut())&&(function(){for(var t=0;t<St.length;t++)St[t]&&St[t].hide()}(),f=!0,Ct(I).bind("click.spectrum",pt),Ct(window).bind("resize.spectrum",u),K.addClass("n2-sp-active"),E.show(),r.showPalette&&nt(),vt(),mt(),J=ut(),ot(),c.show(J))}function pt(t){t&&"click"==t.type&&2==t.button||f&&!l&&(f=!1,Ct(I).unbind("click.spectrum",pt),Ct(window).unbind("resize.spectrum",u),K.removeClass("n2-sp-active"),E.hide(),xt.equals(ut(),J)||(et&&"cancel"!==t?yt(!0):ct(J,!0)),c.hide(ut()))}function ct(t,e){var i;xt.equals(t,ut())||(t=(i=xt(t)).toHsv(),w=t.h,x=t.s,N=t.v,S=t.a,mt(),e||(tt=Q||i.format))}function ut(){return xt.fromRatio({h:w,s:x,v:N,a:Math.round(100*S)/100})}function ft(){mt(),c.move(ut())}function mt(){U.removeClass("n2-sp-validation-error"),gt();var t=xt({h:w,s:"1.0",v:"1.0"});F.css("background-color","#"+t.toHexString());var e=tt;S<1&&("hex"!==e&&"name"!==e||(e="rgb"));var i=ut(),s=i.toHexString(),t=i.toRgbString();Tt||1===i.alpha?Y.css("background-color",t):(Y.css("background-color","transparent"),Y.css("filter",i.toFilter())),r.showAlpha&&((t=i.toRgb()).a=0,s="linear-gradient(to right, "+xt(t).toRgbString()+", "+s+")",O.css("background",s)),r.showInput&&(S<1&&("hex"!==e&&"name"!==e||(e="rgb")),U.val(i.toString(e))),r.showPalette&&nt(),ot()}function gt(){var t=x*m,e=g-N*g,t=Math.max(-y,Math.min(m-y,t-y)),e=Math.max(-y,Math.min(g-y,e-y));M.css({top:e,left:t});t=S*_;H.css({left:t-b/2});t=w*v;R.css({top:t-C})}function yt(t){var e=ut();G&&$.val(e.toString(tt)).change();st(J=e),t&&c.change(e)}function vt(){var t,e,i,s,n,o,a;m=F.width(),g=F.height(),y=M.height(),L.width(),v=L.height(),C=R.height(),_=z.width(),b=H.width(),l||E.offset((t=E,e=q.parent(),i=t.outerWidth(),s=t.outerHeight(),n=e.outerHeight(),o=t[0].ownerDocument,a=o.documentElement,t=a.clientWidth+Ct(o).scrollLeft(),o=a.clientHeight+Ct(o).scrollTop(),(e=e.offset()).top+=n+3,e.left-=Math.min(e.left,e.left+i>t&&i<t?Math.abs(e.left+i-t):0),e.top-=Math.min(e.top,e.top+s>o&&s<o?Math.abs(+(s+n+6)):0),e)),gt()}function _t(){pt(),A=!0,$.attr("disabled",!0),q.addClass("n2-sp-disabled")}!function(){kt&&E.find("*:not(input)").attr("unselectable","on");var t=$.parent().find(".n2-sp-replacer");if(t.length?K=t:(K=X?Ct(Dt).addClass(p):Ct([]),X&&$.parent().after(K)),q=X?K:$,Y=K.find(".n2-sp-preview"),it(!0),l?$.parent().after(E).hide():Ct(P).append(E.hide()),h&&window.localStorage)try{T=window.localStorage[h].split(";")}catch(t){}function e(t){return t.data&&t.data.ignore?(ct(Ct(this).data("color")),ft()):(ct(Ct(this).data("color")),yt(!0),ft(),pt()),!1}q.bind("click.spectrum touchstart.spectrum",function(t){A||dt(),t.stopPropagation(),Ct(t.target).is("input")||t.preventDefault()}),!$.is(":disabled")&&!0!==r.disabled||_t(),E.click($t),U.change(lt),U.bind("paste",function(){setTimeout(lt,1)}),U.keydown(function(t){13==t.keyCode&&lt()}),V.text(r.cancelText),V.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),pt("cancel")}),W.text(r.chooseText),W.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),U.hasClass("n2-sp-validation-error")||(yt(!0),pt())}),Et(z,function(t,e,i){S=t/_,i.shiftKey&&(S=Math.round(10*S)/10),ft()}),Et(L,function(t,e){w=parseFloat(e/v),ft()},at,rt),Et(F,function(t,e){x=parseFloat(t/m),N=parseFloat((g-e)/g),ft()},at,rt),Z?(ct(Z),mt(),tt=Q||xt(Z).format,st(Z)):mt(),l&&ht(),t=kt?"mousedown.spectrum":"click.spectrum touchstart.spectrum",j.delegate(".n2-sp-thumb-el",t,e),B.delegate(".n2-sp-thumb-el:nth-child(1)",t,{ignore:!0},e)}();var bt={show:ht,hide:pt,toggle:dt,reflow:vt,option:function(t,e){return t===wt?Ct.extend({},r):e===wt?r[t]:(r[t]=e,void it())},enable:function(){A=!1,$.attr("disabled",!1),q.removeClass("n2-sp-disabled")},disable:_t,set:function(t){ct(t),yt()},get:ut,destroy:function(){$.show(),q.unbind("click.spectrum touchstart.spectrum"),E.remove(),K.remove(),St[bt.id]=null},container:E};return bt.id=St.push(bt)-1,bt}function i(){}function $t(t){t.stopPropagation()}function At(t,e){var i=Array.prototype.slice,s=i.call(arguments,2);return function(){return t.apply(e,s.concat(i.call(arguments)))}}function Et(s,n,i,t){n=n||function(){},i=i||function(){},t=t||function(){};var o=s.ownerDocument||document,a=!1,r={},l=0,d=0,h=!1,p={};function c(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.returnValue=!1}function u(t){if(a){if(kt&&document.documentMode<9&&!t.button)return f();var e=t.originalEvent.touches,i=(e?e[0]:t).pageX,e=(e?e[0]:t).pageY,i=Math.max(0,Math.min(i-r.left,d)),e=Math.max(0,Math.min(e-r.top,l));h&&c(t),n.apply(s,[i,e,t])}}function f(){a&&(Ct(o).unbind(p),Ct(o.body).removeClass("n2-sp-dragging"),t.apply(s,arguments)),a=!1}p.selectstart=c,p.dragstart=c,p[h?"touchmove":"mousemove"]=u,p[h?"touchend":"mouseup"]=f,Ct(s).bind(h?"touchstart":"mousedown",function(t){var e=t.which?3==t.which:2==t.button;t.originalEvent.touches,e||a||!1!==i.apply(s,arguments)&&(a=!0,l=Ct(s).height(),d=Ct(s).width(),r=Ct(s).offset(),Ct(o).bind(p),Ct(o.body).addClass("n2-sp-dragging"),h||u(t),c(t))})}var a="spectrum.id";return Ct.fn.n2spectrum=function(i,t){if("string"!=typeof i)return this.n2spectrum("destroy").each(function(){var t=o(this,i);Ct(this).data(a,t.id)});var s=this,n=Array.prototype.slice.call(arguments,1);return this.each(function(){var t=St[Ct(this).data(a)];if(t){var e=t[i];if(!e)throw new Error("Spectrum: no such method: '"+i+"'");"get"==i?s=t.get():"container"==i?s=t.container:"option"==i?s=t.option.apply(t,n):"destroy"==i?(t.destroy(),Ct(this).removeData(a)):e.apply(t,n)}}),s},Ct.fn.n2spectrum.load=!0,Ct.fn.n2spectrum.loadOpts={},Ct.fn.n2spectrum.draggable=Et,Ct.fn.n2spectrum.defaults=Nt,Ct.n2spectrum={},Ct.n2spectrum.localization={},Ct.n2spectrum.palettes={},function(){var o=/^[\s,#]+/,h=/\s+$/,s=0,p=Math,c=p.round,u=p.min,f=p.max,t=p.random;function n(t,e,i){t=_(t,255),e=_(e,255),i=_(i,255);var s,n=f(t,e,i),o=u(t,e,i),a=(n+o)/2;if(n==o)s=l=0;else{var r=n-o,l=.5<a?r/(2-n-o):r/(n+o);switch(n){case t:s=(e-i)/r+(e<i?6:0);break;case e:s=(i-t)/r+2;break;case i:s=(t-e)/r+4}s/=6}return{h:s,s:l,l:a}}function m(t,e,i){t=_(t,255),e=_(e,255),i=_(i,255);var s,n=f(t,e,i),o=u(t,e,i),a=n,r=n-o,l=0===n?0:r/n;if(n==o)s=0;else{switch(n){case t:s=(e-i)/r+(e<i?6:0);break;case e:s=(i-t)/r+2;break;case i:s=(t-e)/r+4}s/=6}return{h:s,s:l,v:a}}function g(t,e,i,s){i=[C(c(t).toString(16)),C(c(e).toString(16)),C(c(i).toString(16))];return s||i[0].charAt(0)!=i[0].charAt(1)||i[1].charAt(0)!=i[1].charAt(1)||i[2].charAt(0)!=i[2].charAt(1)?i.join(""):i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0)}(xt=function(t,e){if("object"==typeof t&&t.hasOwnProperty("_tc_id"))return t;var i=function(t){var e={r:0,g:0,b:0},i=1,s=!1,n=!1;"string"==typeof t&&(t=function(t){t=t.replace(o,"").replace(h,"").toLowerCase();var e,i=!1;if(y[t])t=y[t],i=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0};if(e=w.rgb.exec(t))return{r:e[1],g:e[2],b:e[3]};if(e=w.rgba.exec(t))return{r:e[1],g:e[2],b:e[3],a:e[4]};if(e=w.hsl.exec(t))return{h:e[1],s:e[2],l:e[3]};if(e=w.hsla.exec(t))return{h:e[1],s:e[2],l:e[3],a:e[4]};if(e=w.hsv.exec(t))return{h:e[1],s:e[2],v:e[3]};if(e=w.hex6.exec(t))return{r:b(e[1]),g:b(e[2]),b:b(e[3]),format:i?"name":"hex"};if(e=w.hex8.exec(t))return{r:b(e[1]),g:b(e[2]),b:b(e[3]),a:b(e[4])/255,format:i?"name":"hex"};if(e=w.hex3.exec(t))return{r:b(e[1]+""+e[1]),g:b(e[2]+""+e[2]),b:b(e[3]+""+e[3]),format:i?"name":"hex"};return!1}(t));"object"==typeof t&&(t.hasOwnProperty("r")&&t.hasOwnProperty("g")&&t.hasOwnProperty("b")?(e=function(t,e,i){return{r:255*_(t,255),g:255*_(e,255),b:255*_(i,255)}}(t.r,t.g,t.b),s=!0,n="rgb"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("v")?(e=function(t,e,i){t=6*_(t,360),e=_(e,100),i=_(i,100);var s=p.floor(t),n=t-s,o=i*(1-e),t=i*(1-n*e),e=i*(1-(1-n)*e),s=s%6;return{r:255*[i,t,o,o,e,i][s],g:255*[e,i,i,t,o,o][s],b:255*[o,o,e,i,i,t][s]}}(t.h,t.s,t.v),s=!0,n="hsv"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("l")&&(e=function(t,e,i){var s,n,o;function a(t,e,i){return i<0&&(i+=1),1<i&&--i,i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}t=_(t,360),e=_(e,100),i=_(i,100),0===e?s=n=o=i:(s=a(e=2*i-(i=i<.5?i*(1+e):i+e-i*e),i,t+1/3),n=a(e,i,t),o=a(e,i,t-1/3));return{r:255*s,g:255*n,b:255*o}}(t.h,t.s,t.l),s=!0,n="hsl"),t.hasOwnProperty("a")&&(i=t.a));e.r=u(255,f(e.r,0)),e.g=u(255,f(e.g,0)),e.b=u(255,f(e.b,0)),e.r<1&&(e.r=c(e.r));e.g<1&&(e.g=c(e.g));e.b<1&&(e.b=c(e.b));return{ok:s,format:t&&t.format||n,r:e.r,g:e.g,b:e.b,a:i}}(t),a=i.r,r=i.g,l=i.b,d=parseFloat(i.a),t=i.format;return{ok:i.ok,format:t,_tc_id:s++,alpha:d,toHsv:function(){var t=m(a,r,l);return{h:t.h,s:t.s,v:t.v,a:d}},toHsvString:function(){var t=m(a,r,l),e=c(360*t.h),i=c(100*t.s),t=c(100*t.v);return 1==d?"hsv("+e+", "+i+"%, "+t+"%)":"hsva("+e+", "+i+"%, "+t+"%, "+d+")"},toHsl:function(){var t=n(a,r,l);return{h:t.h,s:t.s,l:t.l,a:d}},toHslString:function(){var t=n(a,r,l),e=c(360*t.h),i=c(100*t.s),t=c(100*t.l);return 1==d?"hsl("+e+", "+i+"%, "+t+"%)":"hsla("+e+", "+i+"%, "+t+"%, "+d+")"},toHex:function(){return g(a,r,l)},toHexString:function(t){return g(a,r,l,t)},toHexString8:function(){return g(a,r,l,!0)+C(c(255*d).toString(16))},toRgb:function(){return{r:c(a),g:c(r),b:c(l),a:d}},toRgbString:function(){return 1==d?"rgb("+c(a)+", "+c(r)+", "+c(l)+")":"rgba("+c(a)+", "+c(r)+", "+c(l)+", "+d+")"},toName:function(){return v[g(a,r,l)]||!1},toFilter:function(t,e){var i=g(a,r,l,!0),s=i,n=Math.round(255*parseFloat(d)).toString(16),o=n,t=t&&t.gradientType?"GradientType = 1, ":"";return e&&(s=(e=xt(e)).toHex(),o=Math.round(255*parseFloat(e.alpha)).toString(16)),"progid:DXImageTransform.Microsoft.gradient("+t+"startColorstr=#"+C(n)+i+",endColorstr=#"+C(o)+s+")"},toString:function(t){var e=!1;return"rgb"===(t=t||this.format)&&(e=this.toRgbString()),"hex"===t&&(e=this.toHexString()),"hex6"===t&&(e=this.toHexString(!0)),"hex8"===t&&(e=this.toHexString8()),"name"===t&&(e=this.toName()),"hsl"===t&&(e=this.toHslString()),"hsv"===t&&(e=this.toHsvString()),e||this.toHexString(!0)}}}).fromRatio=function(t){if("object"==typeof t)for(var e in t)1===t[e]&&(t[e]="1.0");return xt(t)},xt.equals=function(t,e){return!(!t||!e)&&xt(t).toRgbString()==xt(e).toRgbString()},xt.random=function(){return xt.fromRatio({r:t(),g:t(),b:t()})},xt.desaturate=function(t,e){t=xt(t).toHsl();return t.s-=(e||10)/100,t.s=i(t.s),xt(t)},xt.saturate=function(t,e){t=xt(t).toHsl();return t.s+=(e||10)/100,t.s=i(t.s),xt(t)},xt.greyscale=function(t){return xt.desaturate(t,100)},xt.lighten=function(t,e){t=xt(t).toHsl();return t.l+=(e||10)/100,t.l=i(t.l),xt(t)},xt.darken=function(t,e){t=xt(t).toHsl();return t.l-=(e||10)/100,t.l=i(t.l),xt(t)},xt.complement=function(t){t=xt(t).toHsl();return t.h=(t.h+.5)%1,xt(t)},xt.triad=function(t){var e=xt(t).toHsl(),i=360*e.h;return[xt(t),xt({h:(120+i)%360,s:e.s,l:e.l}),xt({h:(240+i)%360,s:e.s,l:e.l})]},xt.tetrad=function(t){var e=xt(t).toHsl(),i=360*e.h;return[xt(t),xt({h:(90+i)%360,s:e.s,l:e.l}),xt({h:(180+i)%360,s:e.s,l:e.l}),xt({h:(270+i)%360,s:e.s,l:e.l})]},xt.splitcomplement=function(t){var e=xt(t).toHsl(),i=360*e.h;return[xt(t),xt({h:(72+i)%360,s:e.s,l:e.l}),xt({h:(216+i)%360,s:e.s,l:e.l})]},xt.analogous=function(t,e,i){e=e||6,i=i||30;var s=xt(t).toHsl(),n=360/i,o=[xt(t)];for(s.h*=360,s.h=(s.h-(n*e>>1)+720)%360;--e;)s.h=(s.h+n)%360,o.push(xt(s));return o},xt.monochromatic=function(t,e){e=e||6;for(var t=xt(t).toHsv(),i=t.h,s=t.s,n=t.v,o=[],a=1/e;e--;)o.push(xt({h:i,s:s,v:n})),n=(n+a)%1;return o},xt.readable=function(t,e){t=xt(t).toRgb(),e=xt(e).toRgb();return 10404<(e.r-t.r)*(e.r-t.r)+(e.g-t.g)*(e.g-t.g)+(e.b-t.b)*(e.b-t.b)};var y=xt.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},v=xt.hexNames=function(t){var e,i={};for(e in t)t.hasOwnProperty(e)&&(i[t[e]]=e);return i}(y);function _(t,e){"string"==typeof(i=t)&&-1!=i.indexOf(".")&&1===parseFloat(i)&&(t="100%");var i,i="string"==typeof(i=t)&&-1!=i.indexOf("%");return t=u(e,f(0,parseFloat(t))),i&&(t*=e/100),p.abs(t-e)<1e-6?1:1<=t?t%e/parseFloat(e):t}function i(t){return u(1,f(0,t))}function b(t){return parseInt(t,16)}function C(t){return 1==t.length?"0"+t:""+t}var e,a,w=(a="[\\s|\\(]+("+(e="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?",e="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?",{rgb:new RegExp("rgb"+a),rgba:new RegExp("rgba"+e),hsl:new RegExp("hsl"+a),hsla:new RegExp("hsla"+e),hsv:new RegExp("hsv"+a),hex3:/^([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/})}(),Ct.fn.n2spectrum}),N2D("Notification",function(o,t){function e(){this.deferred=o.Deferred(),N2R("documentReady",this.ready.bind(this))}return e.prototype.ready=function(){this.$container=o('<div class="n2_notification_center n2_admin_ui"></div>').appendTo("body"),this.deferred.resolve()},e.prototype.error=function(t,e){e=o.extend({wide:!1,heading:n2_("Oops, Something Went Wrong")},e);var i=new N2Classes.ModalSimple("notification error",{width:e.wide?1e3:440});i.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--error","red")),i.addContent(N2Classes.UI.modalHeading(e.heading)),i.addContent(N2Classes.UI.modalParagraphHTML(t));t=N2Classes.UI.modalButton(n2_("Got it"),"red");i.addButton(t),t.on("click",function(t){t.preventDefault(),i.hide(t)}),i.show()},e.prototype.success=function(t){this.message("success",n2_("Success"),t,{timeout:3})},e.prototype.notice=function(t){this.message("notice",n2_("Notice"),t)},e.prototype.message=function(t,e,i,s){s=o.extend({timeout:0},s);var n=o('<div class="n2_notification_center__message n2_notification_center__message--'+t+'"></div>').scrollTop(0).prependTo(this.$container);o('<div class="n2_notification_center__message_icon"><i class="ssi_24"></i></div>').appendTo(n);t=o('<div class="n2_notification_center__message_content"></div>').appendTo(n);o('<div class="n2_notification_center__message_content_label">'+e+"</div>").appendTo(t),o('<div class="n2_notification_center__message_content_description">'+i+"</div>").appendTo(t),s.timeout?(n.one("mouseenter",function(){n.remove()}),setTimeout(function(){n.remove()},1e3*s.timeout)):o('<div class="n2_notification_center__message_action"></div>').text(n2_("Got it")).on("click",function(){n.remove()}).appendTo(n),setTimeout(function(t){t.addClass("n2_notification_center__message--animate")}.bind(this,n),100)},new e}),N2D("Form",function(e,t){function i(){this.skipChangeConfirm=!1,this.onChangeCallback=this.onChange.bind(this)}return i.prototype.setID=function(t){this.$form=e(t).data("form",this)},i.prototype.onReady=function(){this.window=e("#n2-admin")[0],this.initButtons(),this.resetChangeTracker(),this.registerBeforeUnload(),document.addEventListener("keydown",this.onKeyDown.bind(this),{capture:!0})},i.prototype.initButtons=function(){},i.prototype.resetChangeTracker=function(){this.hasChange=!1,this.window.addEventListener("nextendChange",this.onChangeCallback,{passive:!0,capture:!0}),this.window.addEventListener("change",this.onChangeCallback,{passive:!0,capture:!0}),this.$saveButton.addClass("n2_button--inactive")},i.prototype.onChange=function(){this.hasChange=!0,this.$saveButton.removeClass("n2_button--inactive"),this.window.removeEventListener("nextendChange",this.onChangeCallback,{passive:!0,capture:!0}),this.window.removeEventListener("change",this.onChangeCallback,{passive:!0,capture:!0})},i.prototype.onKeyDown=function(t){var e;t.defaultPrevented||(e=!1,t.ctrlKey||t.metaKey?83===t.keyCode&&(this.actionSave(),e=!0):27===t.keyCode&&("INPUT"!==t.target.tagName&&"textarea"!==t.target.tagName||(t.target.blur(),e=!0)),e&&t.preventDefault())},i.prototype.isChanged=function(){return this.hasChange},i.prototype.registerBeforeUnload=function(){window.addEventListener("beforeunload",this.actionUnload.bind(this))},i.prototype.actionUnload=function(t){if(!this.skipChangeConfirm&&this.isChanged()){var e=n2_("The changes you made will be lost if you navigate away from this page.");return t.returnValue=e}},i.prototype.actionSave=function(){},i.prototype.afterSave=function(){this.resetChangeTracker()},i}),N2D("FormElement",function(t,e){function i(){this.connectedField=null,this.element.data("field",this)}return i.prototype.triggerOutsideChange=function(){this.element[0].dispatchEvent(new CustomEvent("outsideChange",{cancelable:!1,bubbles:!0,detail:{field:this}})),this.element[0].dispatchEvent(new CustomEvent("nextendChange",{cancelable:!1,bubbles:!0,detail:{field:this}}))},i.prototype.triggerInsideChange=function(){this.element[0].dispatchEvent(new CustomEvent("insideChange",{cancelable:!1,bubbles:!0,detail:{field:this}})),this.element[0].dispatchEvent(new CustomEvent("nextendChange",{cancelable:!1,bubbles:!0,detail:{field:this}}))},i.prototype.focus=function(t){this.connectedField&&this.connectedField.focus(t)},i}),N2D("FormElementAutocomplete","FormElementText",function(s,t){function e(t,e){this.tags=e,N2Classes.FormElementText.prototype.constructor.call(this,t),this.parent.find(".n2_field_text__clear").on("click",this.clear.bind(this)),new N2Classes.UIAutocomplete(this.element,{positionTo:".n2_field_autocomplete",y:-2,appendTo:function(){return this.element.closest(".n2_container_scrollable, body")}.bind(this),source:function(){return this.tags}.bind(this),select:function(t,e){var i=this.value.split(/,/);i.pop(),i.push(e.value),i.push(""),this.value=i.join(","),s(this).trigger("change")}})}return((e.prototype=Object.create(N2Classes.FormElementText.prototype)).constructor=e).prototype.clear=function(t){t.preventDefault(),this.element.val(""),this.change()},e}),N2D("BasicCSSFont",["BasicCSSSkeleton"],function(t,e){function i(){this._singular="font",this._prular="fonts",N2Classes.BasicCSSSkeleton.prototype.constructor.apply(this,arguments),this.form={afont:t("#layer-font-family"),color:t("#layer-font-color"),size:t("#layer-font-size"),weight:t("#layer-font-weight"),lineheight:t("#layer-font-lineheight"),align:t("#layer-font-textalign"),underline:t("#layer-font-decoration"),italic:t("#layer-font-decoration"),letterspacing:t("#layer-font-letterspacing"),wordspacing:t("#layer-font-wordspacing"),texttransform:t("#layer-font-texttransform"),tshadow:t("#layer-font-tshadow"),extra:t("#layer-font-extracss")},this.loaded()}return((i.prototype=Object.create(N2Classes.BasicCSSSkeleton.prototype)).constructor=i).prototype.activateVisual=function(t){this.activeVisual=t,this.setValue(N2Classes.CSSRendererFont.transformData(this.visuals[t].value,this.visuals[t].mode)),this.setStates(N2Classes.CSSRendererFont.rendererModes[this.visuals[t].mode].tabs),N2Classes.BasicCSSSkeleton.prototype.activateVisual.call(this,t)},i.prototype.setValue=function(t){this.value=N2Classes.CSSRendererFont.fixBold(t)},i.prototype._transformsize=function(t){return t.split("||").join("|*|")},i.prototype._setsize=function(t,e){t.size=e.replace("|*|","||")},i.prototype._transformweight=function(t){return parseInt(t)},i.prototype._setweight=function(t,e){t.weight=parseInt(e)},i.prototype._transformunderline=function(t){return[1==this.value[this.activeState].italic?"italic":"",1==t?"underline":""].join("||")},i.prototype._setunderline=function(t,e){e=e.split("||");t.underline="underline"===e[1]?1:0},i.prototype._transformitalic=function(t){return[1==t?"italic":"",1==this.value[this.activeState].underline?"underline":""].join("||")},i.prototype._setitalic=function(t,e){e=e.split("||");t.italic="italic"===e[0]?1:0},i}),N2D("BasicCSSSkeleton",function(n,o){function t(t){this.hasVisuals=!1,this.isInsideChange=!1,this.isReload=!1,this.manager=t,this.$container=t.$container.find('.n2_fields_layer_window[data-field="fieldset-layer-window-basiccss-'+this._singular+'"]'),this.$relatedContainers=t.$container.find('.n2_fields_layer_window[data-parent-design="fieldset-layer-window-basiccss-'+this._singular+'"]'),this.$containers=this.$container.add(this.$relatedContainers).attr("data-state","0"),this.elementField=n("#layerbasiccss-"+this._singular+"-element").data("field"),this.elementField.element.on("nextendChange",function(){this.activateVisual(this.elementField.element.val()),this.activateState(0)}.bind(this)),this.stateField=n("#layerbasiccss-"+this._singular+"-state").data("field"),this.stateField.element.on("nextendChange",function(){this.activateState(this.stateField.element.val())}.bind(this)),this.relatedElementFields=[],this.relatedStateFields=[],this.$relatedContainers.each(function(t,e){var i=n(e),e=i.find("#layerbasiccss-"+i.data("singular")+"-element").data("field"),i=i.find("#layerbasiccss-"+i.data("singular")+"-state").data("field");e.element.on("outsideChange",function(t){this.elementField.insideChange(t.val())}.bind(this,e.element)),i.element.on("outsideChange",function(t){this.stateField.insideChange(t.val())}.bind(this,i.element)),this.relatedElementFields.push(e),this.relatedStateFields.push(i)}.bind(this)),this.$containers.find('.n2_form__table_label_field[data-design-feature="reset-to-normal"] a').on("click",function(t){t.preventDefault(),this.value[this.activeState]={},this._lazySave(t),this.activateState(this.activeState)}.bind(this)),this.activeVisual=0,this.activeState=0}return t.prototype.loaded=function(){for(var t in this.form)this.form[t].on({nextendChange:this.changeValue.bind(this,t)})},t.prototype.changeValue=function(t,e){this.isReload||("function"==typeof this["_set"+t]?this["_set"+t](this.value[this.activeState],this.form[t].val()):this.value[this.activeState][t]=this.form[t].val(),this._lazySave(e))},t.prototype._lazySave=NextendDeBounce(function(t){this.isInsideChange=!0;var e=this.getData();this.visuals[this.activeVisual].field.save(t,e),this.visuals[this.activeVisual].value=e,this.isInsideChange=!1},50),t.prototype.save=function(t){for(var e in this.isInsideChange=!0,t)this.visualsByName[e].field.save({},t[e]),this.visualsByName[e].value=t[e];this.isInsideChange=!1},t.prototype.getData=function(){return JSON.stringify({data:this.value})},t.prototype.load=function(t,e){if(this.hasVisuals=0<e.length,this.$containers.attr("data-elements",e.length),this.hasVisuals){var i={};this.visuals=[],this.visualsByName={};for(var s=0;s<e.length;s++){var n=e[s];this.visualsByName[n.name]={value:t[n.name],mode:n.mode,field:n.field},n.field.element.off(".basiccss").on("outsideChange.basiccss",this.loadSingleValue.bind(this,s,n.name)),this.visuals.push(this.visualsByName[n.name]),i[s]=n.field.getLabel()}this.elementField.setOptions(i);for(s=0;s<this.relatedElementFields.length;s++)this.relatedElementFields[s].setOptions(i);this.activateVisual(0),this.activateState(0)}},t.prototype.loadSingleValue=function(t){this.isInsideChange||(this.visuals[t].value=this.visuals[t].field.element.val(),this.activeVisual==t&&(this.activateVisual(t),this.activateState(this.activeState)))},t.prototype.activateVisual=function(t){for(var e=0;e<this.relatedElementFields.length;e++)parseInt(this.relatedElementFields[e].element.val())!==t&&this.relatedElementFields[e].insideChange(t)},t.prototype.setValue=function(t){this.value=t},t.prototype.setStates=function(t){for(var e={},i=0;i<t.length;i++)e[i]=t[i];this.stateField.setOptions(e);for(i=0;i<this.relatedStateFields.length;i++)this.relatedStateFields[i].setOptions(e)},t.prototype.activateState=function(t){var e,i;for(i in t=Math.max(0,parseInt(t)),this.isReload=!0,this.activeState=t,this.$containers.attr("data-state",t),e=0===t?this.value[0]:n.extend({},this.value[0],this.value[t]))this.form[i]!==o&&("function"==typeof this["_transform"+i]?this.form[i].data("field").insideChange(this["_transform"+i](e[i])):this.form[i].data("field").insideChange(e[i]));for(var s=0;s<this.relatedStateFields.length;s++)parseInt(this.relatedStateFields[s].element.val())!==t&&this.relatedStateFields[s].insideChange(t);this.isReload=!1},t.prototype.serialize=function(){if(this.hasVisuals){var t,e={};for(t in this.visualsByName)e[t]=this.visualsByName[t].value;return e}return{}},t.prototype.unSerialize=function(t){for(var e in t)t.hasOwnProperty(e)&&(this.visualsByName[e].field.save({},t[e]),this.visualsByName[e].value=t[e])},t}),N2D("BasicCSSStyle",["BasicCSSSkeleton"],function(t,e){function i(){this._singular="style",this._prular="styles",N2Classes.BasicCSSSkeleton.prototype.constructor.apply(this,arguments),this.form={backgroundcolor:t("#layer-style-backgroundcolor"),opacity:t("#layer-style-opacity"),padding:t("#layer-style-padding"),border:t("#layer-style-border"),borderradius:t("#layer-style-borderradius"),boxshadow:t("#layer-style-boxshadow"),extra:t("#layer-style-extracss")},this.loaded()}return((i.prototype=Object.create(N2Classes.BasicCSSSkeleton.prototype)).constructor=i).prototype.activateVisual=function(t){this.activeVisual=t,this.setValue(N2Classes.CSSRendererStyle.transformData(this.visuals[t].value,this.visuals[t].mode)),this.setStates(N2Classes.CSSRendererStyle.rendererModes[this.visuals[t].mode].tabs),N2Classes.BasicCSSSkeleton.prototype.activateVisual.call(this,t)},i}),N2D("BasicCSS",function(n,a){function t(t,e){this.inPresetList=!1,this.$container=n("#"+t),this.options=n.extend({ajaxUrl:""},e),this.throttleSetTimeout=null,this.throttleExitTimeout=null,this.storage={},this.assets={font:new N2Classes.BasicCSSFont(this),style:new N2Classes.BasicCSSStyle(this)},this.$preset=n('<div class="n2_layer_window_design_preset"><div class="n2_layer_window_design_preset__label_container"><div class="n2_layer_window_design_preset__label">'+n2_("Preset")+'</div><i class="ssi_16 ssi_16--info" data-tip-description="'+n2_("You can use presets to save style settings for later use. Clicking on any preset will load its styling to your current layer, and the previous style settings will be lost.")+'" data-tip-label="'+n2_("Preset")+'"></i></div></div>').prependTo(this.$container),this.$notice=n('<div class="n2_layer_window_notice n2_layer_window_notice__device_icon"><div class="n2_field" data-field="layerslide-background-notice-image"><div class="n2_field__label"><label for="layerslide-background-notice-image">Note</label></div><div class="n2_field__element"><div class="n2_field_message n2_field_message--warning">'+n2_("Layer design options affect every device. If you need to make responsive adjustments, look for the options with the device icon.")+"</div></div></div></div>").prependTo(this.$container);t=n('<div class="n2_layer_window_design_preset__fields"></div>').appendTo(this.$preset),e=n('<div class="n2_layer_window_design_preset__fields_secondary"></div>').appendTo(t);n('<a class="n2_layer_window_design_preset__button_secondary" href="#" data-n2tip="'+n2_("Reset style to default")+'"><i class="ssi_16 ssi_16--reset"></i></a>').on("click",function(t){t.preventDefault(),this.exitPresetList(this.defs,t)}.bind(this)).appendTo(e),n('<a class="n2_layer_window_design_preset__button_secondary" href="#" data-n2tip="'+n2_("Save style as new preset")+'"><i class="ssi_16 ssi_16--save"></i></a>').on("click",function(t){t.preventDefault(),this.saveAsNew()}.bind(this)).appendTo(e),this.$presets=n('<div class="n2_layer_window_design_preset__presets"></div>').insertAfter(this.$preset),n('<a class="n2_layer_window_design_preset__button_choose" data-n2tip="'+n2_("Load style")+'" href="#"><i class="ssi_16 ssi_16--plus"></i></a>').on("click",function(t){t.preventDefault(),this.showList()}.bind(this)).appendTo(t),n('<a class="n2_layer_window_design_preset__button_back" href="#"><i class="ssi_16 ssi_16--remove"></i></a>').on("click",function(t){t.preventDefault(),this.exitPresetList(!1,t)}.bind(this)).appendTo(t),nextend.basicCSS=this}return t.prototype.showList=function(){this.inPresetList=!0,this.lastState=this.serialize(),this.$presets.on("mouseleave",function(){this.throttledUnSerialize(this.lastState)}.bind(this)),n.when(this.loadType()).done(function(t){0===this.storage[this.type].data("presets")?(N2Classes.Notification.notice(n2_("You have not created any presets for this layer yet.")),this.deActivate()):(this.$presets.append(this.storage[this.type]),n(".n2_ss_layer_window").addClass("n2_ss_layer_window--show-presets"),n(".n2_ss_layer_window__tab_container").scrollTop(0))}.bind(this))},t.prototype.activate=function(t,e,i){this.inPresetList&&this.exitPresetList(!1),this.type&&this.type!==t&&this.storage[this.type]!==a&&this.storage[this.type].detach();var s,n=!1;for(s in this.defs={font:[],style:[]},this.type=t,this.assets){for(var o=0;o<i[s].length;o++)this.defs[s][i[s][o].name]=i[s][o].def;this.assets[s].load(e,i[s]),n=n||this.assets[s].hasVisuals}this.$container.toggleClass("n2_ss_design_layer_window_design--visible",n)},t.prototype.deActivate=function(){this.inPresetList&&this.exitPresetList(!1)},t.prototype.serialize=function(){var t,e={};for(t in this.assets)e[t]=this.assets[t].serialize();return e},t.prototype.unSerialize=function(t){this.assets.font.unSerialize(t.font),this.assets.style.unSerialize(t.style)},t.prototype.throttledUnSerialize=function(t){this._addThrottledRenderTimeout(this.unSerialize.bind(this,t))},t.prototype.saveAsNew=function(t){var i=new N2Classes.ModalSimple("section-save-as",{destroyOnHide:!1,width:440});i.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--plus","green")),i.addContent(N2Classes.UI.modalHeading(n2_("Save as")));var e=N2Classes.UI.modalFormRow(!0);i.addContent(e);var s=N2Classes.UI.modalFieldText(e,"name",n2_("Name"),""),e=N2Classes.UI.modalButton(n2_("Save as"),"green");i.addButton(e),e.on("click",function(e){e.preventDefault();var t=s.val();""===t?N2Classes.Notification.error(n2_("Please fill the name field!")):N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.options.ajaxUrl,{nextendaction:"addVisual"}),data:{type:this.type,value:N2Classes.Base64.encode(JSON.stringify({name:t,data:this.serialize()}))},dataType:"json"}).done(function(t){n.when(this.loadType()).done(function(){this.addVisual(t.data.visual).prependTo(this.storage[this.type])}.bind(this)),i.hide(e),N2Classes.Notification.success(n2_("Preset saved."))}.bind(this))}.bind(this)),i.show()},t.prototype.loadType=function(){var i,e;return this.storage[this.type]===a&&(i=n.Deferred(),e=function(t){this.storage[this.type]=n('<div class="n2_layer_window_design_preset__presets_list"></div>').data("presets",0);for(var e=0;e<t.length;e++)this.addVisual(t[e]);i.resolve()}.bind(this),window[this.type]===a?(this.storage[this.type]=i,N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.options.ajaxUrl,{nextendaction:"loadVisuals"}),data:{type:this.type},dataType:"json"}).done(function(t){e(t.data.visuals)}.bind(this))):e(window[this.type])),this.storage[this.type]},t.prototype.addVisual=function(t){var e=t.value;"{"!==e[0]&&(e=N2Classes.Base64.decode(e));var i=JSON.parse(e),s=n('<div class="n2_layer_window_design_preset__preset_list_preset"><span>'+i.name+"</span></div>").on({mouseenter:function(t,e){this.throttledUnSerialize(t.data)}.bind(this,i),click:function(t,e){e.preventDefault(),this.exitPresetList(t,e)}.bind(this,i.data)}).appendTo(this.storage[this.type]);return this.storage[this.type].data("presets",this.storage[this.type].data("presets")+1),1e4<t.id&&(e=n('<div class="n2_layer_window_design_preset__preset_list_preset_buttons"></div>').appendTo(s),n('<div class="n2_layer_window_design_preset__preset_list_preset_button" data-n2tip="'+n2_("Overwrite preset")+'"><i class="ssi_16 ssi_16--save"></i></div>').on("click",function(t,e,i){i.stopPropagation(),N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.options.ajaxUrl,{nextendaction:"changeVisual"}),data:{visualId:t,value:N2Classes.Base64.encode(JSON.stringify({name:e,data:this.lastState})),type:this.type},dataType:"json"}).done(function(t){s.replaceWith(this.addVisual(t.data.visual)),this.storage[this.type].data("presets",this.storage[this.type].data("presets")-1),N2Classes.Notification.success(n2_("Preset saved."))}.bind(this))}.bind(this,t.id,i.name)).appendTo(e),n('<div class="n2_layer_window_design_preset__preset_list_preset_button"><i class="ssi_16 ssi_16--delete"></i></div>').on("click",function(t,e){e.preventDefault(),e.stopPropagation(),N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.options.ajaxUrl,{nextendaction:"deleteVisual"}),data:{visualId:t,type:this.type},dataType:"json"}).done(function(t){s.remove(),this.storage[this.type].data("presets",this.storage[this.type].data("presets")-1),N2Classes.Notification.success(n2_("Preset deleted."))}.bind(this))}.bind(this,t.id)).appendTo(e),nextend.tooltip.add(e)),s},t.prototype.exitPresetList=function(t,e){this.throttleSetTimeout&&clearTimeout(this.throttleSetTimeout),this.$presets.off("mouseleave"),t?(this.inPresetList=!1,this.unSerialize(t)):this.unSerialize(this.lastState),n(".n2_ss_layer_window").removeClass("n2_ss_layer_window--show-presets"),n(".n2_ss_layer_window__tab_container").scrollTop(0),this.inPresetList=!1},t.prototype._addThrottledRenderTimeout=function(t){this.throttleSetTimeout&&clearTimeout(this.throttleSetTimeout),this.throttleSetTimeout=setTimeout(t,100)},t.prototype._addThrottledExitTimeout=function(t){this.throttleExitTimeout&&clearTimeout(this.throttleExitTimeout),this.throttleExitTimeout=setTimeout(t,100)},t}),N2D("FormElementBreakpoint",function(a,r){function t(t,e){this.$container=a("#"+t).find(".n2_field_breakpoint__breakpoint_container"),this.options=a.extend({orientation:"",devices:[],fields:{},enables:!1,global:!1},e),this.hasEnables=!!this.options.enables,this.useGlobal=!1,this.$container.toggleClass("n2_field_breakpoint--with-enables",this.hasEnables),this.$orientationField=a("#"+this.options.orientation).on("nextendChange",this.onOrientationChanged.bind(this)),this.breakpoints={},a('<div class="n2_field_breakpoint__breakpoint_start"><div class="n2_field_breakpoint__breakpoint_label_container"><div class="n2_field_breakpoint__breakpoint_label">0</div></div></div>').prependTo(this.$container),this.$devices=this.$container.find(".n2_field_breakpoint__device"),this.options.global&&(this.$useGlobalField=a("#"+this.options.global.field).on("nextendChange",this.syncUseGlobal.bind(this)),this.useGlobal="1"===this.$useGlobalField.val(),this.syncUseGlobal());for(var i=!1,s=!1,n=0;n<this.$devices.length;n++){var o=this.createBreakpoint(this.$devices.eq(n),i);o!==r?(s?o.$breakpoint.insertBefore(o.$device):o.$breakpoint.insertAfter(o.$device),i=o):s=!0}this.options.global&&this.syncUseGlobal(),a('<div class="n2_field_breakpoint__breakpoint_end"><div class="n2_field_breakpoint__breakpoint_label_container"><div class="n2_field_breakpoint__breakpoint_label">&infin;</div></div></div>').appendTo(this.$container)}function s(t,e,i,s){this.parentField=t,(this.prev=s)&&s.setNext(this),this.next=!1,this.disableEdit=!1,this.orientation="portrait",this.device=e,this.$device=i,this.$breakpoint=a('<div class="n2_field_breakpoint__breakpoint" data-id="'+e+'"><div class="n2_field_breakpoint__breakpoint_divider"></div></div>'),this.$fieldPortrait=a("#"+t.options.fields[e+"-portrait"]),this.$fieldLandscape=a("#"+t.options.fields[e+"-landscape"]),this.$labelContainer=a('<div class="n2_field_breakpoint__breakpoint_label_container"></div>').appendTo(this.$breakpoint),a('<div class="n2_field_breakpoint__breakpoint_label_rename"><i class="ssi_16 ssi_16--rename"></i></div>').on("click",this.edit.bind(this)).appendTo(this.$labelContainer),this.$labelPortrait=a('<div class="n2_field_breakpoint__breakpoint_label" data-orientation="portrait"></div>').text(this.$fieldPortrait.val()).appendTo(this.$labelContainer),this.$labelLandscape=a('<div class="n2_field_breakpoint__breakpoint_label" data-orientation="landscape"></div>').text(this.$fieldLandscape.val()).appendTo(this.$labelContainer),t.hasEnables&&t.options.enables[e]&&(this.$enableField=a("#"+t.options.enables[e]),this.enableField=this.$enableField.data("field"),this.isEnabled=1===parseInt(this.$enableField.val()),this.syncEnabledClass(),this.$device.append('<div class="n2_field_breakpoint__device_disable"><i class="ssi_16 ssi_16--remove"></i></div>'),this.$device.on("click",this.toggleEnable.bind(this)))}return t.prototype.syncUseGlobal=function(){for(var t in this.useGlobal="1"===this.$useGlobalField.val(),this.breakpoints)this.breakpoints[t].syncUseGlobal(this.useGlobal)},t.prototype.createBreakpoint=function(t,e){var i=t.data("id");return"desktopportrait"!==i?(this.breakpoints[i]=new s(this,i,t,e),this.breakpoints[i]):r},t.prototype.onOrientationChanged=function(){var t,e=this.$orientationField.val();for(t in this.breakpoints)this.breakpoints[t].setOrientation(e);this.$container.attr("data-orientation",e)},s.prototype.setOrientation=function(t){this.orientation=t},s.prototype.setNext=function(t){this.next=t},s.prototype.getValue=function(){return parseInt(this.$fieldPortrait.val())},s.prototype.syncUseGlobal=function(t){t?(this.disableEdit=!0,this.$labelPortrait.text(this.parentField.options.global.values[this.device+"-portrait"]),this.$labelLandscape.text(this.parentField.options.global.values[this.device+"-landscape"])):(this.disableEdit=!1,this.$labelPortrait.text(this.$fieldPortrait.val()),this.$labelLandscape.text(this.$fieldLandscape.val())),this.$labelContainer.toggleClass("n2_field_breakpoint__breakpoint_label_container--disable-edit",this.disableEdit)},s.prototype.toggleEnable=function(t){t.preventDefault(),this.isEnabled=!this.isEnabled,this.enableField.insideChange(this.isEnabled?1:0),this.syncEnabledClass()},s.prototype.syncEnabledClass=function(){this.$device.toggleClass("n2_field_breakpoint__device--enabled",this.isEnabled),this.$breakpoint.toggleClass("n2_field_breakpoint__breakpoint--enabled",this.isEnabled),a("body").attr("data-"+this.device,this.isEnabled?1:0)},s.prototype.edit=function(t){var e="portrait"===this.orientation?this.$labelPortrait:this.$labelLandscape,i="portrait"===this.orientation?this.$fieldPortrait:this.$fieldLandscape;this.disableEdit||"true"===e[0].contentEditable||(t.preventDefault(),new N2Classes.InlineTextEditor(e[0],{filter:this.onFilter.bind(this),onSave:this.onSave.bind(this,i,e),onCancel:this.onCancel.bind(this,i,e)}))},s.prototype.onFilter=function(t){return t.replace(/[^0-9]/gi,"").replace(/^[0]+/gi,"").substr(0,4)},s.prototype.onSave=function(t,e,i){(i=parseInt(i))?(i=Math.max(100,Math.min(99999,parseInt(i))),t.val(i).trigger("change"),e.text(i)):this.onCancel(t,e)},s.prototype.onCancel=function(t,e){e.text(parseInt(t.val()))},t}),N2D("FormElementButtonMoreLess",function(s,n){function t(t,e){if(this.$button=s("#"+t).on("click",this.switchState.bind(this)),this.options=s.extend({labelMore:"",labelLess:"",relatedFields:[]},e),this.shownMore=!1,this.relatedFields=s(""),e.relatedFields!==n&&e.relatedFields.length)for(var i=0;i<e.relatedFields.length;i++)this.relatedFields=this.relatedFields.add(s('[data-field="'+e.relatedFields[i]+'"]'));this.syncState()}return t.prototype.switchState=function(t){t.preventDefault(),this.shownMore=!this.shownMore,this.shownMore?this.$button.text(this.options.labelLess):this.$button.text(this.options.labelMore),this.syncState()},t.prototype.syncState=function(){this.relatedFields.toggleClass("n2_form_element--hidden",!this.shownMore)},t}),N2D("FormElementCheckboxOnOff",["FormElement"],function(s,n){function t(t,e){if(this.separator="||",this.element=s("#"+t),this.$parent=this.element.parent(),this.options=s.extend({invert:!1},e),this.relatedFields=s(""),e.relatedFields!==n&&e.relatedFields.length){for(var i=0;i<e.relatedFields.length;i++)this.relatedFields=this.relatedFields.add(s('[data-field="'+e.relatedFields[i]+'"]'));this.setValue(parseInt(this.element.val())?1:0)}N2Classes.FormElement.prototype.constructor.call(this),this.$parent.on("click",this.switchCheckbox.bind(this))}return((t.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=t).prototype.switchCheckbox=function(){this.setValue(parseInt(this.element.val())?0:1),this.triggerOutsideChange()},t.prototype.setValue=function(t){this.element.val(t);var e=!1;(!this.options.invert&&1===t||this.options.invert&&1!==t)&&(e=!0),this.$parent.toggleClass("n2_field_checkbox_onoff--active",e),this.relatedFields.toggleClass("n2_form_element--hidden",this.options.invert?e:!e)},t.prototype.insideChange=function(t){this.setValue(parseInt(t)?1:0),this.triggerInsideChange()},t}),N2D("FormElementColor",["FormElement"],function(i,t){function e(t,e){this.element=i("#"+t),this.alpha=1===e;e=[["000000","55aa39","357cbd","bb4a28","8757b2"],["81898d","5cba3c","4594e1","d85935","9e74c2"],["ced3d5","27ae60","01add3","e79d19","e264af"],["ffffff","2ecc71","00c1c4","ecc31f","ec87c0"]];this.alpha&&(e[0].push("000000CC"),e[1].push("00000080"),e[2].push("FFFFFFCC"),e[3].push("FFFFFF80")),this.element.off("change").n2spectrum({showAlpha:this.alpha,preferredFormat:this.alpha?"hex8":"hex6",showInput:!1,showButtons:!1,move:this.onMove.bind(this),showSelectionPalette:!0,showPalette:!0,maxSelectionSize:6,localStorageKey:"color",palette:e}).on("change",this.onChange.bind(this)),this.text=this.element.data("field"),N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.onMove=function(){this.element.val(this.getCurrent()),this.triggerOutsideChange()},e.prototype.onChange=function(t){var e=this.getCurrent(),i=this.element.val();e!==i&&(0===i.length?(i=this.alpha?"00000000":"000000",this.element.val(i),this.element.n2spectrum("set",i)):"{"!==i.charAt(0)&&this.element.n2spectrum("set",i),this.triggerInsideChange(),this.triggerOutsideChange()),t.stopImmediatePropagation()},e.prototype.insideChange=function(t){this.element.val(t),0<t.length&&"{"!==t.charAt(0)&&this.element.n2spectrum("set",t),this.triggerInsideChange()},e.prototype.getCurrent=function(){return this.alpha?this.element.n2spectrum("get").toHexString8():this.element.n2spectrum("get").toHexString(!0)},e}),N2D("FormElementDecoration",["FormElement"],function(s,n){function t(t,e){this.separator="||",this.element=s("#"+t),this.values=e,this.checkboxes=this.element.parent().find(".n2_field_decoration__option"),this.states=this.element.val().split(this.separator);for(var i=0;i<this.checkboxes.length;i++)this.states[i]!==n&&this.states[i]===this.values[i]||(this.states[i]=""),this.checkboxes.eq(i).on("click",this.switchCheckbox.bind(this,i));N2Classes.FormElement.prototype.constructor.call(this)}return((t.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=t).prototype.switchCheckbox=function(t){this.states[t]===this.values[t]?(this.states[t]="",this.setSelected(t,0)):(this.states[t]=this.values[t],this.setSelected(t,1)),this.element.val(this.states.join(this.separator)),this.triggerOutsideChange()},t.prototype.insideChange=function(t){for(var e=t.split(this.separator),i=0;i<this.checkboxes.length;i++)e[i]===n||e[i]!==this.values[i]?(this.states[i]="",this.setSelected(i,0)):(this.states[i]=this.values[i],this.setSelected(i,1));this.element.val(this.states.join(this.separator)),this.triggerInsideChange()},t.prototype.setSelected=function(t,e){this.checkboxes.eq(t).toggleClass("n2_field_decoration__option--selected",1===e)},t}),N2D("FormElementDevice",["FormElementOnoff"],function(t,e){function i(t){N2Classes.FormElementOnoff.prototype.constructor.call(this,t,{values:{0:1,1:0}})}return((i.prototype=Object.create(N2Classes.FormElementOnoff.prototype)).constructor=i).prototype.detach=function(){this.onoff.detach()},i.prototype.syncOff=function(){this.onoff.removeClass("n2_field_radio__option--selected")},i.prototype.syncOn=function(){this.onoff.addClass("n2_field_radio__option--selected")},i}),N2D("FormElementDevices",["FormElementDevice"],function(s,t){function e(t,e){this.$el=s("#"+t).data("field",this),this.fields={};for(var i=0;i<e.length;i++)this.fields[e[i]]=new N2Classes.FormElementDevice(t+"-"+e[i])}return e.prototype.setAvailableDevices=function(t){for(var e in t){var i=this.fields[e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()];!t[e]&&i&&i.detach()}this.$el.children().first().addClass("n2-first"),this.$el.children().last().addClass("n2-last")},e}),N2D("FormElementFloatToPercent",["FormElement"],function(s,t){function e(t,e,i){this.min=e,this.max=i,this.element=s("#"+t),this.$parent=this.element.parent(),this.$input=this.$parent.find('input[type="text"]'),this.$input.on({focus:this._focus.bind(this),blur:this.blur.bind(this),change:this.change.bind(this)}),N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype._focus=function(){this.$parent.addClass("n2_field_text--focus"),this.$input.on("keypress.n2-text",function(t){13===t.which&&(this.$input.off("keypress.n2-text"),this.$input.trigger("blur"))}.bind(this))},e.prototype.blur=function(){this.$parent.removeClass("n2_field_text--focus")},e.prototype.change=function(){var t=this.validate(this.$input.val());!0===t?(this.element.val(this.$input.val()/100),this.triggerOutsideChange()):this.$input.val(t).trigger("change")},e.prototype.insideChange=function(t){var e=this.validate(t);!0===e?this.$input.val(t):this.$input.val(e),this.element.val(this.$input.val()/100),this.triggerInsideChange()},e.prototype.validate=function(t){var e=parseFloat(t);return isNaN(e)&&(e=0),(e=Math.max(this.min,Math.min(this.max,e))).toString()===t||e},e}),N2D("FormElementFolders",["FormElementText"],function(t,e){function i(t,e){N2Classes.FormElementText.prototype.constructor.call(this,t),this.parameters=e,this.parent.find(".n2_field_text__clear").on("click",this.clear.bind(this)),this.parent.find(".n2_field_text__choose").on("click",this.show.bind(this)),N2Classes.FormElement.prototype.constructor.call(this)}return((i.prototype=Object.create(N2Classes.FormElementText.prototype)).constructor=i).prototype.clear=function(t){t.preventDefault(),this.val("")},i.prototype.val=function(t){this.element.val(t),this.change()},i.prototype.show=function(t){t.preventDefault(),this.modal=new N2Classes.ModalLightbox(n2_("Choose folder"),"filesystem"),this.modal.addContent(nextend.browse.getNode("folder"));t=N2Classes.UI.modalButton(n2_("Select"),"green").on("click",function(t){t.preventDefault(),this.modal.hide(t),this.val(nextend.browse.getCurrentFolder())}.bind(this));this.modal.addButton(t),this.modal.show()},i}),N2D("FormElementFontHidden",["FormElement"],function(i,t){function e(t,e){this.element=i("#"+t),this.parameters=i.extend({mode:"",label:""},e),N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.getLabel=function(){return this.parameters.label},e.prototype.save=function(t,e){this.val(e)},e.prototype.val=function(t){this.element.val(t),this.triggerOutsideChange()},e.prototype.insideChange=function(t){this.element.val(t),this.triggerInsideChange()},e.prototype.renderFont=function(){return N2Classes.CSSRendererFont.addCSS("",N2Classes.CSSRendererFont.getClass(),this.element.val(),N2Classes.CSSRendererFont.rendererModes[this.parameters.mode])},e}),N2D("FormElementFont",["FormElement"],function(i,t){function e(t,e){this.element=i("#"+t),this.parent=this.element.parent(),this.parameters=i.extend({mode:"",label:"",style:"",style2:"",preview:""},e),N2Classes.FormElement.prototype.constructor.call(this),this.parent.on("click",this.show.bind(this))}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.getLabel=function(){return this.parameters.label},e.prototype.show=function(t){t.preventDefault(),""!==this.parameters.style&&nextend.fontManager.setConnectedStyle(this.parameters.style),""!==this.parameters.style2&&nextend.fontManager.setConnectedStyle2(this.parameters.style2),nextend.fontManager.setFieldID(this.element.attr("id")),nextend.fontManager.show(this.element.val(),this.save.bind(this),{previewMode:this.parameters.mode,previewHTML:this.parameters.preview})},e.prototype.save=function(t,e){this.val(e)},e.prototype.val=function(t){this.element.val(t),this.triggerOutsideChange()},e.prototype.insideChange=function(t){this.element.val(t),this.triggerInsideChange()},e.prototype.renderFont=function(){return N2Classes.CSSRendererFont.addCSS("",N2Classes.CSSRendererFont.getClass(),this.element.val(),N2Classes.CSSRendererFont.rendererModes[this.parameters.mode])},e}),N2D("FormTabbed",function(i,t){function e(t,e){this.options=i.extend({toggleMode:!1,sessionID:""},e),this.id=t,this.$buttons=i('.n2_form__tab_button[data-related-form="'+t+'"]'),this.$tabs=i('.n2_form__tab[data-related-form="'+t+'"]'),this.$buttons.on("click",this.showTab.bind(this)),this.options.toggleMode||(t=this.$buttons.eq(0).data("related-tab"),""!==this.options.sessionID&&(t=localStorage.getItem(this.options.sessionID)),0===(t=this.$buttons.filter('[data-related-tab="'+t+'"]')).length&&(t=this.$buttons.eq(0)),t.triggerHandler("click"))}return e.prototype.showTab=function(t){t.preventDefault();var e=i(t.currentTarget),t=e.data("related-tab");this.$buttons.removeClass("n2_form__tab_button--active"),this.$tabs.removeClass("n2_form__tab--active"),this.options.toggleMode&&this.currentTab===t?delete this.currentTab:(e.addClass("n2_form__tab_button--active"),this.$tabs.filter('[data-tab="'+t+'"]').addClass("n2_form__tab--active"),this.currentTab=t,""!==this.options.sessionID&&localStorage.setItem(this.options.sessionID,t))},e}),N2D("FormElementIconTab",["FormElement"],function(r,t){function e(t,e){if(this.options=r.extend({relatedValueFields:[],relatedAttribute:""},e),this.parent=r("#"+t+"_icon_tab"),this.parent.find(".n2_field_icon_tab__option").each(function(t,e){r(e).on("click",function(t){this.onClick(r(t.currentTarget))}.bind(this))}.bind(this)),this.element=r("#"+t).on("change",this.onHiddenChange.bind(this)),this.relatedValueFields=!1,this.options.relatedValueFields.length){var i=this.element.val();this.relatedValueFields=r("");for(var s=0;s<this.options.relatedValueFields.length;s++)for(var n,o=0;o<this.options.relatedValueFields[s].field.length;o++)(n=r('[data-field="'+this.options.relatedValueFields[s].field[o]+'"]').data("show-values",this.options.relatedValueFields[s].values)).toggleClass("n2_form_element--hidden",-1===this.options.relatedValueFields[s].values.indexOf(i)),this.relatedValueFields=this.relatedValueFields.add(n)}var a;""!==this.options.relatedAttribute&&(a=r("#n2-admin").attr("data-"+this.options.relatedAttribute,this.element.val()),this.element.on("nextendChange",function(){a.attr("data-"+this.options.relatedAttribute,this.element.val())}.bind(this))),N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.onHiddenChange=function(){var t=this.element.val();t&&this.insideChange(t)},e.prototype.onClick=function(t){t.hasClass("n2_field_icon_tab__option--selected")||(this.parent.find(".n2_field_icon_tab__option--selected").removeClass("n2_field_icon_tab__option--selected"),t.addClass("n2_field_icon_tab__option--selected"),this.setHiddenValue(t.attr("data-ssoption")),this.triggerOutsideChange())},e.prototype.insideChange=function(t){this.setHiddenValue(t);t=this.parent.find('.n2_field_icon_tab__option[data-ssoption="'+t+'"]');this.onClick(t),this.triggerInsideChange()},e.prototype.setHiddenValue=function(e){this.element.val(e),this.relatedValueFields&&this.relatedValueFields.each(function(){var t=r(this);t.toggleClass("n2_form_element--hidden",-1===t.data("show-values").indexOf(e))})},e}),N2D("FormElementIcon2Manager",["FormElement"],function(e,t){function i(t){this.element=e("#"+t),this.parent=this.element.parent(),N2Classes.FormElement.prototype.constructor.call(this),this.parent.find(".n2_field_chooser__clear").on("click",this.clear.bind(this)),this.parent.find(".n2_field_chooser__choose").on("click",this.openModal.bind(this)),this.$preview=this.parent.find(".n2_field_icon__preview").on("click",this.openModal.bind(this)),this.updateIsEmpty()}return((i.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=i).prototype.isEmpty=function(t){return""===t},i.prototype.clear=function(t){t.preventDefault(),this.val("")},i.prototype.insideChange=function(t){this.updatePreview(t),this.element.val(t),this.updateIsEmpty(),this.triggerInsideChange()},i.prototype.openModal=function(t){t&&t.preventDefault(),N2Classes.Icons.showModal(this.setIcon.bind(this),this.element.val())},i.prototype.val=function(t){this.element.val(t),this.updatePreview(t),this.updateIsEmpty(),this.triggerOutsideChange()},i.prototype.setIcon=function(t){this.val(t)},i.prototype.updateIsEmpty=function(){this.parent.toggleClass("n2_field_chooser--empty",this.isEmpty(this.element.val()))},i.prototype.updatePreview=function(t){t=N2Classes.Icons.render(t);t?this.$preview.html('<i class="n2i '+t.class+'">'+t.ligature+"</i>"):this.$preview.html("")},i.prototype.focus=function(t){t&&this.openModal()},i}),N2D("FormElementImageList",["FormElement"],function(n,o){function t(t,e,i){if(this.id=t,this.element=n("#"+t),this.$parent=this.element.parent(),this.$preview=this.$parent.find(".n2_field_image_list__preview"),this.$fields=this.$parent.find(".n2_field_image_list__fields"),this.$fields.length&&(this.field=this.$fields.find('input[type="text"]').data("field"),this.field.element.on("outsideChange",function(){var t=this.element.val();this.markSelected(t),this.renderPreview(t)}.bind(this))),this.$popover=!1,this.parameters=n.extend({width:120,column:3,hasDisabled:!1,options:[]},e),this.realItemWidth=this.parameters.width+10,this.relatedFields=!1,i!==o&&i.length){this.relatedFields=n("");for(var s=0;s<i.length;s++)this.relatedFields=this.relatedFields.add(n('[data-field="'+i[s]+'"]'));this.relatedFields.toggleClass("n2_form_element--hidden",this.isOff(this.element.val()))}N2Classes.FormElement.prototype.constructor.call(this),this.$parent.on("click",this.toggle.bind(this)),this.renderPreview(this.element.val())}return((t.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=t).prototype.stopPropagation=function(t){return t.originalEvent["handled"+this.id]!==o||!(t.originalEvent["handled"+this.id]=!0)},t.prototype.toggle=function(t){this.$parent.hasClass("n2_field_image_list--focus")?this.blur(t):this.focus(t)},t.prototype.focus=function(t){this.stopPropagation(t)||(this.$parent.addClass("n2_field_image_list--focus"),n("body").on("click."+this.id,this.blur.bind(this)),this.buildPopover(),this.markSelected(this.element.val()))},t.prototype.blur=function(t){this.stopPropagation(t)||(this.$parent.removeClass("n2_field_image_list--focus"),n("body").off("click."+this.id))},t.prototype.isOff=function(t){return"-1"===t},t.prototype.buildPopover=function(){if(!this.$popover){this.items={},this.$popover=n('<div class="n2_field_image_list__popover"></div>').on("click",this.stopPropagation.bind(this));var t,e=n('<div class="n2_field_image_list__popover_items"></div>').css("width",(this.realItemWidth+20)*this.parameters.column).appendTo(this.$popover);for(t in this.parameters.options){this.items[t]=n('<div class="n2_field_image_list__popover_item"></div>').css("width",this.realItemWidth).on("click",this.selectOption.bind(this,t)).appendTo(e);var i=n('<div class="n2_field_image_list__popover_item_image"></div>').appendTo(this.items[t]);this.loadImage(this.parameters.options[t].url,i),this.parameters.options[t].label!==o&&n('<div class="n2_field_image_list__popover_item_label"></div>').text(this.parameters.options[t].label).appendTo(this.items[t])}this.parameters.hasDisabled&&(this.parameters.options[-1]={url:""},this.items[-1]=n('<div class="n2_field_image_list__popover_item"></div>').on("click",this.selectOption.bind(this,"-1")).append(n('<div class="n2_field_image_list__popover_item_disabled"></div>').text(n2_("Disabled"))).appendTo(e)),this.$fields.appendTo(this.$popover),this.$parent.append(this.$popover),this.$items=this.$popover.find(".n2_field_image_list__popover_item")}},t.prototype.selectOption=function(t,e){this.setValue(t),this.markSelected(t),this.renderPreview(t),this.triggerOutsideChange(),this.blur(e)},t.prototype.setValue=function(t){this.element.val(t),this.relatedFields&&this.relatedFields.toggleClass("n2_form_element--hidden",this.isOff(t))},t.prototype.markSelected=function(t){this.$items.removeClass("n2_field_image_list__popover_item--selected"),this.field&&""!==this.field.element.val()||this.items[t].addClass("n2_field_image_list__popover_item--selected")},t.prototype.renderPreview=function(t){var e,i;this.$preview.html(""),this.field&&""!==this.field.element.val()?e=nextend.imageHelper.fixed(this.field.element.val()):"-1"!==t&&this.parameters.options[t]!==o&&(e=this.parameters.options[t].url,i=this.parameters.options[t].label),e!==o?(this.loadImage(e,this.$preview),i&&n('<div class="n2_field_image_list__preview_label"></div>').text(i).appendTo(this.$preview)):n('<div class="n2_field_image_list__preview_label"></div>').text(n2_("Disabled")).appendTo(this.$preview)},t.prototype.insideChange=function(t){this.parameters.options[t]!==o&&(this.setValue(t),this.markSelected(t),this.renderPreview(t),this.triggerInsideChange())},t.prototype.loadImage=function(t,e){this.getImage(t,"94b2c1").done(function(t){n('<img alt="" src="'+t+'"/>').prependTo(e)})},t.prototype.getCurrentImage=function(t){return this.getImage(this.parameters.options[this.element.val()].url,t)},t.prototype.getImage=function(t,e){var i=n.Deferred();return"svg"===t.split("?")[0].split(".").pop()?n.ajax({url:t,method:"GET",dataType:"text",success:function(t){t=t.replace(/fill="#FFF"/gi,'fill="#'+e.substr(0,6)+'"').replace('opacity="1"','opacity="'+N2Color.hex2alpha(e)+'"');i.resolve("data:image/svg+xml;base64,"+btoa(t))}.bind(this)}):i.resolve(t),i},t}),N2D("FormElementImage",["FormElementText"],function(i,t){function e(t,e){N2Classes.FormElementText.prototype.constructor.call(this,t),this.parameters=i.extend({alt:!1},e),this.preview=this.parent.find(".n2_field_text_image__preview").on("click",this.open.bind(this)),this.element.on("nextendChange",this.makePreview.bind(this)),this.parent.find(".n2_field_text__choose").on("click",this.open.bind(this)),this.parent.find(".n2_field_text__clear").on("click",this.clear.bind(this)),this.$sizeLabel=i('<div class="n2_field_text_image__size_label"></div>').appendTo(this.parent),this.refreshSizeLabel()}return((e.prototype=Object.create(N2Classes.FormElementText.prototype)).constructor=e).prototype.clear=function(t){t.preventDefault(),this.val("")},e.prototype.val=function(t,e){(e=i.extend({alt:!1},e)).alt&&""!==e.alt&&this.parameters.alt&&""!==this.parameters.alt&&i("#"+this.parameters.alt).val(e.alt).trigger("change"),this.element.val(t),this.change()},e.prototype.makePreview=function(){var t=this.element.val();"{"===t.substr(0,1)?this.preview.css("background-image",""):this.preview.css("background-image","url("+nextend.imageHelper.fixed(t)+")"),this.refreshSizeLabel()},e.prototype.open=function(t){t&&t.preventDefault(),nextend.imageHelper.openLightbox(this.val.bind(this))},e.prototype.focus=function(t){t&&this.open()},e.prototype.refreshSizeLabel=function(){this.$sizeLabel.removeClass("n2_field_text_image__size_label--visible");var t,e=this.element.val();""!==e&&"{"!==e.substr(0,1)&&((t=new Image).addEventListener("load",function(){t.naturalWidth&&t.naturalHeight&&this.$sizeLabel.text(t.naturalWidth+"x"+t.naturalHeight).addClass("n2_field_text_image__size_label--visible")}.bind(this)),t.src=nextend.imageHelper.fixed(e))},e}),N2D("FormElementImageManager",["FormElement"],function(i,t){function e(t,e){this.element=i("#"+t),this.parent=this.element.parent(),i("#"+t+"_manage").on("click",this.show.bind(this)),this.parameters=e,this.imageField=this.element.data("field"),N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.show=function(t){t.preventDefault();t=this.element.val();""===t?N2Classes.Notification.error(n2_("Image field can not be empty!")):nextend.imageManager.show(t,this.save.bind(this))},e.prototype.save=function(){},e.prototype.insideChange=function(t){this.element.val(t),this.updateIsEmpty(),this.triggerInsideChange()},e.prototype.updateIsEmpty=function(){this.parent.toggleClass("n2_field_text--empty",this.isEmpty(this.element.val()))},e.prototype.isEmpty=function(t){return""===t},e}),N2D("FormElementLayerWindowFocus",["UIDragTooltip"],function(i,t){var s=new N2Classes.UIDragTooltip("Focus");function e(t,e){this.$field=i("#"+t).on("mousedown",this.onMouseDown.bind(this)),this.onMouseMoveCallback=this.onMouseMove.bind(this),this.onMouseUpCallback=this.onMouseUp.bind(this),this.$image=this.$field.find(".n2_field_layer_window_focus__image").on({error:function(){this.$image.attr("src",nextend.imageHelper.fixed("$system$/images/placeholder/image.png"))}.bind(this)}),this.$dot=i('<div class="n2_field_layer_window_focus__dot"></div>').on("mouseenter",this.onMouseEnter.bind(this)).appendTo(this.$field),this.options=i.extend({image:"",focusX:"",focusY:""},e),this.$imageField=i("#"+this.options.image).on("nextendChange",this.onImageChange.bind(this)),this.imageField=this.$imageField.data("field"),this.$focusXField=i("#"+this.options.focusX).on("nextendChange",this.onFocusXChange.bind(this)),this.focusXField=this.$focusXField.data("field"),this.$focusYField=i("#"+this.options.focusY).on("nextendChange",this.onFocusYChange.bind(this)),this.focusYField=this.$focusYField.data("field")}return e.prototype.onImageChange=function(){var t=nextend.imageHelper.fixed(nextend.currentEditor.generator.fill(this.$imageField.val()));this.image!==t&&(this.image=t,this.$image.attr("src",this.image))},e.prototype.onFocusXChange=function(){var t=this.$focusXField.val();t!==this.focusX&&(this.focusX=t,this.$dot.css("left",this.focusX+"%"))},e.prototype.onFocusYChange=function(){var t=this.$focusYField.val();t!==this.focusY&&(this.focusY=t,this.$dot.css("top",this.focusY+"%"))},e.prototype.onMouseDown=function(t){this.context={originalFocusX:this.$focusXField.val(),originalFocusY:this.$focusYField.val()},N2Classes.History.get().off(),s.dragShow(),this.onMouseMove(t),document.addEventListener("mousemove",this.onMouseMoveCallback),document.addEventListener("mouseup",this.onMouseUpCallback)},e.prototype.onMouseMove=function(t){t.preventDefault();var e=this.$field[0].getBoundingClientRect(),i=Math.max(Math.min(Math.round((t.clientX-e.left)/e.width*100),100),0),e=Math.max(Math.min(Math.round((t.clientY-e.top)/e.height*100),100),0);this.$focusXField.val(i).trigger("change"),this.$focusYField.val(e).trigger("change"),s.dragUpdate(t,"X: "+i+"%<br />Y: "+e+"%")},e.prototype.onMouseUp=function(t){this.$focusXField.val(this.context.originalFocusX).trigger("change"),this.$focusYField.val(this.context.originalFocusY).trigger("change"),N2Classes.History.get().on(),s.dragHide(),document.removeEventListener("mousemove",this.onMouseMoveCallback),document.removeEventListener("mouseup",this.onMouseUpCallback),this.onMouseMove(t),delete this.context},e.prototype.onMouseEnter=function(t){s.hoverShow(t,function(){return"X: "+this.$focusXField.val()+"%<br />Y: "+this.$focusYField.val()+"%"}.bind(this)),this.$dot.on({"mousemove.tooltip":function(t){s.hoverUpdatePosition(t)},"mouseleave.tooltip":function(){this.timeout&&(clearTimeout(this.timeout),delete this.timeout),this.$dot.off(".tooltip"),s.hoverHide()}.bind(this)})},e}),N2D("FormElementList",["FormElement"],function(r,t){function e(t,e){if(this.separator="||",this.options=r.extend({relatedFields:[],relatedValueFields:[],relatedAttribute:""},e),this.element=r("#"+t).on("change",this.onHiddenChange.bind(this)),this.select=r("#"+t+"_select").on("change",this.onChange.bind(this)),this.relatedFields=!1,this.options.relatedFields.length){this.relatedFields=r("");for(var i=0;i<this.options.relatedFields.length;i++)this.relatedFields=this.relatedFields.add(r('[data-field="'+this.options.relatedFields[i]+'"]'));this.relatedFields.toggleClass("n2_form_element--hidden",this.isOff(this.element.val()))}if(this.relatedValueFields=!1,this.options.relatedValueFields.length){var s=this.element.val();this.relatedValueFields=r("");for(i=0;i<this.options.relatedValueFields.length;i++)for(var n,o=0;o<this.options.relatedValueFields[i].field.length;o++)(n=r('[data-field="'+this.options.relatedValueFields[i].field[o]+'"]').data("show-values",this.options.relatedValueFields[i].values)).toggleClass("n2_form_element--hidden",-1===this.options.relatedValueFields[i].values.indexOf(s)),this.relatedValueFields=this.relatedValueFields.add(n)}var a;""!==this.options.relatedAttribute&&(a=r("#n2-admin").attr("data-"+this.options.relatedAttribute,this.element.val()),this.element.on("nextendChange",function(){a.attr("data-"+this.options.relatedAttribute,this.element.val())}.bind(this))),N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.onHiddenChange=function(){var t=this.element.val();t&&t!==this.select.val()&&this.insideChange(t)},e.prototype.onChange=function(){var t=this.select.val();null!==t&&"object"==typeof t&&(t=t.join(this.separator)),this.setHiddenValue(t),this.triggerOutsideChange()},e.prototype.insideChange=function(t){"object"==typeof t?(this.select.val(t),t=t.join("||")):this.select.val(t),this.setHiddenValue(t),this.triggerInsideChange()},e.prototype.setHiddenValue=function(e){this.element.val(e),this.relatedFields&&this.relatedFields.toggleClass("n2_form_element--hidden",this.isOff(e)),this.relatedValueFields&&this.relatedValueFields.each(function(){var t=r(this);t.toggleClass("n2_form_element--hidden",-1===t.data("show-values").indexOf(e))})},e.prototype.isOff=function(t){return""==t||"0"==t||"off"==t},e.prototype.setOptions=function(t){for(var e in this.select.html(""),t)r('<option value="'+e+'"></option>').text(t[e]).appendTo(this.select)},e}),N2D("FormElementMarginPadding",["FormElementMixed"],function(t,e){function i(t,e,i){this.linkedValues=!1,N2Classes.FormElementMixed.prototype.constructor.apply(this,arguments),this.$field=this.element.parent(),this.$field.find(".n2_field_margin_padding__pre_label").on("click",function(t){t.preventDefault(),this.linkedValues=!this.linkedValues,this.$field.toggleClass("n2_field_margin_padding--linked-values",this.linkedValues),this.linkedValues&&this.elements[0].trigger("change")}.bind(this)),this.refresh()}return((i.prototype=Object.create(N2Classes.FormElementMixed.prototype)).constructor=i).prototype.onFieldChange=function(){if(this.linkedValues)for(var t=this.elements[0].val(),e=1;e<4;e++)this.elements[e].data("field").insideChange(t);this.element.val(this.getValue()),this.triggerOutsideChange()},i.prototype.insideChange=function(t){N2Classes.FormElementMixed.prototype.insideChange.apply(this,arguments),this.refresh()},i.prototype.refresh=function(){this.linkedValues=!0;for(var t=this.elements[0].val(),e=1;e<4;e++)if(t!==this.elements[e].val()){this.linkedValues=!1;break}this.$field.toggleClass("n2_field_margin_padding--linked-values",this.linkedValues)},i.prototype.relatedFieldsOff=function(){return"0|*|0|*|0|*|0"===this.element.val()},i.prototype.isEmpty=function(t){return"|*||*||*|"===t||"0|*|0|*|0|*|0"===t},i}),N2D("FormElementMixed",["FormElement"],function(n,t){function e(t,e,i){this.element=n("#"+t),this.elements=[];for(var s=0;s<e.length;s++)this.elements.push(n("#"+e[s]).on("outsideChange",this.onFieldChange.bind(this)));this.separator=i,N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.onFieldChange=function(){this.element.val(this.getValue()),this.triggerOutsideChange()},e.prototype.insideChange=function(t){this.element.val(t);for(var e=t.split(this.separator),i=0;i<this.elements.length;i++)this.elements[i].data("field").insideChange(e[i]);this.triggerInsideChange()},e.prototype.getValue=function(){for(var t=[],e=0;e<this.elements.length;e++)t.push(this.elements[e].val());return t.join(this.separator)},e}),N2D("FormElementNumberSlider",function(n,s){function t(t,e){this.localChange=!1,this.element=n("#"+t),this.$parent=this.element.parent().on({"mouseenter.n2slider":this.startSlider.bind(this,e)});var i,s=this.$parent.siblings(".n2_field_unit").find("> input");e.units&&s.length&&(i=e.units,s.on("nextendChange",function(){e.min=i[s.val()+"Min"],e.max=i[s.val()+"SliderMax"],this.slider&&(this.uiSlider.setOption("min",e.min),this.uiSlider.setOption("max",e.max))}.bind(this)))}return t.prototype.startSlider=function(t,e){var i;this.element.parent().off(".n2slider"),this.slider||(i=n('<div class="n2_field_number__slider"></div>').appendTo(this.$parent),i=n('<div class="n2_field_number__slider_inner"></div>').appendTo(i),this.slider=n("<div></div>").appendTo(i).removeAttr("slide").prop("slide",!1),this.uiSlider=new N2Classes.UISlider(this.slider,n.extend({start:function(){this.element.parent().addClass("n2-active")}.bind(this),stop:function(){this.element.parent().removeClass("n2-active")}.bind(this),sliding:function(t,e){this.localChange=!0,this.element.val(e.value).trigger("change"),this.localChange=!1}.bind(this)},t)),this.slider[0].slide!==s&&(this.slider[0].slide=null),this.element.on("nextendChange",function(){var t;this.localChange||(t=parseFloat(this.element.val()),isFinite(t)&&this.uiSlider.setOption("value",t))}.bind(this))),this.uiSlider.setOption("value",parseFloat(this.element.val()))},t}),N2D("FormElementNumber",["FormElement"],function(o,i){function t(t,e,i,s){this.min=e,this.max=i,this.element=o("#"+t).on({focus:this._focus.bind(this),blur:this.blur.bind(this),change:this.change.bind(this)}),this.parent=this.element.parent();var n=this.parent.siblings(".n2-form-element-units").find("> input");s&&n.length&&n.on("nextendChange",function(){this.min=s[n.val()+"Min"],this.max=s[n.val()+"Max"]}.bind(this)),N2Classes.FormElement.prototype.constructor.call(this)}return((t.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=t).prototype._focus=function(){this.parent.addClass("n2_field_text--focus"),this.element.on("keypress.n2-text",function(t){13===t.which&&(this.element.off("keypress.n2-text"),this.element.trigger("blur"))}.bind(this))},t.prototype.blur=function(){this.parent.removeClass("n2_field_text--focus")},t.prototype.change=function(){var t=this.validate(this.element.val());!0===t?this.triggerOutsideChange():this.element.val(t).trigger("change")},t.prototype.insideChange=function(t){var e=this.validate(t);!0===e?this.element.val(t):this.element.val(e),this.triggerInsideChange()},t.prototype.validate=function(t){if(t!==i&&0<t.length&&"{"===t.charAt(0))return!0;var e=parseFloat(t);return isNaN(e)&&(e=0),(e=Math.max(this.min,Math.min(this.max,e)))+""===t||e},t.prototype.relatedFieldsOff=function(){return 0===parseInt(this.element.val())},t.prototype.isEmpty=function(t){return""===t||0===t},t}),N2D("FormElementOnoff",["FormElement"],function(o,t){function e(t,e){for(var i in this.element=o("#"+t),this.options=o.extend({values:{0:0,1:1},relatedFieldsOff:[],relatedFieldsOn:[],relatedAttribute:""},e),this.options.valuesDict={},this.options.values)this.options.valuesDict[this.options.values[i]]=i;if(this.options.relatedFieldsOff.length){this.relatedFieldsOff=o("");for(var s=0;s<this.options.relatedFieldsOff.length;s++)this.relatedFieldsOff=this.relatedFieldsOff.add(o('[data-field="'+this.options.relatedFieldsOff[s]+'"]'))}else this.relatedFieldsOff=!1;if(this.options.relatedFieldsOn.length){this.relatedFieldsOn=o("");for(s=0;s<this.options.relatedFieldsOn.length;s++)this.relatedFieldsOn=this.relatedFieldsOn.add(o('[data-field="'+this.options.relatedFieldsOn[s]+'"]'))}else this.relatedFieldsOn=!1;var n;""!==this.options.relatedAttribute&&((n=o("#n2-admin")).attr("data-"+this.options.relatedAttribute,this.element.val()),this.element.on("nextendChange",function(){n.attr("data-"+this.options.relatedAttribute,this.element.val())}.bind(this))),this.onoff=this.element.parent().on({click:this.switch.bind(this),keydown:function(t){32===t.keyCode&&(t.stopPropagation(),t.preventDefault(),this.onoff.trigger("click"))}.bind(this)}),this.options.values[this.element.val()]?this.syncOn():this.syncOff(),N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.switch=function(){var t=this.options.values[this.element.val()]?0:1;this.element.val(this.options.valuesDict[t]),this.setSelected(t),this.triggerOutsideChange()},e.prototype.insideChange=function(t){t=this.options.values[t];this.element.val(this.options.valuesDict[t]),this.setSelected(t),this.triggerInsideChange()},e.prototype.setSelected=function(t){t?this.syncOn():this.syncOff()},e.prototype.syncOff=function(){this.onoff.removeClass("n2_field_onoff--on").attr("aria-checked","false"),this.relatedFieldsOff&&this.relatedFieldsOff.removeClass("n2_form_element--hidden"),this.relatedFieldsOn&&this.relatedFieldsOn.addClass("n2_form_element--hidden")},e.prototype.syncOn=function(){this.onoff.addClass("n2_field_onoff--on").attr("aria-checked","true"),this.relatedFieldsOff&&this.relatedFieldsOff.addClass("n2_form_element--hidden"),this.relatedFieldsOn&&this.relatedFieldsOn.removeClass("n2_form_element--hidden")},e}),N2D("FormElementRadio",["FormElement"],function(n,o){function t(t,e,i){if(this.element=n("#"+t),this.values=e,this.relatedFields=!1,i!==o&&i.length){this.relatedFields=n("");for(var s=0;s<i.length;s++)this.relatedFields=this.relatedFields.add(n('[data-field="'+i[s]+'"]'));this.relatedFields.toggleClass("n2_form_element--hidden",this.isOff(this.element.val()))}this.parent=this.element.parent(),this.options=this.parent.find(".n2_field_radio__option");for(s=0;s<this.options.length;s++)this.options.eq(s).on("click",this.click.bind(this));N2Classes.FormElement.prototype.constructor.call(this)}return((t.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=t).prototype.click=function(t){this.changeSelectedIndex(this.options.index(t.currentTarget))},t.prototype.changeSelectedIndex=function(t){var e=this.values[t];this.setValue(e),this.setSelected(t),this.triggerOutsideChange()},t.prototype.insideChange=function(t,e){var i=this.values.indexOf(t);-1===i&&(i=this.partialSearch(t)),-1===i&&e!==o&&(i=this.addOption(t,e)),-1!==i?(this.setValue(this.values[i]),this.setSelected(i),this.triggerInsideChange()):this.options.eq(0).trigger("click")},t.prototype.setSelected=function(t){this.options.removeClass("n2_field_radio__option--selected"),this.options.eq(t).addClass("n2_field_radio__option--selected")},t.prototype.partialSearch=function(t){t=t.replace(/^.*[\\\/]/,"");for(var e=0;e<this.values.length;e++)if(-1!==this.values[e].indexOf(t))return e;return-1},t.prototype.addOption=function(t,e){t=this.values.push(t)-1;return e.appendTo(this.parent).on("click",this.click.bind(this)),this.options=this.options.add(e),t},t.prototype.addTabOption=function(t,e){t=this.values.push(t)-1,e=n('<div class="n2_field_radio__option">'+e+"</div>").insertAfter(this.options.last()).on("click",this.click.bind(this));return this.options=this.options.add(e),t},t.prototype.removeTabOption=function(t){var e=this.values.indexOf(t),t=this.options.eq(e);this.options=this.options.not(t),t.remove(),this.values.splice(e,1)},t.prototype.moveTab=function(t,e){},t.prototype.setValue=function(t){this.element.val(t),this.relatedFields&&this.relatedFields.toggleClass("n2_form_element--hidden",this.isOff(t))},t.prototype.isOff=function(t){return""===t||"0"===t||0===t||"off"===t},t}),N2D("FormRelatedFields",function(s,n){function t(t,e){this.$field=s("#"+t),this.options=s.extend({relatedFieldsOn:[],relatedFieldsOff:[]},e),this.field=this.$field.data("field"),this.field&&this.field.relatedFieldsOff!==n?this.fieldChanged=this.fieldChangedCallback:this.fieldChanged=this.fieldChangedSimple,this.$field.on("nextendChange",this.fieldChanged.bind(this)),this.relatedFieldsOn=s("");for(var i=0;i<this.options.relatedFieldsOn.length;i++)this.relatedFieldsOn=this.relatedFieldsOn.add(s('[data-field="'+this.options.relatedFieldsOn[i]+'"]'));this.relatedFieldsOff=s("");for(i=0;i<this.options.relatedFieldsOff.length;i++)this.relatedFieldsOff=this.relatedFieldsOff.add(s('[data-field="'+this.options.relatedFieldsOff[i]+'"]'));this.fieldChanged()}return t.prototype.fieldChangedSimple=function(){var t=this.$field.val(),t=this.field.isEmpty(t);this.relatedFieldsOn.toggleClass("n2_form_element--hidden",t),this.relatedFieldsOff.toggleClass("n2_form_element--hidden",!t)},t.prototype.fieldChangedCallback=function(){var t=this.field.relatedFieldsOff();this.relatedFieldsOn.toggleClass("n2_form_element--hidden",t),this.relatedFieldsOff.toggleClass("n2_form_element--hidden",!t)},t}),N2D("FormElementRichText",["FormElementText"],function(e,t){function i(t){N2Classes.FormElementText.prototype.constructor.apply(this,arguments),this.parent.find(".n2_field_textarea_rich__button").on("click",this.onButtonClick.bind(this))}return((i.prototype=Object.create(N2Classes.FormElementText.prototype)).constructor=i).prototype.onButtonClick=function(t){switch(e(t.currentTarget).data("action")){case"bold":this.bold();break;case"italic":this.italic();break;case"link":this.link()}},i.prototype.bold=function(){this.wrapText("<b>","</b>")},i.prototype.italic=function(){this.wrapText("<i>","</i>")},i.prototype.link=function(){this.wrapText('<a href="#">',"</a>")},i.prototype.wrapText=function(t,e){var i=this.element,s=i.val().length,n=i[0].selectionStart,o=i[0].selectionEnd,a=t+i.val().substring(n,o)+e;i.val(i.val().substring(0,n)+a+i.val().substring(o,s)),this.triggerOutsideChange(),this.element.focus(),i[0].selectionEnd=o+t.length+e.length},i}),N2D("FormElementSelectIcon",["FormElement"],function(a,t){function e(t,e){if(this.options=a.extend({relatedFields:[],relatedValueFields:[]},e),this.element=a("#"+t),this.$parent=this.element.parent(),this.$options=this.$parent.find(".n2_field_select_icon__option").on("click",this.onSelect.bind(this)),this.relatedFields=!1,this.options.relatedFields.length){this.relatedFields=a("");for(var i=0;i<this.options.relatedFields.length;i++)this.relatedFields=this.relatedFields.add(a('[data-field="'+this.options.relatedFields[i]+'"]'));this.relatedFields.toggleClass("n2_form_element--hidden",this.isOff(this.element.val()))}if(this.relatedValueFields=!1,this.options.relatedValueFields.length){var s=this.element.val();this.relatedValueFields=a("");for(i=0;i<this.options.relatedValueFields.length;i++)for(var n,o=0;o<this.options.relatedValueFields[i].field.length;o++)(n=a('[data-field="'+this.options.relatedValueFields[i].field[o]+'"]').data("show-values",this.options.relatedValueFields[i].values)).toggleClass("n2_form_element--hidden",-1===this.options.relatedValueFields[i].values.indexOf(s)),this.relatedValueFields=this.relatedValueFields.add(n)}N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.onSelect=function(t){t=a(t.currentTarget);t.data("value")!==this.element.val()&&(this.$options.removeClass("n2_field_select_icon__option--selected"),t.addClass("n2_field_select_icon__option--selected"),this.setHiddenValue(t.data("value")),this.triggerOutsideChange())},e.prototype.insideChange=function(t){this.$options.removeClass("n2_field_select_icon__option--selected"),this.$options.filter('[data-value="'+t+'"]').addClass("n2_field_select_icon__option--selected"),this.setHiddenValue(t),this.triggerInsideChange()},e.prototype.setHiddenValue=function(e){this.element.val(e),this.relatedFields&&this.relatedFields.toggleClass("n2_form_element--hidden",this.isOff(e)),this.relatedValueFields&&this.relatedValueFields.each(function(){var t=a(this);t.toggleClass("n2_form_element--hidden",-1===t.data("show-values").indexOf(e))})},e}),N2D("FormElementSkin",["FormElement"],function(n,t){function e(t,e,i,s){this.element=n("#"+t),this.preId=e,this.skins=i,this.list=this.element.data("field"),this.fixedMode=s,this.firstOption=this.list.select.find("option").eq(0),this.originalText=this.firstOption.text(),this.element.on("outsideChange",this.onSkinSelect.bind(this)),N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.onSkinSelect=function(){var t,e=this.element.val();if("0"!==e){for(var i in e=this.skins[e].settings)!e.hasOwnProperty(i)||(t=n("#"+this.preId+i)).length&&t.data("field").insideChange(e[i]);this.fixedMode||(this.changeFirstOptionText(n2_("Done")),this.list.insideChange("0"),setTimeout(this.changeFirstOptionText.bind(this,this.originalText),3e3))}},e.prototype.changeFirstOptionText=function(t){this.firstOption.text(t)},e.prototype.insideChange=function(t){this.element.val(t),this.list.insideChange(t)},e}),N2D("FormElementStyleHidden",["FormElement"],function(i,t){function e(t,e){this.element=i("#"+t),this.parameters=i.extend({mode:"",label:""},e),N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.getLabel=function(){return this.parameters.label},e.prototype.save=function(t,e){this.val(e)},e.prototype.val=function(t){this.element.val(t),this.triggerOutsideChange()},e.prototype.insideChange=function(t){this.element.val(t),this.triggerInsideChange()},e.prototype.renderStyle=function(){return N2Classes.CSSRendererStyle.addCSS("",N2Classes.CSSRendererStyle.getClass(),this.element.val(),N2Classes.CSSRendererStyle.rendererModes[this.parameters.mode])},e}),N2D("FormElementStyle",["FormElement"],function(i,t){function e(t,e){this.element=i("#"+t),this.parent=this.element.parent(),this.parameters=i.extend({mode:"",label:"",font:"",font2:"",style2:"",preview:""},e),N2Classes.FormElement.prototype.constructor.call(this),this.parent.on("click",this.show.bind(this))}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.getLabel=function(){return this.parameters.label},e.prototype.show=function(t){t.preventDefault(),""!==this.parameters.font&&nextend.styleManager.setConnectedFont(this.parameters.font),""!==this.parameters.font2&&nextend.styleManager.setConnectedFont2(this.parameters.font2),""!==this.parameters.style2&&nextend.styleManager.setConnectedStyle(this.parameters.style2),nextend.styleManager.setFieldID(this.element.attr("id")),nextend.styleManager.show(this.element.val(),this.save.bind(this),{previewMode:this.parameters.mode,previewHTML:this.parameters.preview})},e.prototype.save=function(t,e){this.val(e)},e.prototype.val=function(t){this.element.val(t),this.triggerOutsideChange()},e.prototype.insideChange=function(t){this.element.val(t),this.triggerInsideChange()},e.prototype.renderStyle=function(){return N2Classes.CSSRendererStyle.addCSS("",N2Classes.CSSRendererStyle.getClass(),this.element.val(),N2Classes.CSSRendererStyle.rendererModes[this.parameters.mode])},e}),N2D("FormElementSubformIcon",["FormElement"],function($,undefined){function FormElementSubformIcon(t,e,i,s){this.id=t,this.ajaxUrl=e,this.element=$("#"+t).data("field",this),this.$parent=this.element.parent(),this.$targetContainer=$("#"+i),this.originalValue=s,this.form=this.element.closest("form").data("form"),this.$options=this.$parent.find(".n2_field_subform_icon__option").on("click",this.selectOption.bind(this)),N2Classes.FormElement.prototype.constructor.call(this)}return FormElementSubformIcon.prototype=Object.create(N2Classes.FormElement.prototype),FormElementSubformIcon.prototype.constructor=FormElementSubformIcon,FormElementSubformIcon.prototype.selectOption=function(t){var e=$(t.currentTarget),t=e.data("value");this.$options.removeClass("n2_field_subform_icon__option--selected"),e.addClass("n2_field_subform_icon__option--selected"),this.element.val(t),this.triggerOutsideChange(),this.loadSubform(t)},FormElementSubformIcon.prototype.loadSubform=function(t){var e={values:[],value:t};t===this.originalValue&&(e.values=this.form.values),N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl),data:e,dataType:"json"}).done(this.load.bind(this))},FormElementSubformIcon.prototype.load=function(response){this.$targetContainer.html(response.data.html),eval(response.data.scripts),N2Classes.FormTipManager.add(this.$targetContainer)},FormElementSubformIcon}),N2D("FormElementSubformImage",["FormElement"],function(s,t){function e(t,e){this.element=s("#"+t),this.options=s("#"+e).find(".n2-subform-image-option"),this.subform=this.element.data("field"),this.active=this.getIndex(this.options.filter(".n2-active").get(0));for(var i=0;i<this.options.length;i++)this.options.eq(i).on("click",this.selectOption.bind(this));N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.selectOption=function(t){t=this.getIndex(t.currentTarget);t!=this.active&&(this.options.eq(t).addClass("n2-active"),this.options.eq(this.active).removeClass("n2-active"),this.active=t,t=this.subform.list.select.find("option").eq(t).val(),this.subform.list.insideChange(t))},e.prototype.getIndex=function(t){return this.options.indexOf(t)},e}),N2D("FormElementTab",["FormElement"],function(a,t){function r(t,e){if(this.parent=a("#"+t+"_tab"),this.parent.find(".n2_field_tab__option").each(function(t,e){a(e).on("click",function(t){this.onClick(a(t.currentTarget))}.bind(this))}.bind(this)),this.element=a("#"+t).on("change",this.onHiddenChange.bind(this)),this.relatedValueFields=!1,e.length){var i=this.element.val();this.relatedValueFields=a("");for(var s=0;s<e.length;s++)for(var n,o=0;o<e[s].field.length;o++)(n=a('[data-field="'+e[s].field[o]+'"]').data("show-values",e[s].values)).toggleClass("n2_form_element--hidden",-1===e[s].values.indexOf(i)),this.relatedValueFields=this.relatedValueFields.add(n)}N2Classes.FormElement.prototype.constructor.call(this)}return((r.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=r).prototype.onHiddenChange=function(){var t=this.element.val();t&&this.insideChange(t)},r.prototype.onClick=function(t){t.hasClass("n2_field_tab__option--selected")||(this.parent.find(".n2_field_tab__option--selected").removeClass("n2_field_tab__option--selected"),t.addClass("n2_field_tab__option--selected"),this.setHiddenValue(t.attr("data-ssoption")),this.triggerOutsideChange())},r.prototype.insideChange=function(t){this.setHiddenValue(t),this.triggerInsideChange()},r.prototype.setHiddenValue=function(e){this.element.val(e),this.relatedValueFields&&this.relatedValueFields.each(function(){var t=a(this);t.toggleClass("n2_form_element--hidden",-1===t.data("show-values").indexOf(e))})},r.prototype.setOptions=function(t,e,i,s){for(var n in s=s||[],e.html(""),t){var o=a('<div class="n2_field_tab__option" data-ssoption="'+n+'">'+t[n]+"</div>");i===n&&o.addClass("n2_field_tab__option--selected"),e.append(o),new r(e.attr("id").replace("_tab",""),s)}},r}),N2D("FormElementText",["FormElement"],function(e,t){function i(t){this.element=e("#"+t).on({focus:this._focus.bind(this),blur:this._blur.bind(this),change:this.change.bind(this)}),this.tagName=this.element.prop("tagName"),this.parent=this.element.parent(),N2Classes.FormElement.prototype.constructor.call(this),this.updateIsEmpty()}return((i.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=i).prototype._focus=function(){this.parent.addClass("n2_field_text--focus"),"TEXTAREA"!==this.tagName&&this.element.on("keypress.n2-text",function(t){13===t.which&&(this.element.off("keypress.n2-text"),this.element.trigger("blur"))}.bind(this))},i.prototype._blur=function(){this.parent.removeClass("n2_field_text--focus")},i.prototype.change=function(){this.updateIsEmpty(),this.triggerOutsideChange()},i.prototype.insideChange=function(t){this.element.val(t),this.updateIsEmpty(),this.triggerInsideChange()},i.prototype.updateIsEmpty=function(){this.parent.toggleClass("n2_field_text--empty",this.isEmpty(this.element.val()))},i.prototype.isEmpty=function(t){return""===t},i.prototype.focus=function(t){this.connectedField?this.connectedField.focus(t):t&&this.element.focus().select()},i}),N2D("FormElementUnits",["FormElement"],function(s,t){function e(t,e){this.element=s("#"+t),this.$parent=this.element.parent(),this.options=this.$parent.find(".n2_field_unit__unit"),this.currentUnit=this.$parent.find(".n2_field_unit__current_unit"),this.values=e;for(var i=0;i<this.options.length;i++)this.options.eq(i).on("click",this.switch.bind(this,i));N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.switch=function(t,e){this.element.val(this.values[t]),this.setSelected(t),this.triggerOutsideChange()},e.prototype.insideChange=function(t){t=this.values.indexOf(t);this.element.val(this.values[t]),this.setSelected(t),this.triggerInsideChange()},e.prototype.setSelected=function(t){this.currentUnit.html(this.options.eq(t).html())},e}),N2D("FormElementUpload",["FormElement"],function(e,t){function i(t){this.element=e("#"+t).on("change",this.updateName.bind(this)),this.parent=this.element.parent(),this.$name=this.parent.find(".n2_field_chooser__label"),this.updateName(this.element.val()),N2Classes.FormElement.prototype.constructor.call(this)}return((i.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=i).prototype.insideChange=function(t){this.updateName(),this.triggerInsideChange()},i.prototype.updateName=function(){var t=this.element[0].value;this.parent.toggleClass("n2_field_chooser--empty",""===t),this.isEmpty(t)?this.$name.text(n2_("No file selected.")):(t=t.split("\\").pop(),this.$name.text(t))},i.prototype.isEmpty=function(t){return""===t},i}),N2D("FormElementUrl",["FormElementText"],function(t,e){function i(t,e){N2Classes.FormElementText.prototype.constructor.call(this,t),this.parameters=e,this.button=this.parent.find(".n2_field_text__choose").on("click",this.open.bind(this)),this.element.siblings(".n2_field_text__clear").on("click",this.clear.bind(this))}return((i.prototype=Object.create(N2Classes.FormElementText.prototype)).constructor=i).prototype.isEmpty=function(t){return""===t||"#"===t},i.prototype.clear=function(t){t.preventDefault(),this.val("#")},i.prototype.val=function(t){this.element.val(t),this.change()},i.prototype.open=function(t){t.preventDefault(),this.element.val(),N2Classes.ModalUrl.show(this.element.val(),this.parameters.url,function(t){this.val(t)}.bind(this))},i}),N2R("$",function(i){function s(t){return t+Math.floor(281474976710656*(1+Math.random())).toString(16)}i.fn.uid=function(t){var e=null;for(t=t||"n";e=s(t),0<i("#"+e).length;);return e},i.fn.generateUniqueClass=function(t){var e=null;for(t=t||"n";e=s(t),0<i("."+e).length;);return e}}),N2D("UIAutocomplete",["UIWidgetBase"],function(d,t){"use strict";function e(t,e){this.isRendered=!1,this.element=t,this.widgetName=this.widgetName||"UIAutocomplete",this.widgetEventPrefix="autocomplete",this.isActive=!1,this.allowBlur=!0,this.options=d.extend({appendTo:"body",source:null,select:null,positionTo:"self",x:0,y:0},this.options,e),N2Classes.UIWidgetBase.prototype.constructor.apply(this,arguments),this.element.on({focus:this.focus.bind(this),blur:this.blur.bind(this)}),"self"===this.options.positionTo?this.positionTo=this.element:this.positionTo=this.element.closest(this.options.positionTo)}return((e.prototype=Object.create(N2Classes.UIWidgetBase.prototype)).constructor=e).prototype.focus=function(t){!1===this.isActive&&(this.showList(t),this.element.on("click."+this.widgetEventPrefix,this.showList.bind(this)),this.isActive=!0)},e.prototype.showList=function(t){"function"==typeof this.options.appendTo?this.options.appendTo=this.options.appendTo.call(window):this.options.appendTo=d(this.options.appendTo);var e,i,s,n,o=this.getList().appendTo(this.options.appendTo),a={left:0,top:0},r=this.positionTo.offset(),l=0;this.options.appendTo.is(d("body"))||((a=this.options.appendTo.offset()).top-=this.options.appendTo.scrollTop(),o.css("height",""),e=o.height(),i=this.options.appendTo[0].getBoundingClientRect(),s=this.positionTo[0].getBoundingClientRect(),(n=Math.min(i.top+i.height-s.top-s.height-10,e))<100&&n<e&&(n=Math.min(s.top-i.top-10,e),a.top=a.top+s.height+n),o.css("height",n),n2const.rtl.isRtl&&(l=i.width-this.options.appendTo[0].clientWidth)),o.css({left:r.left-a.left+this.options.x-l,top:r.top+this.positionTo.outerHeight()-a.top+this.options.y,minWidth:this.element.parent().outerWidth()+"px"}),o.off("."+this.widgetEventPrefix).on("mousedown."+this.widgetEventPrefix,function(t){d(t.target).is(o)&&(this.element.parent().addClass("focus2"),this.allowBlur=!1)}.bind(this)).on("mouseup."+this.widgetEventPrefix,function(t){d(t.target).is(o)&&(this.allowBlur=!0,this.element.focus(),this.element.parent().removeClass("focus2"))}.bind(this))},e.prototype.blur=function(t){this.allowBlur&&(this.hide(),this.element.off("."+this.widgetEventPrefix))},e.prototype.hide=function(){this.$list.detach(),this.isActive=!1},e.prototype.getList=function(){if(!this.isRendered){this.$list=d('<div class="n2_autocomplete_options"></div>').attr({unselectable:"on"}).on({wheel:function(t){t.stopPropagation()}});for(var t=this.options.source.call(this,this.ui()),e=0;e<t.length;e++)d('<div class="n2_autocomplete_option" tabindex="-1">'+t[e]+"</div>").on({mousedown:function(t){t.preventDefault()},click:function(t,e){this._trigger("select",e,{value:t}),this.hide()}.bind(this,t[e])}).appendTo(this.$list);this.isRendered=!0}return this.$list},e.prototype.ui=function(){return{}},e}),N2D("UIDraggableBar",["UIMouse"],function(i,t){"use strict";function e(t,e){this.element=t,this.widgetName=this.widgetName||"UIDraggable",this.widgetEventPrefix="drag",this.options=i.extend({drag:null,start:null,stop:null},this.options,e),N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this._mouseInit()}return((e.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=e).prototype._mouseStart=function(t){return this.currentData=this.originalData={margin:parseInt(this.element.css("marginLeft"))},this.originalMousePosition={left:t.pageX},this.element.addClass("nui-draggable-dragging"),this._trigger("start",t,this.ui()),this._mouseDrag(t),!0},e.prototype._mouseDrag=function(t){var e=t.pageX-this.originalMousePosition.left||0;return this.currentData={},this.currentData.margin=Math.max(0,this.originalData.margin+e),this._trigger("drag",t,this.ui()),this.element.css("marginLeft",this.currentData.margin),!0},e.prototype._mouseStop=function(t){return this._trigger("stop",t,this.ui()),!0},e.prototype.ui=function(){return{currentData:this.currentData}},e}),N2D("UIDraggableDelay",["UIMouse"],function(i,t){"use strict";function e(t,e){this.element=t,this.widgetName=this.widgetName||"UIDraggable",this.widgetEventPrefix="drag",this.options=i.extend({drag:null,start:null,stop:null},this.options,e),N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this._mouseInit()}return((e.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=e).prototype._mouseStart=function(t){return this.currentData=this.originalData={width:parseInt(this.element.width())},this.originalMousePosition={left:t.pageX},this.element.addClass("nui-draggable-dragging"),this._trigger("start",t,this.ui()),this._mouseDrag(t),!0},e.prototype._mouseDrag=function(t){var e=t.pageX-this.originalMousePosition.left||0;return this.currentData={},this.currentData.width=Math.max(0,this.originalData.width+e),this._trigger("drag",t,this.ui()),this.element.width(this.currentData.width),!0},e.prototype._mouseStop=function(t){return this._trigger("stop",t,this.ui()),!0},e.prototype.ui=function(){return{currentData:this.currentData}},e}),N2D("UIDraggable",["UIMouse"],function(o,t){"use strict";function e(t,e){this.element=t,this.widgetName=this.widgetName||"UIDraggable",this.widgetEventPrefix="drag",this.options=o.extend(!0,{addClasses:!0,appendTo:"parent",axis:!1,containment:!1,cursor:"auto",cursorAt:!1,handle:!1,helper:"original",scroll:!0,scrollSensitivity:20,scrollSpeed:20,min:{top:!1,left:!1},drag:null,start:null,stop:null},this.options,e),N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this.create()}((e.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=e).prototype.create=function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("nui-draggable"),this._setHandleClassName(),this._mouseInit()},e.prototype._setPositionRelative=function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},e.prototype._getHandle=function(t){return!this.options.handle||!!o(t.target).closest(this.element.find(this.options.handle)).length},e.prototype._setHandleClassName=function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("nui-draggable-handle")},e.prototype._mouseCapture=function(t){var e=this.options;return!(this.helper||e.disabled||0<o(t.target).closest(".nui_resize_absolute").length)&&(this.handle=this._getHandle(t),!!this.handle&&(this._blurActiveElement(t),!0))},e.prototype.cancel=function(){return this.helper.is(".nui-draggable-dragging")?this._mouseUp(new o.Event("mouseup",{target:this.element[0]})):this._clear(),this},o.fn.nuiScrollParent=function(t){var e=this.css("position"),i="absolute"===e,s=t?/(auto|scroll|hidden)/:/(auto|scroll)/,t=this.parents().filter(function(){var t=o(this);return(!i||"static"!==t.css("position"))&&s.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==e&&t.length?t:o(this[0].ownerDocument||document)},e.prototype._mouseStart=function(t){var e=this.options;return this.helper=this._createHelper(t),this.helper.addClass("nui-draggable-dragging"),this._cacheHelperProportions(),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.nuiScrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=0<this.helper.parents().filter(function(){return"fixed"===o(this).css("position")}).length,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt),this._setContainment(),!1===this._trigger("start",t)?(this._clear(),!1):(this._cacheHelperProportions(),this._mouseDrag(t,!0),!0)},e.prototype._mouseDrag=function(t,e){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!e){e=this._uiHash();if(!1===this._trigger("drag",t,e))return this._mouseUp(new o.Event("mouseup",t)),!1;this.position=e.position}return!1!==this.options.min.top&&(this.position.top=Math.max(this.position.top,this.options.min.top)),!1!==this.options.min.left&&(this.position.left=Math.max(this.position.left,this.options.min.left)),this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",!1},e.prototype._mouseStop=function(t){return!1!==this._trigger("stop",t)&&this._clear(),!1},e.prototype._mouseUp=function(t){return this.handleElement.is(t.target)&&this.element.trigger("focus"),N2Classes.UIMouse.prototype._mouseUp.call(this,t)},e.prototype._trigger=function(t,e,i){return i=i||this._uiHash(),N2Classes.UIWidgetBase.prototype._trigger.call(this,t,e,i)},e.prototype._uiHash=function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition}},e.prototype._createHelper=function(t){var e=this.options,i=o.isFunction(e.helper),t=i?o(e.helper.apply(this.element[0],[t])):"clone"===e.helper?this.element.clone().removeAttr("id"):this.element;return t.parents("body").length||t.appendTo("parent"===e.appendTo?this.element[0].parentNode:e.appendTo),i&&t[0]===this.element[0]&&this._setPositionRelative(),t[0]===this.element[0]||/(fixed|absolute)/.test(t.css("position"))||t.css("position","absolute"),t},e.prototype._cacheHelperProportions=function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},e.prototype._cacheMargins=function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},e.prototype._refreshOffsets=function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},e.prototype._getParentOffset=function(){var t=this.offsetParent.offset(),e=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==e&&o.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},e.prototype._getRelativeOffset=function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}},e.prototype._convertPositionTo=function(t,e){e=e||this.position;var i="absolute"===t?1:-1,t=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:t?0:this.offset.scroll.top)*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:t?0:this.offset.scroll.left)*i}},e.prototype._setContainment=function(){var t,e,i,s=this.options,n=this.document[0];this.relativeContainer=null,s.containment?"window"!==s.containment?"document"!==s.containment?s.containment.constructor!==Array?("parent"===s.containment&&(s.containment=this.helper[0].parentNode),(i=(e=o(s.containment))[0])&&(t=/(scroll|auto)/.test(e.css("overflow")),this.containment=[(parseInt(e.css("borderLeftWidth"),10)||0)+(parseInt(e.css("paddingLeft"),10)||0),(parseInt(e.css("borderTopWidth"),10)||0)+(parseInt(e.css("paddingTop"),10)||0),(t?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(e.css("borderRightWidth"),10)||0)-(parseInt(e.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(e.css("borderBottomWidth"),10)||0)-(parseInt(e.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=e)):this.containment=s.containment:this.containment=[0,0,o(n).width()-this.helperProportions.width-this.margins.left,(o(n).height()||n.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=[o(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,o(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,o(window).scrollLeft()+o(window).width()-this.helperProportions.width-this.margins.left,o(window).scrollTop()+(o(window).height()||n.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=null},e.prototype._adjustOffsetFromHelper=function(t){"string"==typeof t&&(t=t.split(" ")),o.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},e.prototype._isRootNode=function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},e.prototype._generatePosition=function(t,e){var i,s=this.options,n=this._isRootNode(this.scrollParent[0]),o=t.pageX,a=t.pageY;return n&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(i=this.relativeContainer?(i=this.relativeContainer.offset(),[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):this.containment,t.pageX-this.offset.click.left<i[0]&&(o=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(a=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(o=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(a=i[3]+this.offset.click.top)),"y"===s.axis&&(o=this.originalPageX),"x"===s.axis&&(a=this.originalPageY)),{top:a-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:n?0:this.offset.scroll.top),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:n?0:this.offset.scroll.left)}},e.prototype._clear=function(){this.helper.removeClass("nui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()};return e.prototype._blurActiveElement=function(t){var e=function(e){var i;try{i=e.activeElement}catch(t){i=e.body}return(i=i||e.body).nodeName||(i=e.body),i}(this.document[0]);o(t.target).closest(e).length||(e=e)&&"body"!==e.nodeName.toLowerCase()&&o(e).trigger("blur")},e}),N2D("UIFileUpload",["UIWidgetBase"],function(y,v){"use strict";function t(i){var s="dragover"===i;return function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var e=t.dataTransfer;e&&-1!==e.types.indexOf("Files")&&!1!==this._trigger(i,y.Event(i,{delegatedEvent:t}))&&(t.preventDefault(),s&&(e.dropEffect="copy"))}}function e(t,e){this.element=t,this.widgetName=this.widgetName||"UIFileUpload",this.options=y.extend({dropZone:y(document),pasteZone:v,fileInput:v,replaceFileInput:!0,paramName:v,singleFileUploads:!0,limitMultiFileUploads:v,limitMultiFileUploadSize:v,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:v,forceIframeTransport:!1,redirect:v,redirectParamName:v,postMessage:v,multipart:!0,maxChunkSize:v,uploadedBytes:v,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(i,t){return i=this.messages[i]||i.toString(),t&&y.each(t,function(t,e){i=i.replace("{"+t+"}",e)}),i},formData:function(t){return t.serializeArray()},add:function(t,e){if(t.isDefaultPrevented())return!1;(e.autoUpload||!1!==e.autoUpload&&y(this).UIFileUpload("option","autoUpload"))&&e.process().done(function(){e.submit()})},processData:!1,contentType:!1,cache:!1},this.options,e),N2Classes.UIWidgetBase.prototype.constructor.apply(this,arguments),this._specialOptions=["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],this.create()}return y.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||y('<input type="file">').prop("disabled")),y.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader),y.support.xhrFormDataFileUpload=!!window.FormData,y.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),((e.prototype=Object.create(N2Classes.UIWidgetBase.prototype)).constructor=e).prototype._blobSlice=y.support.blobSlice&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},e.prototype._BitrateTimer=function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(t,e,i){var s=t-this.timestamp;return this.bitrate&&i&&!(i<s)||(this.bitrate=(e-this.loaded)*(1e3/s)*8,this.loaded=e,this.timestamp=t),this.bitrate}},e.prototype._isXHRUpload=function(t){return!t.forceIframeTransport&&(!t.multipart&&y.support.xhrFileUpload||y.support.xhrFormDataFileUpload)},e.prototype._getFormData=function(t){var i;return"function"===y.type(t.formData)?t.formData(t.form):y.isArray(t.formData)?t.formData:"object"===y.type(t.formData)?(i=[],y.each(t.formData,function(t,e){i.push({name:t,value:e})}),i):[]},e.prototype._getTotal=function(t){var i=0;return y.each(t,function(t,e){i+=e.size||1}),i},e.prototype._initProgressObject=function(t){var e={loaded:0,total:0,bitrate:0};t._progress?y.extend(t._progress,e):t._progress=e},e.prototype._initResponseObject=function(t){if(t._response)for(var e in t._response)t._response.hasOwnProperty(e)&&delete t._response[e];else t._response={}},e.prototype._onProgress=function(t,e){var i,s;t.lengthComputable&&(i=Date.now?Date.now():(new Date).getTime(),e._time&&e.progressInterval&&i-e._time<e.progressInterval&&t.loaded!==t.total||(e._time=i,s=Math.floor(t.loaded/t.total*(e.chunkSize||e._progress.total))+(e.uploadedBytes||0),this._progress.loaded+=s-e._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(i,this._progress.loaded,e.bitrateInterval),e._progress.loaded=e.loaded=s,e._progress.bitrate=e.bitrate=e._bitrateTimer.getBitrate(i,s,e.bitrateInterval),this._trigger("progress",y.Event("progress",{delegatedEvent:t}),e),this._trigger("progressall",y.Event("progressall",{delegatedEvent:t}),this._progress)))},e.prototype._initProgressListener=function(i){var s=this,t=(i.xhr?i:y.ajaxSettings).xhr();t.upload&&(y(t.upload).bind("progress",function(t){var e=t.originalEvent;t.lengthComputable=e.lengthComputable,t.loaded=e.loaded,t.total=e.total,s._onProgress(t,i)}),i.xhr=function(){return t})},e.prototype._isInstanceOf=function(t,e){return Object.prototype.toString.call(e)==="[object "+t+"]"},e.prototype._initXHRData=function(i){var s,n=this,t=i.files[0],e=i.multipart||!y.support.xhrFileUpload,o="array"===y.type(i.paramName)?i.paramName[0]:i.paramName;i.headers=y.extend({},i.headers),i.contentRange&&(i.headers["Content-Range"]=i.contentRange),e&&!i.blob&&this._isInstanceOf("File",t)||(i.headers["Content-Disposition"]='attachment; filename="'+encodeURI(t.name)+'"'),e?y.support.xhrFormDataFileUpload&&(i.postMessage?(s=this._getFormData(i),i.blob?s.push({name:o,value:i.blob}):y.each(i.files,function(t,e){s.push({name:"array"===y.type(i.paramName)&&i.paramName[t]||o,value:e})})):(n._isInstanceOf("FormData",i.formData)?s=i.formData:(s=new FormData,y.each(this._getFormData(i),function(t,e){s.append(e.name,e.value)})),i.blob?s.append(o,i.blob,t.name):y.each(i.files,function(t,e){(n._isInstanceOf("File",e)||n._isInstanceOf("Blob",e))&&s.append("array"===y.type(i.paramName)&&i.paramName[t]||o,e,e.uploadName||e.name)})),i.data=s):(i.contentType=t.type||"application/octet-stream",i.data=i.blob||t),i.blob=null},e.prototype._initIframeSettings=function(t){var e=y("<a></a>").prop("href",t.url).prop("host");t.dataType="iframe "+(t.dataType||""),t.formData=this._getFormData(t),t.redirect&&e&&e!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},e.prototype._initDataSettings=function(t){this._isXHRUpload(t)?(this._chunkedUpload(t,!0)||(t.data||this._initXHRData(t),this._initProgressListener(t)),t.postMessage&&(t.dataType="postmessage "+(t.dataType||""))):this._initIframeSettings(t)},e.prototype._getParamName=function(t){var e=y(t.fileInput),s=t.paramName;return s?y.isArray(s)||(s=[s]):(s=[],e.each(function(){for(var t=y(this),e=t.prop("name")||"files[]",i=(t.prop("files")||[1]).length;i;)s.push(e),--i}),s.length||(s=[e.prop("name")||"files[]"])),s},e.prototype._initFormSettings=function(t){t.form&&t.form.length||(t.form=y(t.fileInput.prop("form")),t.form.length||(t.form=y(this.options.fileInput.prop("form")))),t.paramName=this._getParamName(t),t.url||(t.url=t.form.prop("action")||location.href),t.type=(t.type||"string"===y.type(t.form.prop("method"))&&t.form.prop("method")||"").toUpperCase(),"POST"!==t.type&&"PUT"!==t.type&&"PATCH"!==t.type&&(t.type="POST"),t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},e.prototype._getAJAXSettings=function(t){t=y.extend({},this.options,t);return this._initFormSettings(t),this._initDataSettings(t),t},e.prototype._getDeferredState=function(t){return t.state?t.state():t.isResolved()?"resolved":t.isRejected()?"rejected":"pending"},e.prototype._enhancePromise=function(t){return t.success=t.done,t.error=t.fail,t.complete=t.always,t},e.prototype._getXHRPromise=function(t,e,i){var s=y.Deferred(),n=s.promise();return e=e||this.options.context||n,!0===t?s.resolveWith(e,i):!1===t&&s.rejectWith(e,i),n.abort=s.promise,this._enhancePromise(n)},e.prototype._addConvenienceMethods=function(t,i){function s(t){return y.Deferred().resolveWith(n,t).promise()}var n=this;i.process=function(t,e){return(t||e)&&(i._processQueue=this._processQueue=(this._processQueue||s([this])).pipe(function(){return i.errorThrown?y.Deferred().rejectWith(n,[i]).promise():s(arguments)}).pipe(t,e)),this._processQueue||s([this])},i.submit=function(){return"pending"!==this.state()&&(i.jqXHR=this.jqXHR=!1!==n._trigger("submit",y.Event("submit",{delegatedEvent:t}),this)&&n._onSend(t,this)),this.jqXHR||n._getXHRPromise()},i.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",n._trigger("fail",null,this),n._getXHRPromise(!1))},i.state=function(){return this.jqXHR?n._getDeferredState(this.jqXHR):this._processQueue?n._getDeferredState(this._processQueue):void 0},i.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===n._getDeferredState(this._processQueue)},i.progress=function(){return this._progress},i.response=function(){return this._response}},e.prototype._getUploadedBytes=function(t){t=t.getResponseHeader("Range"),t=t&&t.split("-"),t=t&&1<t.length&&parseInt(t[1],10);return t&&t+1},e.prototype._chunkedUpload=function(o,t){o.uploadedBytes=o.uploadedBytes||0;var e,a,r=this,i=o.files[0],l=i.size,d=o.uploadedBytes,h=o.maxChunkSize||l,p=this._blobSlice,c=y.Deferred(),s=c.promise();return!(!(this._isXHRUpload(o)&&p&&(d||h<l))||o.data)&&(!!t||(l<=d?(i.error=o.i18n("uploadedBytes"),this._getXHRPromise(!1,o.context,[null,"error",i.error])):(a=function(){var s=y.extend({},o),n=s._progress.loaded;s.blob=p.call(i,d,d+h,i.type),s.chunkSize=s.blob.size,s.contentRange="bytes "+d+"-"+(d+s.chunkSize-1)+"/"+l,r._initXHRData(s),r._initProgressListener(s),e=(!1!==r._trigger("chunksend",null,s)&&y.ajax(s)||r._getXHRPromise(!1,s.context)).done(function(t,e,i){d=r._getUploadedBytes(i)||d+s.chunkSize,n+s.chunkSize-s._progress.loaded&&r._onProgress(y.Event("progress",{lengthComputable:!0,loaded:d-s.uploadedBytes,total:d-s.uploadedBytes}),s),o.uploadedBytes=s.uploadedBytes=d,s.result=t,s.textStatus=e,s.jqXHR=i,r._trigger("chunkdone",null,s),r._trigger("chunkalways",null,s),d<l?a():c.resolveWith(s.context,[t,e,i])}).fail(function(t,e,i){s.jqXHR=t,s.textStatus=e,s.errorThrown=i,r._trigger("chunkfail",null,s),r._trigger("chunkalways",null,s),c.rejectWith(s.context,[t,e,i])})},this._enhancePromise(s),s.abort=function(){return e.abort()},a(),s)))},e.prototype._beforeSend=function(t,e){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(e),this._initProgressObject(e),e._progress.loaded=e.loaded=e.uploadedBytes||0,e._progress.total=e.total=this._getTotal(e.files)||1,e._progress.bitrate=e.bitrate=0,this._active+=1,this._progress.loaded+=e.loaded,this._progress.total+=e.total},e.prototype._onDone=function(t,e,i,s){var n=s._progress.total,o=s._response;s._progress.loaded<n&&this._onProgress(y.Event("progress",{lengthComputable:!0,loaded:n,total:n}),s),o.result=s.result=t,o.textStatus=s.textStatus=e,o.jqXHR=s.jqXHR=i,this._trigger("done",null,s)},e.prototype._onFail=function(t,e,i,s){var n=s._response;s.recalculateProgress&&(this._progress.loaded-=s._progress.loaded,this._progress.total-=s._progress.total),n.jqXHR=s.jqXHR=t,n.textStatus=s.textStatus=e,n.errorThrown=s.errorThrown=i,this._trigger("fail",null,s)},e.prototype._onAlways=function(t,e,i,s){this._trigger("always",null,s)},e.prototype._onSend=function(t,e){e.submit||this._addConvenienceMethods(t,e);function i(){return a._sending+=1,r._bitrateTimer=new a._BitrateTimer,s=s||((n||!1===a._trigger("send",y.Event("send",{delegatedEvent:t}),r))&&a._getXHRPromise(!1,r.context,n)||a._chunkedUpload(r)||y.ajax(r)).done(function(t,e,i){a._onDone(t,e,i,r)}).fail(function(t,e,i){a._onFail(t,e,i,r)}).always(function(t,e,i){if(a._onAlways(t,e,i,r),--a._sending,--a._active,r.limitConcurrentUploads&&r.limitConcurrentUploads>a._sending)for(var s=a._slots.shift();s;){if("pending"===a._getDeferredState(s)){s.resolve();break}s=a._slots.shift()}0===a._active&&a._trigger("stop")})}var s,n,o,a=this,r=a._getAJAXSettings(e);return this._beforeSend(t,r),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?((e=1<this.options.limitConcurrentUploads?(o=y.Deferred(),this._slots.push(o),o.pipe(i)):(this._sequence=this._sequence.pipe(i,i),this._sequence)).abort=function(){return n=[v,"abort","abort"],s?s.abort():(o&&o.rejectWith(r.context,n),i())},this._enhancePromise(e)):i()},e.prototype._onAdd=function(s,n){var o,t,a,e,r=this,l=!0,i=y.extend({},this.options,n),d=n.files,h=d.length,p=i.limitMultiFileUploads,c=i.limitMultiFileUploadSize,u=i.limitMultiFileUploadSizeOverhead,f=0,m=this._getParamName(i),g=0;if(!c||h&&d[0].size!==v||(c=v),(i.singleFileUploads||p||c)&&this._isXHRUpload(i))if(i.singleFileUploads||c||!p)if(!i.singleFileUploads&&c)for(a=[],o=[],e=0;e<h;e+=1)f+=d[e].size+u,(e+1===h||f+d[e+1].size+u>c||p&&p<=e+1-g)&&(a.push(d.slice(g,e+1)),(t=m.slice(g,e+1)).length||(t=m),o.push(t),g=e+1,f=0);else o=m;else for(a=[],o=[],e=0;e<h;e+=p)a.push(d.slice(e,e+p)),(t=m.slice(e,e+p)).length||(t=m),o.push(t);else a=[d],o=[m];return n.originalFiles=d,y.each(a||d,function(t,e){var i=y.extend({},n);return i.files=a?e:[e],i.paramName=o[t],r._initResponseObject(i),r._initProgressObject(i),r._addConvenienceMethods(s,i),l=r._trigger("add",y.Event("add",{delegatedEvent:s}),i)}),l},e.prototype._replaceFileInput=function(t){var i=t.fileInput,s=i.clone(!0);t.fileInputClone=s,y("<form></form>").append(s)[0].reset(),i.after(s).detach(),y.cleanData(i.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(t,e){return e===i[0]?s[0]:e}),i[0]===this.element[0]&&(this.element=s)},e.prototype._handleFileTreeEntry=function(e,i){function s(t){t&&!t.entry&&(t.entry=e),o.resolve([t])}var t,n=this,o=y.Deferred(),a=function(){t.readEntries(function(t){t.length?(r=r.concat(t),a()):(t=r,n._handleFileTreeEntries(t,i+e.name+"/").done(function(t){o.resolve(t)}).fail(s))},s)},r=[];return i=i||"",e.isFile?e._file?(e._file.relativePath=i,o.resolve(e._file)):e.file(function(t){t.relativePath=i,o.resolve(t)},s):e.isDirectory?(t=e.createReader(),a()):o.resolve([]),o.promise()},e.prototype._handleFileTreeEntries=function(t,e){var i=this;return y.when.apply(y,y.map(t,function(t){return i._handleFileTreeEntry(t,e)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},e.prototype._getDroppedFiles=function(t){var e=(t=t||{}).items;return e&&e.length&&(e[0].webkitGetAsEntry||e[0].getAsEntry)?this._handleFileTreeEntries(y.map(e,function(t){var e;return t.webkitGetAsEntry?((e=t.webkitGetAsEntry())&&(e._file=t.getAsFile()),e):t.getAsEntry()})):y.Deferred().resolve(y.makeArray(t.files)).promise()},e.prototype._getSingleFileInputFiles=function(t){var e=(t=y(t)).prop("webkitEntries")||t.prop("entries");if(e&&e.length)return this._handleFileTreeEntries(e);if((e=y.makeArray(t.prop("files"))).length)e[0].name===v&&e[0].fileName&&y.each(e,function(t,e){e.name=e.fileName,e.size=e.fileSize});else{if(!(t=t.prop("value")))return y.Deferred().resolve([]).promise();e=[{name:t.replace(/^.*\\/,"")}]}return y.Deferred().resolve(e).promise()},e.prototype._getFileInputFiles=function(t){return t instanceof y&&1!==t.length?y.when.apply(y,y.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(t)},e.prototype._onChange=function(e){var i=this,s={fileInput:y(e.target),form:y(e.target.form)};this._getFileInputFiles(s.fileInput).always(function(t){s.files=t,i.options.replaceFileInput&&i._replaceFileInput(s),!1!==i._trigger("change",y.Event("change",{delegatedEvent:e}),s)&&i._onAdd(e,s)})},e.prototype._onPaste=function(t){var e=t.originalEvent&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items,i={files:[]};e&&e.length&&(y.each(e,function(t,e){e=e.getAsFile&&e.getAsFile();e&&i.files.push(e)}),!1!==this._trigger("paste",y.Event("paste",{delegatedEvent:t}),i)&&this._onAdd(t,i))},e.prototype._onDrop=function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var i=this,t=e.dataTransfer,s={};t&&t.files&&t.files.length&&(e.preventDefault(),e.stopPropagation(),this._getDroppedFiles(t).always(function(t){s.files=t,!1!==i._trigger("drop",y.Event("drop",{delegatedEvent:e}),s)&&i._onAdd(e,s)}))},e.prototype._onDragOver=t("dragover"),e.prototype._onDragEnter=t("dragenter"),e.prototype._onDragLeave=t("dragleave"),e.prototype._initEventHandlers=function(){this._isXHRUpload(this.options)&&(y(this.options.dropZone).on({dragover:this._onDragOver.bind(this),drop:this._onDrop.bind(this),dragenter:this._onDragEnter.bind(this),dragleave:this._onDragLeave.bind(this)}),y(this.options.pasteZone).on({paste:this._onPaste.bind(this)})),y.support.fileInput&&y(this.options.fileInput).on({change:this._onChange.bind(this)})},e.prototype._destroyEventHandlers=function(){y(this.options.dropZone).off("dragenter dragleave dragover drop"),y(this.options.pasteZone).off("paste"),y(this.options.fileInput).off("change")},e.prototype.setOption=function(t,e){t=-1!==this._specialOptions.indexOf(t);t&&this._destroyEventHandlers(),N2Classes.UIWidgetBase.prototype.setOption.apply(this,arguments),t&&(this._initSpecialOptions(),this._initEventHandlers())},e.prototype._initSpecialOptions=function(){var t=this.options;t.fileInput===v?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof y||(t.fileInput=y(t.fileInput)),t.dropZone instanceof y||(t.dropZone=y(t.dropZone)),t.pasteZone instanceof y||(t.pasteZone=y(t.pasteZone))},e.prototype._getRegExp=function(t){var e=t.split("/"),t=e.pop();return e.shift(),new RegExp(e.join("/"),t)},e.prototype._isRegExpOption=function(t,e){return"url"!==t&&"string"===y.type(e)&&/^\/.*\/[igm]{0,3}$/.test(e)},e.prototype._initDataAttributes=function(){var s=this,n=this.options,o=this.element.data();y.each(this.element[0].attributes,function(t,e){var i=e.name.toLowerCase();/^data-/.test(i)&&(i=i.slice(5).replace(/-[a-z]/g,function(t){return t.charAt(1).toUpperCase()}),e=o[i],s._isRegExpOption(i,e)&&(e=s._getRegExp(e)),n[i]=e)})},e.prototype.create=function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},e.prototype.active=function(){return this._active},e.prototype.progress=function(){return this._progress},e.prototype.add=function(e){var i=this;e&&!this.options.disabled&&(e.fileInput&&!e.files?this._getFileInputFiles(e.fileInput).always(function(t){e.files=t,i._onAdd(null,e)}):(e.files=y.makeArray(e.files),this._onAdd(null,e)))},e.prototype.send=function(e){if(e&&!this.options.disabled){if(e.fileInput&&!e.files){var i,s,n=this,o=y.Deferred(),t=o.promise();return t.abort=function(){return s=!0,i?i.abort():(o.reject(null,"abort","abort"),t)},this._getFileInputFiles(e.fileInput).always(function(t){s||(t.length?(e.files=t,(i=n._onSend(null,e)).then(function(t,e,i){o.resolve(t,e,i)},function(t,e,i){o.reject(t,e,i)})):o.reject())}),this._enhancePromise(t)}if(e.files=y.makeArray(e.files),e.files.length)return this._onSend(null,e)}return this._getXHRPromise(!1,e&&e.context)},e}),N2D("ajaxTransportIframe",function(l,d){"use strict";var i=0;l.ajaxTransport("iframe",function(n){if(n.async){var o,a,e,r=n.initialIframeSrc||"javascript:false;";return{send:function(t,s){(o=l('<form style="display:none;"></form>')).attr("accept-charset",n.formAcceptCharset),e=/\?/.test(n.url)?"&":"?","DELETE"===n.type?(n.url=n.url+e+"_method=DELETE",n.type="POST"):"PUT"===n.type?(n.url=n.url+e+"_method=PUT",n.type="POST"):"PATCH"===n.type&&(n.url=n.url+e+"_method=PATCH",n.type="POST"),a=l('<iframe src="'+r+'" name="iframe-transport-'+(i+=1)+'"></iframe>').bind("load",function(){var i,e=l.isArray(n.paramName)?n.paramName:[n.paramName];a.unbind("load").bind("load",function(){var e;try{if(!(e=a.contents()).length||!e[0].firstChild)throw new Error}catch(t){e=d}s(200,"success",{iframe:e}),l('<iframe src="'+r+'"></iframe>').appendTo(o),window.setTimeout(function(){o.remove()},0)}),o.prop("target",a.prop("name")).prop("action",n.url).prop("method",n.type),n.formData&&l.each(n.formData,function(t,e){l('<input type="hidden"/>').prop("name",e.name).val(e.value).appendTo(o)}),n.fileInput&&n.fileInput.length&&"POST"===n.type&&(i=n.fileInput.clone(),n.fileInput.after(function(t){return i[t]}),n.paramName&&n.fileInput.each(function(t){l(this).prop("name",e[t]||n.paramName)}),o.append(n.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data"),n.fileInput.removeAttr("form")),o.submit(),i&&i.length&&n.fileInput.each(function(t,e){t=l(i[t]);l(e).prop("name",t.prop("name")).attr("form",t.attr("form")),t.replaceWith(e)})}),o.append(a).appendTo(document.body)},abort:function(){a&&a.unbind("load").prop("src",r),o&&o.remove()}}}}),l.ajaxSetup({converters:{"iframe text":function(t){return t&&l(t[0].body).text()},"iframe json":function(t){return t&&l.parseJSON(l(t[0].body).text())},"iframe html":function(t){return t&&l(t[0].body).html()},"iframe xml":function(t){t=t&&t[0];return t&&l.isXMLDoc(t)?t:l.parseXML(t.XMLDocument&&t.XMLDocument.xml||l(t.body).html())},"iframe script":function(t){return t&&l.globalEval(l(t[0].body).text())}}})}),N2D("UILayerWindow",["UIMouse"],function(i,t){"use strict";function e(t,e){this.element=t,this.widgetName=this.widgetName||"UILayerWindow",this.widgetEventPrefix="layerWindow",this.options=i.extend(!0,{},this.options,e),N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this.create()}return((e.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=e).prototype.create=function(){this.bodyRect=document.body.getBoundingClientRect(),window.addEventListener("resize",function(){this.bodyRect=document.body.getBoundingClientRect(),this.limitHorizontal(this.left,this.width,!0),this.limitVertical(this.top,this.height,!0)}.bind(this),{passive:!0}),this.left=parseInt(localStorage.getItem("ssPanelLeft")),this.left||(this.left=200),this.top=parseInt(localStorage.getItem("ssPanelTop")),this.top||(this.top=100),this.width=355,this.height=parseInt(localStorage.getItem("ssPanelHeight")),this.height||(this.height=400),this.limitHorizontal(this.left,this.width),this.limitVertical(this.top,this.height),this._setupHandles(),this._mouseInit()},e.prototype._setupHandles=function(){this.$title=this.element.find(".n2_ss_layer_window__title_inner").on("mousedown",this._mouseDown.bind(this)),this.$resize=i('<div class="n2_ss_layer_window__resize"></div>').on("mousedown",this._mouseDown.bind(this)).appendTo(this.element)},e.prototype._mouseInit=function(){},e.prototype._mouseCapture=function(t){return this.$title.is(t.target)?(this.currentAction="move",!0):!!this.$resize.is(t.target)&&(this.currentAction="resize",!0)},e.prototype._mouseStart=function(t){var e=this.element[0].getBoundingClientRect();this.context={},"move"===this.currentAction?this.context.mouseDiff={x:t.clientX-e.left,y:t.clientY-e.top}:"resize"===this.currentAction&&(this.context.mouseDiff={y:t.clientY-e.top-e.height})},e.prototype._mouseDrag=function(t){"move"===this.currentAction?(this.limitHorizontal(t.clientX-this.context.mouseDiff.x,this.width),this.limitVertical(t.clientY-this.context.mouseDiff.y,this.height)):"resize"===this.currentAction&&this.limitVertical(this.top,t.clientY-this.top-this.context.mouseDiff.y)},e.prototype._mouseStop=function(t){"move"===this.currentAction?(this.limitHorizontal(t.clientX-this.context.mouseDiff.x,this.width,!0),this.limitVertical(t.clientY-this.context.mouseDiff.y,this.height,!0)):"resize"===this.currentAction&&this.limitVertical(this.top,t.clientY-this.top-this.context.mouseDiff.y,!0),delete this.currentAction},e.prototype.limitVertical=function(t,e,i){this.height=e,this.top=Math.min(Math.max(t,60),this.bodyRect.height-this.height),this.top<60&&(this.height=this.height+this.top-60,this.top=60),this.height=Math.max(this.height,200),this.element.css({top:this.top,height:this.height}),i&&(localStorage.setItem("ssPanelTop",this.top),localStorage.setItem("ssPanelHeight",this.height))},e.prototype.limitHorizontal=function(t,e,i){this.left=Math.min(Math.max(t,50),this.bodyRect.width-e),this.element.css({left:this.left}),i&&localStorage.setItem("ssPanelLeft",this.left)},e}),N2D("UIMouse",["UIWidgetBase"],function(n,t){"use strict";var e=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),o=!1;function i(t,e){this.widgetName=this.widgetName||"UIMouse",this.options=n.extend({cancel:"input, textarea, button, select, option",distance:1,delay:0},this.options),N2Classes.UIWidgetBase.prototype.constructor.apply(this,arguments)}return n(document).on("mouseup",function(){o=!1}),((i.prototype=Object.create(N2Classes.UIWidgetBase.prototype)).constructor=i).prototype._mouseInit=function(){var e=this;this.element.on("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).on("click."+this.widgetName,function(t){if(!0===n.data(t.target,e.widgetName+".preventClickEvent"))return n.removeData(t.target,e.widgetName+".preventClickEvent"),t.stopImmediatePropagation(),!1})},i.prototype._mouseDestroy=function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},i.prototype._mouseDown=function(t){if(!o){document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur(),this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var e=this,i=1===t.which,s=!("string"!=typeof this.options.cancel||!t.target.nodeName)&&n(t.target).closest(this.options.cancel).length;return i&&!s&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){e.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(t),!this._mouseStarted)?(t.preventDefault(),!0):(!0===n.data(t.target,this.widgetName+".preventClickEvent")&&n.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return e._mouseMove(t)},this._mouseUpDelegate=function(t){return e._mouseUp(t)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),o=!0)):!0}},i.prototype._mouseMove=function(t){if(this._mouseMoved){if(e&&(!document.documentMode||document.documentMode<9)&&!t.button)return this._mouseUp(t);if(!t.which)if(t.originalEvent.altKey||t.originalEvent.ctrlKey||t.originalEvent.metaKey||t.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,t),this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},i.prototype._mouseUp=function(t){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted?(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&n.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)):this._mouseCancel(t),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,o=!1,t.preventDefault()},i.prototype._mouseDistanceMet=function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},i.prototype._mouseDelayMet=function(){return this.mouseDelayMet},i.prototype._mouseStart=function(){},i.prototype._mouseDrag=function(){},i.prototype._mouseStop=function(){},i.prototype._mouseCancel=function(){},i.prototype._mouseCapture=function(){return!0},i}),N2D("UIResizeBar",["UIMouse"],function(n,t){"use strict";function e(t,e){this.element=t,this.widgetName=this.widgetName||"UIResizable",this.widgetEventPrefix="resize",this.options=n.extend({resize:null,start:null,stop:null},this.options,e),N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this.create()}return((e.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=e).prototype.create=function(){this.options;this.element.addClass("nui_resize_bar"),this._setupHandles(),this._mouseInit(),this._trigger("create",null,{})},e.prototype._setupHandles=function(){var t=["e","w"];this.handles={},this.$handles=n();for(var e=0;e<t.length;e++){var i=t[e],s=n("<div>").addClass("nui_resize_bar__handle nui_resize_bar__handle--"+i).on({mousedown:function(t,e){this.currentHandle=t,this._mouseDown(e)}.bind(this,i)}).appendTo(this.element);this.handles[i]=s,this.$handles=this.$handles.add(s)}},e.prototype._mouseStart=function(t){this.currentData=this.originalData={margin:parseInt(this.element.css("marginLeft")),width:parseInt(this.element.width())},this.originalMousePosition={left:t.pageX};var e=this.handles[this.currentHandle].css("cursor");return n("body").css("cursor",e),this._trigger("start",t,this.ui()),!0},e.prototype._mouseDrag=function(t){var e=t.pageX-this.originalMousePosition.left||0;this.currentData={},"e"===this.currentHandle?(this.currentData.margin=this.originalData.margin,this.currentData.width=Math.max(0,this.originalData.width+e)):"w"===this.currentHandle&&(this.currentData.margin=Math.max(0,this.originalData.margin+e),this.currentData.width=Math.max(0,this.originalData.width-e)),this.currentData.width=Math.max(0,this.currentData.width),this._trigger("resize",t,this.ui()),this.element.css("marginLeft",this.currentData.margin),this.element.css("width",this.currentData.width)},e.prototype._mouseStop=function(t){n("body").css("cursor","auto"),this._trigger("stop",t,this.ui())},e.prototype.ui=function(){return{currentData:this.currentData}},e}),N2D("UISlider",["UIMouse"],function(i,e){"use strict";function t(t,e){this.element=i(t),this.widgetName=this.widgetName||"UISlider",this.widgetEventPrefix="sliding",this.options=i.extend({min:0,max:100,step:1,value:0,change:null,sliding:null,start:null,stop:null},this.options,e),N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this.create()}return((t.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=t).prototype.create=function(){this._mouseSliding=!1,this._mouseInit(),this._calculateNewMax(),this.element.addClass("nui-slider nui-slider-horizontal"),this._refresh()},t.prototype.doAction=function(t){if(N2Classes.UIWidgetBase.prototype.doAction.apply(this,arguments),"value"===t)return this._value()},t.prototype.setOption=function(t,e){switch(N2Classes.UIWidgetBase.prototype.setOption.call(this,t,e),t){case"value":this._refreshValue(),this._change(null,0);break;case"step":case"min":case"max":this._calculateNewMax(),this._refreshValue()}},t.prototype._refresh=function(){this._createHandle(),this._refreshValue()},t.prototype._createHandle=function(){var t=this.element.find(".nui-slider-handle");t.length?this.handle=t:this.handle=i("<span></span>"),this.handle.addClass("nui-slider-handle").appendTo(this.element)},t.prototype._mouseCapture=function(t){var e,i=this.handle;return!this.options.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),e={x:t.pageX,y:t.pageY},e=this._normValueFromMouse(e),!1!==this._start(t)&&(this._mouseSliding=!0,i.trigger("focus"),this._slide(t,e),!0))},t.prototype._mouseStart=function(){return this.lastValue=Number.MAX_VALUE,!0},t.prototype._mouseDrag=function(t){var e={x:t.pageX,y:t.pageY},e=this._normValueFromMouse(e);return this.lastValue!=e&&(this._slide(t,e),this.lastValue=e),!1},t.prototype._mouseStop=function(t){return this._mouseSliding=!1,this._stop(t),this._change(t),!1},t.prototype._mouseCancel=function(t){this._trigger("cancel",t)},t.prototype._normValueFromMouse=function(t){var e=this.elementSize.width,t=(t.x-this.elementOffset.left)/e;return 1<t&&(t=1),t<0&&(t=0),e=this._valueMax()-this._valueMin(),e=this._valueMin()+t*e,this._trimAlignValue(e)},t.prototype._trimAlignValue=function(t){if(t<=this._valueMin())return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=0<this.options.step?this.options.step:1,i=(t-this._valueMin())%e,t=t-i;return 2*Math.abs(i)>=e&&(t+=0<i?e:-e),parseFloat(t.toFixed(5))},t.prototype._calculateNewMax=function(){var t=this.options.max,e=this._valueMin(),i=this.options.step;(t=Math.round((t-e)/i)*i+e)>this.options.max&&(t-=i),this.max=parseFloat(t.toFixed(this._precision()))},t.prototype._precision=function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},t.prototype._precisionOf=function(t){var e=t.toString(),t=e.indexOf(".");return-1===t?0:e.length-t-1},t.prototype._change=function(t){this._mouseSliding||this._trigger("change",t,this._uiHash())},t.prototype.value=function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),void this._change(null,0)):this._value()},t.prototype._value=function(){var t=this.options.value;return t=this._trimAlignValue(t)},t.prototype._valueMin=function(){return this.options.min},t.prototype._valueMax=function(){return this.max},t.prototype._refreshValue=function(){var t=this.value(),e=this._valueMin(),i=this._valueMax(),e=i!==e?(t-e)/(i-e)*100:0;this.handle.css("left",e+"%")},t.prototype._uiHash=function(t){return{handle:this.handle[0],value:t!==e?t:this.value()}},t.prototype._start=function(t){return this._trigger("start",t,this._uiHash())},t.prototype._slide=function(t,e){e!==this.value()&&!1!==this._trigger("sliding",t,this._uiHash(e))&&this.value(e)},t.prototype._stop=function(t){this._trigger("stop",t,this._uiHash())},t}),N2D("UISortable",["UIMouse"],function(o,t){"use strict";function e(t,e){this.element=t,this.widgetName=this.widgetName||"UISortable",this.widgetEventPrefix="sortable",this.options=o.extend({items:"> *",handle:"",placeholder:!1,helper:"original",forcePlaceholderSize:!1,forceHelperSize:!1,axis:!1,droppables:!1},this.options,e),this.isOver=!1,N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this.create()}return((e.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=e).prototype.create=function(){this._mouseInit()},e.prototype._mouseCapture=function(t){if(this.options.disabled)return!1;var e=null,t=o(t.target);if(""!==this.options.handle){var i=this.element.find(this.options.items+" "+this.options.handle);if(-1===i.index(t)&&!i.has(t).length)return!1}i=this.element.find(this.options.items);return!!(e=-1!==i.index(t)?t:i.has(t)).length&&(this.currentItem=e,!0)},e.prototype._mouseStart=function(t){this._trigger("beforestart",t,{currentItem:this.currentItem}),this.context={e:t,original:{pageX:t.pageX,pageY:t.pageY,clientX:t.clientX,clientY:t.clientY,elementBCR:this.element[0].getBoundingClientRect(),currentItemBCR:this.currentItem[0].getBoundingClientRect()},offsetShift:{top:0,left:0},scrollCB:this._mouseScroll.bind(this)},this.element.addClass("n2-ui-sortable-in-progress"),this._cacheItems(),this.placeholder=o("<div></div>").addClass(this.options.placeholder||this.currentItem[0].className);var e={width:this.currentItem.width(),height:this.currentItem.height()};"clone"===this.options.helper?this.helper=this.currentItem.clone():"clone_hide"===this.options.helper?(this.helper=this.currentItem.clone(),this.currentItem.css("display","none")):this.helper=this.currentItem,this.options.forceHelperSize&&this.helper.css(e),this.options.forcePlaceholderSize&&this.placeholder.css(e),this.helper.addClass("n2-ui-sortable-helper").css({position:"absolute",zIndex:1e3}).appendTo(this.element),this._trigger("start",t,this.ui()),window.addEventListener("scroll",this.context.scrollCB,{capture:!0,passive:!0})},e.prototype._mouseDrag=function(t){this.context.e=t;var e,i=this.element[0].getBoundingClientRect(),s={};this.options.axis&&"x"!==this.options.axis||(e=i.left+this.context.original.clientX-t.clientX,this.context.offsetShift.left=t.pageX-this.context.original.pageX-this.context.original.elementBCR.left+e,s.left=this.context.original.currentItemBCR.left-e),this.options.axis&&"y"!==this.options.axis||(n=i.top+this.context.original.clientY-t.clientY,this.context.offsetShift.top=t.pageY-this.context.original.pageY-this.context.original.elementBCR.top+n,s.top=this.context.original.currentItemBCR.top-n),this.helper.css(s);var n=this._findClosestItem(t),s="before"===n[1]?this.items[Math.max(0,n[2]-1)]:this.items[Math.min(this.items.length-1,n[2])];"clone"===this.options.helper&&(n[0].is(this.currentItem)||o(s).is(this.currentItem))?this.placeholder.detach():this.positionPlaceholder(n),this.options.droppables&&("over"!==n[1]?this.isOver&&(this._trigger("out",t,this.ui()),this.isOver=!1):(this.isOver&&!this.isOver.is(n[0])&&(this._trigger("out",t,this.ui()),this.isOver=!1),this.isOver||(this.isOver=n[0],this._trigger("over",t,this.ui()))))},e.prototype.positionPlaceholder=function(t){switch(t[1]){case"before":this.placeholder.insertBefore(t[0]);break;case"after":this.placeholder.insertAfter(t[0]);break;case"over":this.placeholder.detach()}},e.prototype._mouseStop=function(t){this.context.e=t,this._trigger("beforestop",t,this.ui()),window.removeEventListener("scroll",this.context.scrollCB,{capture:!0,passive:!0}),this.placeholder.remove();var e=this._findClosestItem(t);switch(e[1]){case"before":this.currentItem.insertBefore(e[0]);break;case"after":this.currentItem.insertAfter(e[0])}this.helper.removeClass("n2-ui-sortable-helper").css({position:"",zIndex:"",left:"",top:""}),"clone"!==this.options.helper&&"clone_hide"!==this.options.helper||this.helper.remove(),"clone_hide"===this.options.helper&&this.currentItem.css("display",""),this.element.removeClass("n2-ui-sortable-in-progress"),"over"===e[1]?(this._trigger("drop",t,this.ui()),this._trigger("out",t,this.ui())):this._trigger("stop",t,this.ui()),this.currentItem=null},e.prototype._findClosestItem=function(t){for(var e,i,s,n=Number.MAX_VALUE,o=t.pageX-this.context.offsetShift.left,a=t.pageY-this.context.offsetShift.top,r=0;r<this.itemsData.length;r++){var l,d=this.itemsData[r];for(l in d.side){var h=Math.sqrt(Math.pow((o-d.side[l].left)/d.width,2)+Math.pow((a-d.side[l].top)/d.height,2));h<n&&(n=h,e=d.item,"after"===(i=l)?s=r+1:"before"===l&&(s=r))}}return[e,i,s]},e.prototype.getItems=function(){return this.element.find(this.options.items)},e.prototype._cacheItems=function(){this.items=this.getItems(),this.itemsData=[];for(var t,e,i,s,n=0;n<this.items.length;n++)"original"===this.options.helper&&this.items[n]===this.currentItem[0]||(s=this.items.eq(n).offset(),t=this.items.eq(n).width(),e=this.items.eq(n).height(),i={},this.options.droppables&&!this.currentItem.hasClass(this.options.droppables)&&this.items.eq(n).hasClass(this.options.droppables)?(i.before={left:s.left+t/6,top:s.top+e/6},i.over={left:s.left+3*t/6,top:s.top+3*e/6},i.after={left:s.left+5*t/6,top:s.top+5*e/6}):(i.before={left:s.left+t/4,top:s.top+e/4},i.after={left:s.left+3*t/4,top:s.top+3*e/4}),window.n2const.isRTL()&&(s=i.after,i.after=i.before,i.before=s),this.itemsData.push({item:this.items.eq(n),side:i,width:t,height:e}))},e.prototype._mouseScroll=function(){var t=this.context.e;document.dispatchEvent(new MouseEvent("mousemove",{clientX:t.clientX,clientY:t.clientY}))},e.prototype.ui=function(){return{placeholder:this.placeholder,helper:this.helper,item:this.currentItem,droppable:this.isOver}},e}),N2D("UIWidgetBase",function(a,t){"use strict";function e(t,e){t=t[0];this.document=a(t.style?t.ownerDocument:t.document||t),this.window=a(this.document[0].defaultView||this.document[0].parentWindow),this.disabled=!1,this.plugins=[]}return e.prototype.setOption=function(t,e){return this.options[t]=e,this},e.prototype.destroy=function(){return this},e.prototype._trigger=function(t,e,i){var s,n,o=this.options[t];if(i=i||{},(e=a.Event(e)).type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),e.target=this.element[0],n=e.originalEvent)for(s in n)s in e||(e[s]=n[s]);return this.element.trigger(e,i),!(a.isFunction(o)&&!1===o.apply(this.element[0],[e].concat(i))||e.isDefaultPrevented())},e.prototype._triggerInteraction=function(){this.element.trigger("interaction")},e.addPlugin=function(t,e,i){for(var s in i)t.plugins[s]=t.plugins[s]||[],t.plugins[s].push([e,i[s]])},e.prototype.callPlugin=function(t,e,i){var s=this.constructor.plugins[t];if(s&&(i||this.element[0].parentNode&&11!==this.element[0].parentNode.nodeType))for(var n=0;n<s.length;n++)this.options[s[n][0]]&&s[n][1].apply(this.element,e)},e}),N2D("NextendVisualCore",function(t,s){function e(t,e){this.id=t.id,this.visualManager=e,this.setValue(t.value,!1),this.visual=t,this.visualManager.visuals[this.id]=this}return e.prototype.compare=function(t){for(var e=Math.max(this.value.length,t.length),i=0;i<e;i++)if(!this._compareTab(this.value[i]===s?{}:this.value[i],t[i]===s?{}:t[i]))return!1;return!0},e.prototype._compareTab=function(t,e){var i=Object.getOwnPropertyNames(t),s=Object.getOwnPropertyNames(e);if(0===t.length&&0===s.length)return!0;if(i.length!=s.length)return!1;for(var n=0;n<i.length;n++){var o=i[n];if(t[o]!==e[o])return!1}return!0},e.prototype.setValue=function(t,e){var i,s=null,s="string"==typeof t?("{"!=(i=t)[0]?(this.base64=i,i=N2Classes.Base64.decode(i)):this.base64=N2Classes.Base64.encode(i),JSON.parse(i)):t;this.name=s.name,this.value=s.data,e&&this.render()},e.prototype.isSystem=function(){return 1==this.visual.system},e.prototype.isEditable=function(){return 1==this.visual.editable},e.prototype.activate=function(t,e){t&&t.preventDefault(),this.visualManager.changeActiveVisual(this),"function"==typeof e?this.visualManager.controller.asyncVisualData(this.value,this.visualManager.showParameters,e):this.visualManager.controller.load(this.value,!1,this.visualManager.showParameters)},e.prototype.active=function(){},e.prototype.notActive=function(){},e.prototype.delete=function(t){t&&t.preventDefault(),this._delete()},e.prototype._delete=function(){return N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.visualManager.parameters.ajaxUrl,{nextendaction:"deleteVisual"}),data:{visualId:this.id},dataType:"json"}).done(function(t){t.data.visual;this.visualManager.activeVisual&&this.id==this.visualManager.activeVisual.id&&this.visualManager.changeActiveVisual(null),delete this.visualManager.visuals[this.id],delete this.set.visuals[this.id],this.row.remove(),this.visualManager.$.trigger("visualDelete",[this.id]),N2Classes.Notification.success(n2_("Deleted."))}.bind(this))},e.prototype.render=function(){},e.prototype.isUsed=function(){return!1},e}),N2D("NextendFragmentEditorController",["NextendFragmentEditorControllerWithEditor"],function(n,i){function t(){N2Classes.NextendFragmentEditorControllerWithEditor.prototype.constructor.apply(this,arguments),this.clearTabButton=n("#n2-"+this.type+"-editor"+this.type+"-clear-tab").on("click",this.clearCurrentTab.bind(this)),this.$tabField=n("#n2-"+this.type+"-editor"+this.type+"-state").on("nextendChange.n2-editor",this.tabChanged.bind(this)),this.$tabContainer=n("#n2-"+this.type+"-editor"+this.type+"-state_tab")}return((t.prototype=Object.create(N2Classes.NextendFragmentEditorControllerWithEditor.prototype)).constructor=t).prototype.loadDefaults=function(){N2Classes.NextendFragmentEditorControllerWithEditor.prototype.loadDefaults.call(this),this.currentTabIndex=0,this._renderTimeout=!1,this._delayStart=0},t.prototype._load=function(t,e,i){this.currentVisual=[];for(var s=0;s<t.length;s++)this.currentVisual[s]=n.extend(!0,this.getCleanVisual(),t[s]);this.localModePreview={},this.mode=i.previewMode,!1===e&&(e=this.getTabs());for(s=this.currentVisual.length;s<e.length;s++)this.currentVisual[s]=this.getCleanVisual();if(!1!==i.previewHTML&&""!==i.previewHTML&&(this.localModePreview[i.previewMode]=i.previewHTML),this.setPreview(),!1===e){e=[];for(s=0;s<this.currentVisual.length;s++)e.push("#"+s)}this.setTabs(e)},t.prototype.getCleanVisual=function(){return{}},t.prototype.getTabs=function(){return[]},t.prototype.setTabs=function(t){for(var e=this.$tabField.data("field"),i={},s=0;s<t.length;s++)i[s]=t[s];e.setOptions(i,this.$tabContainer,"0"),e.insideChange("0")},t.prototype.tabChanged=function(){document.activeElement&&document.activeElement.blur();var t=this.$tabField.val();this.currentTabIndex=t,this.currentVisual[t]===i&&(this.currentVisual[t]={});var e=n.extend({},this.currentVisual[0]);"0"!==t?(n.extend(e,this.currentVisual[t]),this.clearTabButton.css("display","")):this.clearTabButton.css("display","none"),this.editor.load(e),this._tabChanged()},t.prototype._tabChanged=function(){this.renderCSS()},t.prototype.clearCurrentTab=function(t){t&&t.preventDefault(),this.currentVisual[this.currentTabIndex]={},this.tabChanged(),this.renderCSS()},t.prototype.setPreview=function(){},t.prototype.propertyChanged=function(t,e,i){this.isChanged=!0,this.currentVisual[this.currentTabIndex][e]=i,this.renderPreview()},t.prototype.renderPreview=function(){var t=n.now();this._renderTimeout?(clearTimeout(this._renderTimeout),100<t-this._delayStart&&(this.renderCSS(),this._delayStart=t)):this._delayStart=t,this._renderTimeout=setTimeout(this.renderCSS.bind(this),33)},t.prototype.renderCSS=function(){this._renderTimeout=!1},t}),N2D("NextendFragmentEditorControllerWithEditor",function(s,t){function e(){this.loadDefaults(),this.lightbox=s("#n2-lightbox-"+this.type),this.editor=this.initEditor(),this.editor.$.on("change",this.propertyChanged.bind(this))}return e.prototype.loadDefaults=function(){this.type="",this.isChanged=!1,this.visible=!1},e.prototype.pause=function(){},e.prototype.getEmptyVisual=function(){return[]},e.prototype.get=function(){return this.currentVisual},e.prototype.initEditor=function(){return new N2Classes.NextendFragmentEditor},e.prototype.propertyChanged=function(t,e,i){this.isChanged=!0,this.currentVisual[e]=i},e.prototype.load=function(t,e,i){this.isChanged=!1,this._load(t,e,i)},e.prototype._load=function(t,e,i){this.currentVisual=s.extend(!0,{},t),this.loadToEditor()},e.prototype.loadToEditor=function(){this.editor.load(this.currentVisual)},e.prototype.show=function(){this.visible=!0,N2Classes.WindowManager.addWindow("visual")},e.prototype.close=function(){this.visible=!1,N2Classes.WindowManager.removeWindow()},e}),N2D("CSSRenderer",function(p,n){function t(){}return t.prototype.decodeData=function(t){if("object"==typeof t)return t;if(""===t)return!1;"{"!==t[0]&&(t=N2Classes.Base64.decode(t));t=JSON.parse(t);return t.data!==n&&t.data},t.prototype.getCSS=function(t,e,i,s,n){n=p.extend({deleteRule:!1},n);var o,a="",r=new RegExp("@pre","g"),l=new RegExp("@selector","g");for(o in s.selectors){var d=o.replace(r,t).replace(l,e);a+=d+"{\n"+s.selectors[o]+"}\n",n.deleteRule&&nextend.css.deleteRule(d)}if(s.renderOptions.combined)for(var h=0;h<i.length;h++)a=a.replace(new RegExp("@tab"+h,"g"),this.render(i[h]));else for(h=0;h<i.length;h++)i[h]=p.extend({},i[h]),a=a.replace(new RegExp("@tab"+h,"g"),this.render(i[h]));return a},t.prototype.render=function(t){var e,i=this.makeVisualData(t),s="",t="";for(e in i.raw!==n&&(t=i.raw,delete i.raw),i)s+=this.deCase(e)+": "+i[e]+";\n";return s+=t},t.prototype.makeVisualData=function(t){var e,i={};for(e in t)t.hasOwnProperty(e)&&"function"!=typeof t[e]&&this["makeStyle"+e](t[e],i);return i},t.prototype.deCase=function(t){return t.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()})},t}),N2D("NextendFragmentEditor",function(t,e){function i(){this.fields={},this.$=t(this)}return i.prototype.load=function(t){this._off(),this._on()},i.prototype._on=function(){for(var t in this.fields)this.fields[t].element.on(this.fields[t].events)},i.prototype._off=function(){for(var t in this.fields)this.fields[t].element.off(".n2-editor")},i.prototype.trigger=function(t,e){this.$.trigger("change",[t,e])},i}),N2D("NextendVisualWithSet",["NextendVisualCore"],function(t,e){function i(t,e,i){this.set=e,N2Classes.NextendVisualCore.prototype.constructor.call(this,t,i)}return((i.prototype=Object.create(N2Classes.NextendVisualCore.prototype)).constructor=i).prototype.active=function(){var t=this.set.set.id;this.visualManager.changeSet(t),N2Classes.NextendVisualCore.prototype.active.call(this)},i}),N2D("NextendVisualWithSetRow",["NextendVisualWithSet"],function(t,e){function i(){N2Classes.NextendVisualWithSet.prototype.constructor.apply(this,arguments)}return((i.prototype=Object.create(N2Classes.NextendVisualWithSet.prototype)).constructor=i).prototype.createRow=function(){return this.row=t('<div class="n2_fullscreen_editor__visual"></div>').append(t('<div class="n2_fullscreen_editor__visual_label"></div>').text(this.name).on("click",this.activate.bind(this))),this.isSystem()||this.row.append(t('<div class="n2_fullscreen_editor__visual_actions"></div>').append(t('<div class="n2_fullscreen_editor__visual_action"><i class="ssi_16 ssi_16--delete"></i></div>').on("click",this.delete.bind(this)))),this.row},i.prototype.setValue=function(t,e){N2Classes.NextendVisualWithSet.prototype.setValue.call(this,t,e),this.row&&this.row.find(".n2_fullscreen_editor__visual_label").text(this.name)},i.prototype.active=function(){this.row.addClass("n2_fullscreen_editor__visual--active"),N2Classes.NextendVisualWithSet.prototype.active.call(this)},i.prototype.notActive=function(){this.row.removeClass("n2_fullscreen_editor__visual--active"),N2Classes.NextendVisualWithSet.prototype.notActive.call(this)},i}),N2D("NextendVisualWithSetRowMultipleSelection",["NextendVisualWithSetRow"],function(e,t){function i(t,e,i){this.checked=!1,t.system=1,t.editable=0,N2Classes.NextendVisualWithSetRow.prototype.constructor.apply(this,arguments)}return((i.prototype=Object.create(N2Classes.NextendVisualWithSetRow.prototype)).constructor=i).prototype.createRow=function(){var t=N2Classes.NextendVisualWithSetRow.prototype.createRow.call(this);return this.checkbox=e('<div class="n2_fullscreen_editor__visual_select_tick"><i class="ssi_16 ssi_16--check"></i></div>').on("click",this.checkOrUnCheck.bind(this)).prependTo(t),t},i.prototype.setValue=function(t,e){this.name=t.name,this.value=t.data,this.row&&this.row.find(".n2_fullscreen_editor__visual_label").text(this.name),e&&this.render()},i.prototype.activate=function(t,e){t&&t.preventDefault(),this.visualManager.changeActiveVisual(this),this.visualManager.controller.setAnimationProperties(this.value)},i.prototype.checkOrUnCheck=function(t){t.preventDefault(),t.stopPropagation(),this.checked?this.unCheck():this.check()},i.prototype.check=function(){this.checked=!0,this.row.addClass("n2_fullscreen_editor__visual--selected"),this.activate()},i.prototype.unCheck=function(){this.checked=!1,this.row.removeClass("n2_fullscreen_editor__visual--selected"),this.activate()},i}),N2D("NextendVisualSetsManager",function(e,t){return function(t){this.visualManager=t,this.$=e(this)}}),N2D("NextendVisualSet",function(i,s){function t(t,e){this.set=t,this.visualManager=e,this.visualList=i('<div class="n2_fullscreen_editor__visual_list"></div>'),this.visualManager.sets[t.id]=this,""!==t.referencekey&&(this.visualManager.setsByReference[t.referencekey]=t),this.visualManager.setsSelector&&(this.option=i('<option value="'+t.id+'"></option>').text(t.value).appendTo(this.visualManager.setsSelector))}return t.prototype.active=function(){i.when(this._loadVisuals()).done(function(){this.visualList.appendTo(this.visualManager.visualListContainer)}.bind(this))},t.prototype.notActive=function(){this.visualList.detach()},t.prototype.loadVisuals=function(t){if(this.visuals===s){this.visuals={};for(var e=0;e<t.length;e++)this.addVisual(t[e])}},t.prototype._loadVisuals=function(){return null!=this.visuals||N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.visualManager.parameters.ajaxUrl,{nextendaction:"loadVisualsForSet"}),data:{setId:this.set.id},dataType:"json"}).done(function(t){this.loadVisuals(t.data.visuals)}.bind(this))},t.prototype.addVisual=function(t){return this.visuals[t.id]===s&&(this.visuals[t.id]=this.visualManager.createVisual(t,this),this.visualList.append(this.visuals[t.id].createRow())),this.visuals[t.id]},t.prototype.rename=function(t){this.set.value=t,this.option.text(t)},t.prototype.delete=function(){this.option.remove(),delete this.visualManager.sets[this.set.id]},t}),N2D("NextendVisualManagerCore",function(s,n){function t(t){this.loadDefaults(),this.$=s(this),(window.nextend[this.type+"Manager"]=this).lightbox=s("#n2-lightbox-"+this.type),this.lightbox.find(".n2_fullscreen_editor__overlay").on("click",this.hide.bind(this)),this.visualListContainer=s('<div class="n2_fullscreen_editor__visual_list_container"></div>').appendTo(this.lightbox.find(".n2_fullscreen_editor__content_sidebar")),this.parameters=t,this.visuals={},this.controller=this.initController(),this.controller&&(this.renderer=this.controller.renderer),this.firstLoadVisuals(t.visuals),this.lightbox.find(".n2_fullscreen_editor__save_as_new").on("click",this.saveAsNew.bind(this)),this.cancelButton=this.lightbox.find(".n2_fullscreen_editor__cancel").on("click",this.hide.bind(this)),this.saveButton=this.lightbox.find(".n2_fullscreen_editor__save"),this.setVisual!==n&&this.saveButton.on("click",this.setVisual.bind(this))}return t.prototype.loadDefaults=function(){this.mode="linked",this.labels={visual:"visual",visuals:"visuals"},this.visualLoadDeferreds={},this.showParameters=!1},t.prototype.firstLoadVisuals=function(t){for(var e in t)this.sets[e].loadVisuals(t[e])},t.prototype.initController=function(){},t.prototype.getVisual=function(t){if(0<parseInt(t)){if(this.visuals[t]!==n)return this.visuals[t];if(this.visualLoadDeferreds[t]!==n)return this.visualLoadDeferreds[t];var e=s.Deferred();return this.visualLoadDeferreds[t]=e,this._loadVisualFromServer(t).done(function(){e.resolve(this.visuals[t]),delete this.visualLoadDeferreds[t]}.bind(this)).fail(function(){e.resolve({id:-1,name:n2_("Empty")}),delete this.visualLoadDeferreds[t]}.bind(this)),e}try{var i=t;return"{"!=i[0]&&(i=N2Classes.Base64.decode(i)),JSON.parse(i),{id:0,name:n2_("Static")}}catch(t){return{id:-1,name:n2_("Empty")}}},t.prototype._loadVisualFromServer=function(t){return N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.parameters.ajaxUrl,{nextendaction:"loadVisual"}),data:{visualId:t},dataType:"json"})},t.prototype.show=function(t,e,i){N2Classes.Esc.add(function(){return this.hide(),!0}.bind(this)),this.showParameters=s.extend({previewMode:!1,previewHTML:!1},i),s("body").addClass("n2_body--fullscreen-editor-visible"),this.lightbox.addClass("n2_fullscreen_editor--visible"),this.loadDataToController(t),this.$.on("save",e),this._show()},t.prototype._show=function(){s(":focus").blur(),this.controller.show(),s(window).on({"keydown.visual":function(t){"TEXTAREA"===t.target.tagName||"INPUT"===t.target.tagName||t.target.isContentEditable||13===t.keyCode&&this.saveButton.trigger("click")}.bind(this)})},t.prototype.setAndClose=function(t){this.$.trigger("save",[t])},t.prototype.hide=function(t){this.controller.pause(),t!==n&&(t.preventDefault(),N2Classes.Esc.pop()),this.controller.close(),this.$.off("save"),s("body").removeClass("n2_body--fullscreen-editor-visible"),this.lightbox.removeClass("n2_fullscreen_editor--visible"),s(window).off("keydown.visual")},t.prototype.getDataFromController=function(t,e,i){return this.showParameters=s.extend({previewMode:!1,previewHTML:!1},e),this.loadDataToController(t,i)},t.prototype.loadDataToController=function(e){this.isVisualData(e)?s.when(this.getVisual(e)).done(function(t){0<t.id?t.activate():console.error(e+" visual is not found linked")}.bind(this)):console.error(e+" visual not found")},t.prototype.isVisualData=function(t){return 0<parseInt(t)},t.prototype.saveAsNew=function(t){t.preventDefault();var i=new N2Classes.ModalSimple("section-save-as",{destroyOnHide:!1,width:440});i.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--plus","green")),i.addContent(N2Classes.UI.modalHeading(n2_("Save as")));t=N2Classes.UI.modalFormRow(!0);i.addContent(t);var s=N2Classes.UI.modalFieldText(t,"name",n2_("Name"),""),t=N2Classes.UI.modalButton(n2_("Save as New"),"green");i.addButton(t),t.on("click",function(t){t.preventDefault();var e=s.val();""===e?N2Classes.Notification.error(n2_("Please fill the name field!")):this._saveAsNew(e).done(i.hide.bind(i,t),N2Classes.Notification.success(n2_("Saved.")))}.bind(this)),i.show()},t.prototype._saveAsNew=function(t){return N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.parameters.ajaxUrl,{nextendaction:"addVisual"}),data:{setId:this.getSetValue(),value:N2Classes.Base64.encode(JSON.stringify({name:t,data:this.controller.get("saveAsNew")}))},dataType:"json"}).done(function(t){t=t.data.visual;this.changeActiveVisual(this.sets[t.referencekey].addVisual(t))}.bind(this))},t.prototype.saveActiveVisual=function(t){return N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.parameters.ajaxUrl,{nextendaction:"changeVisual"}),data:{visualId:this.activeVisual.id,value:this.getBase64(t)},dataType:"json"}).done(function(t){this.activeVisual.setValue(t.data.visual.value,!0)}.bind(this))},t.prototype.changeActiveVisual=function(t){this.activeVisual&&(this.activeVisual.notActive(),this.activeVisual=!1),t&&("static"==this.mode&&this.setMode("linked"),t.active(),this.activeVisual=t)},t.prototype.getBase64=function(t){return N2Classes.Base64.encode(JSON.stringify({name:t,data:this.controller.get("set")}))},t}),N2D("NextendVisualManagerMultipleSelection",["NextendVisualManagerVisibleSets"],function(a,t){function e(t){(window.nextend[this.type+"Manager"]=this)._lateInit=function(t){N2Classes.NextendVisualManagerVisibleSets.prototype.constructor.call(this,t)}.bind(this,t)}return((e.prototype=Object.create(N2Classes.NextendVisualManagerVisibleSets.prototype)).constructor=e).prototype.lateInit=function(){this.inited||(this.inited=!0,this._lateInit())},e.prototype.show=function(t,e,i){this.lateInit(),N2Classes.Esc.add(function(){return this.hide(),!0}.bind(this)),a("body").addClass("n2_body--fullscreen-editor-visible"),this.lightbox.addClass("n2_fullscreen_editor--visible");var s=0;if(""!=t)for(var n=t.split("||"),o=!1;s<n.length;s++)a.when(this.getVisual(n[s])).done(function(t){t&&t.check&&(t.check(),o||(o=!0,t.activate()))});this.$.on("save",e),this.controller.start(i),0==s&&a.when(this.activeSet._loadVisuals()).done(function(){for(var t in this.activeSet.visuals){this.activeSet.visuals[t].activate();break}}.bind(this)),this._show()},e.prototype.setVisual=function(t){t.preventDefault(),this.setAndClose(this.getAsString()),this.hide(t)},e.prototype.getAsString=function(){var t,e=[];for(t in this.sets){var i,s=this.sets[t];for(i in s.visuals)s.visuals[i].checked&&e.push(s.visuals[i].id)}return 0==e.length&&this.activeVisual&&e.push(this.activeVisual.id),e.join("||")},e.prototype.hide=function(t){for(var e in N2Classes.NextendVisualManagerVisibleSets.prototype.hide.apply(this,arguments),this.sets){var i,s=this.sets[e];for(i in s.visuals)s.visuals[i].unCheck()}},e}),N2D("NextendVisualManagerSetsAndMore",["NextendVisualManagerVisibleSets"],function(s,n){function t(){N2Classes.NextendVisualManagerVisibleSets.prototype.constructor.apply(this,arguments),this.setMode(0)}return((t.prototype=Object.create(N2Classes.NextendVisualManagerVisibleSets.prototype)).constructor=t).prototype.setMode=function(t){if("static"==t&&this.changeActiveVisual(null),this.mode!=t){switch(t){case 0:this.cancelButton.css("display","none"),this.saveButton.off("click");break;case"static":default:this.cancelButton.css("display","inline-block"),this.saveButton.off("click").on("click",this.setVisualAsStatic.bind(this))}this.mode=t}},t.prototype.loadDataToController=function(t,e){if(0<parseInt(t))s.when(this.getVisual(t)).done(function(t){0<t.id?(this.setMode("linked"),t.activate(n,e)):(this.setMode("static"),"function"==typeof e?this.controller.asyncVisualData("",this.showParameters,e):this.controller.load("",!1,this.showParameters))}.bind(this));else{var i="";this.setMode("static");try{i=this.getStaticData(t)}catch(t){}"function"==typeof e?this.controller.asyncVisualData(i,this.showParameters,e):this.controller.load(i,!1,this.showParameters)}},t.prototype.getStaticData=function(t){"{"!==t[0]&&(t=N2Classes.Base64.decode(t));t=JSON.parse(t).data;return t===n?"":t},t.prototype.setVisualAsStatic=function(t){t.preventDefault(),this.setAndClose(this.getBase64(n2_("Static"))),this.hide(t)},t}),N2D("NextendVisualManagerVisibleSets",["NextendVisualManagerCore"],function(s,e){function t(){N2Classes.NextendVisualManagerCore.prototype.constructor.apply(this,arguments)}return((t.prototype=Object.create(N2Classes.NextendVisualManagerCore.prototype)).constructor=t).prototype.firstLoadVisuals=function(t){this.sets={},this.setsByReference={},this.setsSelector=s("#"+this.parameters.setsIdentifier+"sets_select");for(var e,i=0;i<this.parameters.sets.length;i++)this.newVisualSet(this.parameters.sets[i]);for(e in this.initSetsManager(),t)this.sets[e].loadVisuals(t[e]);this.activeSet=this.sets[this.getSetValue()],this.activeSet.active(),this.setsSelector.length&&this.setsSelector.on("change",function(){this.activeSet.notActive(),this.activeSet=this.sets[this.getSetValue()],this.activeSet.active()}.bind(this))},t.prototype.initSetsManager=function(){new N2Classes.NextendVisualSetsManager(this)},t.prototype._loadVisualFromServer=function(t){return N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.parameters.ajaxUrl,{nextendaction:"loadSetByVisualId"}),data:{visualId:t},dataType:"json"}).done(function(t){this.sets[t.data.set.setId].loadVisuals(t.data.set.visuals)}.bind(this))},t.prototype.changeSet=function(t){this.getSetValue()!=t&&this.setsSelector.val(t).trigger("change")},t.prototype.changeSetById=function(t){this.sets[t]!==e&&this.changeSet(t)},t.prototype.newVisualSet=function(t){return new N2Classes.NextendVisualSet(t,this)},t.prototype.getSetValue=function(){return this.setsSelector.length?this.setsSelector.val():this.parameters.fixedSet},t}),N2D("NextendBrowse",function(n,t){var s={};function o(t,e){var i=n('<div class="n2_modal_filesystem_box n2_modal_filesystem_box--file" title="'+t+'"><div class="n2-button n2-button-icon n2-button-s n2-button-blue"><i class="ssi_16 ssi_16--check"></i></div><div class="n2_modal_filesystem_box__label">'+t+"</div></div>"),t=t.split(".").pop();return("mp4"!==t&&"mp3"!==t?n('<div class="n2_modal_filesystem_box__image"></div>').css("background-image","url("+encodeURI(nextend.imageHelper.fixed(e))+")"):n('<div class="n2_modal_filesystem_box__icon"><i class="ssi_64 ssi_64--dummy"></i></div>')).prependTo(i),i}function e(t,e){this.url=t,this.uploadAllowed=parseInt(e),this.currentPath=localStorage.getItem("browsePath")||"";var i=null;this.node=n('<div class="n2_modal_filesystem__content"></div>').on("dragover",function(t){null!==i?(clearTimeout(i),i=null):n(t.currentTarget).addClass("n2-drag-over"),i=setTimeout(function(){n(t.currentTarget).removeClass("n2-drag-over"),i=null},400)}),nextend.browse=this}return e.prototype.clear=function(){this.uiFileUpload&&this.uiFileUpload.destroy(),this.node.empty()},e.prototype.getNode=function(t,e){return this.clear(),this.node.attr("data-mode",t),"multiple"===(this.mode=t)&&(this.selected=[]),this.callback=e,this._loadPath(this.getCurrentFolder(),this._renderBoxes.bind(this)),this.node},e.prototype._renderBoxes=function(t){for(var e in this.clear(),localStorage.setItem("browsePath",this.getCurrentFolder()),n('<div class="n2_modal_filesystem__current_path">'+n2_("Current path")+": "+t.fullPath+"</div>").appendTo(this.node),this.uploadAllowed&&this.initUpload(),""!==t.path&&n('<div class="n2_modal_filesystem_box n2_modal_filesystem_box--directory-up"><div class="n2_modal_filesystem_box__icon"><i class="ssi_64 ssi_64--folderup"></i></div><div class="n2_modal_filesystem_box__label">'+n2_("Parent directory")+"</div></div>").appendTo(this.node).on("click",function(t){this._loadPath(t,this._renderBoxes.bind(this))}.bind(this,t.path+"/..")),t.directories)t.directories.hasOwnProperty(e)&&n('<div class="n2_modal_filesystem_box n2_modal_filesystem_box--directory"><div class="n2_modal_filesystem_box__icon"><i class="ssi_64 ssi_64--folder"></i></div><div class="n2_modal_filesystem_box__label">'+e+"</div></div>").appendTo(this.node).on("click",function(t){this._loadPath(t,this._renderBoxes.bind(this))}.bind(this,t.directories[e]));var i,s;for(i in t.files)t.files.hasOwnProperty(i)&&(s=o(i,t.files[i]).appendTo(this.node).on("click",this.clickImage.bind(this,t.files[i])),"multiple"===this.mode&&-1!==this.selected.indexOf(t.files[i])&&s.addClass("n2_modal_filesystem_box--active"))},e.prototype._loadPath=function(e,i){s[e]===t&&(s[e]=N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.url),data:{path:e},dataType:"json"})),n.when(s[e]).done(function(t){this.currentPath=t.data.path,s[t.data.path]=t,s[e]=t,i(t.data)}.bind(this))},e.prototype.initUpload=function(){n('<div class="n2_modal_filesystem_box n2_modal_filesystem_box--upload"><input id="n2-browse-upload" type="file" name="image" multiple></div>').append('<div class="n2_modal_filesystem_box__icon"><i class="ssi_48 ssi_48--drop"></i></div>').append('<div class="n2_modal_filesystem_box__label">'+n2_("Drop files here or")+' <a href="#">'+n2_("Upload")+"</a></div>").appendTo(this.node),this.uiFileUpload=new N2Classes.UIFileUpload(this.node.find("#n2-browse-upload"),{url:N2Classes.AjaxHelper.makeAjaxUrl(this.url,{nextendaction:"upload"}),sequentialUploads:!0,dropZone:this.node,pasteZone:!1,dataType:"json",paramName:"image",add:function(t,e){e.box=n('<div class="n2_modal_filesystem_box n2_modal_filesystem_box--file"><div class="n2_modal_filesystem_box__label">0%</div></div>').appendTo(this.node),e.formData={path:this.currentPath},e.submit()}.bind(this),progress:function(t,e){var i=parseInt(e.loaded/e.total*100,10);e.box.find(".n2_modal_filesystem_box__label").text(i+"%")},done:function(t,e){e.box.remove();var i=e.result;i.data&&i.data.name&&(s[i.data.path].data.files[i.data.name]=i.data.url,o(i.data.name,i.data.url).appendTo(this.node).on("click",this.clickImage.bind(this,i.data.url)),"multiple"===this.mode&&(this.selected.push(i.data.url),e.box.addClass("n2_modal_filesystem_box--active"))),N2Classes.AjaxHelper.notification(i)}.bind(this),fail:function(t,e){e.box.remove(),N2Classes.AjaxHelper.notification(e.jqXHR.responseJSON)}.bind(this)})},e.prototype.clickImage=function(t,e){var i;"single"===this.mode?this.callback(t):"multiple"===this.mode&&(-1===(i=this.selected.indexOf(t))?(n(e.currentTarget).addClass("n2_modal_filesystem_box--active"),this.selected.push(t)):(n(e.currentTarget).removeClass("n2_modal_filesystem_box--active"),this.selected.splice(i,1)))},e.prototype.getSelected=function(){return this.selected},e.prototype.getCurrentFolder=function(){return this.currentPath},e}),N2D("IconPack",function(i,e){function t(t,e){this.currentQuery="",this.manager=t,this.data=e,this.$li=i('<div class="n2_modal_icons__list_item">'+e.label+"</div>").on("click",function(t){t.preventDefault(),this.activate()}.bind(this)).appendTo(this.manager.$list)}return t.prototype.load=function(){this.data.isLoaded===e&&(i("head").append("<link rel='stylesheet' href='"+this.data.css+"' type='text/css' media='screen'>"),this.data.isLoaded=!0)},t.prototype.render=function(){if(this.table===e){for(var t in this.table=N2Classes.UI.modalFormTable(this.data.label),this.data.data)i('<div class="n2_modal_icons__icon" data-identifier="'+this.data.id+":"+t+'" data-kw="'+this.data.data[t].kw.toLowerCase()+'">'+this._render(t)+"</div>").on("click",function(t){this.manager.selectIcon(i(t.currentTarget).data("identifier"),t)}.bind(this)).appendTo(this.table.$content);this.$icons=this.table.$content.find(".n2_modal_icons__icon")}},t.prototype.activate=function(){this.manager.activate(this),this.$li.addClass("n2_modal_icons__list_item--active"),this.load(),this.render(),this.search(this.manager.getQuery()),console.log(this.table.$table),this.manager.$content.append(this.table.$table)},t.prototype.search=function(t){var e;this.currentQuery!==t&&(t.length<=1?this.$icons.css("display",""):(e=this.$icons.filter("[data-kw*='"+t+"']"),this.$icons.not(e).css("display","none"),e.css("display",""))),this.currentQuery=t},t.prototype.deActivate=function(){this.$li.removeClass("n2_modal_icons__list_item--active"),this.table.$table.detach()},t.prototype._render=function(t){return this.data.isLigature?'<i class="n2i '+this.data.class+'">'+t+"</i>":'<i class="n2i '+this.data.class+" "+this.data.prefix+t+'"></i>'},t.prototype.getIcon=function(t){return this.data.isLigature?{class:this.data.class,ligature:t}:{class:this.data.class+" "+this.data.prefix+t,ligature:""}},t}),N2D("Icons",function(i,s){function t(t){for(var e in(N2Classes.Icons=this).data=t,this.$list=i('<div class="n2_modal_icons__list"></div>'),this.iconPacks={},this.data)this.iconPacks[this.data[e].id]=new N2Classes.IconPack(this,this.data[e]);this.defaultId=Object.keys(this.iconPacks)[0]}return t.prototype.render=function(t){var e=t.split(":");if(2!==e.length)return!1;t=e[0],e=e[1];if(this.iconPacks[t]===s)return!1;t=this.iconPacks[t];return t.data.data[e]!==s&&(t.load(),t.getIcon(e))},t.prototype.showModal=function(t,e){this.callback=t;var i=!1;this.modal===s&&(i=!0,this.startModal());t=!1,e=e.split(":");this.iconPacks[e[0]]!==s&&(this.iconPacks[e[0]].activate(),t=!0),i&&!t&&this.iconPacks[this.defaultId].activate(),this.modal.show()},t.prototype.selectIcon=function(t,e){this.callback(t),this.modal.hide(e)},t.prototype.startModal=function(){this.modal=new N2Classes.ModalLightbox(n2_("Icons"),"icons");var t=i('<div class="n2_modal__sidebar n2_form--dark"></div>');this.modal.addContent(t),this.$sidebar=i('<div class="n2_modal__sidebar_inner"></div>').appendTo(t);t=i('<div class="n2_modal_icons__search_area" />').appendTo(this.$sidebar);this.$searchField=N2Classes.UI.modalFieldText(t,"search-icon",!1,"").attr("placeholder",n2_("Search")).on("keyup",function(t){this.activePack.search(this.$searchField.val())}.bind(this)),this.$list.appendTo(this.$sidebar);t=i('<div class="n2_modal__content"></div>');this.$content=i('<div class="n2_modal__content_inner"></div>').appendTo(t),this.modal.addContent(t)},t.prototype.activate=function(t){this.activePack!==s&&this.activePack.deActivate(),this.activePack=t},t.prototype.getQuery=function(){return this.$searchField.val()},t}),N2D("NextendFontServiceGoogle",function(n,s){function t(t,e,i,s){this.style=t,this.subset=e,this.fonts=i,this.loadedFamilies=s,n(window).on("n2Family",this.loadFamily.bind(this))}return t.prototype.loadFamily=function(t,e){var i=e.toLowerCase();return this.fonts[i]!==s&&-1===this.loadedFamilies.indexOf(this.fonts[i])?(n("<link />").attr({rel:"stylesheet",type:"text/css",href:"//fonts.googleapis.com/css?family="+encodeURIComponent(this.fonts[i]+":"+this.style)+"&subset="+encodeURIComponent(this.subset)}).appendTo(n("head")),this.loadedFamilies.push(this.fonts[i]),this.fonts[i]):e},t}),N2D("NextendFontEditor",["NextendFragmentEditor"],function(t,e){function i(){N2Classes.NextendFragmentEditor.prototype.constructor.apply(this,arguments),this.fields={family:{element:t("#n2-font-editorfamily"),events:{"nextendChange.n2-editor":this.changeFamily.bind(this)}},color:{element:t("#n2-font-editorcolor"),events:{"outsideChange.n2-editor":this.changeColor.bind(this)}},size:{element:t("#n2-font-editorsize"),events:{"outsideChange.n2-editor":this.changeSize.bind(this)}},lineHeight:{element:t("#n2-font-editorlineheight"),events:{"outsideChange.n2-editor":this.changeLineHeight.bind(this)}},weight:{element:t("#n2-font-editorweight"),events:{"outsideChange.n2-editor":this.changeWeight.bind(this)}},decoration:{element:t("#n2-font-editordecoration"),events:{"outsideChange.n2-editor":this.changeDecoration.bind(this)}},align:{element:t("#n2-font-editortextalign"),events:{"outsideChange.n2-editor":this.changeAlign.bind(this)}},shadow:{element:t("#n2-font-editortshadow"),events:{"outsideChange.n2-editor":this.changeShadow.bind(this)}},letterSpacing:{element:t("#n2-font-editorletterspacing"),events:{"outsideChange.n2-editor":this.changeLetterSpacing.bind(this)}},wordSpacing:{element:t("#n2-font-editorwordspacing"),events:{"outsideChange.n2-editor":this.changeWordSpacing.bind(this)}},textTransform:{element:t("#n2-font-editortexttransform"),events:{"outsideChange.n2-editor":this.changeTextTransform.bind(this)}},css:{element:t("#n2-font-editorextracss"),events:{"outsideChange.n2-editor":this.changeCSS.bind(this)}}}}return((i.prototype=Object.create(N2Classes.NextendFragmentEditor.prototype)).constructor=i).prototype.load=function(t){this._off();var e=t.afont.split("||");this.fields.family.element.data("field").insideChange(e[0]),this.fields.color.element.data("field").insideChange(t.color),this.fields.size.element.data("field").insideChange(t.size.split("||").join("|*|")),this.fields.lineHeight.element.data("field").insideChange(t.lineheight),this.fields.weight.element.data("field").insideChange(t.weight),this.fields.decoration.element.data("field").insideChange([1==t.italic?"italic":"",1==t.underline?"underline":""].join("||")),this.fields.align.element.data("field").insideChange(t.align),this.fields.shadow.element.data("field").insideChange(t.tshadow.replace(/\|\|px/g,"")),this.fields.letterSpacing.element.data("field").insideChange(t.letterspacing),this.fields.wordSpacing.element.data("field").insideChange(t.wordspacing),this.fields.textTransform.element.data("field").insideChange(t.texttransform),this.fields.css.element.data("field").insideChange(t.extra),this._on()},i.prototype.changeFamily=function(){this.trigger("afont",this.fields.family.element.val())},i.prototype.changeColor=function(){this.trigger("color",this.fields.color.element.val())},i.prototype.changeSize=function(){this.trigger("size",this.fields.size.element.val().replace("|*|","||"))},i.prototype.changeLineHeight=function(){this.trigger("lineheight",this.fields.lineHeight.element.val())},i.prototype.changeWeight=function(){this.trigger("weight",this.fields.weight.element.val())},i.prototype.changeDecoration=function(){var t=this.fields.decoration.element.val(),e=0;-1!=t.indexOf("italic")&&(e=1),this.trigger("italic",e);e=0;-1!=t.indexOf("underline")&&(e=1),this.trigger("underline",e)},i.prototype.changeAlign=function(){this.trigger("align",this.fields.align.element.val())},i.prototype.changeShadow=function(){this.trigger("tshadow",this.fields.shadow.element.val())},i.prototype.changeLetterSpacing=function(){this.trigger("letterspacing",this.fields.letterSpacing.element.val())},i.prototype.changeWordSpacing=function(){this.trigger("wordspacing",this.fields.wordSpacing.element.val())},i.prototype.changeTextTransform=function(){this.trigger("texttransform",this.fields.textTransform.element.val())},i.prototype.changeCSS=function(){this.trigger("extra",this.fields.css.element.val())},i}),N2D("NextendFontEditorController",["NextendFragmentEditorController"],function($,undefined){function NextendFontEditorController(){this.css=[],N2Classes.NextendFragmentEditorController.prototype.constructor.apply(this,arguments),this.preview=$('<div class="n2_form__table_preview"></div>').css("fontSize",N2Classes.CSSRendererFont.fontSize+"px").appendTo('.n2_form__table[data-field="table-font-preview"]'),this.initBackgroundColor()}return NextendFontEditorController.prototype=Object.create(N2Classes.NextendFragmentEditorController.prototype),NextendFontEditorController.prototype.constructor=NextendFontEditorController,NextendFontEditorController.prototype.loadDefaults=function(){N2Classes.NextendFragmentEditorController.prototype.loadDefaults.call(this),this.type="font",this.preview=null},NextendFontEditorController.prototype.initEditor=function(){return new N2Classes.NextendFontEditor},NextendFontEditorController.prototype.getCleanVisual=function(){return N2Classes.CSSRendererFont.getEmpty()},NextendFontEditorController.prototype.initBackgroundColor=function(){this.$background=$("#n2-font-editorpreview-background").on("nextendChange",function(){this.preview.css("background","#"+this.$background.val())}.bind(this)),this.preview.css("background","#"+this.$background.val())},NextendFontEditorController.prototype.getTabs=function(){return N2Classes.CSSRendererFont.rendererModes[this.mode].tabs},NextendFontEditorController.prototype.renderCSS=function(){this._renderTimeout=!1,this.clearCSS();var t=N2Classes.CSSRendererFont.addCSS("",this.getPreviewCssClass(),this.currentVisual,N2Classes.CSSRendererFont.rendererModes[this.mode]);this.css.push(t)},NextendFontEditorController.prototype.setPreview=function(){var fontClassName=this.getPreviewCssClass(),styleClassName=nextend.fontManager.styleClassName,styleClassName2=nextend.fontManager.styleClassName2,data={fontClassName:fontClassName,styleClassName:styleClassName,styleClassName2:styleClassName2},html="";this.localModePreview[this.mode]!==undefined?(this.preview.html(""),this.preview.append(N2Classes[this.localModePreview[this.mode]].renderFont(nextend.fontManager.fieldID,data))):(html=N2Classes.CSSRendererFont.rendererModes[this.mode].preview,html=html.replace(/\{([^]*?)\}/g,function(match,script){return eval(script)}),this.preview.html(html))},NextendFontEditorController.prototype.getPreviewCssClass=function(){return"n2-"+this.type+"-editor-preview"},NextendFontEditorController.prototype.pause=function(){this.clearCSS()},NextendFontEditorController.prototype.clearCSS=function(){for(var t=0;t<this.css.length;t++)this.css[t].destroy();this.css=[]},NextendFontEditorController}),N2D("NextendFontManager",function(s,i){function t(){this.$=s(this),this.showParameters=!1,this.type="font",this.css=[],this.styleClassName="",this.styleClassName2="",(window.nextend.fontManager=this).lightbox=s("#n2-lightbox-"+this.type),this.lightbox.find(".n2_fullscreen_editor__overlay").on("click",this.hide.bind(this)),this.controller=this.initController(),this.lightbox.find(".n2_fullscreen_editor__cancel").on("click",this.hide.bind(this)),this.saveButton=this.lightbox.find(".n2_fullscreen_editor__save").on("click",this.setVisualAsStatic.bind(this))}return t.prototype.initController=function(){return new N2Classes.NextendFontEditorController},t.prototype.setFieldID=function(t){this.fieldID=t},t.prototype.setConnectedStyle=function(t){t=s("#"+t).data("field").renderStyle();this.css.push(t),this.styleClassName=t.getBaseClassName()},t.prototype.setConnectedStyle2=function(t){t=s("#"+t).data("field").renderStyle();this.css.push(t),this.styleClassName2=t.getBaseClassName()},t.prototype.setAndClose=function(t){this.$.trigger("save",[t])},t.prototype.setVisualAsStatic=function(t){t.preventDefault(),this.setAndClose(JSON.stringify({data:this.controller.get("set")})),this.hide(t)},t.prototype.hide=function(t){this.controller.pause();for(var e=0;e<this.css.length;e++)this.css[e].destroy();this.css=[],t!==i&&(t.preventDefault(),N2Classes.Esc.pop()),this.controller.close(),this.$.off("save"),s("body").removeClass("n2_body--fullscreen-editor-visible"),this.lightbox.removeClass("n2_fullscreen_editor--visible"),s(window).off("keydown.visual")},t.prototype.loadDataToController=function(t){this.controller.load(N2Classes.CSSRendererFont.parseRawData(t),!1,this.showParameters)},t.prototype.show=function(t,e,i){N2Classes.Esc.add(function(){return this.hide(),!0}.bind(this)),this.showParameters=s.extend({previewMode:!1,previewHTML:!1},i),s("body").addClass("n2_body--fullscreen-editor-visible"),this.lightbox.addClass("n2_fullscreen_editor--visible"),this.loadDataToController(t),this.controller.show(),this.$.on("save",e),this._show()},t.prototype._show=function(){s(":focus").blur(),s(window).on({"keydown.visual":function(t){"TEXTAREA"===t.target.tagName||"INPUT"===t.target.tagName||t.target.isContentEditable||13===t.keyCode&&this.saveButton.trigger("click")}.bind(this)})},t}),N2D("CSSRendererFont",["CSSRenderer"],function(l,d){function t(){}((t.prototype=Object.create(N2Classes.CSSRenderer.prototype)).constructor=t).prototype.getCSS=function(t,e,i,s,n){if(!1===(i=this.decodeData(i)))return"";if((i=l.extend([],i))[0]=l.extend(N2Classes.CSSRendererFont.getDefault(),i[0]),s.renderOptions.combined)for(var o,a,r=1;r<i.length;r++)i[r]=l.extend({},i[r-1],i[r]),i[r].size===i[0].size?i[r].size="100||%":(o=i[0].size.split("||"),a=i[r].size.split("||"),2===o.length&&2===a.length&&"px"===o[1]&&"px"===a[1]&&(i[r].size=Math.round(a[0]/o[0]*100)+"||%"));return t===d&&(t=N2Classes.CSSRendererFont.pre),N2Classes.CSSRenderer.prototype.getCSS.call(this,t,e,i,s,n)},t.prototype.makeStylecolor=function(t,e){e.color="#"+t.substr(0,6)+";\ncolor: "+N2Color.hex2rgbaCSS(t)},t.prototype.makeStylesize=function(t,e){var i=t.split("||");"px"===i[1]?e.fontSize=i[0]/N2Classes.CSSRendererFont.fontSize*100+"%":e.fontSize=t.replace("||","")},t.prototype.makeStyletshadow=function(t,e){t=t.split("|*|");"0"==t[0]&&"0"==t[1]&&"0"==t[2]?e.textShadow="none":e.textShadow=t[0]+"px "+t[1]+"px "+t[2]+"px "+N2Color.hex2rgbaCSS(t[3])},t.prototype.makeStyleafont=function(t,e){for(var i=t.split(","),s=0;s<i.length;s++)i[s]=this.getFamily(i[s].replace(/^\s+|\s+$/gm,"").replace(/"|'/gm,""));e.fontFamily=i.join(",")},t.prototype.getFamily=function(t){var e=l(window).triggerHandler("n2Family",[t]);return e===d&&(e=t),"'"+e+"'"},t.prototype.makeStylelineheight=function(t,e){e.lineHeight=t},t.prototype.makeStyleweight=t.prototype.makeStylebold=function(t,e){e.fontWeight=1==t?"bold":1<t?t:"normal"},t.prototype.makeStyleitalic=function(t,e){e.fontStyle=1==t?"italic":"normal"},t.prototype.makeStyleunderline=function(t,e){e.textDecoration=1==t?"underline":"none"},t.prototype.makeStylealign=function(t,e){e.textAlign=t},t.prototype.makeStyleletterspacing=function(t,e){e.letterSpacing=t},t.prototype.makeStylewordspacing=function(t,e){e.wordSpacing=t},t.prototype.makeStyletexttransform=function(t,e){e.textTransform=t},t.prototype.makeStyleextra=function(t,e){e.raw=t};var e=1,o=new t,i={pre:"",defaultFamily:"Roboto,Arial",fontSize:16,rendererModes:{},getDefault:function(){return{color:"000000ff",size:"14||px",tshadow:"0|*|0|*|0|*|000000ff",afont:i.defaultFamily,lineheight:"1.5",weight:400,italic:0,underline:0,align:"left",letterspacing:"normal",wordspacing:"normal",texttransform:"none",extra:""}},getEmpty:function(){return{extra:""}},getClass:function(){return"n2-font-"+e++},addCSS:function(t,e,i,s,n){return nextend.css.add(e,o.getCSS.call(o,t,"."+e,i,s,n))},fixBold:function(t){for(var e=0;e<t.length;e++)t[e].bold!==d&&(t[e].weight!==d||(1===parseInt(t[e].bold)?t[e].weight=700:0<t[e].bold&&(t[e].weight=t[e].bold)),delete t[e].bold);return t},parseRawData:function(e){if(0<e.length){"{"!==e[0]&&(e=N2Classes.Base64.decode(e));try{var t=JSON.parse(e);if(t.data!==d)return t.data=this.fixBold(t.data),t.data[0]=l.extend({},this.getDefault(),t.data[0]),t.data}catch(t){console.error("Unexpected data",e,t)}}return[this.getDefault()]},transformData:function(t,e){for(var i=this.parseRawData(t),s=this.rendererModes[e].tabs,n=[],o=0;o<i.length;o++)n[o]=l.extend(!0,this.getEmpty(),i[o]);for(o=n.length;o<s.length;o++)n[o]=this.getEmpty();return n}};return i}),N2D("NextendStyleEditor",["NextendFragmentEditor"],function(t,e){function i(){N2Classes.NextendFragmentEditor.prototype.constructor.apply(this,arguments),this.fields={backgroundColor:{element:t("#n2-style-editorbackgroundcolor"),events:{"nextendChange.n2-editor":this.changeBackgroundColor.bind(this)}},opacity:{element:t("#n2-style-editoropacity"),events:{"outsideChange.n2-editor":this.changeOpacity.bind(this)}},padding:{element:t("#n2-style-editorpadding"),events:{"outsideChange.n2-editor":this.changePadding.bind(this)}},boxShadow:{element:t("#n2-style-editorboxshadow"),events:{"outsideChange.n2-editor":this.changeBoxShadow.bind(this)}},border:{element:t("#n2-style-editorborder"),events:{"outsideChange.n2-editor":this.changeBorder.bind(this)}},borderRadius:{element:t("#n2-style-editorborderradius"),events:{"outsideChange.n2-editor":this.changeBorderRadius.bind(this)}},extracss:{element:t("#n2-style-editorextracss"),events:{"outsideChange.n2-editor":this.changeExtraCSS.bind(this)}}}}return((i.prototype=Object.create(N2Classes.NextendFragmentEditor.prototype)).constructor=i).prototype.load=function(t){this._off(),this.fields.backgroundColor.element.data("field").insideChange(t.backgroundcolor),this.fields.opacity.element.data("field").insideChange(t.opacity),this.fields.padding.element.data("field").insideChange(t.padding),this.fields.boxShadow.element.data("field").insideChange(t.boxshadow),this.fields.border.element.data("field").insideChange(t.border),this.fields.borderRadius.element.data("field").insideChange(t.borderradius),this.fields.extracss.element.data("field").insideChange(t.extra),this._on()},i.prototype.changeBackgroundColor=function(){this.trigger("backgroundcolor",this.fields.backgroundColor.element.val())},i.prototype.changeOpacity=function(){this.trigger("opacity",this.fields.opacity.element.val())},i.prototype.changePadding=function(){this.trigger("padding",this.fields.padding.element.val())},i.prototype.changeBoxShadow=function(){this.trigger("boxshadow",this.fields.boxShadow.element.val())},i.prototype.changeBorder=function(){this.trigger("border",this.fields.border.element.val())},i.prototype.changeBorderRadius=function(){this.trigger("borderradius",this.fields.borderRadius.element.val())},i.prototype.changeExtraCSS=function(){this.trigger("extra",this.fields.extracss.element.val())},i}),N2D("NextendStyleEditorController",["NextendFragmentEditorController"],function($,undefined){function NextendStyleEditorController(){this.css=[],N2Classes.NextendFragmentEditorController.prototype.constructor.apply(this,arguments),this.preview=$('<div class="n2_form__table_preview"></div>').css("fontSize","16px").appendTo('.n2_form__table[data-field="table-style-preview"]'),this.initBackgroundColor()}return NextendStyleEditorController.prototype=Object.create(N2Classes.NextendFragmentEditorController.prototype),NextendStyleEditorController.prototype.constructor=NextendStyleEditorController,NextendStyleEditorController.prototype.loadDefaults=function(){N2Classes.NextendFragmentEditorController.prototype.loadDefaults.call(this),this.type="style",this.preview=null},NextendStyleEditorController.prototype.initEditor=function(){return new N2Classes.NextendStyleEditor},NextendStyleEditorController.prototype.getCleanVisual=function(){return N2Classes.CSSRendererStyle.getEmpty()},NextendStyleEditorController.prototype.initBackgroundColor=function(){this.$background=$("#n2-style-editorpreview-background").on("nextendChange",function(){this.preview.css("background","#"+this.$background.val())}.bind(this)),this.preview.css("background","#"+this.$background.val())},NextendStyleEditorController.prototype.getTabs=function(){return N2Classes.CSSRendererStyle.rendererModes[this.mode].tabs},NextendStyleEditorController.prototype.renderCSS=function(){this._renderTimeout=!1,this.clearCSS();var t=N2Classes.CSSRendererStyle.addCSS("",this.getPreviewCssClass(),this.currentVisual,N2Classes.CSSRendererStyle.rendererModes[this.mode]);this.css.push(t)},NextendStyleEditorController.prototype.setPreview=function(){var styleClassName=this.getPreviewCssClass(),fontClassName=nextend.styleManager.fontClassName,fontClassName2=nextend.styleManager.fontClassName2,styleClassName2=nextend.styleManager.styleClassName2,data={styleClassName:styleClassName,fontClassName:fontClassName,fontClassName2:fontClassName2,styleClassName2:styleClassName2},html="";this.localModePreview[this.mode]!==undefined&&""!==this.localModePreview[this.mode]?(this.preview.html(""),this.preview.append(N2Classes[this.localModePreview[this.mode]].renderStyle(nextend.styleManager.fieldID,data))):(html=N2Classes.CSSRendererStyle.rendererModes[this.mode].preview,html=html.replace(/\{([^]*?)\}/g,function(match,script){return eval(script)}),this.preview.html(html))},NextendStyleEditorController.prototype.getPreviewCssClass=function(){return"n2-"+this.type+"-editor-preview"},NextendStyleEditorController.prototype.pause=function(){this.clearCSS()},NextendStyleEditorController.prototype.clearCSS=function(){for(var t=0;t<this.css.length;t++)this.css[t].destroy();this.css=[]},NextendStyleEditorController}),N2D("NextendStyleManager",function(s,i){function t(){this.$=s(this),this.showParameters=!1,this.type="style",this.css=[],this.styleClassName2="",this.fontClassName="",this.fontClassName2="",(window.nextend.styleManager=this).lightbox=s("#n2-lightbox-"+this.type),this.lightbox.find(".n2_fullscreen_editor__overlay").on("click",this.hide.bind(this)),this.controller=this.initController(),this.controller&&(this.renderer=this.controller.renderer),this.lightbox.find(".n2_fullscreen_editor__cancel").on("click",this.hide.bind(this)),this.saveButton=this.lightbox.find(".n2_fullscreen_editor__save").on("click",this.setVisualAsStatic.bind(this))}return t.prototype.initController=function(){return new N2Classes.NextendStyleEditorController},t.prototype.setFieldID=function(t){this.fieldID=t},t.prototype.setConnectedStyle=function(t){t=s("#"+t).data("field").renderStyle();this.css.push(t),this.styleClassName2=t.getBaseClassName()},t.prototype.setConnectedFont=function(t){t=s("#"+t).data("field").renderFont();this.css.push(t),this.fontClassName=t.getBaseClassName()},t.prototype.setConnectedFont2=function(t){t=s("#"+t).data("field").renderFont();this.css.push(t),this.fontClassName2=t.getBaseClassName()},t.prototype.setAndClose=function(t){this.$.trigger("save",[t])},t.prototype.setVisualAsStatic=function(t){t.preventDefault(),this.setAndClose(JSON.stringify({data:this.controller.get("set")})),this.hide(t)},t.prototype.hide=function(t){this.controller.pause();for(var e=0;e<this.css.length;e++)this.css[e].destroy();this.css=[],t!==i&&(t.preventDefault(),N2Classes.Esc.pop()),this.controller.close(),this.$.off("save"),s("body").removeClass("n2_body--fullscreen-editor-visible"),this.lightbox.removeClass("n2_fullscreen_editor--visible"),s(window).off("keydown.visual")},t.prototype.loadDataToController=function(t){this.controller.load(N2Classes.CSSRendererStyle.parseRawData(t),!1,this.showParameters)},t.prototype.show=function(t,e,i){N2Classes.Esc.add(function(){return this.hide(),!0}.bind(this)),this.showParameters=s.extend({previewMode:!1,previewHTML:!1},i),s("body").addClass("n2_body--fullscreen-editor-visible"),this.lightbox.addClass("n2_fullscreen_editor--visible"),this.loadDataToController(t),this.controller.show(),this.$.on("save",e),this._show()},t.prototype._show=function(){s(":focus").blur(),s(window).on({"keydown.visual":function(t){"TEXTAREA"===t.target.tagName||"INPUT"===t.target.tagName||t.target.isContentEditable||13===t.keyCode&&this.saveButton.trigger("click")}.bind(this)})},t}),N2D("CSSRendererStyle",["CSSRenderer"],function(a,o){function t(){}((t.prototype=Object.create(N2Classes.CSSRenderer.prototype)).constructor=t).prototype.getCSS=function(t,e,i,s,n){return!1===(i=this.decodeData(i))?"":(i[0]=a.extend(N2Classes.CSSRendererStyle.getDefault(),i[0]),t===o&&(t=N2Classes.CSSRendererStyle.pre),N2Classes.CSSRenderer.prototype.getCSS.call(this,t,e,i,s,n))},t.prototype.makeStylebackgroundcolor=function(t,e){e.background="#"+t.substr(0,6)+";\n\tbackground: "+N2Color.hex2rgbaCSS(t)},t.prototype.makeStyleopacity=function(t,e){e.opacity=parseInt(t)/100},t.prototype.makeStylepadding=function(t,e){for(var i=t.split("|*|"),s=i.pop(),n=0;n<i.length;n++)i[n]+=s;e.padding=i.join(" ")},t.prototype.makeStyleboxshadow=function(t,e){t=t.split("|*|");"0"==t[0]&&"0"==t[1]&&"0"==t[2]&&"0"==t[3]?e.boxShadow="none":e.boxShadow=t[0]+"px "+t[1]+"px "+t[2]+"px "+t[3]+"px "+N2Color.hex2rgbaCSS(t[4])},t.prototype.makeStyleborder=function(t,e){t=t.split("|*|");e.borderWidth=t[0]+"px",e.borderStyle=t[1],e.borderColor="#"+t[2].substr(0,6)+";\n\tborder-color:"+N2Color.hex2rgbaCSS(t[2])},t.prototype.makeStyleborderradius=function(t,e){t.split("|*|").push(""),e.borderRadius=t+"px"},t.prototype.makeStyleextra=function(t,e){e.raw=t};var e=1,r=new t;return{pre:"",rendererModes:{},getDefault:function(){return{backgroundcolor:"ffffff00",opacity:100,padding:"0|*|0|*|0|*|0|*|px",boxshadow:"0|*|0|*|0|*|0|*|000000ff",border:"0|*|solid|*|000000ff",borderradius:"0",extra:""}},getEmpty:function(){return{extra:""}},getClass:function(){return"n2-style-"+e++},addCSS:function(t,e,i,s,n){return nextend.css.add(e,r.getCSS.call(r,t,"."+e,i,s,n))},parseRawData:function(e){if(0<e.length){"{"!==e[0]&&(e=N2Classes.Base64.decode(e));try{var t=JSON.parse(e);if(t.data!==o)return t.data[0]=a.extend({},this.getDefault(),t.data[0]),t.data}catch(t){console.error("Unexpected data",e,t)}}return[this.getDefault()]},transformData:function(t,e){for(var i=this.parseRawData(t),s=this.rendererModes[e].tabs,n=[],o=0;o<i.length;o++)n[o]=a.extend(!0,this.getEmpty(),i[o]);for(o=n.length;o<s.length;o++)n[o]=this.getEmpty();return n}}}),N2D("NextendImageEditor",["NextendFragmentEditor"],function(t,s){function e(){this.previews=null,this.desktopImage="",N2Classes.NextendFragmentEditor.prototype.constructor.apply(this,arguments),this.fields={"desktop-size":{element:t("#n2-image-editordesktop-size"),events:{"nextendChange.n2-editor":this.changeSize.bind(this,"desktop")}},"desktop-retina-image":{element:t("#n2-image-editordesktop-retina-image"),events:{"nextendChange.n2-editor":this.changeImage.bind(this,"desktop-retina")}},"desktop-retina-size":{element:t("#n2-image-editordesktop-retina-size"),events:{"nextendChange.n2-editor":this.changeSize.bind(this,"desktop-retina")}},"tablet-image":{element:t("#n2-image-editortablet-image"),events:{"nextendChange.n2-editor":this.changeImage.bind(this,"tablet")}},"tablet-size":{element:t("#n2-image-editortablet-size"),events:{"nextendChange.n2-editor":this.changeSize.bind(this,"tablet")}},"tablet-retina-image":{element:t("#n2-image-editortablet-retina-image"),events:{"nextendChange.n2-editor":this.changeImage.bind(this,"tablet-retina")}},"tablet-retina-size":{element:t("#n2-image-editortablet-retina-size"),events:{"nextendChange.n2-editor":this.changeSize.bind(this,"tablet-retina")}},"mobile-image":{element:t("#n2-image-editormobile-image"),events:{"nextendChange.n2-editor":this.changeImage.bind(this,"mobile")}},"mobile-size":{element:t("#n2-image-editormobile-size"),events:{"nextendChange.n2-editor":this.changeSize.bind(this,"mobile")}},"mobile-retina-image":{element:t("#n2-image-editormobile-retina-image"),events:{"nextendChange.n2-editor":this.changeImage.bind(this,"mobile-retina")}},"mobile-retina-size":{element:t("#n2-image-editormobile-retina-size"),events:{"nextendChange.n2-editor":this.changeSize.bind(this,"mobile-retina")}}},this.previews={desktop:t("#n2-image-editordesktop-preview"),"desktop-retina":t("#n2-image-editordesktop-retina-preview"),tablet:t("#n2-image-editortablet-preview"),"tablet-retina":t("#n2-image-editortablet-retina-preview"),mobile:t("#n2-image-editormobile-preview"),"mobile-retina":t("#n2-image-editormobile-retina-preview")};t(this.buttonGenerate()).on("click",this.generateImage.bind(this,"tablet")).insertAfter(this.fields["tablet-image"].element.parent()),t(this.buttonGenerate()).on("click",this.generateImage.bind(this,"mobile")).insertAfter(this.fields["mobile-image"].element.parent())}return((e.prototype=Object.create(N2Classes.NextendFragmentEditor.prototype)).constructor=e).prototype.load=function(t,e){for(var i in this._off(),this.desktopImage=t,this.makePreview("desktop",t),e)e[i].image!==s&&this.makePreview(i,e[i].image);this._on()},e.prototype.changeImage=function(t,e){e=e.detail.field.element.val();this.makePreview(t,e),this.trigger(t,"image",e)},e.prototype.changeSize=function(t,e){e=e.detail.field;this.trigger(t,"size",e.element.val())},e.prototype.makePreview=function(t,e){return e?(this.previews[t].html('<img style="max-width:100%; max-height: 300px;" src="'+nextend.imageHelper.fixed(e)+'" />'),!0):(this.previews[t].html(""),!1)},e.prototype.buttonGenerate=function(){return'<a href="#" class="n2_field_button n2_field_text_image__button">'+n2_("Generate")+"</a>"},e.prototype.generateImage=function(e){var t=this.desktopImage;return""==t?(N2Classes.Notification.error(n2_("Desktop image is empty!"),{timeout:3}),!1):N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(nextend.imageManager.parameters.ajaxUrl,{nextendaction:"generateImage"}),data:{device:e,image:t},dataType:"json"}).done(function(t){t=t.data.image;this.fields[e+"-image"].element.data("field").insideChange(nextend.imageHelper.dynamic(t))}.bind(this))},e.prototype.trigger=function(t,e,i){this.$.trigger("change",[t,e,i])},e}),N2D("NextendImageEditorController",["NextendFragmentEditorControllerWithEditor"],function(t,e){function i(){N2Classes.NextendFragmentEditorControllerWithEditor.prototype.constructor.apply(this,arguments)}return((i.prototype=Object.create(N2Classes.NextendFragmentEditorControllerWithEditor.prototype)).constructor=i).prototype.loadDefaults=function(){N2Classes.NextendFragmentEditorControllerWithEditor.prototype.loadDefaults.call(this),this.type="image",this.currentImage=""},i.prototype.get=function(t){return this.currentVisual},i.prototype.getEmptyVisual=function(){return{desktop:{size:"0|*|0"},"desktop-retina":{image:"",size:"0|*|0"},tablet:{image:"",size:"0|*|0"},"tablet-retina":{image:"",size:"0|*|0"},mobile:{image:"",size:"0|*|0"},"mobile-retina":{image:"",size:"0|*|0"}}},i.prototype.initEditor=function(){return new N2Classes.NextendImageEditor},i.prototype._load=function(t,e,i){this.currentImage=t.visual.image,N2Classes.NextendFragmentEditorControllerWithEditor.prototype._load.call(this,t.value,e,i)},i.prototype.loadToEditor=function(){this.currentVisual=t.extend({},this.getEmptyVisual(),this.currentVisual),this.editor.load(this.currentImage,this.currentVisual)},i.prototype.propertyChanged=function(t,e,i,s){this.isChanged=!0,this.currentVisual[e][i]=s},i}),N2D("NextendImage",["NextendVisualCore"],function(t,e){function i(){N2Classes.NextendVisualCore.prototype.constructor.apply(this,arguments)}return((i.prototype=Object.create(N2Classes.NextendVisualCore.prototype)).constructor=i).prototype.setValue=function(t,e){this.base64=t,this.value=JSON.parse(N2Classes.Base64.decode(t))},i.prototype.activate=function(t){t!==e&&t.preventDefault(),this.visualManager.changeActiveVisual(this),this.visualManager.controller.load(this,!1,this.visualManager.showParameters)},i}),N2D("NextendImageManager",["NextendVisualManagerCore"],function(s,n){function t(){this.referenceKeys={},N2Classes.NextendVisualManagerCore.prototype.constructor.apply(this,arguments)}return((t.prototype=Object.create(N2Classes.NextendVisualManagerCore.prototype)).constructor=t).prototype.loadDefaults=function(){N2Classes.NextendVisualManagerCore.prototype.loadDefaults.apply(this,arguments),this.type="image",this.labels={visual:"image",visuals:"images"},this.fontClassName=""},t.prototype.initController=function(){return new N2Classes.NextendImageEditorController},t.prototype.createVisual=function(t){return new N2Classes.NextendImage(t,this)},t.prototype.firstLoadVisuals=function(t){for(var e=0;e<t.length;e++)this.referenceKeys[t[e].hash]=this.visuals[t[e].id]=this.createVisual(t[e])},t.prototype.getVisual=function(t){if(""!=t){var e=md5(t);if(this.referenceKeys[e]!==n)return this.referenceKeys[e];if(this.visualLoadDeferreds[e]!==n)return this.visualLoadDeferreds[e];var i=s.Deferred();return this.visualLoadDeferreds[e]=i,this._loadVisualFromServer(t).done(function(){i.resolve(this.referenceKeys[e]),delete this.visualLoadDeferreds[e]}.bind(this)).fail(function(){i.resolve({id:-1,name:n2_("Empty")}),delete this.visualLoadDeferreds[e]}.bind(this)),i}N2Classes.Notification.error(n2_("The image is empty"),{timeout:3})},t.prototype._loadVisualFromServer=function(t){return N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.parameters.ajaxUrl,{nextendaction:"loadVisualForImage"}),data:{image:t},dataType:"json"}).done(function(t){t=t.data.visual;this.referenceKeys[t.hash]=this.visuals[t.id]=this.createVisual(t)}.bind(this))},t.prototype.isVisualData=function(t){return""!==t},t.prototype.setVisual=function(e){e.preventDefault(),this.controller.isChanged?this.saveActiveVisual(this.activeVisual.name).done(function(t){s(window).trigger(t.data.visual.hash,this.activeVisual.value),this.hide(e)}.bind(this)):this.hide(e)},t.prototype.getBase64=function(){return N2Classes.Base64.encode(JSON.stringify(this.controller.get("set")))},t.prototype.loadDataToController=function(e){s.when(this.getVisual(e)).done(function(t){0<t.id?t.activate():console.error(e+" visual is not found linked")}.bind(this))},t}),N2D("BrowserCompatibility",function(t,e){var i={firefox:52,edge:18,opera:55,safari:10,chrome:68,safariIOS:604};return function(t){window.location.href.match(/nextendcontroller=(sliders|slider|slides|generator)/)&&!function(){var t=navigator.userAgent,e=t.match(/Firefox\/([0-9]+)/);if(e)return parseInt(e[1])>=i.firefox;if(e=t.match(/Edge\/([0-9]+)/))return parseInt(e[1])>=i.edge;if(e=t.match(/OPR\/([0-9]+)/))return parseInt(e[1])>=i.opera;if(e=t.match(/Version\/([0-9]+)[0-9. ]*?Safari/))return parseInt(e[1])>=i.safari;if(e=t.match(/Chrome\/([0-9]+)/))return parseInt(e[1])>=i.chrome;if(e=t.match(/Safari\/([0-9]+)/))return parseInt(e[1])>=i.safariIOS;return!1}()&&(window.location=t)}}),N2D("ContextMenu",function(a,r){var l,d,h,p,i,e,s,c,n,u;function f(t){d[0]===t.target||a.contains(d[0],t.target)||u&&(u===t.target||a.contains(u,t.target))||m()}function m(){0===l&&(b(),o(),p[0].removeEventListener("mouseover",g,{passive:!0,capture:!0}),p[0].removeEventListener("mouseleave",y,{passive:!0,capture:!0}),d.remove(),s=i=p=d=r,document.removeEventListener("mousedown",f,{passive:!0,capture:!0}),document.removeEventListener("pointerdown",f,{passive:!0,capture:!0}),cancelAnimationFrame(this.frame),window.removeEventListener("scroll",m,{passive:!0,capture:!0}),window.removeEventListener("resize",m),window.removeEventListener("blur",m),c.onClose&&c.onClose.call(window))}function g(t){var e=a(t.target);e.hasClass("n2_context_menu__item")||(e=e.closest(".n2_context_menu__item")),i&&e[0]===i[0]||(b(),!(i=e).length||(e=i.data("items"))!==r&&(i.addClass("n2_context_menu__item--active"),(s=i.data("submenu"))||(s=function(t,e){for(var i=e.getBoundingClientRect(),s=a('<div class="n2_context_menu__sub_menu"></div>').appendTo(d),n=0;n<t.length;n++)new("onoff"===t[n].type?x:w)(s,t[n]);var o=s.width();e=n2const.rtl.isRtl?i.left<o:i.left+i.width+o<window.innerWidth;o=e?Math.round(i.width-3):-Math.round(o-3);return s.css({left:o,top:Math.round(Math.min(i.top,window.innerHeight-s.height()-5)-h.top)}),s[0].addEventListener("mouseover",v,{passive:!0,capture:!0}),s[0].addEventListener("mouseleave",v,{passive:!0,capture:!0}),s}(e,i[0]),i.data("submenu",s)),s.addClass("n2_context_menu__sub_menu--active"))),y(t)}function y(t){t=a(t.target);t.hasClass("n2_context_menu__item")||(t=t.closest(".n2_context_menu__item")),e&&t[0]===e[0]||(o(),(e=t).length&&e.data("item").onFocus())}function o(){var t;e&&e.length&&((t=e.data("item"))&&t.onBlur(),e=r)}function v(t){t=a(t.target);t.hasClass("n2_context_menu__item")||(t=t.closest(".n2_context_menu__item")),n&&t[0]===n[0]||(_(),(n=t).length&&n.data("item").onFocus())}function _(){var t;n&&n.length&&((t=n.data("item"))&&t.onBlur(),n=r)}function b(){s!==r&&(_(),s.removeClass("n2_context_menu__sub_menu--active"),n=s=r,i.removeClass("n2_context_menu__item--active"))}function C(t,e){this.$item=a('<div class="n2_context_menu__item"></div>').data("item",this).appendTo(t),e.color!==r&&this.$item.addClass("n2_context_menu__item--color-"+e.color),this.setData(e)}function w(t,e){C.prototype.constructor.call(this,t,e)}function x(t,e){w.prototype.constructor.call(this,t,e),this.$item.addClass("n2_context_menu__item_onoff")}return C.prototype.setData=function(t){this.data=t,this.$item.html(""),this.render(t),t.items!==r&&this.$item.data("items",t.items)},C.prototype.render=function(t){t.render(this.$item)},C.prototype.onClick=function(){!1!==this.data.action.call(window,this)&&m()},C.prototype.onFocus=function(){this.data.focus!==r&&this.data.focus.call()},C.prototype.onBlur=function(){this.data.blur!==r&&this.data.blur.call()},((w.prototype=Object.create(C.prototype)).constructor=w).prototype.render=function(t){this.$icon=a('<i class="n2_context_menu__item_icon '+t.icon+'"></i>').appendTo(this.$item),this.$label=a('<div class="n2_context_menu__item_label"></div>').appendTo(this.$item),"function"==typeof t.label?t.label.call(this,this):this.$label.text(t.label),this.$item.off("click"),t.action!==r?(this.$item.on("click",this.onClick.bind(this)),this.$item.addClass("n2_context_menu__item--has-action")):this.$item.removeClass("n2_context_menu__item--has-action")},((x.prototype=Object.create(w.prototype)).constructor=x).prototype.render=function(t){this.isOn=!!t.isOn.call(this),this.syncClass(),a('<i class="n2_context_menu__item_icon ssi_16"></i>').appendTo(this.$item),this.$label=a('<div class="n2_context_menu__item_label"></div>').appendTo(this.$item),"function"==typeof t.label?t.label.call(this,this.$label):this.$label.text(t.label),this.$item.off("click"),this.$item.on("click",this.toggle.bind(this)),this.$item.addClass("n2_context_menu__item--has-action")},x.prototype.syncClass=function(){this.$item.toggleClass("n2_context_menu__item_onoff--on",this.isOn)},x.prototype.toggle=function(){this.isOn=!this.isOn,this.syncClass(),this.data.action(this.isOn)},function(t,e,i){if(l=0,c=a.extend({x:0,y:0,horizontalAlign:"right",verticalAlign:"bottom",onClose:!1,forceLtr:!1},i),d===r||(m(),u!==t)){d=a('<div class="n2_context_menu"></div>').appendTo("body"),c.forceLtr&&d.attr("dir","ltr"),p=a('<div class="n2_context_menu__inner"></div>').appendTo(d),e.sort(function(t,e){return t.priority-e.priority});for(var s=0;s<e.length;s++)switch(e[s].type){case"raw":new C(p,e[s]);break;case"onoff":new x(p,e[s]);break;default:new w(p,e[s])}var n,o={top:"auto",right:"auto",bottom:"auto",left:"auto"};return t instanceof Element?(n=(u=t).getBoundingClientRect(),"right"===c.horizontalAlign?o.left=Math.min(n.left+c.x,window.innerWidth-p.width()-c.x-10):"left"===c.horizontalAlign&&(o.left=n.right-p.width()-c.x),"bottom"===c.verticalAlign?(i=n.top+n.height+c.y)<=window.innerHeight-p.height()-10?o.top=i:o.bottom=window.innerHeight-n.top+c.y:"top"===c.verticalAlign&&(n.top-10>=p.height()?o.bottom=window.innerHeight-n.top+c.y:o.top=n.top+n.height+c.y)):(u=!1,o.left=Math.min(t.clientX+1,window.innerWidth-p.width()-10),o.top=Math.min(t.clientY+1,window.innerHeight-p.height()-10)),d.css(o),h=p[0].getBoundingClientRect(),p[0].addEventListener("mouseover",g,{passive:!0,capture:!0}),p[0].addEventListener("mouseleave",y,{passive:!0,capture:!0}),document.addEventListener("mousedown",f,{passive:!0,capture:!0}),document.addEventListener("pointerdown",f,{passive:!0,capture:!0}),this.frame=requestAnimationFrame(function(){window.addEventListener("scroll",m,{passive:!0,capture:!0})}),window.addEventListener("resize",m),window.addEventListener("blur",m),{lock:function(){l++},unlock:function(){l--,l=Math.max(l,0)}}}}}),N2D("DashboardInfo",function(e,t){function i(){this.isVisible=!1,this.blurInteractionCallback=this.blurInteraction.bind(this),this.blurCallback=this.blur.bind(this),N2R("documentReady",this.onReady.bind(this))}return i.prototype.onReady=function(){this.$info=e(".n2_dashboard_info"),this.$button=this.$info.find("> .n2_button_plain_icon").on("click",this.toggleInfo.bind(this))},i.prototype.toggleInfo=function(t){t.preventDefault(),this.isVisible?this.hideInfo():this.showInfo()},i.prototype.showInfo=function(){this.isVisible||(this.isVisible=!this.isVisible,document.addEventListener("mousedown",this.blurInteractionCallback,{passive:!0,capture:!0}),window.addEventListener("scroll",this.blurCallback,{passive:!0,capture:!0}),this.syncClass())},i.prototype.hideInfo=function(){this.isVisible&&(this.isVisible=!this.isVisible,this.syncClass(),document.removeEventListener("mousedown",this.blurInteractionCallback,{passive:!0,capture:!0}),window.removeEventListener("scroll",this.blurCallback,{passive:!0,capture:!0}))},i.prototype.syncClass=function(){this.$info.toggleClass("n2_dashboard_info--visible",this.isVisible)},i.prototype.blur=function(){this.hideInfo()},i.prototype.blurInteraction=function(t){this.$info[0]===t.target||e.contains(this.$info[0],t.target)||this.hideInfo()},i}),N2D("DeviceChanger",function(n,i){function t(t){this.slider=t,this.activeStates={hover:!1,drag:!1},this.devices={},this.slider.stages.done("ResponsiveStart",this.onResponsiveStart.bind(this))}function s(t,e,i,s){this.deviceChanger=t,this.device=e,this.data=i,this.icon=s,this.$button=n('<div class="n2_device_tester_devices__device" data-device="'+e+'"><i class="ssi_24 '+s+'"></i></div>').on("click",this.activate.bind(this)).appendTo(t.$containerDevices),t.registerDevice(e,this)}function o(t){this.trailSize=160,this.deviceChanger=t;t=n('<div class="n2_device_tester_zoom"></div>').appendTo(t.$deviceTester);this.$min=n('<div class="n2_device_tester_zoom__min_label">0</div>').appendTo(t),this.mouseMoveDelegate=this.onMouseMove.bind(this),this.mouseUpDelegate=this.onMouseUp.bind(this),this.$zoomInner=n('<div class="n2_device_tester_zoom__inner"></div>').on("mousedown",this.onMouseDown.bind(this)).appendTo(t),this.$max=n('<div class="n2_device_tester_zoom__max_label">3000</div>').appendTo(t),n('<div class="n2_device_tester_zoom__trail"></div>').appendTo(this.$zoomInner),this.$editorSize=n('<div class="n2_device_tester_zoom__editor_size"></div>').appendTo(this.$zoomInner),this.$handle=n('<div class="n2_device_tester_zoom__handle"></div>').appendTo(this.$zoomInner),this.$handleLabel=n('<div class="n2_device_tester_zoom__handle_label"></div>').appendTo(this.$handle)}return t.prototype.registerDevice=function(t,e){this.devices[t]=e},t.prototype.setActiveState=function(t,e){this.activeStates[t]=e,this.$deviceChanger.toggleClass("n2_device_changer--active",this.activeStates.hover||this.activeStates.drag)},t.prototype.onResponsiveStart=function(){var t;this.$deviceChanger=n(".n2_device_changer").on({mouseenter:function(){t&&(clearTimeout(t),t=i),this.setActiveState("hover",!0)}.bind(this),mouseleave:function(){t=setTimeout(function(){this.setActiveState("hover",!1)}.bind(this),500)}.bind(this)}),this.$icon=this.$deviceChanger.find(".n2_device_changer__button .ssi_24"),this.responsive=this.slider.responsive,this.container=this.responsive.containerElement.closest(".n2_slider_preview_area__inner, .n2_slide_editor_slider__editor"),this.$deviceTester=this.$deviceChanger.find(".n2_device_tester"),this.$containerDevices=n('<div class="n2_device_tester_devices"></div>').appendTo(this.$deviceTester),this.resizer=new o(this);var e=this.responsive.parameters.enabledDevices;e.mobilePortrait&&new s(this,"mobilePortrait",this.responsive.parameters.sizes.mobilePortrait,"ssi_24--mobileportrait"),e.mobileLandscape&&new s(this,"mobileLandscape",this.responsive.parameters.sizes.mobileLandscape,"ssi_24--mobileportraitlarge"),e.tabletPortrait&&new s(this,"tabletPortrait",this.responsive.parameters.sizes.tabletPortrait,"ssi_24--tabletportrait"),e.tabletLandscape&&new s(this,"tabletLandscape",this.responsive.parameters.sizes.tabletLandscape,"ssi_24--tabletportraitlarge"),new s(this,"desktopPortrait",this.responsive.parameters.sizes.desktopPortrait,"ssi_24--desktop").activate(),e.desktopLandscape&&new s(this,"desktopLandscape",this.responsive.parameters.sizes.desktopLandscape,"ssi_24--desktoplandscape"),this.responsive.identifyDeviceID=this.proxyIdentifyDeviceID.bind(this)},t.prototype.setDevice=function(t,e,i,s){this.device&&(this.devices[this.device].markInActive(),this.$icon.removeClass(this.devices[this.device].icon)),this.device=t,n("body").attr("data-device",t),this.devices[this.device].markActive(),this.$icon.addClass(this.devices[this.device].icon),this.width=e,this.minWidth=i,this.maxWidth=s,this.resizer.setLimits(i,s,e),this.resizer.setValue(this.width),this.container.width(this.width),this.slider.stages.resolved("Resized")&&this.responsive.doResize()},t.prototype.setWidth=function(t){(t=Math.max(Math.min(t,this.maxWidth),this.minWidth))!==this.width&&(this.width=t,this.resizer.setValue(t),this.container.width(this.width),this.responsive.doResize())},t.prototype.proxyIdentifyDeviceID=function(){return N2Classes.SmartSliderResponsive.DeviceMode[this.device]},s.prototype.markActive=function(){this.$button.addClass("n2_device_tester_devices__device--active")},s.prototype.markInActive=function(){this.$button.removeClass("n2_device_tester_devices__device--active")},s.prototype.activate=function(){this.deviceChanger.setDevice(this.device,this.data.width,this.data.min,this.data.max)},o.prototype.setLimits=function(t,e,i){this.min=t,this.$min.text(t),this.max=e,this.$max.text(e),this.editorSize=i,this.onePxToReal=(e-t)/this.trailSize,this.$editorSize.css("left",Math.round((i-t)/(e-t)*this.trailSize))},o.prototype.setValue=function(t){this.$handleLabel.text(t),this.$handle.css("left",Math.round((t-this.min)/(this.max-this.min)*this.trailSize))},o.prototype.onMouseDown=function(t){t.preventDefault(),n("body").addClass("n2_body--resize-editor"),this.resizeContext={clientX:this.$zoomInner[0].getBoundingClientRect().left,width:this.deviceChanger.width},document.addEventListener("mousemove",this.mouseMoveDelegate),document.addEventListener("mouseup",this.mouseUpDelegate),this.deviceChanger.setActiveState("drag",!0),this.onMouseMove(t)},o.prototype.onMouseMove=function(t){t=Math.round(this.min+(t.clientX-this.resizeContext.clientX)*this.onePxToReal);Math.abs(this.editorSize-t)<2*this.onePxToReal&&(t=this.editorSize),this.deviceChanger.setWidth(t)},o.prototype.onMouseUp=function(t){document.removeEventListener("mousemove",this.mouseMoveDelegate),document.removeEventListener("mouseup",this.mouseUpDelegate),this.deviceChanger.setActiveState("drag",!1),n("body").removeClass("n2_body--resize-editor")},t}),N2D("License",["EditorAbstract"],function(s,h){function o(t){this.options=s.extend({activated:!1,maybeActive:!1,activationUrl:"",activationArgs:{},ajaxUrl:""},t),(o.instance=this).setActivated(this.options.activated)}return o.get=function(){return o.instance},o.prototype.isActivated=function(t,e){var i=s.Deferred();return this.options.activated?this.options.maybeActive?i.resolve():N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.options.ajaxUrl,{nextendaction:"check",cacheAccepted:t+0,showErrors:e+0}),dataType:"json"}).done(function(){i.resolve()}.bind(this)).fail(function(){i.reject()}.bind(this)):i.reject(),i},o.prototype.setActivated=function(t){this.options.activated=t,document.documentElement.setAttribute("data-ss3-activated",this.options.activated?"1":"0")},o.prototype.showActivationModal=function(){var t=s.Deferred();return this.isActivated(!0,!1).done(function(){t.resolve()}.bind(this)).fail(function(){this.displayModal(t,!1)}.bind(this)),t},o.prototype.showActivationModalSkippable=function(){var t=s.Deferred();return this.isActivated(!0,!1).done(function(){t.resolve()}.bind(this)).fail(function(){this.displayModal(t,!0)}.bind(this)),t},o.prototype.displayModal=function(e,t){var i=new N2Classes.ModalSimple("activate",{destroyOnHide:!1});i.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--protect","green")),i.addContent(N2Classes.UI.modalHeading(n2_("Activate Smart Slider 3 Pro")));var s=N2Classes.UI.modalFormRow();i.addContent(s),i.addContent(N2Classes.UI.modalParagraph(n2_("Activation is required to unlock all features!")+" "+n2_("Register Smart Slider 3 Pro on this domain to enable auto update, slider templates and slide library."))),t&&(n=N2Classes.UI.modalButton(n2_("Skip"),"grey"),i.addButton(n),n.on("click",function(t){t.preventDefault(),e.resolve(),i.hide()}.bind(this)));var n=N2Classes.UI.modalButton(n2_("Activate"),"green");i.addButton(n),n.on("click",function(t){o.instance.activate(e),e.done(function(){i.hide()}.bind(this,t))}.bind(this)),i.show()},o.prototype.startActivation=function(){var t=s.Deferred();return this.isActivated(!0,!1).done(function(){t.resolve()}.bind(this)).fail(function(){this.activate(t)}.bind(this)),t},o.prototype.activate=function(i){if(n2const.isIE||n2const.isEdge)return i.reject(),N2Classes.Notification.error(n2_("Activation process is not supported in this browser. Please use Google Chrome.")),!1;i.fail(function(){this.options.maybeActive=!1}.bind(this)),this.closePopup!==h&&this.closePopup();function t(t){if("https://secure.nextendweb.com"===t.origin&&t.source===s.popup){var e=t[t.message?"message":"data"];try{e=JSON.parse(e),s.onMessageReceived(e,i)}catch(t){console.error(t)}}}var s=this;window.addEventListener("message",t,!1),this.closePopup=function(){this.popup.close(),window.removeEventListener("message",t,!1),delete this.popup,delete this.closePopup}.bind(this),this.popup=this.popupCenter(this.options.activationUrl,"authorize-window",980,800)},o.prototype.onMessageReceived=function(t,e){if(t.action)switch(t.action){case"ready":this.send({action:"authorize",data:this.options.activationArgs});break;case"license":this.addLicenseKey(e,t.license_key)}},o.prototype.send=function(t){this.popup.postMessage(JSON.stringify(t),"*")},o.prototype.addLicenseKey=function(e,t){N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.options.ajaxUrl,{nextendaction:"add"}),data:{licenseKey:t},dataType:"json"}).done(function(t){t.data.valid&&(this.setActivated(!0),this.options.maybeActive=!0,e.resolve(),N2Classes.Notification.notice(n2_("Smart Slider 3 activated!")),s("#n2-ss-add-license-key").remove())}.bind(this))},o.prototype.popupCenter=function(t,e,i,s){function n(){return/\b(iPhone|iP[ao]d)/.test(o)||/\b(iP[ao]d)/.test(o)||/Android/i.test(o)||/Mobile/i.test(o)}var o=navigator.userAgent,a=window.screenX!==h?window.screenX:window.screenLeft,r=window.screenY!==h?window.screenY:window.screenTop,l=window.outerWidth!==h?window.outerWidth:document.documentElement.clientWidth,d=window.outerHeight!==h?window.outerHeight:document.documentElement.clientHeight-22,i=n()?null:i,s=n()?null:s,a=a<0?window.screen.width+a:a,l=parseInt(a+(l-i)/2,10),r=parseInt(r+(d-s)/2.5,10),d=[];null!==i&&d.push("width="+i),null!==s&&d.push("height="+s),d.push("left="+l),d.push("top="+r),d.push("scrollbars=1");d=window.open(t,e,d.join(","));return window.focus&&d.focus(),d},o}),N2D("SliderPreview",["UIDragTooltip"],function(n,e){var i,o=new N2Classes.UIDragTooltip("Resize");function t(){i={desktopPortrait:n2_("Desktop"),desktopLandscape:n2_("Large desktop"),tabletPortrait:n2_("Tablet"),tabletLandscape:n2_("Large tablet"),mobilePortrait:n2_("Mobile"),mobileLandscape:n2_("Large mobile")},this.frameScrollTop=0,this.scale=1,this.activeInfo=!1,this.sliderInfos={},this.isIframeContext=window.parent!==window,this.isIframeContext?(this.$parentDocument=window.parent.N2Classes.$(window.parent.document),document.addEventListener("wheel",function(t){t.preventDefault()}.bind(this),{passive:!1}),window.addEventListener("message",function(t){var e={};try{e=JSON.parse(t.data)}catch(t){}switch(e.action){case"cancel":this.$parentDocument.triggerHandler("n2Close");break;case"scrollTop":this.updateFrameScrollTop(e.data);break;case"device_info":this.updateDeviceInfo(e.data)}}.bind(this),!1),document.addEventListener("keydown",function(t){t.defaultPrevented||27===t.keyCode&&(t.preventDefault(),this.$parentDocument.triggerHandler("n2Close"))}.bind(this)),n(".n2_preview_slider__close").on("click",function(t){t.preventDefault(),this.$parentDocument.triggerHandler("n2Close")}.bind(this))):window.addEventListener("message",function(t){var e={};try{e=JSON.parse(t.data)}catch(t){}switch(e.action){case"scrollTop":this.updateFrameScrollTop(e.data);break;case"device_info":this.updateDeviceInfo(e.data)}}.bind(this),!1),this.init(),this.$frame=n(".n2_preview__device_screen_inner iframe"),n(".n2_preview form").submit()}function s(t){return t.replace(/[^0-9]/gi,"").replace(/^[0]+/gi,"").substr(0,5)}function a(t,e,i,s){this.sliderPreview=t,this.label=e,this.width=i,this.height=s,t.devices.push(this),this.$bar=n('<div class="n2_preview__ruler_device"><div></div></div>').on({mouseenter:function(){this.sliderPreview.setTempLabel(this.getLabel())}.bind(this),mouseleave:function(){this.sliderPreview.resetLabel()}.bind(this),click:function(){this.sliderPreview.setDimensions(this.width,this.height),this.sliderPreview.setCurrentDevice(this)}.bind(this)}).prependTo(t.$ruler),this.refreshScale()}function r(t,e){this.sliderPreview=t,this.id=e,this.top=0,this.$tip=n('<div class="n2_preview__slider_info"></div>').appendTo(this.sliderPreview.$infoState)}return t.prototype.init=function(){this.$fieldWidth=n(".n2_preview_toolbar__width").on("click",function(){"true"!==this.$fieldWidth[0].contentEditable&&new N2Classes.InlineTextEditor(this.$fieldWidth[0],{filter:s,onSave:function(t){(t=parseInt(t))?this.setWidth(t):this.onResize()}.bind(this),onCancel:function(){this.onResize()}.bind(this)})}.bind(this)),this.$fieldHeight=n(".n2_preview_toolbar__height").on("click",function(){"true"!==this.$fieldHeight[0].contentEditable&&new N2Classes.InlineTextEditor(this.$fieldHeight[0],{filter:s,onSave:function(t){(t=parseInt(t))?this.setHeight(t):this.onResize()}.bind(this),onCancel:function(){this.onResize()}.bind(this)})}.bind(this)),this.$fieldScale=n(".n2_preview_toolbar__scale").on("change",function(){this.setScale(this.$fieldScale.val()/100)}.bind(this)),this.devices=[],this.$ruler=n(".n2_preview__ruler"),new a(this,n2_("Mobile")+" S",375,667),new a(this,n2_("Mobile")+" L",425,756),new a(this,n2_("Tablet"),768,1024),new a(this,n2_("Laptop"),1024,768),new a(this,n2_("Laptop")+" L",1440,900),new a(this,"Full HD",1920,1080),new a(this,"4K",2560,1440),this.$label=n(".n2_preview__ruler_label"),this.$infoState=n(".n2_preview__device_info_state"),this.$infoTip=n(".n2_preview__device_info .ssi_16"),this.$screen=n(".n2_preview__device_screen"),this.$notification=n('<div class="n2_preview__notification_scale"></div>').appendTo(this.$screen),this.$screenInner=n(".n2_preview__device_screen_inner"),n(".n2_preview__resize_width").on("mousedown",function(t){t.preventDefault(),o.dragShow(),n("body").addClass("n2_body--resize-horizontal");var i=t.clientX,s=Math.floor(this.$screenInner.width()/this.scale);o.dragUpdate(t,n2_("Width")+": "+Math.max(320,Math.ceil(s))+"px"),n(document).on({"mousemove.resize":function(t){var e=Math.floor(s-2*(i-t.clientX)/this.scale);this.setWidth(e),this.removeCurrentDevice(),o.dragUpdate(t,n2_("Width")+": "+Math.max(320,Math.ceil(e))+"px")}.bind(this),"mouseup.resize":function(){o.dragHide(),n(document).off(".resize"),n("body").removeClass("n2_body--resize-horizontal")},"mouseleave.resize":function(){o.dragHide(),n(document).off(".resize"),n("body").removeClass("n2_body--resize-horizontal")}})}.bind(this)),n(".n2_preview__resize_height").on("mousedown",function(t){t.preventDefault(),o.dragShow(),n("body").addClass("n2_body--resize-vertical");var i=t.clientY,s=Math.floor(this.$screenInner.height()/this.scale);o.dragUpdate(t,n2_("Height")+": "+Math.max(320,s)+"px"),n(document).on({"mousemove.resize":function(t){var e=Math.floor(s-(i-t.clientY)/this.scale);this.setHeight(e),this.removeCurrentDevice(),o.dragUpdate(t,n2_("Height")+": "+Math.max(320,e)+"px")}.bind(this),"mouseup.resize":function(){o.dragHide(),n(document).off(".resize"),n("body").removeClass("n2_body--resize-vertical")}})}.bind(this)),n(".n2_button_preview_orientation").on("click",function(t){t.preventDefault(),this.removeCurrentDevice(),this.setDimensions(this.$screenInner.height()/this.scale,this.$screenInner.width()/this.scale)}.bind(this)),n(".n2_button_preview_reload").on("click",function(t){t.preventDefault(),this.reload()}.bind(this)),n(window).on("resize",this.onResize.bind(this)),this.onResize()},t.prototype.reload=function(){n(".n2_preview form").submit()},t.prototype.onResize=function(){this.$fieldWidth.text(Math.floor(this.$screenInner.width()/this.scale)),this.$fieldHeight.text(Math.floor(this.$screenInner.height()/this.scale))},t.prototype.displayNotification=function(t){this.notificationTimeout&&clearTimeout(this.notificationTimeout),this.$notification.text(t).addClass("n2_preview__notification_scale--visible"),this.notificationTimeout=setTimeout(function(){this.$notification.removeClass("n2_preview__notification_scale--visible"),delete this.notificationTimeout}.bind(this),600)},t.prototype.setScale=function(t){this.displayNotification(100*t+"%");var e=this.scale;this.scale=t,n("body").addClass("n2_body--scale-preview"),setTimeout(function(){n("body").removeClass("n2_body--scale-preview")},1500),this.$screen=n(".n2_preview__device_screen");var i=this.$screenInner.width(),t=this.$screenInner.height();this.$frame.css({transform:"scale("+this.scale+")",width:1/this.scale*100+"%",height:1/this.scale*100+"%",marginLeft:(100-1/this.scale*100)/2+"%",marginRight:(100-1/this.scale*100)/2+"%"});for(var s=0;s<this.devices.length;s++)this.devices[s].refreshScale();this._setDimensions(i/e,t/e),this.onResize()},t.prototype.setDimensions=function(t,e){var i=this.$screen.width(),s=this.$screen.height(),s=Math.max(25,25*Math.floor(100*Math.min(1,i/t,s/e)/25));parseInt(this.$fieldScale.val())!==s&&s<=100&&this.$fieldScale.val(s).trigger("change"),this._setDimensions(t,e)},t.prototype._setDimensions=function(t,e){this.setWidth(t),this.setHeight(e)},t.prototype.setWidth=function(t){t=Math.floor(Math.max(320,t)*this.scale),this.$screenInner.css("maxWidth",t),this.$fieldWidth.text(Math.floor(this.$screenInner.width()/this.scale))},t.prototype.setHeight=function(t){t=Math.floor(Math.max(320,t)*this.scale),this.$screenInner.css("maxHeight",t),this.$fieldHeight.text(Math.floor(this.$screenInner.height()/this.scale))},t.prototype.setCurrentDevice=function(t){this.currentDevice&&this.currentDevice!==t&&this.removeCurrentDevice(),this.currentDevice=t,this.resetLabel()},t.prototype.removeCurrentDevice=function(){this.currentDevice&&(this.currentDevice.deActivate(),delete this.currentDevice,this.resetLabel())},t.prototype.setTempLabel=function(t){this.currentDevice&&this.currentDevice.deActivate(),this.$label.text(t)},t.prototype.resetLabel=function(){this.currentDevice?(this.$label.text(this.currentDevice.getLabel()),this.currentDevice.activate()):this.$label.text("")},t.prototype.setInfo=function(t,e,i,s){this.$infoState.text(t);t=[];t.push("<b>"+n2_("Orientation")+": </b>"+(e?n2_("Landscape"):n2_("Portrait"))),i<=0?t.push("<b>"+n2_("Size")+": </b>"+n2_sprintf(n2_("Below %s pixels."),s)):1e5<=s?t.push("<b>"+n2_("Size")+": </b>"+n2_sprintf(n2_("Above %s pixels."),i)):t.push("<b>"+n2_("Size")+": </b>"+n2_sprintf(n2_("Between %s and %s pixels."),i,s)),this.$infoTip.data("formTip")?this.$infoTip.data("formTip").setDescription(t.join("<br>")):this.$infoTip.data("tip-description",t.join("<br>"))},t.prototype.updateFrameScrollTop=function(t){this.frameScrollTop=t.scrollTop,this.updateActive()},t.prototype.updateDeviceInfo=function(t){this.sliderInfos[t.id]===e&&(this.sliderInfos[t.id]=new r(this,t.id)),this.sliderInfos[t.id].update(t),this.updateActive()},t.prototype.updateActive=function(){var t,e=!1,i=Number.POSITIVE_INFINITY;for(t in this.sliderInfos)this.sliderInfos[t].top<i&&(i=this.sliderInfos[t].top,e=this.sliderInfos[t]);for(t in this.sliderInfos)this.sliderInfos[t].top<=this.frameScrollTop&&e.top<this.sliderInfos[t].top&&(e=this.sliderInfos[t]);this.activeInfo!==e&&(this.activeInfo=e,this.updateInfo(e))},t.prototype.updateInfo=function(t){this.activeInfo===t&&this.setInfo(this.activeInfo.device,this.activeInfo.isLandscape,this.activeInfo.minScreenWidth,this.activeInfo.maxScreenWidth)},a.prototype.activate=function(){this.$bar.addClass("n2_preview__ruler_device--active")},a.prototype.deActivate=function(){this.$bar.removeClass("n2_preview__ruler_device--active")},a.prototype.getLabel=function(){return this.label+" "+this.width+" x "+this.height+"px"},a.prototype.refreshScale=function(){var t=this.width*this.sliderPreview.scale;this.$bar.css({width:t+"px",marginLeft:-t/2+"px"})},r.prototype.update=function(t){this.device=i[t.device],this.isLandscape=t.isLandscape,this.minScreenWidth=t.minScreenWidth,this.maxScreenWidth=t.maxScreenWidth,this.top=t.top,this.sliderPreview.updateInfo(this)},t}),N2D("TallSlideDetector",function(i,t){function l(t){this.slider=t,this.slider.visible(this.onVisible.bind(this))}return l.threshold=.7,l.prototype.onVisible=function(){this.responsive=this.slider.responsive;for(var t=0;t<this.slider.visibleRealSlides.length;t++)if(this.slider.visibleRealSlides[t].isCurrentlyEdited()){this.editedSlide=this.slider.visibleRealSlides[t];break}this.$noticeMarker=i(".n2_device_changer__button");var e=i(".n2_device_tester");this.$notice=i('<div class="n2_slide_editor_tall_slide_detector"></div>').appendTo(e),this.$label=i('<div class="n2_slide_editor_tall_slide_detector__label"></div>').appendTo(this.$notice),this.$description=i('<div class="n2_slide_editor_tall_slide_detector__description"></div>').appendTo(this.$notice),setTimeout(function(){this.slider.sliderElement.on("SliderResize",NextendDeBounce(this.update.bind(this),300)),this.update()}.bind(this),1e3)},l.prototype.update=function(){var t,e,i,s=this.responsive.minimumSlideHeight,n=Number.POSITIVE_INFINITY,o=[];for(r=0;r<this.slider.visibleRealSlides.length;r++)if((e=this.slider.visibleRealSlides[r])===this.editedSlide){t=Math.max(e.$layer.data("contentHeight"),s);break}for(r=0;r<this.slider.visibleRealSlides.length;r++)(e=this.slider.visibleRealSlides[r])!==this.editedSlide&&(i=Math.max(e.$layer.data("contentHeight"),s),n=Math.min(n,i),t<i*l.threshold&&o.push(e));if(n<t*l.threshold)this.$label.text(n2_("Slide height probably too high")),this.$description.text(n2_("The height of this slide is much higher than others so it will increase the height of the other slides.")),this.$notice.addClass("n2_slide_editor_tall_slide_detector--visible"),this.$noticeMarker.addClass("n2_device_changer__button--marked");else if(o.length){this.$label.text(n2_("Slide height increased"));for(var a=[],r=0;r<o.length;r++)a.push('<a href="'+window.location.href.replace(/slideid=[0-9]+/,"slideid="+o[r].group.$element.data("id"))+'">'+o[r].group.$element.data("title")+"</a>");this.$description.html(n2_sprintf(n2_("The height of this slide increased because the following slides are much higher: %s."),a.join(", "))),this.$notice.addClass("n2_slide_editor_tall_slide_detector--visible"),this.$noticeMarker.addClass("n2_device_changer__button--marked")}else this.$notice.removeClass("n2_slide_editor_tall_slide_detector--visible"),this.$noticeMarker.removeClass("n2_device_changer__button--marked")},l}),N2D("SliderChangeType",function(e,t){function i(t){(nextend.changeSliderType=this).options=e.extend({types:{},currentType:"simple",ajaxUrl:""},t),N2R("documentReady",this.onReady.bind(this))}return i.prototype.onReady=function(){e(".n2_slider_action__change_slider_type").on("click",this.showModal.bind(this))},i.prototype.showModal=function(t){t&&t.preventDefault();var e=new N2Classes.ModalSimple("activate",{destroyOnHide:!0,width:630});e.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--convert","blue")),e.addContent(N2Classes.UI.modalHeading(n2_("Change slider type")));t=N2Classes.UI.modalFormRow(!0);e.addContent(t),N2Classes.UI.modalNotice(t,n2_("Changing your slider type is irreversible. After changing your slider type, <b>you will lose all slider type related settings</b>."),"notice");t=N2Classes.UI.modalFormRow(!0);e.addContent(t);var i=N2Classes.UI.modalFieldSelectIcon(t,"slider-type",n2_("Slider type"),this.options.types,this.options.currentType),t=N2Classes.UI.modalButton(n2_("Convert"),"blue");e.addButton(t),t.on("click",function(t){t.preventDefault(),this.convertSliderType(i.val()),e.hide()}.bind(this)),e.show()},i.prototype.convertSliderType=function(t){this.options.currentType!==t&&N2Classes.AjaxHelper.ajax({type:"POST",url:this.options.ajaxUrl,data:{targetSliderType:t},dataType:"json"}).done(function(){window.location.reload()})},i}),N2D("CreateSlider",function(m,t){function e(t,e,i,s,n,o){this.groupID=t,this.ajaxUrl=e,this.userEmail=s,this.shouldSkipLicenseModal=i,this.skipNewsletter=n,this.importUrl=o,m(".n2_slider_manager__new_slider").on("click",this.createProject.bind(this)),"createslider"===window.location.hash.substring(1)&&this.createProject()}return e.prototype.createProject=function(){var e=new N2Classes.ModalSimple("new-project",{destroyOnHide:!0,width:1e3}),t=m('<div class="n2_new_project"></div>');e.addContent(t),m('<div class="n2_new_project__heading"></div>').text(n2_("What do you want to create today?")).appendTo(t),m('<div class="n2_new_project__sub_heading"></div>').text(n2_("Use our powerful visual editor, or simply import one of our existing template.")).appendTo(t);var i=m('<div class="n2_new_project__boxes"></div>').appendTo(t),s=m('<div class="n2_new_project__box"></div>').on("click",function(t){this.shouldSkipLicenseModal?this.createSlider():N2Classes.License.get().showActivationModalSkippable().done(this.createSlider.bind(this)),e.hide(t)}.bind(this)).appendTo(i);m('<div class="n2_new_project__box_illustration"><img src="'+nextend.imageHelper.fixed("$ss3-admin$/images/sliders/newproject.svg")+'" alt="" width="160" /></div>').appendTo(s),m('<div class="n2_new_project__box_heading"></div>').text(n2_("Create a New Project")).appendTo(s),m('<div class="n2_new_project__box_sub_heading"></div>').text(n2_("Start a new project from scratch and build exactly what youve imagined. You can easily customize every pixels and create anything with layers.")).appendTo(s);i=m('<div class="n2_new_project__box"></div>').on("click",function(t){N2Classes.License.get().showActivationModal().done(this.showExampleSlidersWindow.bind(this)),e.hide(t)}.bind(this)).appendTo(i);m('<div class="n2_new_project__box_illustration"><img src="'+nextend.imageHelper.fixed("$ss3-admin$/images/sliders/template.svg")+'" alt="" width="160" /></div>').appendTo(i),m('<div class="n2_new_project__box_heading"></div>').text(n2_("Start with a Template")).appendTo(i),m('<div class="n2_new_project__box_sub_heading"></div>').text(n2_("Start with a template and make it your own with the innovative drag and drop interface. You can choose from hundreds of premade templates.")).appendTo(i),m('<a class="n2_new_project__import" href="'+this.importUrl+'"></a>').text(n2_("or import your own files")).appendTo(t),e.show()},e.prototype.createSlider=function(){var t=new N2Classes.ModalSimple("create-new-project",{destroyOnHide:!0,width:900}),e=m('<div class="n2_create_new_project"></div>');t.addContent(e),m('<div class="n2_create_new_project__heading"></div>').text(n2_("Create new project")).appendTo(e);function i(){var t=n.val(),e="simple";o.toggleClass("n2_form_element--hidden","block"===t),e=a.val(),"block"===t&&(e="block"),c.toggleClass("n2_form_element--hidden","showcase"!==e&&"carousel"!==e),f.toggleClass("n2_form_element--hidden","showcase"!==e&&"carousel"!==e),t=h.data("field"),"simple"!==e&&"block"!==e?("fullpage"===h.val()&&t.insideChange("fullwidth"),t.select.find('option[value="fullpage"]').remove()):0===t.select.find('option[value="fullpage"]').length&&t.select.append('<option value="fullpage">'+n2_("Full page")+"</option>")}var s=N2Classes.UI.modalFormRowLarge().appendTo(e),n=N2Classes.UI.modalFieldSelectIcon(s,"project-type",n2_("Project type"),{slider:{icon:"ssi_64 ssi_64--fullwidthslider",label:n2_("Slider")},block:{icon:"ssi_64 ssi_64--block",label:n2_("Block")}},"slider");n.on("nextendChange",i);var o=N2Classes.UI.modalFormContainer(e,"slider-settings-container"),s=N2Classes.UI.modalFormRowLarge().appendTo(o),a=N2Classes.UI.modalFieldSelectIcon(s,"slider-type",n2_("Slider type"),{simple:{icon:"ssi_64 ssi_64--slider",label:n2_("Simple")},carousel:{icon:"ssi_64 ssi_64--carousel",label:n2_("Carousel")},showcase:{icon:"ssi_64 ssi_64--showcase",label:n2_("Showcase")}},"simple");a.on("nextendChange",i),N2Classes.UI.modalSubHeading(n2_("Settings")).appendTo(e);var s=N2Classes.UI.modalFormRow().appendTo(e),r=N2Classes.UI.modalFieldText(s,"project-name",n2_("Name"),n2_("My project")).css("width",200),l=N2Classes.UI.modalNumber(s,"slider-width",n2_("Width"),1200,{min:200,unit:"px"}),d=N2Classes.UI.modalNumber(s,"slider-height",n2_("Height"),600,{min:100,unit:"px"}),e={boxed:n2_("Boxed"),fullwidth:n2_("Full width"),fullpage:n2_("Full page")},h=N2Classes.UI.modalSelect(s,"slider-responsive-mode",n2_("Layout"),e,"fullwidth"),p=N2Classes.UI.modalNumber(s,"slide-width",n2_("Slide width"),600,{min:200,unit:"px"}),c=p.closest(".n2_field"),u=N2Classes.UI.modalNumber(s,"slide-height",n2_("Slide height"),400,{min:100,unit:"px"}),f=u.closest(".n2_field"),s=N2Classes.UI.modalButton(n2_("Create"),"green").on("click",function(t){t.preventDefault();t={groupID:this.groupID,projectName:r.val(),projectType:n.val(),sliderWidth:parseInt(l.val()),sliderHeight:parseInt(d.val()),responsiveMode:h.val()};t.sliderType=a.val(),t.slideWidth=parseInt(p.val()),t.slideHeight=parseInt(u.val()),N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"create"}),data:t,dataType:"json"}).done(function(t){N2Classes.LoadingScreen.startLoading()}.bind(this))}.bind(this));t.addButton(s),i(),t.show()},e.prototype.showExampleSlidersWindow=function(){var s=this;m("body").css("overflow","hidden");function n(){m("body").css("overflow",""),t.remove(),window.removeEventListener("message",e,!1)}var t=m('<iframe src="//smartslider3.com/demo-import/?pro=1&version='+N2SS3VERSION+"&utm_campaign="+N2SS3C+"&utm_source=import-slider-frame&utm_medium=smartslider-"+N2PLATFORM+'-pro"></iframe>').css({position:"fixed",zIndex:1e5,left:0,top:0,width:"100%",height:"100%"}).appendTo("body"),e=function(t){if("http://smartslider3.com"===t.origin||"https://smartslider3.com"===t.origin){var e,i=t.data;switch(i.key){case"importSlider":return e=i.data.href,void N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(s.ajaxUrl,{nextendaction:"importDemo"}),data:{groupID:s.groupID,key:N2Classes.Base64.encode(e.replace(/^(http(s)?:)?\/\//,"//"))},dataType:"json"}).fail(function(){});case"closeWindow":n()}}};N2Classes.Esc.add(function(){return n(),!0}.bind(this)),window.addEventListener("message",e,!1)},e.prototype.joinCommunity=function(e){function i(t,e){N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(N2Classes.AjaxHelper.getAdminUrl("ss3-admin"),{nextendcontroller:"settings",nextendaction:e||"dismissNewsletterSampleSliders"}),dataType:"json"})}this.modal=new N2Classes.ModalSimple("url-modal"),this.modal.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--newsletter","purple")),this.modal.addContent(N2Classes.UI.modalHeading(n2_("Join The Smart Slider 3 Community"))),this.modal.addContent(N2Classes.UI.modalParagraph(n2_("Join more than 120,000 subscribers and get access to the latest slider templates, tips, tutorials and other exclusive contents directly to your inbox.")).css("margin-bottom","12px")),this.modal.$modalBody.css("text-align","center");var s=m("<form></form>");s.append(N2Classes.UI.modalInput("EMAIL","email","","example@google.com")),s.append(N2Classes.UI.modalInput(N2PLATFORM.toUpperCase(),"hidden","Yes")),s.append(N2Classes.UI.modalInput("SOURCE","hidden","Smart Slider 3")),this.modal.addContent(s);var t=N2Classes.UI.modalButton(n2_("Subscribe"),"purple");this.modal.addButton(t),t.on("click",function(t){N2Classes.AjaxHelper.ajax({type:"POST",url:"https://secure.nextendweb.com/mailchimp/subscribe.php",data:s.serialize(),dataType:"json"}).done(function(){e()}),i(0,"subscribed")}.bind(this)),this.modal.$modalBodyOuter.find(".n2_modal__close").on("click",function(t){i(),e()}),this.modal.show()},e}),N2D("SliderEdit",function(n,o){function t(t){this.options=n.extend({previewInNewWindow:!1,saveAjaxUrl:"",previewUrl:"",ajaxUrl:"",formData:{}},t),this.url=this.options.ajaxUrl,this.values=this.options.formData,N2Classes.Form.prototype.constructor.call(this),N2R("documentReady",this.onReady.bind(this))}return((t.prototype=Object.create(N2Classes.Form.prototype)).constructor=t).prototype.onReady=function(){this.setID("#n2-ss-edit-slider-form"),N2Classes.Form.prototype.onReady.call(this),this.$form.on("submit",this.onSaveSubmit.bind(this)),this.initPreview()},t.prototype.onKeyDown=function(t){var e=!1;return(t.ctrlKey||t.metaKey)&&49===t.keyCode&&(this.showPreview(),e=!0),e?t.preventDefault():e=N2Classes.Form.prototype.onKeyDown.call(this,t),e},t.prototype.initButtons=function(){this.$saveButton=n(".n2_slider_settings_save").on("click",this.actionSave.bind(this)),n(".n2_slider_settings_back").on("click",this.actionCancel.bind(this))},t.prototype.actionSave=function(t){t&&t.preventDefault(),this.skipChangeConfirm=!0,this.$form.submit()},t.prototype.actionCancel=function(t){t&&t.preventDefault(),window.location=t.currentTarget.href},t.prototype.onSaveSubmit=function(t){this.$form.attr("target")===o&&(t.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:this.options.saveAjaxUrl,data:this.$form.serialize(),dataType:"json",success:this.onAfterSave.bind(this)}))},t.prototype.onAfterSave=function(t){if(n(".n2_header__heading_primary").text(n("#slidertitle").val()),t&&t.data&&t.data.changedFields){for(var e in t.data.changedFields)t.data.changedFields.hasOwnProperty(e)&&n("#"+e).val(t.data.changedFields[e]);var i,s;t.data.changedFields.slideralias!==o&&(i=t.data.changedFields[e],(s=n('.n2_ss_slider_publish__option_code[data-mode="alias"]')).length||(s=n('<div class="n2_ss_slider_publish__option_code" data-mode="alias"></div>').insertAfter(n('.n2_ss_slider_publish__option_code[data-mode="id"]'))),i?s.text('[smartslider3 alias="'+i+'"]'):s.remove())}this.afterSave()},t.prototype.initPreview=function(){this.options.previewInNewWindow||(this.modal=new N2Classes.ModalIframe("preview-slider")),n(".n2_top_bar_main__preview").on("click",function(t){t.preventDefault(),this.showPreview()}.bind(this))},t.prototype.showPreview=function(){"main"===N2Classes.WindowManager.getCurrentWindow()&&(this.options.previewInNewWindow?N2Classes.PreviewPopup("","preview-slider"):this.modal.show(),this.$form.attr({action:N2Classes.AjaxHelper.makeAjaxUrl(this.options.previewUrl,{nextendaction:this.options.previewInNewWindow?"index":"slider"}),target:"preview-slider"}).submit().attr({action:this.formAction,target:null}))},t}),N2D("SliderImport",function(t,e){function i(t){N2Classes.Form.prototype.constructor.call(this),N2R("documentReady",this.onReady.bind(this))}return((i.prototype=Object.create(N2Classes.Form.prototype)).constructor=i).prototype.onReady=function(){this.setID("#n2-ss-form-slider-import"),N2Classes.Form.prototype.onReady.call(this),this.$localImportSwitch=t("#sliderupload_or_local"),this.$localImport=t("#sliderlocal-import-file"),this.$uploadImport=t("#sliderimport-file"),this.$form.on("submit",this.onSubmit.bind(this))},i.prototype.onChange=function(){this.hasChange=!1,parseInt(this.$localImportSwitch.val())?""!==this.$localImport.val()&&(this.hasChange=!0):""!==this.$uploadImport.val()&&(this.hasChange=!0),this.$saveButton.toggleClass("n2_button--inactive",!this.hasChange)},i.prototype.initButtons=function(){this.$saveButton=t(".n2_slider_import").on("click",this.actionSave.bind(this)),t(".n2_slider_import_back").on("click",this.actionCancel.bind(this))},i.prototype.actionSave=function(t){t&&t.preventDefault(),this.skipChangeConfirm=!0,this.$form.submit(),this.afterSave()},i.prototype.actionCancel=function(t){t&&t.preventDefault(),window.location=t.currentTarget.href},i.prototype.onSubmit=function(t){t.preventDefault();t=new FormData(this.$form[0]);N2Classes.AjaxHelper.ajax({type:"POST",contentType:!1,url:this.$form.attr("action"),processData:!1,data:t,dataType:"json"})},i}),N2D("ManageSliders",function(d,t){function e(t,e,i){this.groupID=t,this.exportAllUrl=e.exportAllUrl,this.ajaxUrl=e.ajaxUrl,this.previewUrl=e.previewUrl,this.importUrl=e.importUrl,this.sliders=[],this.sliderPanel=d(".n2_slider_manager"),this.orderBy="ordering"===this.sliderPanel.data("orderby"),this.slidersContainer=this.sliderPanel.find(".n2_slider_manager__content");for(var s=this.slidersContainer.find(".n2_slider_box"),n=0;n<s.length;n++)this.sliders.push(new N2Classes.Slider(this,s.eq(n)));this.changed(),this.initOrderable(),this.create=new N2Classes.CreateSlider(t,this.ajaxUrl,i,e.userEmail,e.skipNewsletter,this.importUrl),d(".n2_slider_create_group").on("click",function(t){t.preventDefault(),this.showCreateGroup()}.bind(this)),this.initBulk()}return e.prototype.showCreateGroup=function(){N2Classes.ModalCreateGroup.init(this,this.ajaxUrl),N2Classes.ModalCreateGroup.show()},e.prototype.changed=function(){d("html").attr("data-sliders",this.sliders.length)},e.prototype.initSliders=function(){for(var t=this.slidersContainer.find(".n2_slider_box"),e=[],i=0;i<t.length;i++){var s=t.eq(i).data("slider");e.push(s)}this.sliders=e,this.changed(),d(window).triggerHandler("SmartSliderSidebarSlidersChanged")},e.prototype.initOrderable=function(){var t;this.orderBy&&((t={helper:"clone",items:"> .n2_slider_box",stop:this.saveOrder.bind(this),placeholder:"n2_slider_manager__sortable_placeholder",distance:10,droppables:"n2_slider_box--group"}).over=function(t,e){e.droppable.addClass("n2_slider_box--drop-target"),e.helper.addClass("n2_slider_box--drop-instance")}.bind(this),t.out=function(t,e){e.helper.removeClass("n2_slider_box--drop-instance"),e.droppable.removeClass("n2_slider_box--drop-target")}.bind(this),t.drop=function(t,e){this._addToGroup("move",e.droppable.data("slider").getId(),[e.item.data("slider").getId()])}.bind(this),this.uiSortable=new N2Classes.UISortable(this.slidersContainer,t))},e.prototype.saveOrder=function(t,e){for(var i=this.slidersContainer.find(".n2_slider_box"),s=[],n=[],o=[],a=0;a<i.length;a++){var r=i.eq(a).data("slider");s.push(r),n.push(r.getId())}for(a=0;a<this.sliders.length;a++)o.push(this.sliders[a].getId());JSON.stringify(o)!==JSON.stringify(n)&&(d(window).triggerHandler("SmartSliderSidebarSlidersOrderChanged"),N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendcontroller:"sliders",nextendaction:"order"}),data:{groupID:this.groupID,sliderorder:n,isReversed:"DESC"===this.sliderPanel.data("orderbydirection")?1:0}}),this.sliders=s)},e.prototype.trashSliders=function(t,e){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendcontroller:"sliders",nextendaction:"trash"}),type:"POST",data:{groupID:this.groupID,sliders:t}}).done(function(){for(var t=0;t<e.length;t++)e[t].remove();this.initSliders(),this.leaveBulk()}.bind(this))},e.prototype.duplicateSliders=function(t,e){for(var i=0;i<this.sliders.length;i++)this.sliders[i].selected&&this.sliders[i].duplicate(d.Event("click",{currentTarget:null}))},e.prototype.exportSliders=function(t,e){window.location.href=N2Classes.N2QueryString.add_query_arg({sliders:t},this.exportAllUrl)},e.prototype.initBulk=function(){this.selection=[],this.isBulkSelection=!1,d("#n2_slider_manager_bulk_actions a[data-action]").on("click",function(t){switch(t.preventDefault(),d(t.currentTarget).data("action")){case"duplicate":this.bulkAction("duplicateSliders",!1);break;case"trash":this.bulkAction("trashSliders",!1);break;case"export":this.bulkAction("exportSliders",!1);break;case"select-all":this.bulkSelect(function(t){t.select()});break;case"select-none":this.bulkSelect(function(t){t.deSelect()})}}.bind(this))},e.prototype.addSelection=function(t){0===this.selection.length&&this.enterBulk(),this.selection.push(t)},e.prototype.removeSelection=function(t){this.selection.splice(this.selection.indexOf(t),1),0===this.selection.length&&this.leaveBulk()},e.prototype.bulkSelect=function(t){for(var e=0;e<this.sliders.length;e++)t(this.sliders[e])},e.prototype.bulkAction=function(t,e){var i=[],s=[];this.bulkSelect(function(t){!t.selected||e&&t.isGroup||(i.push(t),s.push(t.getId()))}),s.length?(this[t](s,i),this.leaveBulk()):e?N2Classes.Notification.notice("Please select one or more sliders for the action!"):N2Classes.Notification.notice("Please select one or more sliders or groups for the action!")},e.prototype.enterBulk=function(){this.isBulkSelection||(this.isBulkSelection=!0,this.orderBy&&this.uiSortable.setOption("disabled",!0),d("body").addClass("n2_body--bulk-select"))},e.prototype.leaveBulk=function(){if(this.isBulkSelection){this.orderBy&&this.uiSortable.setOption("disabled",!1),d("body").removeClass("n2_body--bulk-select");for(var t=0;t<this.sliders.length;t++)this.sliders[t].deSelect();this.selection=[],this.isBulkSelection=!1}},e.prototype.changeGroup=function(l){N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"getGroupInfoBySliderID"}),data:{sliderID:l},dataType:"json"}).done(function(t){var e=t.data.groups,o=t.data.linkedTo,a=new N2Classes.ModalSimple("create-group",{destroyOnHide:!0,width:440});a.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--group","green")),a.addContent(N2Classes.UI.modalHeading(n2_("Change group")));t=N2Classes.UI.modalFormRow(!0);a.addContent(t);for(var i={0:n2_("Dashboard")},s=0;s<e.length;s++)i[e[s].id]=e[s].title;var r=N2Classes.UI.modalSelect(t,"linkedTo",n2_("Groups"),i,o,{isMultiple:!0}),t=N2Classes.UI.modalButton(n2_("Set"),"green");a.addButton(t),t.on("click",function(t){t.preventDefault();for(var e=""===r.val()?["0"]:r.val().split("||"),s=[],n=[],i=0;i<o.length;i++)-1===e.indexOf(o[i])&&s.push(o[i]);for(i=0;i<e.length;i++)-1===o.indexOf(e[i])&&n.push(e[i]);(s.length||n.length)&&N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"changeGroup"}),data:{sliderID:l,toLink:n,toDelete:s},dataType:"json"}).done(function(){for(var t=0;t<s.length;t++)if(s[t]===this.groupID){d('.n2_slider_box[data-sliderid="'+l+'"]').data("slider").remove(),this.initSliders();for(var e=0;e<n.length;e++){var i=d('.n2_slider_box--group[data-sliderid="'+n[e]+'"] .n2_slider_box__footer_children_count');i.html(parseInt(i.html())+1)}break}this.leaveBulk(),a.hide()}.bind(this))}.bind(this)),a.show()}.bind(this))},e.prototype._addToGroup=function(s,n,o){return N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"addToGroup"}),data:{currentGroupID:this.groupID,groupID:n,actionType:s,sliders:o},dataType:"json"}).done(function(t){if("move"===s){for(var e=0;e<o.length;e++)d('.n2_slider_box[data-sliderid="'+o[e]+'"]').data("slider").remove();this.initSliders()}var i=d('.n2_slider_box--group[data-sliderid="'+n+'"] .n2_slider_box__footer_children_count');i.html(parseInt(i.html())+o.length)}.bind(this))},e}),N2D("ParticleAdminManager",function(o,t){var s={preset:0,custom:"",color:"FFFFFF80","line-color":"FFFFFF66",speed:2,number:28,hover:"off",click:"off",mobile:0};function e(t,i){window.ssForceFullHorizontalSelector=".n2_slider_preview_area__inner",N2R("#n2-ss-"+t,function(t,e){this.slider=e,this.types=i,this.fields={},this.values=t.extend({},s),this.isReady=!1,this.registerFields(),this.slider.ready(this.onVisible.bind(this)),this.updateParticle=NextendThrottle(this.updateParticle,33),window.parent!==window&&t(window).on("keydown keyup keypress",function(t){27==t.keyCode&&this.postMessage("cancel")}.bind(this)),t("#n2-ss-form-cancel").on("click",function(t){t.preventDefault(),this.postMessage("cancel")}.bind(this)),t("#n2-ss-form-save").on("click",function(t){t.preventDefault(),this.postMessage("save",this.getValues())}.bind(this)),window.addEventListener("message",this.onMessage.bind(this),!1),this.slider.ready(function(){this.postMessage("ready")}.bind(this))}.bind(this))}return e.prototype.getValues=function(){if("0"==this.values.preset)return JSON.stringify(!1);var t=o.extend({},this.values);return""!=t.custom&&(t.custom=JSON.parse(t.custom.replace(/\/\*.*?\*\//,""))),JSON.stringify(t)},e.prototype.postMessage=function(t){var e=1<arguments.length?arguments[1]:!1;parent.postMessage(JSON.stringify({action:t,data:e}),"*")},e.prototype.onMessage=function(t){if(t.source==parent)try{var e=JSON.parse(t.data);if("load"===e.action)try{var i=JSON.parse(e.data);!1===i?this.loadValues(s):this.loadValues(i)}catch(t){this.loadValues(s)}}catch(t){console.error(t)}},e.prototype.registerFields=function(){this.registerField("preset"),this.registerField("mobile"),this.registerField("color"),this.registerField("line-color"),this.registerField("speed"),this.registerField("number"),this.registerField("hover"),this.registerField("click"),this.registerField("custom")},e.prototype.onVisible=function(){this.isReady=!0,this.updateParticle()},e.prototype.updateParticle=function(){var t=this.slider.plugins.get("particleJS");if(t){var e=this.getValue("preset");if(0==e)return o(window).trigger("resize"),void(t.pJS&&(t.pJS.pJS.fn.vendors.destroypJS(),t.pJS=!1));var i={};if("custom"==e){o(window).trigger("resize");var s=this.getValue("custom").replace(/\/\*.*?\*\//,"");if(""==s)return void(t.pJS&&(t.pJS.pJS.fn.vendors.destroypJS(),t.pJS=!1));try{i=JSON.parse(s)}catch(t){alert("Invalid JSON data in custom field.")}}else{o(window).trigger("resize"),i=JSON.parse(this.types[e]);var n=N2Color.colorToSVG(this.getValue("color"));i.particles.color.value=n[0],i.particles.opacity.value=n[1];var n=N2Color.colorToSVG(this.getValue("line-color"));i.particles.line_linked.color=n[0],i.particles.line_linked.opacity=n[1],i.particles.number.value=this.getValue("number"),i.particles.move.speed=parseInt(this.getValue("speed"));n=this.getValue("hover");"0"==n?i.interactivity.events.onhover.enable=0:(i.interactivity.events.onhover.enable=1,i.interactivity.events.onhover.mode=n);n=this.getValue("click");"0"==n?i.interactivity.events.onclick.enable=0:(i.interactivity.events.onclick.enable=1,i.interactivity.events.onclick.mode=n)}i.interactivity.detect_on=this.slider.sliderElement[0],t.pJS?(n=t.pJS.pJS,o.extend(!0,t.pJS.pJS,i),n.tmp.obj={size_value:n.particles.size.value,size_anim_speed:n.particles.size.anim.speed,move_speed:n.particles.move.speed,line_linked_distance:n.particles.line_linked.distance,line_linked_width:n.particles.line_linked.width,mode_grab_distance:n.interactivity.modes.grab.distance,mode_bubble_distance:n.interactivity.modes.bubble.distance,mode_bubble_size:n.interactivity.modes.bubble.size,mode_repulse_distance:n.interactivity.modes.repulse.distance},t.pJS.pJS.fn.particlesRefresh()):t.start(i)}},e.prototype.registerField=function(t){this.fields[t]=o("#slider"+t).on("nextendChange",function(){this.values[t]=this.fields[t].val(),this.isReady&&this.updateParticle()}.bind(this))},e.prototype.loadValues=function(t){for(var e in"object"==typeof t.custom&&(t.custom=JSON.stringify(t.custom,null,2)),this.values=o.extend({},s,t),this.fields)this.fields[e].data("field").insideChange(this.getValue(e))},e.prototype.getValue=function(t){return this.values[t]},e}),N2D("SelectSlider",function(a,e){var s=!1;function n(){this.cache={},this.ajaxUrl=N2Classes.AjaxHelper.makeAjaxUrl(N2Classes.AjaxHelper.getAdminUrl("ss3-admin"),{nextendcontroller:"sliders",nextendaction:"list"}),this.modal=new N2Classes.ModalLightbox("","select-slider"),this.modal.insertButton=N2Classes.UI.modalButton(n2_("Insert"),"green").addClass("n2_button--inactive"),this.modal.addButton(this.modal.insertButton),this.modal.insertButton.on("click",function(t){this.insertSlider(t)}.bind(this)),this.$content=a('<div class="n2_modal_select_slider"></div>'),this.modal.addContent(this.$content)}return n.prototype.setSkipGroup=function(t){this.skipGroup=t},n.prototype.setTitle=function(t){this.modal.setTitle(t)},n.prototype.displayList=function(t){t===e&&(t=0),this.cache[t]===e?N2Classes.AjaxHelper.ajax({url:this.ajaxUrl,type:"POST",data:{parentID:t}}).done(function(t,e){this.cache[t]=e.data,this.renderResponse(t,e.data)}.bind(this,t)):this.renderResponse(t,this.cache[t])},n.prototype.renderResponse=function(e,t){this.$content.html(""),this.selectedSlider=[0],this.modal.insertButton.addClass("n2_button--inactive"),0<e&&(a('<div class="n2_slider_box__content"></div>').append(a('<div class="n2_modal_select_slider__box n2_slider_box"></div>').append(a('<div class="n2_slider_box__icon n2_slider_box__icon_grey"></div>').append(a('<div class="n2_slider_box__icon_container"><i class="ssi_64 ssi_64--folderup"></i></div>')).append(a('<div class="n2_slider_box__icon_text">'+n2_("Up")+"</div>")))).appendTo(this.$content).on("click",this.displayList.bind(this,0)),this.skipGroup||a('<div class="n2_slider_box__content"></div>').append(a('<div class="n2_modal_select_slider__box n2_slider_box"></div>').append(a('<div class="n2_slider_box__icon n2_slider_box__icon_grey"></div>').append(a('<div class="n2_slider_box__icon_container"><i class="ssi_64 ssi_64--folder"></i></div>')).append(a('<div class="n2_slider_box__icon_text">'+n2_("Insert group")+"</div>")))).appendTo(this.$content).on("click",function(t){this.selectedSlider=[e],this.insertSlider(t)}.bind(this)));for(var i=0;i<t.length;i++){var s=t[i],n=a('<div class="n2_slider_box__slider_identifiers"></div>').append(a('<div class="n2_slider_box__slider_identifier"></div>').text("#"+s.id));s.isGroup&&n.append(a('<div class="n2_slider_box__slider_identifier"></div>').text(n2_("Group"))),s.alias&&n.append(a('<div class="n2_slider_box__slider_identifier"></div>').text(s.alias));var o="ssi_64 ssi_64--image";s.isGroup&&(o="ssi_64 ssi_64--folder");o=a('<div class="n2_slider_box__icon"><div class="n2_slider_box__icon_container"><i class="'+o+'"></i></div></div>'),n=a('<div class="n2_slider_box__content"></div>').append(n);""===s.thumbnail&&n.append(o);o=a('<div class="n2_slider_box__footer"></div>');s.isGroup&&o.append(a('<div class="n2_slider_box__footer_icon"><i class="ssi_16 ssi_16--folderclosed"></i></div>'));o=a('<div class="n2_modal_select_slider__box n2_slider_box"></div>').css("background-image","url("+s.thumbnail+")").append(n).append(o.append(a('<div class="n2_slider_box__footer_title"></div>').text(s.title)).append(a('<div class="n2_slider_box__footer_children_count"></div>').text(s.childrenCount))).appendTo(this.$content);s.isGroup?o.addClass("n2_slider_box--group").on("click",this.displayList.bind(this,s.id)):o.addClass("n2_slider_box--slider").on("click",this.select.bind(this,s.id,s.alias,e))}},n.prototype.select=function(t,e,i,s){this.$content.find(".n2_slider_box--selected").removeClass("n2_slider_box--selected"),a(s.currentTarget).addClass("n2_slider_box--selected"),this.selectedSlider=[t,e,i],this.modal.insertButton.removeClass("n2_button--inactive")},n.prototype.insertSlider=function(t){var e=this.selectedSlider[0],i=this.selectedSlider[1],s=this.selectedSlider[2];0!==e&&(this.callback.call(window,e,i,s),this.modal.hide(t))},n.prototype.show=function(t){this.callback=t,this.displayList(),this.modal.show()},function(t,e,i){!1===s&&(s=new n),s.setSkipGroup(i),s.setTitle(t),s.show(e)}}),N2D("ShapeDividerAdminManager",function(r,l){var n={type:"0",color:"FFFFFFFF",color2:"FFFFFF80",desktopportraitwidth:100,desktoplandscapewidth:100,tabletportraitwidth:100,tabletlandscapewidth:100,mobileportraitwidth:100,mobilelandscapewidth:100,desktopportraitheight:100,desktoplandscapeheight:100,tabletportraitheight:50,tabletlandscapeheight:50,mobileportraitheight:25,mobilelandscapeheight:25,flip:0,animate:0,speed:100,scroll:0};function t(t,i){window.ssForceFullHorizontalSelector=".n2_slider_preview_area__inner",N2R("#n2-ss-"+t,function(t,e){this.slider=e,this.top=new s(this.slider,this,i,"top"),this.bottom=new s(this.slider,this,i,"bottom"),window.parent!==window&&t(window).on("keydown keyup keypress",function(t){27==t.keyCode&&this.postMessage("cancel")}.bind(this)),t("#n2-ss-form-cancel").on("click",function(t){t.preventDefault(),this.postMessage("cancel")}.bind(this)),t("#n2-ss-form-save").on("click",function(t){t.preventDefault(),this.postMessage("save",this.getValues())}.bind(this)),window.addEventListener("message",this.onMessage.bind(this),!1),this.slider.ready(function(){this.postMessage("ready"),this.initDeviceSwitcherShortcut()}.bind(this))}.bind(this))}function s(t,e,i,s){this.slider=t,this.manager=e,this.types=i,this.side=s,this.devicePrefix="desktopportrait",this.isDeviceBased={},this.fields={},this.values=r.extend({},n),this.tweens=[],this.renderDivider=NextendThrottle(this.renderDivider,33),this.slider.ready(this.onVisible.bind(this))}t.prototype.getValues=function(){return JSON.stringify({top:this.top.getValues(),bottom:this.bottom.getValues()})},t.prototype.postMessage=function(t){var e=1<arguments.length?arguments[1]:!1;parent.postMessage(JSON.stringify({action:t,data:e}),"*")},t.prototype.onMessage=function(t){if(t.source==parent)try{var e=JSON.parse(t.data);if("load"===e.action)try{var i=JSON.parse(e.data);this.top.loadValues(i.top),this.bottom.loadValues(i.bottom)}catch(t){this.top.loadValues(n),this.bottom.loadValues(n)}}catch(t){console.error(t)}},t.prototype.initDeviceSwitcherShortcut=function(){var t,e=r("#n2-admin").find('[data-field="table-shapedivider"]'),i=r('<div id="n2-ss-devicespecific-settings"></div>'),s=this.slider.parameters.responsive.enabledDevices,n={desktopLandscape:"ssi_16--desktoplandscape",desktopPortrait:"ssi_16--desktopportrait",tabletLandscape:"ssi_16--tabletportraitlarge",tabletPortrait:"ssi_16--tabletportrait",mobileLandscape:"ssi_16--mobileportraitlarge",mobilePortrait:"ssi_16--mobileportrait"};for(t in s)s[t]&&i.append('<i class="ssi_16 '+n[t]+'" data-device="'+t+'"></i>');var o={mouseenter:function(t){i.appendTo(t.currentTarget)}.bind(this),mouseleave:function(t){i.detach()}.bind(this)},e=e.find("[data-devicespecific] label").parent(),o=r('<div class="n2_field__label_modifier ssi_16 ssi_16--minidesktopportrait"></div>').on(o);e.prepend(o),i.find(".ssi_16").on({click:function(t){t.preventDefault();t=r(t.currentTarget);r('.n2_device_tester_devices__device[data-device="'+t.data("device")+'"]').trigger("click")}.bind(this)})},s.prototype.loadValues=function(t){for(var e in this.values=r.extend({},n,t),this.renderDivider(),this.fields)this.fields[e].data("field").insideChange(this.getValue(e))},s.prototype.getValues=function(){return 0!=this.values.type&&this.values},s.prototype.onVisible=function(){this.$shapeContainer=this.slider.getSlideBackgroundContainer(),this.registerField("type",!1),this.$fieldGroups=this.fields.type.closest(".n2-element").find(".n2-mixed-group").slice(1).css("display","none"),this.registerField("color",!1),this.registerField("color2",!1),this.$color2Container=this.fields.color2.closest(".n2_field").addClass("n2_form_element--hidden"),this.registerField("flip",!1),this.registerField("animate",!1),this.registerField("speed",!1),this.registerField("width",!0),this.registerField("height",!0),this.registerField("scroll",!1),this.slider.sliderElement.on("SliderDeviceOrientation",this.onDeviceChange.bind(this))},s.prototype.onDeviceChange=function(t,e){for(var i in this.devicePrefix=e.device.toLowerCase(),this.isDeviceBased)this.isDeviceBased[i]&&this.fields[i].data("field").insideChange(this.getValue(i));this.renderDivider()},s.prototype.renderDivider=function(){if(this.tweens.length){for(var t=0;t<this.tweens.length;t++)this.tweens[t].kill();this.tweens=[]}this.slider.sliderElement.find(".n2-ss-shape-divider-"+this.side).remove();var e=this.getValue("type");if(0==e?this.$fieldGroups.css("display","none"):this.$fieldGroups.css("display",""),this.$color2Container.toggleClass("n2_form_element--hidden",!e.match(/bi\-/)),"0"!=e&&this.types[e]!==l){e=this.types[e].replace(/#000000/g,N2Color.hex2rgbaCSS(this.getValue("color"))).replace(/#000010/g,N2Color.hex2rgbaCSS(this.getValue("color2")));"bottom"===this.side?e=parseInt(this.getValue("flip"))?d.mirror(e,!0,!0):d.mirror(e,!1,!0):parseInt(this.getValue("flip"))&&(e=d.mirror(e,!0,!1));e=r("<div class='n2-ss-shape-divider n2-ss-shape-divider-"+this.side+"' style='height:"+this.getValue("height")+"px;'><div style='width:"+this.getValue("width")+"%;margin-left:"+-(this.getValue("width")-100)/2+"%;' class='n2-ss-shape-divider-inner'>"+e+"</div></div>").appendTo(this.$shapeContainer);if(parseInt(this.getValue("animate"))){e.addClass("n2-ss-divider-animate");var i=e.find(".n2-ss-divider-start > *"),s=e.find(".n2-ss-divider-end > *");if(i.parent().attr("yoyo"))for(var n={onComplete:function(){this.reverse()},onReverseComplete:function(){this.restart()}},o=0;o<i.length;o++)this.tweens.push(NextendTween.to(i[o],parseFloat(i.eq(o).attr("duration"))*(100/parseInt(this.getValue("speed"))),r.extend({morphSVG:s[o],delay:0,ease:"easeInOut"},n,{delay:i.eq(o).attr("delay"),ease:i.eq(o).attr("ease")})));else{for(var a=new NextendTimeline({onComplete:function(){this.restart()}}),o=0;o<i.length;o++)a.to(i[o],parseFloat(i.eq(o).attr("duration"))*(100/parseInt(this.getValue("speed"))),r.extend({morphSVG:s[o],delay:0,ease:"easeOutCubic"},{delay:i.eq(o).attr("delay"),ease:i.eq(o).attr("ease")}),0);a.to({x:0},2,{x:10}),this.tweens.push(a)}}}},s.prototype.registerField=function(t,e){this.isDeviceBased[t]=e,this.fields[t]=r("#slidershapedivider-"+this.side+"-"+t).on("nextendChange",function(){e?this.values[this.devicePrefix+t]=this.fields[t].val():this.values[t]=this.fields[t].val(),this.renderDivider()}.bind(this))},s.prototype.getValue=function(t){return this.isDeviceBased[t]?this.values[this.devicePrefix+t]==l||""==this.values[this.devicePrefix+t]?this.values["desktopportrait"+t]:this.values[this.devicePrefix+t]:this.values[t]};var d={viewBoxX:0,viewBoxY:0,mirror:function(t,e,i){var s;if(e&&i)s=this.xy;else if(e)s=this.x;else{if(!i)return t;s=this.y}i=t.match(/(viewBox)=['"](.*?)['"]/i),i=i[i.length-1].split(" ");return this.viewBoxX=parseInt(i[2]),this.viewBoxY=parseInt(i[3]),t.replace(/(points|d)=[\'"](.*?)[\'"]/gi,s.bind(this))},x:function(t,e,i){if("points"===e){for(r=i.split(" "),o=0;o<r.length;o+=2)r[o]=this.viewBoxX-parseFloat(r[o]);return'points="'+r.join(" ")+'"'}if("d"===e){for(var s=(i=i.substr(0,i.length-1)).split(" "),n="",o=0;o<s.length;o++){for(var a=s[o].substr(0,1),r=s[o].substr(1).split(","),l=0;l<r.length;l+=2)switch(a){case"l":case"m":case"h":case"c":case"s":case"q":case"t":r[l]=-parseFloat(r[l]);break;case"L":case"M":case"H":case"C":case"S":case"Q":case"T":r[l]=this.viewBoxX-parseFloat(r[l])}n+=a+r.join(",")}return'd="'+n+'z"'}},y:function(t,e,i){if("points"===e){for(r=i.split(" "),o=1;o<r.length;o+=2)r[o]=this.viewBoxY-parseFloat(r[o]);return'points="'+r.join(" ")+'"'}if("d"===e){for(var s=(i=i.substr(0,i.length-1)).split(" "),n="",o=0;o<s.length;o++){for(var a=s[o].substr(0,1),r=s[o].substr(1).split(","),l=0;l<r.length;l+=2)switch(a){case"v":r[l]=-parseFloat(r[l]);break;case"V":r[l]=this.viewBoxY-parseFloat(r[l]);break;case"l":case"m":case"c":case"s":case"q":case"t":r[l+1]=-parseFloat(r[l+1]);break;case"L":case"M":case"C":case"S":case"Q":case"T":r[l+1]=this.viewBoxY-parseFloat(r[l+1])}n+=a+r.join(",")}return'd="'+n+'z"'}},xy:function(t,e,i){if("points"===e){for(r=i.split(" "),o=0;o<r.length;o+=2)r[o]=this.viewBoxX-parseFloat(r[o]),r[o+1]=this.viewBoxY-parseFloat(r[o+1]);return'points="'+r.join(" ")+'"'}if("d"===e){for(var s=(i=i.substr(0,i.length-1)).split(" "),n="",o=0;o<s.length;o++){for(var a=s[o].substr(0,1),r=s[o].substr(1).split(","),l=0;l<r.length;l+=2)switch(a){case"h":case"v":r[l]=-parseFloat(r[l]);break;case"H":r[l]=this.viewBoxX-parseFloat(r[l]);break;case"V":r[l]=this.viewBoxY-parseFloat(r[l]);break;case"l":case"m":case"c":case"s":case"q":case"t":r[l]=-parseFloat(r[l]),r[l+1]=-parseFloat(r[l+1]);break;case"L":case"M":case"C":case"S":case"Q":case"T":r[l]=this.viewBoxX-parseFloat(r[l]),r[l+1]=this.viewBoxY-parseFloat(r[l+1])}n+=a+r.join(",")}return'd="'+n+'z"'}}};return t}),N2D("Slider",function(s,t){function i(t,e){this.selected=!1,this.manager=t,this.box=e.data("slider",this),this.isGroup=!!this.box.data("group"),this.editUrl=this.box.find(".n2_slider_box__slider_overlay_edit_button").attr("href"),this.box.on("contextmenu",this.onContextMenu.bind(this)),this.box.find(".n2_slider_box__slider_select_tick").on("click",function(t){t.stopPropagation(),t.preventDefault(),this.invertSelection()}.bind(this)),this.$more=this.box.find(".n2_slider_box__slider_action_more").on("click",this.onMore.bind(this)),this.initRename()}return i.prototype.getId=function(){return this.box.data("sliderid")},i.prototype.onContextMenu=function(t){t.preventDefault(),this.showContextMenu(t)},i.prototype.onMore=function(t){t.preventDefault(),this.showContextMenu(this.$more[0])},i.prototype.showContextMenu=function(t){var e=[];e.push({priority:10,label:n2_("Preview"),icon:"ssi_16 ssi_16--eye",action:this.preview.bind(this)}),this.isGroup||e.push({priority:10,label:n2_("Change group"),icon:"ssi_16 ssi_16--folderclosed",action:this.changeGroup.bind(this)}),e.push({priority:55,label:n2_("Duplicate"),icon:"ssi_16 ssi_16--duplicate",action:this.duplicate.bind(this)}),e.push({priority:1e3,label:n2_("Move to trash"),icon:"ssi_16 ssi_16--delete",action:this.trash.bind(this),color:"red"}),this.box.addClass("n2_slider_box--context-menu"),N2Classes.ContextMenu(t,e,{y:5,horizontalAlign:"left",onClose:function(){this.box.removeClass("n2_slider_box--context-menu")}.bind(this)})},i.prototype.preview=function(){window.open(N2Classes.N2QueryString.add_query_arg({sliderid:this.getId()},this.manager.previewUrl),"_blank")},i.prototype.changeGroup=function(){this.manager.changeGroup(this.getId())},i.prototype.duplicate=function(){var e=s.Deferred();return N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.manager.ajaxUrl,{nextendcontroller:"slider",nextendaction:"duplicate",sliderid:this.getId()})}).done(function(t){t=s(t.data).insertAfter(this.box),t=new i(this.manager,t);this.manager.initSliders(),e.resolve(t)}.bind(this)),e},i.prototype.trash=function(){this.manager.trashSliders([this.getId()],[this])},i.prototype.remove=function(){this.box.remove()},i.prototype.invertSelection=function(t){t&&t.preventDefault(),this.selected?this.deSelect():this.select()},i.prototype.select=function(){this.selected||(this.selected=!0,this.box.addClass("n2_slider_box--bulk-selected"),this.manager.addSelection(this))},i.prototype.deSelect=function(){this.selected&&(this.selected=!1,this.box.removeClass("n2_slider_box--bulk-selected"),this.manager.removeSelection(this))},i.prototype.initRename=function(){this.dblClickTimeout=!1,this.$label=this.box.find(".n2_slider_box__footer_title").on("click",function(t){"true"!==this.$label[0].contentEditable&&(this.dblClickTimeout?(clearTimeout(this.dblClickTimeout),this.dblClickTimeout=!1,this.editName()):this.dblClickTimeout=setTimeout(function(){window.location=this.editUrl,this.dblClickTimeout=!1}.bind(this),500))}.bind(this)),this.title=this.$label.text().trim(),this.$label.text(this.title)},i.prototype.editName=function(){new N2Classes.InlineTextEditor(this.$label[0],{onSave:function(t){this.title!==t&&N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.manager.ajaxUrl,{nextendcontroller:"slider",nextendaction:"rename",sliderid:this.getId(),title:t})}).done(function(){this.title=t}.bind(this)).fail(function(){this.$label.text(this.title)}.bind(this))}.bind(this),onCancel:function(){this.$label.text(this.title)}.bind(this),onTab:function(t){for(var e=s(".n2_slider_box__footer_title"),i=0;i<e.length;i++)if(this.$label.is(e[i])){t.shiftKey?i--:i++;break}i<0?i=e.length-1:i>=e.length&&(i=0),e.eq(i).trigger("click").trigger("click")}.bind(this)})},i}),N2D("SlidersTrash",function(s,t){function e(t){this.options=t,this.$container=s(".n2_slider_trash");for(var e=this.$container.find(".n2_slider_box"),i=0;i<e.length;i++)new n(this,e.eq(i));this.$emptyTrashButton=s(".n2_slider_empty_trash").on("click",this.emptyTrash.bind(this)),this.refreshEmptyTrashStatus()}function n(t,e){this.manager=t,this.$box=e,this.$box.on("contextmenu",this.onContextMenu.bind(this)),this.$box.find(".n2_slider_box__slider_overlay_restore_button").on("click",this.restore.bind(this)),this.$more=this.$box.find(".n2_slider_box__slider_action_more").on("click",this.onMore.bind(this))}return e.prototype.emptyTrash=function(t){t.preventDefault(),this.isEmpty()||N2Classes.ModalDeleteConfirm(n2_("empty the trash"),function(){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.options.ajaxUrl,{nextendcontroller:"sliders",nextendaction:"emptyTrash"}),type:"POST"}).done(function(){this.$container.find(".n2_slider_box").remove(),this.refreshEmptyTrashStatus()}.bind(this))}.bind(this))},e.prototype.isEmpty=function(){return 0===this.$container.find(".n2_slider_box").length},e.prototype.refreshEmptyTrashStatus=function(){var t=this.isEmpty();this.$container.toggleClass("n2_slider_trash--empty",t),this.$emptyTrashButton.toggleClass("n2_button--inactive",t)},n.prototype.getId=function(){return this.$box.data("sliderid")},n.prototype.onContextMenu=function(t){t.preventDefault(),this.showContextMenu(t)},n.prototype.onMore=function(t){t.preventDefault(),this.showContextMenu(this.$more[0])},n.prototype.showContextMenu=function(t){var e=[];e.push({priority:20,label:n2_("Preview"),icon:"ssi_16 ssi_16--eye",action:this.preview.bind(this)}),e.push({priority:30,label:n2_("Delete permanently"),icon:"ssi_16 ssi_16--delete",action:this.deletePermanently.bind(this),color:"red"}),this.$box.addClass("n2_slider_box--context-menu"),N2Classes.ContextMenu(t,e,{y:5,horizontalAlign:"left",onClose:function(){this.$box.removeClass("n2_slider_box--context-menu"),this.manager.refreshEmptyTrashStatus()}.bind(this)})},n.prototype.restore=function(t){t.preventDefault(),N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.manager.options.ajaxUrl,{nextendcontroller:"slider",nextendaction:"restore"}),type:"POST",data:{slider:this.getId()}}).done(function(){this.$box.remove(),this.manager.refreshEmptyTrashStatus()}.bind(this))},n.prototype.preview=function(){window.open(N2Classes.N2QueryString.add_query_arg({sliderid:this.getId()},this.manager.options.previewUrl),"_blank")},n.prototype.deletePermanently=function(){N2Classes.ModalDeleteConfirm(n2_("delete this slider"),function(){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.manager.options.ajaxUrl,{nextendcontroller:"slider",nextendaction:"deletePermanently"}),type:"POST",data:{slider:this.getId()}}).done(function(t){this.$box.remove();for(var e=t.data.sliderIDs,i=0;i<e.length;i++)s('.n2_slider_manager__box[data-sliderid="'+e[i]+'"]').remove();this.manager.refreshEmptyTrashStatus()}.bind(this))}.bind(this))},e}),N2D("NextendSplitTextAnimation",["NextendVisualWithSetRow"],function(t,e){function i(){N2Classes.NextendVisualWithSetRow.prototype.constructor.apply(this,arguments)}return((i.prototype=Object.create(N2Classes.NextendVisualWithSetRow.prototype)).constructor=i).prototype.activate=function(t){t!==e&&t.preventDefault(),this.visualManager.changeActiveVisual(this),this.value.transformOrigin!==e&&this.visualManager.controller.loadTransformOrigin(this.value.transformOrigin),this.visualManager.controller.load(this.value.animation,!1,this.visualManager.showParameters)},i}),N2D("NextendSplitTextAnimationEditor",["NextendFragmentEditor"],function(t,e){function i(){N2Classes.NextendFragmentEditor.prototype.constructor.apply(this,arguments),this.fields={mode:{element:t("#n2-splittextanimation-editormode"),events:{"outsideChange.n2-editor":this.changeMode.bind(this)}},sort:{element:t("#n2-splittextanimation-editorsort"),events:{"outsideChange.n2-editor":this.changeSort.bind(this)}},duration:{element:t("#n2-splittextanimation-editorduration"),events:{"outsideChange.n2-editor":this.changeDuration.bind(this)}},stagger:{element:t("#n2-splittextanimation-editorstagger"),events:{"outsideChange.n2-editor":this.changeStagger.bind(this)}},easing:{element:t("#n2-splittextanimation-editoreasing"),events:{"outsideChange.n2-editor":this.changeEasing.bind(this)}},opacity:{element:t("#n2-splittextanimation-editoropacity"),events:{"outsideChange.n2-editor":this.changeOpacity.bind(this)}},offset:{element:t("#n2-splittextanimation-editoroffset"),events:{"outsideChange.n2-editor":this.changeOffset.bind(this)}},rotate:{element:t("#n2-splittextanimation-editorrotate"),events:{"outsideChange.n2-editor":this.changeRotate.bind(this)}},scale:{element:t("#n2-splittextanimation-editorscale"),events:{"outsideChange.n2-editor":this.changeScale.bind(this)}},transformOrigin:{element:t("#n2-splittextanimation-editortransformorigin"),events:{"outsideChange.n2-editor":this.changeTransformOrigin.bind(this)}}}}return((i.prototype=Object.create(N2Classes.NextendFragmentEditor.prototype)).constructor=i).prototype.load=function(t){this._off(),"lines"===t.mode&&(t.mode="words"),this.fields.mode.element.data("field").insideChange(t.mode),t.sort||(t.sort="normal"),this.fields.sort.element.data("field").insideChange(t.sort),this.fields.duration.element.data("field").insideChange(1e3*t.duration),this.fields.stagger.element.data("field").insideChange(1e3*t.stagger),this.fields.easing.element.data("field").insideChange(t.ease),this.fields.opacity.element.data("field").insideChange(100*t.opacity),this.fields.offset.element.data("field").insideChange(t.x+"|*|"+t.y),this.fields.rotate.element.data("field").insideChange(t.rotationX+"|*|"+t.rotationY+"|*|"+t.rotationZ),this.fields.scale.element.data("field").insideChange(100*t.scale),this.fields.transformOrigin.element.data("field").insideChange(nextend.splittextanimationManager.controller.transformOrigin),this._on()},i.prototype.changeMode=function(){this.trigger("mode",this.fields.mode.element.val())},i.prototype.changeSort=function(){this.trigger("sort",this.fields.sort.element.val())},i.prototype.changeDuration=function(){this.trigger("duration",this.fields.duration.element.val()/1e3)},i.prototype.changeStagger=function(){this.trigger("stagger",this.fields.stagger.element.val()/1e3)},i.prototype.changeEasing=function(){this.trigger("ease",this.fields.easing.element.val())},i.prototype.changeOpacity=function(){this.trigger("opacity",this.fields.opacity.element.val()/100)},i.prototype.changeOffset=function(){var t=this.fields.offset.element.val().split("|*|");this.trigger("x",t[0]),this.trigger("y",t[1])},i.prototype.changeRotate=function(){var t=this.fields.rotate.element.val().split("|*|");this.trigger("rotationX",t[0]),this.trigger("rotationY",t[1]),this.trigger("rotationZ",t[2])},i.prototype.changeScale=function(){this.trigger("scale",this.fields.scale.element.val()/100)},i.prototype.changeTransformOrigin=function(){nextend.splittextanimationManager.controller.refreshTransformOrigin(this.fields.transformOrigin.element.val(),!0)},i}),N2D("NextendSplitTextAnimationEditorController",["NextendFragmentEditorControllerWithEditor"],function($,undefined){function NextendSplitTextAnimationEditorController(){this.timeline=new NextendTimeline,N2Classes.NextendFragmentEditorControllerWithEditor.prototype.constructor.apply(this,arguments),this.preview=$('<div class="n2_form__table_preview"></div>').css("fontSize","16px").appendTo('.n2_form__table[data-field="table-splittextanimation-preview"]'),this.initBackgroundColor()}return NextendSplitTextAnimationEditorController.prototype=Object.create(N2Classes.NextendFragmentEditorControllerWithEditor.prototype),NextendSplitTextAnimationEditorController.prototype.constructor=NextendSplitTextAnimationEditorController,NextendSplitTextAnimationEditorController.prototype.loadDefaults=function(){N2Classes.NextendFragmentEditorControllerWithEditor.prototype.loadDefaults.call(this),this.type="splittextanimation",this.group="in",this.preview=null,this.playing=!1,this.transformOrigin="0|*|0|*|0",this.mySplitText=null,this.repeatTimeout=null},NextendSplitTextAnimationEditorController.prototype.initEditor=function(){return new N2Classes.NextendSplitTextAnimationEditor},NextendSplitTextAnimationEditorController.prototype._load=function(t,e,i){""===t&&(t={}),this.group=i.group,N2Classes.NextendFragmentEditorControllerWithEditor.prototype._load.call(this,$.extend(!0,{},this.getEmptyVisual(),t),e,i),this.render(i.previewHTML)},NextendSplitTextAnimationEditorController.prototype.propertyChanged=function(t,e,i){N2Classes.NextendFragmentEditorControllerWithEditor.prototype.propertyChanged.call(this,t,e,i),this.refreshTimeline()},NextendSplitTextAnimationEditorController.prototype.get=function(t){return"saveAsNew"==t?{transformOrigin:this.transformOrigin,animation:this.currentVisual}:this.currentVisual},NextendSplitTextAnimationEditorController.prototype.getEmptyVisual=function(){return{mode:"chars",sort:"normal",duration:.4,stagger:.05,ease:"easeOutCubic",opacity:1,scale:1,x:0,y:0,rotationX:0,rotationY:0,rotationZ:0}},NextendSplitTextAnimationEditorController.prototype.initBackgroundColor=function(){this.$background=$("#n2-splittextanimation-editorpreview-background").on("nextendChange",function(){this.preview.css("background","#"+this.$background.val())}.bind(this)),this.preview.css("background","#"+this.$background.val())},NextendSplitTextAnimationEditorController.prototype.render=function(html){var fontClassName=nextend.splittextanimationManager.fontClassName,styleClassName=nextend.splittextanimationManager.styleClassName;html=html.replace(/\{([^]*?)\}/g,function(match,script){return eval(script)}),this.preview.html(html),this.visible&&this.refreshTimeline()},NextendSplitTextAnimationEditorController.prototype.refreshTimeline=function(){this.killPreview();var t=$.extend({},this.currentVisual),e=t.mode;"chars"===e&&(e+=",words"),this.mySplitText=new NextendSplitText(this.preview.find($('span[class^="n2-font-"]')).first(),{type:e});var i=[];switch(t.mode){case"lines":case"words":i=this.mySplitText.words;break;default:i=this.mySplitText.chars}delete t.mode,this.timeline=new NextendTimeline({repeat:-1});var s=t.duration,n=t.stagger;delete t.duration,delete t.stagger,NextendTween.set(i,{transformOrigin:this.transformOrigin.split("|*|").join("% ")+"px"});var o=null;switch(t.sort){case"reversed":i.reverse();break;case"random":!function(t,e,i,s){for(i=t.length;i;)e=Math.random()*i--|0,s=t[i],t[i]=t[e],t[e]=s}(i);break;case"side":case"center":for(var a=[],o=[];1<i.length;)a.push(i.shift()),o.push(i.pop());1==i.length&&a.push(i.shift()),i=a,"center"==t.sort&&(i.reverse(),o.reverse());break;case"sideShifted":case"centerShifted":for(a=[];1<i.length;)a.push(i.shift()),a.push(i.pop());1==i.length&&a.push(i.shift()),i=a,"centerShifted"==t.sort&&i.reverse()}delete t.sort,"out"==this.group?(delete(e=this.getEmptyVisual()).mode,delete e.sort,delete e.duration,delete e.easing,delete e.stagger,this.timeline.staggerFromTo(i,s,e,t,-n,.3),o&&o.length&&this.timeline.staggerFromTo(o,s,e,t,-n,.3)):(this.timeline.staggerFrom(i,s,t,n,.3),o&&o.length&&this.timeline.staggerFrom(o,s,t,n,.3)),this.timeline.eventCallback("onComplete",function(){this.repeatTimeout=setTimeout(function(){this.timeline.play(0,!1)}.bind(this),500)}.bind(this)),this.timeline.play()},NextendSplitTextAnimationEditorController.prototype.killPreview=function(){this.repeatTimeout&&clearTimeout(this.repeatTimeout),this.timeline.pause(),this.mySplitText&&this.mySplitText.revert()},NextendSplitTextAnimationEditorController.prototype.show=function(){this.loadTransformOrigin(nextend.splittextanimationManager.transformOriginElement.val()),N2Classes.NextendFragmentEditorControllerWithEditor.prototype.show.call(this),this.refreshTimeline()},NextendSplitTextAnimationEditorController.prototype.close=function(){this.killPreview(),N2Classes.NextendFragmentEditorControllerWithEditor.prototype.close.call(this)},NextendSplitTextAnimationEditorController.prototype.loadTransformOrigin=function(t){this.editor.fields.transformOrigin.element.data("field").insideChange(t),this.refreshTransformOrigin(t,!1)},NextendSplitTextAnimationEditorController.prototype.refreshTransformOrigin=function(t,e){this.transformOrigin=t,NextendTween.set(this.preview.parent().get(0),{perspective:"1000px"}),e&&this.refreshTimeline()},NextendSplitTextAnimationEditorController}),N2D("NextendSplitTextAnimationManager",["NextendVisualManagerSetsAndMore"],function(s,t){function e(){this.css=[],N2Classes.NextendVisualManagerSetsAndMore.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.NextendVisualManagerSetsAndMore.prototype)).constructor=e).prototype.loadDefaults=function(){N2Classes.NextendVisualManagerSetsAndMore.prototype.loadDefaults.apply(this,arguments),this.type="splittextanimation",this.labels={visual:"Text animation",visuals:"Text animations"},this.styleClassName="",this.fontClassName=""},e.prototype.initController=function(){return new N2Classes.NextendSplitTextAnimationEditorController},e.prototype.createVisual=function(t,e){return new N2Classes.NextendSplitTextAnimation(t,e,this)},e.prototype.setConnectedStyle=function(t){t=s("#"+t).data("field").renderStyle();this.css.push(t),this.styleClassName=t.getBaseClassName()},e.prototype.setConnectedFont=function(t){t=s("#"+t).data("field").renderFont();this.css.push(t),this.fontClassName=t.getBaseClassName()},e.prototype.setVisualAsStatic=function(t){var e;null!==this.transformOriginElement&&((e=this.transformOriginElement.data("field")).insideChange(this.controller.transformOrigin),e.triggerOutsideChange()),t.preventDefault(),"static"===this.mode?(this.setAndClose(this.getBase64(n2_("Static"))),this.hide(t)):N2Classes.NextendVisualManagerSetsAndMore.prototype.setVisualAsStatic.call(this,t)},e.prototype.getBase64=function(t){return N2Classes.Base64.encode(JSON.stringify({name:t,data:this.controller.get("set")}))},e.prototype.hide=function(t){N2Classes.NextendVisualManagerSetsAndMore.prototype.hide.call(this,t);for(var e=0;e<this.css.length;e++)this.css[e].destroy();this.css=[]},e.prototype.show=function(t,e,i){this.transformOriginElement=i.transformOrigin,N2Classes.NextendVisualManagerSetsAndMore.prototype.show.call(this,t,e,i),""==t&&s.when(this.activeSet._loadVisuals()).done(function(){for(var t in this.activeSet.visuals){this.activeSet.visuals[t].activate();break}}.bind(this))},e}),N2D("GroupEdit",function(n,o){function t(t){this.options=n.extend({previewInNewWindow:!1,saveAjaxUrl:"",previewUrl:"",ajaxUrl:"",formData:{}},t),this.url=this.options.ajaxUrl,this.values=this.options.formData,N2Classes.Form.prototype.constructor.call(this),N2R("documentReady",this.onReady.bind(this))}return((t.prototype=Object.create(N2Classes.Form.prototype)).constructor=t).prototype.onReady=function(){this.setID("#n2-ss-edit-group-form"),N2Classes.Form.prototype.onReady.call(this),this.$form.on("submit",this.onSaveSubmit.bind(this)),this.initPreview()},t.prototype.onKeyDown=function(t){var e=!1;return(t.ctrlKey||t.metaKey)&&49===t.keyCode&&(this.showPreview(),e=!0),e?t.preventDefault():e=N2Classes.Form.prototype.onKeyDown.call(this,t),e},t.prototype.initButtons=function(){this.$saveButton=n(".n2_group_settings_save").on("click",this.actionSave.bind(this)),n(".n2_group_settings_back").on("click",this.actionCancel.bind(this))},t.prototype.actionSave=function(t){t&&t.preventDefault(),this.skipChangeConfirm=!0,this.$form.submit()},t.prototype.actionCancel=function(t){t&&t.preventDefault(),window.location=t.currentTarget.href},t.prototype.onSaveSubmit=function(t){this.$form.attr("target")===o&&(t.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:this.options.saveAjaxUrl,data:this.$form.serialize(),dataType:"json",success:this.onAfterSave.bind(this)}))},t.prototype.onAfterSave=function(t){if(n(".n2_header__heading_primary").text(n("#slidertitle").val()),t&&t.data&&t.data.changedFields){for(var e in t.data.changedFields)t.data.changedFields.hasOwnProperty(e)&&n("#"+e).val(t.data.changedFields[e]);var i,s;t.data.changedFields.slideralias!==o&&(i=t.data.changedFields[e],(s=n('.n2_ss_slider_publish__option_code[data-mode="alias"]')).length||(s=n('<div class="n2_ss_slider_publish__option_code" data-mode="alias"></div>').insertAfter(n('.n2_ss_slider_publish__option_code[data-mode="id"]'))),i?s.text('[smartslider3 alias="'+i+'"]'):s.remove())}this.afterSave()},t.prototype.initPreview=function(){this.options.previewInNewWindow||(this.modal=new N2Classes.ModalIframe("preview-slider")),n(".n2_top_bar_main__preview").on("click",this.showPreview.bind(this))},t.prototype.showPreview=function(t){t&&t.preventDefault(),this.options.previewInNewWindow?N2Classes.PreviewPopup("","preview-slider"):this.modal.show(),this.$form.attr({action:N2Classes.AjaxHelper.makeAjaxUrl(this.options.previewUrl,{nextendaction:this.options.previewInNewWindow?"index":"slider"}),target:"preview-slider"}).submit().attr({action:this.formAction,target:null})},t}),N2D("FormElementAnimationManager",["FormElement"],function(i,t){function e(t,e){this.element=i("#"+t),this.parent=this.element.parent(),this.managerIdentifier=e,this.parent.find(".n2_field_chooser__choose, .n2_field_chooser__label").on("click",this.show.bind(this)),this.parent.find(".n2_field_chooser__clear").on("click",this.clear.bind(this)),this.$name=this.parent.find(".n2_field_chooser__label"),this.updateName(this.element.val()),N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.show=function(t){t.preventDefault(),nextend[this.managerIdentifier].show(this.element.val(),this.save.bind(this))},e.prototype.clear=function(t){t.preventDefault(),t.stopPropagation(),this.val("")},e.prototype.save=function(t,e){this.val(e)},e.prototype.val=function(t){this.element.val(t),this.updateName(t),this.triggerOutsideChange()},e.prototype.insideChange=function(t){this.element.val(t),this.updateName(t),this.triggerInsideChange()},e.prototype.updateName=function(t){this.parent.toggleClass("n2_field_chooser--empty",""===t),t=""===t?n2_("Disabled"):n2_("Enabled"),this.$name.text(t)},e.prototype.isEmpty=function(t){return""===t},e}),N2D("FormElementColumns",["FormElement"],function(n,e){function t(t){this.denominators={1:100,2:100,3:144,4:100,5:100,6:144},this.element=n("#"+t),N2Classes.FormElement.prototype.constructor.call(this),this.$c=n("#"+t).parent(),this.$container=this.$c.find(".n2_field_columns__content"),this.containerWidth=280,this.maxWidth=0,new N2Classes.UISortable(this.$container,{axis:"x",items:".n2_field_columns__column",helper:"clone_hide",start:function(t,e){this.$container.addClass("n2-sortable-currently-sorted"),e.placeholder.css({width:e.item.width(),visibility:"hidden"});var i=this.$container.find(".n2_field_columns__column");e.item.data("index",i.index(e.item))}.bind(this),stop:function(t,e){var i=this.$container.find(".n2_field_columns__column"),s=e.item.data("index"),i=i.index(e.item);s!=i&&(this.currentRow.moveColOrOrder(s,i),e.item.data("index",null)),this.makeResizable(),this.$container.removeClass("n2-sortable-currently-sorted")}.bind(this)}),this.$c.find(".n2_field_columns__add").on({click:function(){this.currentRow.createCol()}.bind(this)})}return((t.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=t).prototype.getDenominator=function(t){return this.denominators[t]===e&&(this.denominators[t]=15*t),this.denominators[t]},t.prototype.setRow=function(t){this.currentRow=t,this.insideChange(t.getColumnsOrdered())},t.prototype.setValue=function(t){},t.prototype.insideChange=function(t){this.start(t)},t.prototype.activateColumn=function(t){var e=this.$container.find(".n2_field_columns__column").index(t.currentTarget);this.currentRow.activateColumn(e,t)},t.prototype.start=function(t){this.percentages=[];for(var e=t.split("+"),i=0;i<e.length;i++)this.percentages.push(new Fraction(e[i]));this.refreshMaxWidth(),this.$container.empty();for(i=0;i<this.percentages.length;i++){var s=n('<div class="n2_field_columns__column">').on("click",this.activateColumn.bind(this)).appendTo(this.$container);nextend.tooltip.addElement(s,n2_("Column")),this.updateColumn(s,this.percentages[i])}this.makeResizable()},t.prototype.refreshMaxWidth=function(){this.maxWidth=this.containerWidth-16*(this.percentages.length-1)},t.prototype.updateColumn=function(t,e){t.css("width",this.maxWidth*e.valueOf()+"px").html(Math.round(100*e.valueOf()*10)/10+"%")},t.prototype.makeResizable=function(){this.handles&&this.handles.remove(),this.$columns=this.$container.find(".n2_field_columns__column"),n('<div class="n2_field_columns__handle"><div class="ssi_16 ssi_16--divide"></div></div>').insertAfter(this.$columns.not(this.$columns.last())),this.handles=this.$container.find(".n2_field_columns__handle").on("mousedown",this._resizeStart.bind(this))},t.prototype._resizeStart=function(t){var e=this.handles.index(t.currentTarget),i=this.$container.offset().left+8;this.resizeContext={index:e,cLeft:i,$currentCol:this.$columns.eq(e),$nextCol:this.$columns.eq(e+1),startX:Math.max(0,Math.min(t.clientX-i,this.containerWidth))},this._resizeMove(t),n("html").off(".resizecol").on({"mousemove.resizecol":this._resizeMove.bind(this),"mouseup.resizecol mouseleave.resizecol":this._resizeStop.bind(this)})},t.prototype._resizeMove=function(t){t.preventDefault();var e=Math.max(0,Math.min(t.clientX-this.resizeContext.cLeft,this.containerWidth)),i=this.getDenominator(this.percentages.length),t=new Fraction(Math.round((e-this.resizeContext.startX)/(this.maxWidth/i)),i);t.compare(this.percentages[this.resizeContext.index].clone().mul(-1))<0&&(t=this.percentages[this.resizeContext.index].clone().mul(-1)),0<t.compare(this.percentages[this.resizeContext.index+1])&&(t=this.percentages[this.resizeContext.index+1].clone());e=this.percentages[this.resizeContext.index].add(t),i=this.percentages[this.resizeContext.index+1].sub(t);this.updateColumn(this.resizeContext.$currentCol,e),this.updateColumn(this.resizeContext.$nextCol,i);t=n.extend([],this.percentages);return t[this.resizeContext.index]=e,t[this.resizeContext.index+1]=i,this.onColumnWidthChange(t),[e,i]},t.prototype._resizeStop=function(t){t=this._resizeMove(t);this.percentages[this.resizeContext.index]=t[0],this.percentages[this.resizeContext.index+1]=t[1],n("html").off(".resizecol"),delete this.resizeContext,this.currentRow.setRealColsWidth(this.percentages)},t.prototype.onColumnWidthChange=function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i].valueOf());this.currentRow.updateColumnWidth(e)},t}),N2D("FormElementControlTypePicker",["FormElement"],function($,undefined){function FormElementControlTypePicker(t,e){this.options=$.extend({ajaxUrl:"",target:"",originalValue:""},e),this.id=t,this.element=$("#"+t);t=this.element.parent();this.$items=t.find(".n2_field_control_type_picker__item"),this.target=$("#"+this.options.target),this.form=this.element.closest("form").data("form"),this.element.on("nextendChange",this.loadSubform.bind(this)),this.$items.on("click",function(t){this.selectOption($(t.currentTarget).data("controltype"))}.bind(this)),this.markSelected(this.options.originalValue),N2Classes.FormElement.prototype.constructor.call(this)}return FormElementControlTypePicker.prototype=Object.create(N2Classes.FormElement.prototype),FormElementControlTypePicker.prototype.constructor=FormElementControlTypePicker,FormElementControlTypePicker.prototype.loadSubform=function(){var t=this.element.val(),e=[];t===this.options.originalValue&&(e=this.form.values);t={values:e,value:t};N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.options.ajaxUrl),data:t,dataType:"json"}).done(this.load.bind(this))},FormElementControlTypePicker.prototype.load=function(response){this.target.html(response.data.html),eval(response.data.scripts),N2Classes.FormTipManager.add(this.target)},FormElementControlTypePicker.prototype.selectOption=function(t){this.setValue(t),this.markSelected(t),this.triggerOutsideChange()},FormElementControlTypePicker.prototype.setValue=function(t){this.element.val(t)},FormElementControlTypePicker.prototype.markSelected=function(t){this.$items.removeClass("n2_field_control_type_picker__item--selected");for(var e=0;e<this.$items.length;e++)this.$items.eq(e).data("controltype")===t&&$(this.$items[e]).addClass("n2_field_control_type_picker__item--selected")},FormElementControlTypePicker}),N2D("FormElementDatePicker",["FormElement"],function(s,t){function e(t,e){this.element=s("#"+t),this.elements=[],this.elements.push(s("#"+e[0]).on("outsideChange",this.onFieldOnOffChange.bind(this)));for(var i=1;i<e.length;i++)this.elements.push(s("#"+e[i]).on("outsideChange",this.onFieldChange.bind(this)));N2Classes.FormElement.prototype.constructor.call(this),this.syncOnOff(),this.fixDate()}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.getValue=function(){if(1!==parseInt(this.elements[0].val()))return this.getEmptyDate();var t=[this.elements[1].val(),this.pad(this.elements[2].val()),this.pad(this.elements[3].val())],e=[this.pad(this.elements[4].val()),this.pad(this.elements[5].val()),"00"];return t.join("-")+" "+e.join(":")},e.prototype.onFieldOnOffChange=function(){var t,e;1===parseInt(this.elements[0].val())&&"0000"===this.elements[1].val()&&(t=[(e=new Date).getFullYear(),this.pad(e.getMonth()+1),this.pad(e.getDate())],e=[this.pad(e.getHours()),this.pad(e.getMinutes()),"00"],this.insideChange(t.join("-")+" "+e.join(":"))),this.onFieldChange()},e.prototype.onFieldChange=function(){this.fixDate()||(this.element.val(this.getValue()),this.triggerOutsideChange())},e.prototype.insideChange=function(t){var e;this.element.val(t),t===this.getEmptyDate()?this.elements[0].data("field").insideChange(0):(t=(e=t.split(" "))[0].split("-"),e=e[1].split(":"),this.elements[0].data("field").insideChange(1),this.elements[1].data("field").insideChange(t[0]),this.elements[2].data("field").insideChange(t[1]),this.elements[3].data("field").insideChange(t[2]),this.elements[4].data("field").insideChange(e[0]),this.elements[5].data("field").insideChange(e[1]),this.fixDate()),this.triggerInsideChange()},e.prototype.syncOnOff=function(){this.element.val()===this.getEmptyDate()?this.elements[0].data("field").insideChange(0):this.elements[0].data("field").insideChange(1)},e.prototype.getEmptyDate=function(){return"0000-00-00 00:00:00"},e.prototype.pad=function(t,e){e=e||2;for(var i=t+"";i.length<e;)i="0"+i;return i},e.prototype.fixDate=function(){if(1===parseInt(this.elements[0].val())){for(var t=this.elements[1].val(),e=this.elements[2].val(),i=this.elements[3].val(),s=this.elements[3].data("field").select,n=new Date(t,e,0).getDate(),e=s[0].length,o=e;0<o;o--)s[0][o-1].removeAttribute("hidden");for(var a=e;n<a;a--)s[0][a-1].setAttribute("hidden","hidden");if(n<i)return this.elements[3].data("field").insideChange(n),this.onFieldChange(),!0}return!1},e}),function(t){"use strict";var m={s:1,n:0,d:1};function g(t,e){return isNaN(t=parseInt(t,10))&&y(),t*e}function y(){throw"Invalid Param"}var i=function(t,e){var i,s=0,n=1,o=1,a=0,r=0,l=0,d=1,h=1,p=0,c=1,u=1,f=1;if(null!=t)if(void 0!==e)o=(s=t)*(n=e);else switch(typeof t){case"object":"d"in t&&"n"in t?(s=t.n,n=t.d,"s"in t&&(s*=t.s)):0 in t?(s=t[0],1 in t&&(n=t[1])):y(),o=s*n;break;case"number":if(t<0&&(t=-(o=t)),t%1==0)s=t;else if(0<t){for(1<=t&&(t/=h=Math.pow(10,Math.floor(1+Math.log(t)/Math.LN10)));c<=1e7&&f<=1e7;){if(t===(i=(p+u)/(c+f))){n=c+f<=1e7?(s=p+u,c+f):c<f?(s=u,f):(s=p,c);break}i<t?(p+=u,c+=f):(u+=p,f+=c),n=1e7<c?(s=u,f):(s=p,c)}s*=h}else(isNaN(t)||isNaN(e))&&(n=s=NaN);break;case"string":if("-"===(c=t.match(/\d+|./g))[p]?(o=-1,p++):"+"===c[p]&&p++,c.length===p+1?r=g(c[p++],o):"."===c[p+1]||"."===c[p]?("."!==c[p]&&(a=g(c[p++],o)),(++p+1===c.length||"("===c[p+1]&&")"===c[p+3]||"'"===c[p+1]&&"'"===c[p+3])&&(r=g(c[p],o),d=Math.pow(10,c[p].length),p++),("("===c[p]&&")"===c[p+2]||"'"===c[p]&&"'"===c[p+2])&&(l=g(c[p+1],o),h=Math.pow(10,c[p+1].length)-1,p+=3)):"/"===c[p+1]||":"===c[p+1]?(r=g(c[p],o),d=g(c[p+2],1),p+=3):"/"===c[p+3]&&" "===c[p+1]&&(a=g(c[p],o),r=g(c[p+2],o),d=g(c[p+4],1),p+=5),c.length<=p){o=s=l+(n=d*h)*a+h*r;break}default:y()}if(0===n)throw"DIV/0";m.s=o<0?-1:1,m.n=Math.abs(s),m.d=Math.abs(n)},u=function(t,e){if(!t)return e;if(!e)return t;for(;;){if(!(t%=e))return e;if(!(e%=t))return t}};function f(t,e){if(!(this instanceof f))return new f(t,e);i(t,e),t=f.REDUCE?u(m.d,m.n):1,this.s=m.s,this.n=m.n/t,this.d=m.d/t}f.REDUCE=1,f.prototype={s:1,n:0,d:1,abs:function(){return new f(this.n,this.d)},neg:function(){return new f(-this.s*this.n,this.d)},add:function(t,e){return i(t,e),new f(this.s*this.n*m.d+m.s*this.d*m.n,this.d*m.d)},sub:function(t,e){return i(t,e),new f(this.s*this.n*m.d-m.s*this.d*m.n,this.d*m.d)},mul:function(t,e){return i(t,e),new f(this.s*m.s*this.n*m.n,this.d*m.d)},div:function(t,e){return i(t,e),new f(this.s*m.s*this.n*m.d,this.d*m.n)},clone:function(){return new f(this)},mod:function(t,e){return isNaN(this.n)||isNaN(this.d)?new f(NaN):void 0===t?new f(this.s*this.n%this.d,1):(i(t,e),0===m.n&&0===this.d&&f(0,0),new f(this.s*m.d*this.n%(m.n*this.d),m.d*this.d))},gcd:function(t,e){return i(t,e),new f(u(m.n,this.n),m.d*this.d/u(m.d,this.d))},lcm:function(t,e){return i(t,e),0===m.n&&0===this.n?new f:new f(m.n*this.n/u(m.n,this.n),u(m.d,this.d))},ceil:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new f(NaN):new f(Math.ceil(t*this.s*this.n/this.d),t)},floor:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new f(NaN):new f(Math.floor(t*this.s*this.n/this.d),t)},round:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new f(NaN):new f(Math.round(t*this.s*this.n/this.d),t)},inverse:function(){return new f(this.s*this.d,this.n)},pow:function(t){return t<0?new f(Math.pow(this.s*this.d,-t),Math.pow(this.n,-t)):new f(Math.pow(this.s*this.n,t),Math.pow(this.d,t))},equals:function(t,e){return i(t,e),this.s*this.n*m.d==m.s*m.n*this.d},compare:function(t,e){i(t,e);e=this.s*this.n*m.d-m.s*m.n*this.d;return(0<e)-(e<0)},divisible:function(t,e){return i(t,e),!(!(m.n*this.d)||this.n*m.d%(m.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(t){var e,i="",s=this.n,n=this.d;return this.s<0&&(i+="-"),1===n?i+=s:(t&&0<(e=Math.floor(s/n))&&(i+=e,i+=" ",s%=n),i+=s,i+="/",i+=n),i},toLatex:function(t){var e,i="",s=this.n,n=this.d;return this.s<0&&(i+="-"),1===n?i+=s:(t&&0<(e=Math.floor(s/n))&&(i+=e,s%=n),i+="\\frac{",i+=s,i+="}{",i+=n,i+="}"),i},toContinued:function(){for(var t,e=this.n,i=this.d,s=[];s.push(Math.floor(e/i)),t=e%i,e=i,i=t,1!==e;);return s},toString:function(){var t,e=this.n,i=this.d;if(isNaN(e)||isNaN(i))return"NaN";f.REDUCE||(e/=t=u(e,i),i/=t);for(var s=String(e).split(""),n=0,o=[~this.s?"":"-","",""],a="",r=function(t){for(;t%2==0;t/=2);for(;t%5==0;t/=5);if(1===t)return 0;for(var e=10%t,i=1;1!==e;i++)if(e=10*e%t,2e3<i)return 0;return i}(i),l=function(t,e){for(var i=1,s=function(t,e,i){for(var s=1;0<e;t=t*t%i,e>>=1)1&e&&(s=s*t%i);return s}(10,e,t),n=0;n<300;n++){if(i===s)return n;i=10*i%t,s=10*s%t}return 0}(i,r),d=-1,h=1,p=15+r+l+s.length,c=0;c<p;c++,n*=10){if(c<s.length?n+=Number(s[c]):(h=2,d++),0<r)if(d===l)o[h]+=a+"(",a="";else if(d===r+l){o[h]+=a+")";break}i<=n?(o[h]+=a+(n/i|0),a="",n%=i):1<h?a+="0":o[h]&&(o[h]+="0")}return o[0]+=o[1]||"0",o[2]?o[0]+"."+o[2]:o[0]}},t.Fraction=f}(window),N2D("FormElementLayerPicker",["FormElement"],function(s,t){var e=0,a=1,n=3,i=4,o='<div class="n2_ss_absolute_parent_picker__overlay n2_ss_absolute_parent_picker__overlay--tile" data-align="left" data-valign="top"></div><div class="n2_ss_absolute_parent_picker__overlay n2_ss_absolute_parent_picker__overlay--tile" data-align="center" data-valign="top" style="left:33%;top:0;"></div><div class="n2_ss_absolute_parent_picker__overlay n2_ss_absolute_parent_picker__overlay--tile" data-align="right" data-valign="top" style="left:66%;top:0;width:34%;"></div><div class="n2_ss_absolute_parent_picker__overlay n2_ss_absolute_parent_picker__overlay--tile" data-align="left" data-valign="middle" style="left:0;top:33%;"></div><div class="n2_ss_absolute_parent_picker__overlay n2_ss_absolute_parent_picker__overlay--tile" data-align="center" data-valign="middle" style="left:33%;top:33%; "></div><div class="n2_ss_absolute_parent_picker__overlay n2_ss_absolute_parent_picker__overlay--tile" data-align="right" data-valign="middle" style="left:66%;top:33%;width:34%;"></div><div class="n2_ss_absolute_parent_picker__overlay n2_ss_absolute_parent_picker__overlay--tile" data-align="left" data-valign="bottom" style="left:0;top:66%;height:34%;"></div><div class="n2_ss_absolute_parent_picker__overlay n2_ss_absolute_parent_picker__overlay--tile" data-align="center" data-valign="bottom" style="left:33%;top:66%;height:34%;"></div><div class="n2_ss_absolute_parent_picker__overlay n2_ss_absolute_parent_picker__overlay--tile" data-align="right" data-valign="bottom" style="left:66%;top:66%;width:34%;height:34%;"></div>';function r(t){this.status=e,this.element=s("#"+t),this.$parent=this.element.parent(),this.overlays=null,this.$picker=this.$parent.find(".n2_ss_absolute_parent_picker").on("click",function(t){t.preventDefault(),""===this.element.val()?this.click(t):this.change("")}.bind(this)),N2Classes.FormElement.prototype.constructor.call(this)}return((r.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=r).prototype.click=function(t){this.status===e?(this.data={parent:null,parentVAlign:null,parentHAlign:null,child:nextend.currentEditor.fragmentEditor.getActiveLayer().layer,childVAlign:null,childHAlign:null},s("body").on("mousedown.n2-ss-parent-linker",function(t){s(t.target).hasClass("n2_ss_absolute_parent_picker__overlay")||this.destroy()}.bind(this)),N2Classes.Esc.add(function(){return this.destroy(),!1}.bind(this)),this.pickParent(t)):(this.data=null,this.change(""),this.destroy())},r.prototype.getAbsoluteLayers=function(t){for(var e=[],i=t.getSortedLayers(),s=0;s<i.length;s++)"absolute"===i[s].placement.getType()&&e.push(i[s].layer[0]);return e},r.prototype.getSiblingLayers=function(t){var e=t.group.container.getSortedLayers(),t=e.indexOf(t);return-1<t&&e.splice(t,1),e},r.prototype.pickParent=function(t){this.data.childLayer=this.data.child.data("layerObject");var n=this.getSiblingLayers(this.data.childLayer),o=function(t){var e=t.getProperty("id");if(""!==e){for(var i=[],s=n.length-1;0<=s;s--)e===n[s].getProperty("parentid")&&(i.push(n[s]),n.splice(s,1));for(s=i.length-1;0<=s;s--)o(i[s])}};if(o(this.data.childLayer),0===n.length)N2Classes.Notification.error(n2_("There is no layer available to be parent of the current layer!")),this.destroy();else{for(var e=[],i=0;i<n.length;i++)e.push(n[i].layer);this.status=a,nextend.tooltipMouse.show(n2_("Pick the parent layer!"),t),s('<div class="n2_ss_absolute_parent_picker__overlay"></div>').on("click",function(t){t.preventDefault(),t.stopPropagation(),this.data.parent=s(t.currentTarget).parent(),this._destroy(),this.pickParentAlign(t)}.bind(this)).appendTo(e)}},r.prototype.pickParentAlign=function(t){this.status=n,nextend.tooltipMouse.show(n2_("Pick the align point of the parent layer!"),t),this.data.parent.addClass("n2_ss_absolute_parent_picker__component--focused");var i=s(o).appendTo(this.data.parent).on("click",function(t){t.preventDefault(),t.stopPropagation();var e=s(t.currentTarget);this.data.parentHAlign=e.data("align"),this.data.parentVAlign=e.data("valign"),e.off("click").addClass("n2_ss_absolute_parent_picker__overlay--selected"),this.data.parent.removeClass("n2_ss_absolute_parent_picker__component--focused"),i.not(e).remove(),this.pickChildAlign(t)}.bind(this))},r.prototype.pickChildAlign=function(t){this.status=i,nextend.tooltipMouse.show(n2_("Pick the align point of the child layer!"),t),this.data.child.addClass("n2_ss_absolute_parent_picker__component--focused");s(o).appendTo(this.data.child).on("click",function(t){t.preventDefault(),t.stopPropagation();t=s(t.currentTarget);this.data.childHAlign=t.data("align"),this.data.childVAlign=t.data("valign"),this.data.child.removeClass("n2_ss_absolute_parent_picker__component--focused"),this.done()}.bind(this))},r.prototype.done=function(){this.data.child.data("layerObject").placement.current.parentPicked(this.data.parent.data("layerObject"),this.data.parentHAlign,this.data.parentVAlign,this.data.childHAlign,this.data.childVAlign),this.destroy()},r.prototype._destroy=function(){this.data.parent&&this.data.parent.removeClass("n2_ss_absolute_parent_picker__component--focused"),this.data.child.removeClass("n2_ss_absolute_parent_picker__component--focused"),s(".n2_ss_absolute_parent_picker__overlay").remove()},r.prototype.destroy=function(){nextend.tooltipMouse.hide(),this._destroy(),s("body").off(".n2-ss-parent-linker"),N2Classes.Esc.pop(),this.status=e},r.prototype.change=function(t){this.element.val(t).trigger("change"),this._setValue(t),this.triggerOutsideChange()},r.prototype.insideChange=function(t){this.element.val(t),this._setValue(t),this.triggerInsideChange()},r.prototype._setValue=function(t){this.$picker.toggleClass("n2_ss_absolute_parent_picker--active",!this.isEmpty(t))},r.prototype.isEmpty=function(t){return""===t||null===t},r}),N2D("FormElementPostAnimationManager",["FormElementAnimationManager"],function(t,e){function i(){this.empty=!0,N2Classes.FormElementAnimationManager.prototype.constructor.apply(this,arguments)}return((i.prototype=Object.create(N2Classes.FormElementAnimationManager.prototype)).constructor=i).prototype.clear=function(t){t.preventDefault(),t.stopPropagation();t=this.element.val().split("|*|");t[2]="",this.val(t.join("|*|"))},i.prototype.updateName=function(t){t=t.split("|*|")[2],N2Classes.FormElementAnimationManager.prototype.updateName.call(this,t)},i.prototype.relatedFieldsOff=function(){return""===this.element.val().split("|*|")[2]},i}),N2D("FormElementSliderWidgetArea",["FormElement"],function(e,t){function i(t){this.element=e("#"+t),this.area=this.element.parent(),this.areas=this.area.find(".n2_field_widget_area__area"),this.areas.on("click",this.chooseArea.bind(this)),N2Classes.FormElement.prototype.constructor.call(this)}return((i.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=i).prototype.chooseArea=function(t){t=parseInt(e(t.target).data("area"));this.element.val(t),this.setSelected(t),this.triggerOutsideChange()},i.prototype.insideChange=function(t){t=parseInt(t),this.element.val(t),this.setSelected(t),this.triggerInsideChange()},i.prototype.setSelected=function(t){this.areas.removeClass("n2_field_widget_area__area--selected"),this.areas.eq(t-1).addClass("n2_field_widget_area__area--selected")},i}),N2D("FormElementWidgetPosition",function(e,i){function t(t){this.id=t,this.$element=e("#"+t),this.$label=this.$element.find(".n2_field_widget_position__label"),this.$positionElement=e("#"+t+"-area").on("nextendChange",this.onPositionChange.bind(this)),this.positionValue=this.$positionElement.val(),this.$offsetElement=e("#"+t+"-offset").on("nextendChange",this.onOffsetChange.bind(this)),this.offsetValue=this.$offsetElement.val(),this.$positionMode=e("#"+t+"-mode").on("nextendChange",this.onModeChange.bind(this)),this.modeValue=this.$positionMode.val(),this.refreshLabel(),this.$element.on("click",this.toggle.bind(this)),this.$element.find(".n2_field_widget_position__popover").on("click",this.stopPropagation.bind(this))}return t.prototype.stopPropagation=function(t){return t.originalEvent["handled"+this.id]!==i||!(t.originalEvent["handled"+this.id]=!0)},t.prototype.toggle=function(t){this.$element.hasClass("n2_field_widget_position--focus")?this.blur(t):this.focus(t)},t.prototype.focus=function(t){this.stopPropagation(t)||(this.$element.addClass("n2_field_widget_position--focus"),e("body").on("click."+this.id,this.blur.bind(this)))},t.prototype.blur=function(t){this.stopPropagation(t)||(this.$element.removeClass("n2_field_widget_position--focus"),e("body").off("click."+this.id))},t.prototype.refreshLabel=function(){var t="";if("advanced"===this.modeValue)t=n2_("Advanced");else{switch(parseInt(this.positionValue)){case 1:t=n2_sprintf(n2_("Outer %s"),n2_("Top"));break;case 2:t=n2_("Top")+" "+n2_("Left");break;case 3:t=n2_("Top")+" "+n2_("Center");break;case 4:t=n2_("Top")+" "+n2_("Right");break;case 5:t=n2_sprintf(n2_("Outer %s"),n2_("Left"));break;case 6:t=n2_("Middle")+" "+n2_("Left");break;case 7:t=n2_("Middle")+" "+n2_("Right");break;case 8:t=n2_sprintf(n2_("Outer %s"),n2_("Right"));break;case 9:t=n2_("Bottom")+" "+n2_("Left");break;case 10:t=n2_("Bottom")+" "+n2_("Center");break;case 11:t=n2_("Bottom")+" "+n2_("Right");break;case 12:t=n2_sprintf(n2_("Outer %s"),n2_("Bottom"))}0!==parseInt(this.offsetValue)&&(t+=" + "+this.offsetValue+"px")}this.$label.text(t)},t.prototype.onPositionChange=function(){this.positionValue=this.$positionElement.val(),this.refreshLabel()},t.prototype.onOffsetChange=function(){this.offsetValue=this.$offsetElement.val(),this.refreshLabel()},t.prototype.onModeChange=function(){this.modeValue=this.$positionMode.val(),this.refreshLabel()},t}),N2D("GeneratorAdd",function(t,e){function i(t){N2Classes.Form.prototype.constructor.call(this),N2R("documentReady",this.onReady.bind(this))}return((i.prototype=Object.create(N2Classes.Form.prototype)).constructor=i).prototype.onReady=function(){this.setID("#n2-ss-form-generator-add"),N2Classes.Form.prototype.onReady.call(this),this.$form.on("submit",this.onSubmit.bind(this))},i.prototype.resetChangeTracker=function(){},i.prototype.initButtons=function(){this.$saveButton=t(".n2_generator_add").on("click",this.actionSave.bind(this)),t(".n2_generator_add_cancel").on("click",this.actionCancel.bind(this))},i.prototype.actionSave=function(t){t&&t.preventDefault(),this.skipChangeConfirm=!0,this.$form.submit(),this.afterSave()},i.prototype.actionCancel=function(t){t&&t.preventDefault(),window.location=t.currentTarget.href},i.prototype.onSubmit=function(t){t.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:this.$form.attr("action"),data:this.$form.serialize(),dataType:"json"})},i}),N2D("GeneratorConfigure",function(t,e){function i(t){N2Classes.Form.prototype.constructor.call(this),N2R("documentReady",this.onReady.bind(this))}return((i.prototype=Object.create(N2Classes.Form.prototype)).constructor=i).prototype.onReady=function(){this.setID("#n2-ss-form-generator-configure"),N2Classes.Form.prototype.onReady.call(this),this.$form.on("submit",this.onSubmit.bind(this))},i.prototype.initButtons=function(){this.$saveButton=t(".n2_generator_configuration_save").on("click",this.actionSave.bind(this)),t(".n2_generator_configuration_cancel").on("click",this.actionCancel.bind(this))},i.prototype.actionSave=function(t){t&&t.preventDefault(),this.skipChangeConfirm=!0,this.$form.submit(),this.afterSave()},i.prototype.actionCancel=function(t){t&&t.preventDefault(),window.location=t.currentTarget.href},i.prototype.onSubmit=function(t){t.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:this.$form.attr("action"),data:this.$form.serialize(),dataType:"json"})},i}),N2D("GeneratorEdit",function(e,t){function i(t){N2Classes.Form.prototype.constructor.call(this),this.options=e.extend({previewInNewWindow:!1,previewUrl:""},t),N2R("documentReady",this.onReady.bind(this))}return((i.prototype=Object.create(N2Classes.Form.prototype)).constructor=i).prototype.onReady=function(){this.setID("#n2-ss-form-generator-edit"),N2Classes.Form.prototype.onReady.call(this),this.$form.on("submit",this.onSubmit.bind(this)),this.initPreview()},i.prototype.initButtons=function(){this.$saveButton=e(".n2_generator_settings_save").on("click",this.actionSave.bind(this)),e(".n2_generator_settings_back").on("click",this.actionCancel.bind(this))},i.prototype.actionSave=function(t){t&&t.preventDefault(),this.skipChangeConfirm=!0,this.$form.submit(),this.afterSave()},i.prototype.actionCancel=function(t){t&&t.preventDefault(),window.location=t.currentTarget.href},i.prototype.onSubmit=function(t){!0!==this.$form.data("preview")&&(t.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:this.$form.attr("action"),data:this.$form.serialize(),dataType:"json"}))},i.prototype.initPreview=function(){this.options.previewInNewWindow||(this.modal=new N2Classes.ModalIframe("preview-slider")),e("#n2-ss-preview").on("click",function(t){t.preventDefault(),this.$form.data("preview",!0),this.options.previewInNewWindow?N2Classes.PreviewPopup("","preview-slider"):this.modal.show();t=this.$form.attr("action");this.$form.attr({action:N2Classes.AjaxHelper.makeAjaxUrl(this.options.previewUrl,{nextendaction:this.options.previewInNewWindow?"index":"generator"}),target:"preview-slider"}).submit().attr({action:t,target:null}),this.$form.data("preview",!1)}.bind(this))},i}),N2D("FieldRecordViewer",function(i,t){function e(t,e){this.ajaxUrl=e,this.$element=i("#"+t).on("click",this.showRecords.bind(this)),this.$form=this.$element.closest("form")}return e.prototype.showRecords=function(t){t.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:this.ajaxUrl,data:this.$form.serialize(),dataType:"json"}).done(function(t){null!==t.data&&N2Classes.ModalGeneratorRecordViewer(t.data.headings,t.data.rows)})},e}),N2D("FormElementAutoPlayPicker",["FormElementMixed"],function(e,i){function t(t,e,i){this.separator=i,N2Classes.FormElementMixed.prototype.constructor.apply(this,arguments),this.$element=this.element.parent(),this.id=t,this.$label=this.$element.find(".n2_field_autoplaypicker__label"),this.refreshLabel(),this.$element.on("click",this.toggle.bind(this)),this.$element.find(".n2_field_autoplaypicker__popover").on("click",this.stopPropagation.bind(this))}return((t.prototype=Object.create(N2Classes.FormElementMixed.prototype)).constructor=t).prototype.onFieldChange=function(){N2Classes.FormElementMixed.prototype.onFieldChange.call(this),this.refreshLabel()},t.prototype.insideChange=function(t){N2Classes.FormElementMixed.prototype.insideChange.call(this,t),this.refreshLabel()},t.prototype.refreshLabel=function(){var t=this.getValue().split(this.separator),e=parseInt(t[0]),i=t[1],s=t[2],t="";"slide"===i?t=n2_sprintf(n2_("Switches %s slide(s)."),e):"loop"===i?"current"===s?t=n2_sprintf(n2_("Loops %s and stops before starting slide."),e):"next"===s&&(t=n2_sprintf(n2_("Loops %s and returns to starting slide."),e)):"slideindex"===i&&(t=n2_sprintf(n2_("Switches to the %s. slide."),e)),this.$label.text(t)},t.prototype.stopPropagation=function(t){return t.originalEvent["handled"+this.id]!==i||!(t.originalEvent["handled"+this.id]=!0)},t.prototype.toggle=function(t){this.$element.hasClass("n2_field_autoplaypicker--focus")?this.blur(t):this.focus(t)},t.prototype.focus=function(t){this.stopPropagation(t)||(this.$element.addClass("n2_field_autoplaypicker--focus"),e("body").on("click."+this.id,this.blur.bind(this)))},t.prototype.blur=function(t){this.stopPropagation(t)||(this.$element.removeClass("n2_field_autoplaypicker--focus"),e("body").off("click."+this.id))},t}),N2D("FormElementParticleManager",["FormElement"],function(i,t){function e(t,e){this.element=i("#"+t),this.parent=this.element.parent(),N2Classes.FormElement.prototype.constructor.call(this),this.options=i.extend({editUrl:""},e),this.parent.find(".n2_field_chooser__clear").on("click",this.clear.bind(this)),this.parent.find(".n2_field_chooser__choose, .n2_field_chooser__label").on("click",this.show.bind(this)),this.$name=this.parent.find(".n2_field_chooser__label"),this.updateName(this.element.val()),this.updateIsEmpty(),this.form=i("#n2-ss-edit-slider-form"),this.formAction=this.form.attr("action"),this.onMessage=function(t){if(t.source===this.iframeWindow)try{var e=JSON.parse(t.data);switch(e.action){case"ready":this.iframeReadyDeferred.resolve();break;case"save":this.val(e.data),this.removeLightbox();break;case"cancel":this.removeLightbox()}}catch(t){}}.bind(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.show=function(t){t.preventDefault(),N2Classes.LoadingScreen.startLoading(),this.iframeReadyDeferred=i.Deferred(),this.$lightbox=i('<div class="n2_fullscreen_editor n2_fullscreen_editor--visible"><div class="n2_fullscreen_editor__overlay"></div></div>').appendTo("body");var t=i('<div class="n2_fullscreen_editor__window"></div>').appendTo(this.$lightbox),e=i('<iframe name="n2-ss-particleframe"></iframe>').appendTo(t);this.form.attr({action:this.options.editUrl,target:"n2-ss-particleframe"}).submit().attr({action:this.formAction,target:null}),this.iframeWindow=e[0].contentWindow||e[0].contentDocument,window.addEventListener("message",this.onMessage,!1),this.iframeReadyDeferred.done(function(){this.iframeWindow.postMessage(JSON.stringify({action:"load",data:this.element.val()}),"*"),N2Classes.LoadingScreen.stopLoading(),e.focus()}.bind(this))},e.prototype.removeLightbox=function(){this.$lightbox.remove(),this.$lightbox=null,window.removeEventListener("message",this.onMessage,!1)},e.prototype.clear=function(t){t.preventDefault(),t.stopPropagation();t=this.element.val().split("|*|");t[2]="",this.val(t.join("|*|"))},e.prototype.change=function(){this.updateIsEmpty(),this.triggerOutsideChange()},e.prototype.save=function(t,e){this.val(e)},e.prototype.val=function(t){this.element.val(t),this.updateName(t),this.change()},e.prototype.insideChange=function(t){this.updateName(t),N2Classes.FormElementText.prototype.insideChange.call(this,t)},e.prototype.updateName=function(t){var e="";try{e=JSON.parse(t)?n2_("Enabled"):n2_("Disabled")}catch(t){e=n2_("Disabled")}this.$name.text(e)},e.prototype.updateIsEmpty=function(){this.parent.toggleClass("n2_field_chooser--empty",this.isEmpty(this.element.val()))},e.prototype.isEmpty=function(t){try{if(JSON.parse(t))return!1}catch(t){}return!0},e}),N2D("FormElementShapeDividerManager",["FormElement"],function(i,t){function e(t,e){this.element=i("#"+t),this.parent=this.element.parent(),N2Classes.FormElement.prototype.constructor.call(this),this.options=i.extend({editUrl:""},e),this.parent.find(".n2_field_chooser__clear").on("click",this.clear.bind(this)),this.parent.find(".n2_field_chooser__choose, .n2_field_chooser__label").on("click",this.show.bind(this)),this.$name=this.parent.find(".n2_field_chooser__label"),this.updateName(this.element.val()),this.updateIsEmpty(),this.form=i("#n2-ss-edit-slider-form"),this.formAction=this.form.attr("action"),this.onMessage=function(t){if(t.source===this.iframeWindow)try{var e=JSON.parse(t.data);switch(e.action){case"ready":this.iframeReadyDeferred.resolve();break;case"save":this.val(e.data),this.removeLightbox();break;case"cancel":this.removeLightbox()}}catch(t){}}.bind(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.show=function(t){t.preventDefault(),N2Classes.LoadingScreen.startLoading(),this.iframeReadyDeferred=i.Deferred(),this.$lightbox=i('<div class="n2_fullscreen_editor n2_fullscreen_editor--visible"><div class="n2_fullscreen_editor__overlay"></div></div>').appendTo("body");var t=i('<div class="n2_fullscreen_editor__window"></div>').appendTo(this.$lightbox),e=i('<iframe name="n2-ss-shapedividerframe"></iframe>').appendTo(t);this.form.attr({action:this.options.editUrl,target:"n2-ss-shapedividerframe"}).submit().attr({action:this.formAction,target:null}),this.iframeWindow=e[0].contentWindow||e[0].contentDocument,window.addEventListener("message",this.onMessage,!1),this.iframeReadyDeferred.done(function(){this.iframeWindow.postMessage(JSON.stringify({action:"load",data:this.element.val()}),"*"),N2Classes.LoadingScreen.stopLoading(),e.focus()}.bind(this))},e.prototype.removeLightbox=function(){this.$lightbox.remove(),this.$lightbox=null,window.removeEventListener("message",this.onMessage,!1)},e.prototype.clear=function(t){t.preventDefault(),this.val("")},e.prototype.change=function(){this.updateIsEmpty(),this.triggerOutsideChange()},e.prototype.save=function(t,e){this.val(e)},e.prototype.val=function(t){this.element.val(t),this.updateName(t),this.change()},e.prototype.insideChange=function(t){this.updateName(t),N2Classes.FormElementText.prototype.insideChange.call(this,t)},e.prototype.updateName=function(t){var e="";try{var i=JSON.parse(t),e=i.top&&i.bottom?n2_("Top and bottom"):i.top?n2_("Top"):i.bottom?n2_("Bottom"):n2_("Disabled")}catch(t){e=n2_("Disabled")}this.$name.text(e)},e.prototype.updateIsEmpty=function(){this.parent.toggleClass("n2_field_chooser--empty",this.isEmpty(this.element.val()))},e.prototype.isEmpty=function(t){try{var e=JSON.parse(t);if(e.top||e.bottom)return!1}catch(t){}return!0},e}),N2D("FormElementSplitTextAnimationManager",["FormElement"],function(a,t){function e(t,e){this.element=a("#"+t),this.parent=this.element.parent(),N2Classes.FormElement.prototype.constructor.call(this),this.parameters=a.extend({linkedRelatedFields:!1},e),this.parent.find(".n2_field_chooser__clear").on("click",this.clear.bind(this)),this.parent.find(".n2_field_chooser__choose, .n2_field_chooser__label").on("click",this.show.bind(this)),this.$name=this.parent.find(".n2_field_chooser__label"),this.updateName(this.element.val()),this.updateIsEmpty(),this.hideRelatedFields()}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.isEmpty=function(t){return""===t},e.prototype.show=function(t){t.preventDefault(),this.parameters.font&&nextend.splittextanimationManager.setConnectedFont(this.parameters.font),this.parameters.style&&nextend.splittextanimationManager.setConnectedStyle(this.parameters.style),nextend.splittextanimationManager.show(this.element.val(),this.save.bind(this),{previewMode:"0",previewHTML:this.parameters.preview,group:this.parameters.group,transformOrigin:a("#"+this.parameters.transformOrigin)})},e.prototype.clear=function(t){t.preventDefault(),this.val("")},e.prototype.change=function(){this.updateIsEmpty(),this.hideRelatedFields(),this.triggerOutsideChange()},e.prototype.save=function(t,e){this.val(e)},e.prototype.val=function(t){this.element.val(t),this.updateName(t),this.change()},e.prototype.insideChange=function(t){this.updateName(t),N2Classes.FormElementText.prototype.insideChange.call(this,t),this.hideRelatedFields()},e.prototype.updateName=function(t){this.isEmpty(t)?this.$name.text(n2_("Disabled")):this.$name.text(n2_("Enabled"))},e.prototype.updateIsEmpty=function(){this.parent.toggleClass("n2_field_chooser--empty",this.isEmpty(this.element.val()))},e.prototype.isEmpty=function(t){return""===t},e.prototype.hideRelatedFields=function(){if(this.parameters.linkedRelatedFields&&this.parameters.linkedRelatedFields.linkedFields&&this.parameters.linkedRelatedFields.relatedFields){for(var t=!1,e=this.parameters.linkedRelatedFields.linkedFields,i=this.parameters.linkedRelatedFields.relatedFields,s=0;s<e.length;s++){var n=a("#"+e[s]);this.isEmpty(this.element.val())&&n.data("field")&&n.data("field").isEmpty(n.val())&&(t=!0)}for(s=0;s<i.length;s++){var o=a('[data-field="'+i[s]+'"]');o&&o.toggleClass("n2_form_element--hidden",t)}}},e}),N2D("FormElementDribbbleProjects",function(i,t){function e(t,e){this.element=i("#"+t),this.select=this.element.parent().find("select"),this.relatedField=i("#generatordribbble-user-id").on("nextendChange",this.refreshList.bind(this)),this.url=e}return e.prototype.refreshList=function(t){N2Classes.AjaxHelper.ajax({url:this.url,data:{method:"getProjects",userID:this.relatedField.val()}}).done(function(t){if(0!=t.data.length){for(var e in this.select.find("option").remove(),t.data)i('<option value="'+e+'"></option>').text(t.data[e]).appendTo(this.select);this.select.val(this.select.find("option:first").val()).trigger("change")}}.bind(this))},e}),N2D("FormElementDribbbleToken",function(i,t){function e(t,e){this.element=i("#"+t),this.element.parent().find(".n2_field_text__choose_text").on("click",this.requestToken.bind(this)),this.url=e}return e.prototype.requestToken=function(t){t.preventDefault(),N2Classes.AjaxHelper.ajax({url:this.url,data:i("#n2-ss-form-generator-configure").serialize()}).done(function(t){var e=(screen.width-1e3)/2,i=(screen.height-600)/2;window.open(t.data.authUrl,"Dribbble authentication","width=1000,height=600,toolbar=0,scrollbars=0,status=0,resizable=0,location=0,menuBar=0,left="+e+",top="+i)})},e}),N2D("FormElementFacebookAlbums",function(i,t){function e(t,e){this.element=i("#"+t),this.select=this.element.parent().find("select"),this.relatedField=i("#generatorfacebook-id").on("nextendChange",this.refreshList.bind(this)),this.url=e}return e.prototype.refreshList=function(t){N2Classes.AjaxHelper.ajax({url:this.url,data:{method:"getAlbums",facebookID:this.relatedField.val()}}).done(function(t){for(var e in this.select.find("option").remove(),t.data)i('<option value="'+e+'"></option>').text(t.data[e]).appendTo(this.select);this.select.val(this.select.find("option:first").val()).trigger("change")}.bind(this))},e}),N2D("FormElementFacebookToken",function(i,t){function e(t,e){this.element=i("#"+t),this.element.parent().find(".n2_field_text__choose_text").on("click",this.requestToken.bind(this)),this.url=e}return e.prototype.requestToken=function(t){t.preventDefault(),N2Classes.AjaxHelper.ajax({url:this.url,data:i("#n2-ss-form-generator-configure").serialize()}).done(function(t){var e=(screen.width-600)/2,i=(screen.height-600)/2;window.open(t.data.authUrl,"Facebook authentication","width=600,height=600,toolbar=0,scrollbars=0,status=0,resizable=0,location=0,menuBar=0,left="+e+",top="+i)})},e}),N2D("FormElementFlickrToken",function(i,t){function e(t,e){this.element=i("#"+t),this.element.parent().find(".n2_field_text__choose_text").on("click",this.requestToken.bind(this)),this.url=e}return e.prototype.requestToken=function(t){t.preventDefault(),N2Classes.AjaxHelper.ajax({url:this.url,data:i("#n2-ss-form-generator-configure").serialize()}).done(function(t){var e=(screen.width-1200)/2,i=(screen.height-1e3)/2;window.open(t.data.authUrl,"Flickr authentication","width=1200,height=1000,toolbar=0,scrollbars=0,status=0,resizable=0,location=0,menuBar=0,left="+e+",top="+i)})},e}),N2D("FormElementTwitterToken",function(i,t){function e(t,e){this.element=i("#"+t),this.element.parent().find(".n2_field_text__choose_text").on("click",this.requestToken.bind(this)),this.url=e}return e.prototype.requestToken=function(t){t.preventDefault(),N2Classes.AjaxHelper.ajax({url:this.url,data:i("#n2-ss-form-generator-configure").serialize()}).done(function(t){var e=(screen.width-1e3)/2,i=(screen.height-600)/2;window.open(t.data.authUrl,"Twitter authentication","width=1000,height=600,toolbar=0,scrollbars=0,status=0,resizable=0,location=0,menuBar=0,left="+e+",top="+i)})},e}),N2D("FormElementVimeoToken",function(i,t,e){function s(t,e){this.element=i("#"+t),this.element.parent().find(".n2_field_text__choose_text").on("click",this.requestToken.bind(this)),this.url=e}return s.prototype.requestToken=function(t){t.preventDefault(),N2Classes.AjaxHelper.ajax({url:this.url,data:i("#n2-ss-form-generator-configure").serialize()}).done(function(t){var e=(screen.width-1e3)/2,i=(screen.height-600)/2;window.open(t.data.authUrl,"Vimeo authentication","width=1000,height=600,toolbar=0,scrollbars=0,status=0,resizable=0,location=0,menuBar=0,left="+e+",top="+i)})},s}),N2D("FormElementYouTubePlaylists",function(i,t,e){function s(t,e){this.element=i("#"+t),this.select=this.element.parent().find("select"),this.relatedField=i("#generatorchannel-id").on("nextendChange",this.refreshList.bind(this)),this.url=e}return s.prototype.refreshList=function(t){N2Classes.AjaxHelper.ajax({url:this.url,data:{method:"getPlayListsAjax",channelID:this.relatedField.val()}}).done(function(t){for(var e in this.select.find("option").remove(),t.data)i('<option value="'+e+'"></option>').text(t.data[e]).appendTo(this.select);this.select.val(this.select.find("option:first").val()).trigger("change")}.bind(this))},s}),N2D("FormElementYoutubeToken",function(i,t){function e(t,e){this.element=i("#"+t),this.element.parent().find(".n2_field_text__choose_text").on("click",this.requestToken.bind(this)),this.url=e}return e.prototype.requestToken=function(t){t.preventDefault(),N2Classes.AjaxHelper.ajax({url:this.url,data:i("#n2-ss-form-generator-configure").serialize()}).done(function(t){var e=(screen.width-1e3)/2,i=(screen.height-600)/2;window.open(t.data.authUrl,"YouTube authentication","width=1000,height=600,toolbar=0,scrollbars=0,status=0,resizable=0,location=0,menuBar=0,left="+e+",top="+i)})},e}),N2D("SettingsFonts",function(t,e){function i(t){N2Classes.Form.prototype.constructor.call(this),N2R("documentReady",this.onReady.bind(this))}return((i.prototype=Object.create(N2Classes.Form.prototype)).constructor=i).prototype.onReady=function(){this.setID("#n2-ss-form-settings-fonts"),N2Classes.Form.prototype.onReady.call(this),this.$form.on("submit",this.onSubmit.bind(this))},i.prototype.initButtons=function(){this.$saveButton=t(".n2_settings_save").on("click",this.actionSave.bind(this))},i.prototype.actionSave=function(t){t&&t.preventDefault(),this.skipChangeConfirm=!0,this.$form.submit(),this.afterSave()},i.prototype.onSubmit=function(t){t.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:this.$form.attr("action"),data:this.$form.serialize(),dataType:"json"})},i}),N2D("SettingsFramework",function(t,e){function i(t){N2Classes.Form.prototype.constructor.call(this),N2R("documentReady",this.onReady.bind(this))}return((i.prototype=Object.create(N2Classes.Form.prototype)).constructor=i).prototype.onReady=function(){this.setID("#n2-ss-form-settings-framework"),N2Classes.Form.prototype.onReady.call(this),this.$form.on("submit",this.onSubmit.bind(this))},i.prototype.initButtons=function(){this.$saveButton=t(".n2_settings_save").on("click",this.actionSave.bind(this))},i.prototype.actionSave=function(t){t&&t.preventDefault(),this.skipChangeConfirm=!0,this.$form.submit(),this.afterSave()},i.prototype.onSubmit=function(t){t.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:this.$form.attr("action"),data:this.$form.serialize(),dataType:"json"})},i}),N2D("SettingsGeneral",function(t,e){function i(t){N2Classes.Form.prototype.constructor.call(this),N2R("documentReady",this.onReady.bind(this))}return((i.prototype=Object.create(N2Classes.Form.prototype)).constructor=i).prototype.onReady=function(){this.setID("#n2-ss-form-settings-general"),N2Classes.Form.prototype.onReady.call(this),this.$form.on("submit",this.onSubmit.bind(this))},i.prototype.initButtons=function(){this.$saveButton=t(".n2_settings_save").on("click",this.actionSave.bind(this))},i.prototype.actionSave=function(t){t&&t.preventDefault(),this.skipChangeConfirm=!0,this.$form.submit(),this.afterSave()},i.prototype.onSubmit=function(t){t.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:this.$form.attr("action"),data:this.$form.serialize(),dataType:"json"})},i}),N2D("SettingsItemDefaults",function(t,e){function i(t){N2Classes.Form.prototype.constructor.call(this),N2R("documentReady",this.onReady.bind(this))}return((i.prototype=Object.create(N2Classes.Form.prototype)).constructor=i).prototype.onReady=function(){this.setID("#n2-ss-form-settings-item-defaults"),N2Classes.Form.prototype.onReady.call(this),this.$form.on("submit",this.onSubmit.bind(this))},i.prototype.initButtons=function(){this.$saveButton=t(".n2_settings_save").on("click",this.actionSave.bind(this))},i.prototype.actionSave=function(t){t&&t.preventDefault(),this.skipChangeConfirm=!0,this.$form.submit(),this.afterSave()},i.prototype.onSubmit=function(t){t.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:this.$form.attr("action"),data:this.$form.serialize(),dataType:"json"})},i}),N2D("Slide",function(s,e){function n(t,e){this.selected=!1,this.manager=t,this.box=e.data("slide",this),this.editUrl=this.box.find(".n2_slide_box__slide_overlay_edit_button").attr("href"),this.isEdited=this.box.hasClass("n2_slide_box--currently-edited"),this.box.on("contextmenu",this.onContextMenu.bind(this)),this.box.find(".n2_slide_box__footer_status_published, .n2_slide_box__footer_status_unpublished").on("click",this.switchPublished.bind(this)),this.box.find(".n2_slide_box__slide_select_tick").on("click",function(t){t.preventDefault(),this.invertSelection()}.bind(this)),this.$more=this.box.find(".n2_slide_box__slide_action_more").on("click",this.onMore.bind(this)),this.initRename()}return n.prototype.onContextMenu=function(t){t.preventDefault(),this.showContextMenu(t)},n.prototype.onMore=function(t){t.preventDefault(),this.showContextMenu(this.$more[0])},n.prototype.showContextMenu=function(t){var e=[];e.push({priority:55,label:n2_("Duplicate"),icon:"ssi_16 ssi_16--duplicate",action:this.duplicate.bind(this)}),e.push({priority:55,label:n2_("Copy"),icon:"ssi_16 ssi_16--copy",action:this.copy.bind(this)}),this.box.hasClass("n2_slide_box--published")?e.push({priority:55,label:n2_("Unpublish"),icon:"ssi_16 ssi_16--filledremove",action:this.unpublish.bind(this)}):e.push({priority:55,label:n2_("Publish"),icon:"ssi_16 ssi_16--filledcheck",action:this.publish.bind(this)}),this.box.hasClass("n2_slide_box--has-generator")&&e.push({priority:55,label:n2_("Edit generator"),icon:"ssi_16 ssi_16--cog",action:this.goToEditGenerator.bind(this)}),this.box.hasClass("n2_slide_box--first-slide")||this.box.hasClass("n2_slide_box--static-overlay")||e.push({priority:55,label:n2_("Set as first"),icon:"ssi_16 ssi_16--star",action:function(){this.setFirst()}.bind(this)}),this.box.hasClass("n2_slide_box--static-overlay")&&e.push({priority:55,label:n2_("Convert to slide"),icon:"ssi_16 ssi_16--paste",action:this.convertToSlide.bind(this)}),e.push({priority:1e3,label:n2_("Delete"),icon:"ssi_16 ssi_16--delete",action:function(){this.delete()}.bind(this),color:"red"}),this.box.addClass("n2_slide_box--context-menu"),N2Classes.ContextMenu(t,e,{y:5,horizontalAlign:n2const.isRTL()?"right":"left",onClose:function(){this.box.removeClass("n2_slide_box--context-menu")}.bind(this)})},n.prototype.getSliderId=function(){return this.box.data("sliderid")},n.prototype.getId=function(){return this.box.data("slideid")},n.prototype.setFirst=function(t){t&&t.preventDefault(),N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.manager.ajaxUrl,{nextendaction:"first"}),type:"POST",data:{id:this.getId()}}).done(function(){this.manager.unsetFirst(),this.box.addClass("n2_slide_box--first-slide")}.bind(this))},n.prototype.unsetFirst=function(){this.box.removeClass("n2_slide_box--first-slide")},n.prototype.publish=function(){this.switchPublished()},n.prototype.unpublish=function(){this.switchPublished()},n.prototype.switchPublished=function(t){t&&t.preventDefault(),this.isPublished()?this.manager.unPublishSlides([this.getId()],[this]):this.manager.publishSlides([this.getId()],[this])},n.prototype.isPublished=function(){return this.box.hasClass("n2_slide_box--published")},n.prototype.published=function(){this.box.addClass("n2_slide_box--published")},n.prototype.unPublished=function(){this.box.removeClass("n2_slide_box--published")},n.prototype.duplicate=function(){var i=s.Deferred();return N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.manager.ajaxUrl,{nextendcontroller:"slides",nextendaction:"duplicate",sliderid:this.getSliderId(),slideid:this.getId()})}).done(function(t){var e=s(t.data).insertAfter(this.box),t=new n(this.manager,e);this.manager.initSlides(),i.resolve(t),nextend.tooltip.add(e)}.bind(this)),i},n.prototype.delete=function(t){t&&t.preventDefault(),this.manager.deleteSlides([this.getId()],[this])},n.prototype.deleted=function(){this.box.remove()},n.prototype.invertSelection=function(t){t&&t.preventDefault(),this.selected?this.deSelect():this.select()},n.prototype.select=function(){this.selected||(this.selected=!0,this.box.addClass("n2_slide_box--bulk-selected"),this.manager.addSelection(this))},n.prototype.deSelect=function(){this.selected&&(this.selected=!1,this.box.removeClass("n2_slide_box--bulk-selected"),this.manager.removeSelection(this))},n.prototype.goToEditGenerator=function(){window.location=this.box.data("generator-edit")},n.prototype.copy=function(){N2Classes.SelectSlider(n2_("Copy slide to")+" ...",function(t,e,i){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.manager.ajaxUrl,{nextendcontroller:"slides",nextendaction:"copy",targetGroupID:i,targetSliderID:t,sliderid:this.getSliderId(),slideid:this.getId()})})}.bind(this),!0)},n.prototype.initRename=function(){this.dblClickTimeout=!1,this.$label=this.box.find(".n2_slide_box__footer_title").on("click",function(t){"true"!==this.$label[0].contentEditable&&(this.dblClickTimeout?(clearTimeout(this.dblClickTimeout),this.dblClickTimeout=!1,this.editName()):this.dblClickTimeout=setTimeout(function(){this.isEdited||(window.location=this.editUrl),this.dblClickTimeout=!1}.bind(this),500))}.bind(this)),this.title=this.$label.text().trim(),this.$label.text(this.title)},n.prototype.editName=function(){new N2Classes.InlineTextEditor(this.$label[0],{onSave:function(t){this.title!==t&&N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.manager.ajaxUrl,{nextendcontroller:"slides",nextendaction:"rename",slideid:this.getId(),title:t})}).done(function(){this.title=t,this.isEdited&&(N2Classes.History.get().off(),nextend.currentEditor.fragmentEditor.mainContainer.outsideStoreProperty(e,"title",t,"slideTitleRename"),N2Classes.History.get().on())}.bind(this)).fail(function(){this.$label.text(this.title)}.bind(this))}.bind(this),onCancel:function(){this.$label.text(this.title)}.bind(this),onTab:function(t){for(var e=s(".n2_slide_box__footer_title"),i=0;i<e.length;i++)if(this.$label.is(e[i])){t.shiftKey?i--:i++;break}i<0?i=e.length-1:i>=e.length&&(i=0),e.eq(i).trigger("click").trigger("click")}.bind(this)})},n.prototype.convertToSlide=function(){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.manager.ajaxUrl,{nextendcontroller:"slides",nextendaction:"convertToSlide",sliderid:this.getSliderId(),slideid:this.getId()})}).done(function(){this.box.removeClass("n2_slide_box--static-overlay"),this.box.find(".n2_slide_box__details_static_slide").remove()}.bind(this))},n}),N2D("SlidesManager",function(d,l){function t(t,e,i,s,n){this.quickPostModal=null,this.parameters=e,this.slides=[],this.options=d.extend({sliderUrl:""},t),this.url=t.url,this.ajaxUrl=t.ajaxUrl,this.contentAjaxUrl=t.contentAjaxUrl,this.$slideManager=d(".n2_slide_manager"),this.slidesContainer=d(".n2_slide_manager__content"),this.initSlidesOrderable();for(var o,a,r=this.slidesContainer.find(".n2_slide_box"),l=0;l<r.length;l++)this.slides.push(new N2Classes.Slide(this,r.eq(l)));document.documentElement.setAttribute("data-slides",this.slides.length),d(".n2_slide_manager__add_slide, .n2_slide_manager__dummy_slide").on("click",function(){this.$slideManager.toggleClass("n2_slide_manager--add-slide")}.bind(this)),d(".n2_slide_manager__add_slide_action[data-action]").on("click",function(t){switch(t.preventDefault(),d(t.currentTarget).data("action")){case"image":this.addQuickImage(t);break;case"empty-slide":t.preventDefault(),this.createSlide("empty-slide");break;case"post":this.addQuickPost(t);break;case"static-overlay":t.preventDefault(),this.createSlide("static-overlay")}}.bind(this)),d(".n2-box-slide-dummy").on("click",this.addQuickImage.bind(this)),d(".n2_slide_manager__block_notice_button").on("click",this.changeSliderType.bind(this)),"changeslidertype"===window.location.hash.substring(1)&&(window.location.hash="",this.changeSliderType()),this.initBulk(),i||(o=[],new N2Classes.UIFileUpload(this.slidesContainer,{url:s,pasteZone:!1,dataType:"json",paramName:"image",dropZone:this.$slideManager,add:function(t,e){e.formData={path:"/"+n},e.submit()}.bind(this),done:function(t,e){e=e.result;e.data&&e.data.name?o.push({title:e.data.name.replace(/\.[^/.]+$/,""),description:"",image:e.data.url}):N2Classes.AjaxHelper.notification(e)}.bind(this),fail:function(t,e){N2Classes.AjaxHelper.notification(e.jqXHR.responseJSON)}.bind(this),start:function(){N2Classes.LoadingScreen.startLoading()},stop:function(){o.length?this._addQuickImages(o):setTimeout(function(){N2Classes.LoadingScreen.stopLoading()},100),o=[]}.bind(this)}),a=null,this.slidesContainer.on("dragover",function(t){null!==a?(clearTimeout(a),a=null):this.slidesContainer.addClass("n2-drag-over"),a=setTimeout(function(){this.slidesContainer.removeClass("n2-drag-over"),a=null}.bind(this),400)}.bind(this)))}return t.prototype.changed=function(){},t.prototype.initSlidesOrderable=function(){this.uiSortable=new N2Classes.UISortable(this.slidesContainer,{items:".n2_slide_box",stop:this.saveSlideOrder.bind(this),placeholder:"n2_slide_manager__sortable_placeholder",distance:10,helper:"clone"})},t.prototype.saveSlideOrder=function(){for(var t=this.slidesContainer.find(".n2_slide_box"),e=[],i=[],s=[],n=0;n<t.length;n++){var o=t.eq(n).data("slide");e.push(o),i.push(o.getId())}for(n=0;n<this.slides.length;n++)s.push(this.slides[n].getId());JSON.stringify(s)!==JSON.stringify(i)&&(d(window).triggerHandler("SmartSliderSidebarSlidesOrderChanged"),N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendcontroller:"slides",nextendaction:"order"}),data:{slideorder:i}}),this.slides=e,this.changed())},t.prototype.initSlides=function(){for(var t=this.slidesContainer.find(".n2_slide_box"),e=[],i=0;i<t.length;i++){var s=t.eq(i).data("slide");e.push(s)}this.slides=e,this.changed(),d(window).triggerHandler("SmartSliderSidebarSlidesChanged"),document.documentElement.setAttribute("data-slides",this.slides.length)},t.prototype.unsetFirst=function(){for(var t=0;t<this.slides.length;t++)this.slides[t].unsetFirst();this.changed()},t.prototype.addBoxes=function(t){t.appendTo(this.slidesContainer),t.addClass("n2_slide_box--just-added").each(function(t,e){new N2Classes.Slide(this,d(e))}.bind(this)),this.initSlides(),setTimeout(function(){t.removeClass("n2_slide_box--just-added")},200)},t.prototype.createSlide=function(t,e){return N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"create",type:t}),data:e}).done(function(t){this.addBoxes(d(t.data))}.bind(this))},t.prototype.addQuickImage=function(t){t.preventDefault(),nextend.imageHelper.openMultipleLightbox(this._addQuickImages.bind(this))},t.prototype._addQuickImages=function(t){for(var e=[],i=0;i<t.length;i++)t[i].image.match(/\.(mp4)/i)||e.push(t[i]);e.length&&this.createSlide("image",{images:N2Classes.Base64.encode(JSON.stringify(e))})},t.prototype.addQuickPost=function(t){var e,i,s,n,o,a,r;t.preventDefault(),this.quickPostModal||(i={},s=function(t){return i[t]===l&&(i[t]=N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.contentAjaxUrl),data:{keyword:t},dataType:"json"})),i[t]}.bind(e=this),this.quickPostModal=new N2Classes.ModalSimple("create-quick-post"),this.quickPostModal.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--post","green")),this.quickPostModal.addContent(N2Classes.UI.modalHeading(n2_("Add post"))),t=N2Classes.UI.modalFormRow(!0),this.quickPostModal.addContent(t),n=N2Classes.UI.modalFieldText(t,"keyword",n2_("Search keyword"),""),o="",t=N2Classes.UI.modalFormRow(!0),this.quickPostModal.addContent(t),a=!1,r=N2Classes.UI.modalSelectList(t,"quick-post",n2_("Posts"),function(t){a=t}),n.on("keyup",function(){o=n.val(),s(o).done(function(t){if(n.val()===o){r.removeOptions();for(var e=t.data,i=0;i<e.length;i++)r.addOption(e[i].title,e[i].info,e[i])}}.bind(this))}.bind(this)).trigger("keyup").focus(),t=N2Classes.UI.modalButton(n2_("Add post"),"green"),this.quickPostModal.addButton(t),t.on("click",function(){a?e._addQuickPost(this.quickPostModal,a):N2Classes.Notification.error(n2_("Please select a Post first!"))}.bind(this))),this.quickPostModal.show()},t.prototype._addQuickPost=function(t,e){e.image||(e.image=""),this.createSlide("post",{post:e}),t&&this.quickPostModal.hide()},t.prototype.initBulk=function(){this.selection=[],this.isBulkSelection=!1,d("#n2_slide_manager_bulk_actions a[data-action]").on("click",function(t){switch(t.preventDefault(),d(t.currentTarget).data("action")){case"duplicate":this.bulkAction("duplicateSlides");break;case"copy":this.bulkAction("copySlides");break;case"delete":this.bulkAction("deleteSlides");break;case"publish":this.bulkAction("publishSlides");break;case"unpublish":this.bulkAction("unPublishSlides");break;case"select-all":this.bulkSelect(function(t){t.select()});break;case"select-none":this.bulkSelect(function(t){t.deSelect()});break;case"select-published":this.bulkSelect(function(t){t.box.hasClass("n2_slide_box--published")?t.select():t.deSelect()});break;case"select-unpublished":this.bulkSelect(function(t){t.box.hasClass("n2_slide_box--published")?t.deSelect():t.select()})}}.bind(this)),d(".n2-bulk-actions a").on("click",function(t){var e=d(t.currentTarget).data("action");e&&(t.preventDefault(),this.bulkAction(e))}.bind(this))},t.prototype.addSelection=function(t){0==this.selection.length&&this.enterBulk(),this.selection.push(t)},t.prototype.removeSelection=function(t){this.selection.splice(this.selection.indexOf(t),1),0==this.selection.length&&this.leaveBulk()},t.prototype.bulkSelect=function(t){for(var e=0;e<this.slides.length;e++)t(this.slides[e])},t.prototype.bulkAction=function(t){var e=[],i=[];this.bulkSelect(function(t){t.selected&&(e.push(t),i.push(t.getId()))}),i.length?this[t](i,e):N2Classes.Notification.notice("Please select one or more slides for the action!")},t.prototype.enterBulk=function(){this.isBulkSelection||(this.isBulkSelection=!0,this.uiSortable.setOption("disabled",!0),d(".n2_slide_manager").addClass("n2_slide_manager--bulk-select"))},t.prototype.leaveBulk=function(){if(this.isBulkSelection){this.uiSortable.setOption("disabled",!1),d(".n2_slide_manager").removeClass("n2_slide_manager--bulk-select");for(var t=0;t<this.slides.length;t++)this.slides[t].deSelect();this.selection=[],this.isBulkSelection=!1}},t.prototype.deleteSlides=function(e,i){var t=1<i.length?n2_("delete these slides"):n2_("delete this slide"),s=parseInt(d(".n2-ss-currently-edited-slide").attr("data-id"));N2Classes.ModalDeleteConfirm(t,function(){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"delete"}),type:"POST",data:{slides:e}}).done(function(){for(var t=0;t<i.length;t++)i[t].deleted();this.initSlides(),this.leaveBulk(),-1!==e.indexOf(s)&&(window.location=this.options.sliderUrl)}.bind(this))}.bind(this))},t.prototype.duplicateSlides=function(t,e){for(var i=0;i<this.slides.length;i++)this.slides[i].selected&&this.slides[i].duplicate(d.Event("click",{currentTarget:null}))},t.prototype.copySlides=function(s){N2Classes.SelectSlider(n2_("Copy slide to")+" ...",function(t,e,i){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"copySlides",targetGroupID:i,targetSliderID:t}),type:"POST",data:{slides:s}})}.bind(this),!0)},t.prototype.publishSlides=function(t,e){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"publish"}),type:"POST",data:{slides:t}}).done(function(){for(var t=0;t<e.length;t++)e[t].published();this.changed()}.bind(this))},t.prototype.unPublishSlides=function(t,e){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"unpublish"}),type:"POST",data:{slides:t}}).done(function(){for(var t=0;t<e.length;t++)e[t].unPublished();this.changed()}.bind(this))},t.prototype.changeSliderType=function(t){nextend.changeSliderType!==l&&(t&&t.preventDefault(),nextend.changeSliderType.showModal())},t}),N2D("SmartSliderSlideBackgroundAdmin",["SmartSliderSlideBackground"],function(s,t){function e(t,e,i){this.types={color:"SmartSliderAdminSlideBackgroundColor",image:"SmartSliderAdminSlideBackgroundImage",video:"SmartSliderAdminSlideBackgroundVideo"},this.allowVisualLoad=!0,this.slider=t.slider,N2Classes.SmartSliderSlideBackground.prototype.constructor.call(this,t,e,i)}return((e.prototype=Object.create(N2Classes.SmartSliderSlideBackground.prototype)).constructor=e).prototype.setRelatedSectionSlide=function(t){this.sectionSlide=t},e.prototype.setVisualLoad=function(t){this.allowVisualLoad=t},e.prototype.setType=function(t){"color"===t?(this.elements.color||this.createColorElement(!0),this.elements.image&&(this.elements.image.kill(),this.elements.image=!1),this.elements.video&&(this.elements.video.kill(),this.elements.video=!1)):"image"===t?(this.elements.color||this.createColorElement(!0),this.elements.image||this.createImageElement(),this.elements.video&&(this.elements.video.kill(),this.elements.video=!1)):"video"===t&&(this.elements.image&&(this.elements.image.kill(),this.elements.image=!1),this.elements.color||this.createColorElement(!0),this.elements.video||this.createVideoElement())},e.prototype.setMode=function(t){"default"===t&&(t=this.slider.editor.options.slideBackgroundMode),this.element.attr("data-mode",t),this.elements.image&&this.elements.image.updateMode(t,this.mode),this.mode=t},e.prototype.setFocus=function(t,e){this.elements.image&&this.elements.image.updateFocus(t,e)},e.prototype.setImageOpacity=function(t){this.elements.image&&this.elements.image.updateOpacity(t)},e.prototype.setBlur=function(t){this.elements.image&&this.elements.image.updateBlur(t)},e.prototype.createColorElement=function(t){t=t||!1,this.elements.color=new N2Classes[this.types.color](this,s('<div class="n2-ss-slide-background-color"></div>').appendTo(this.$wrapElement)),t&&this.elements.color.update(this.sectionSlide.getProperty("backgroundColor"),this.sectionSlide.getProperty("backgroundGradient"),this.sectionSlide.getProperty("backgroundColorEnd"),this.sectionSlide.getProperty("backgroundColorOverlay"))},e.prototype.updateColor=function(t,e,i,s){this.elements.color||this.createColorElement(),this.elements.color.update(t,e,i,s)},e.prototype.createImageElement=function(){var t,e=nextend.currentEditor.generator.fill(this.sectionSlide.getProperty("backgroundImage"));""!==e&&(t=nextend.imageHelper.fixed(e),t=s('<div class="n2-ss-slide-background-image"></div>').css({opacity:this.sectionSlide.getProperty("backgroundImageOpacity")/100,backgroundPosition:nextend.currentEditor.generator.fill(this.sectionSlide.getProperty("backgroundFocusX"))+"% "+nextend.currentEditor.generator.fill(this.sectionSlide.getProperty("backgroundFocusY"))+"%"}).attr({"data-hash":md5(e),"data-desktop":t,"data-blur":this.sectionSlide.getProperty("backgroundImageBlur")}).appendTo(this.$wrapElement),this.elements.image=new N2Classes[this.types.image](this.slide,this.manager,this,t),this.elements.image.preLoadAdmin(e))},e.prototype.setImage=function(t){this.elements.image?this.elements.image.setDesktopSrc(t):""!==t&&(null===t.match(/\.(png|jpg|jpeg|gif|webp|svg)/i)?(N2Classes.Notification.error("The background image format is not correct! The supported image formats are: png, jpg, jpeg, gif, webp, svg."),s("#layerslide-backgroundImage").val("").trigger("change")):"image"===this.sectionSlide.getProperty("background-type")&&this.createImageElement())},e.prototype.setThumbnail=function(t,e){var i=s("#layerslide-thumbnail");""===t||!t.match(/\.(png|jpg|jpeg|gif|webp|svg)/i)||""!==i.val()&&i.val()!==e||i.val(t).trigger("change")},e.prototype.createVideoElement=function(){var t=nextend.imageHelper.fixed(nextend.currentEditor.generator.fill(this.sectionSlide.getProperty("backgroundVideoMp4")));""!==t&&(null===t.toLowerCase().match(/\.(mp4)$/)?(N2Classes.Notification.error("The background video format is not correct! Only MP4 videos are supported."),s("#slidebackgroundVideoMp4").val("").trigger("change")):(t=s('<video muted loop preload="auto" playsinline="playsinline" webkit-playsinline="webkit-playsinline"></video>').attr({class:"n2-ss-slide-background-video n2-ow n2-active","data-mode":this.sectionSlide.getProperty("backgroundVideoMode")}).append('<source src="'+t+'" type="video/mp4">').appendTo(this.$wrapElement),this.elements.video=new N2Classes[this.types.video](this.slide,this,t),this.elements.video.updateOpacity(this.sectionSlide.getProperty("backgroundVideoOpacity"))))},e.prototype.setVideo=function(){this.elements.video&&this.elements.video.kill(),this.createVideoElement()},e.prototype.setVideoMode=function(t){this.elements.video&&this.elements.video.updateVideoMode(t)},e.prototype.setVideoOpacity=function(t){this.elements.video&&this.elements.video.updateOpacity(t)},e}),N2D("SlideEdit",function(s,o){function t(t){this.options=s.extend({ajaxUrl:"",slideAsFile:0,nextendAction:"",previewInNewWindow:!1,previewUrl:"",sliderElementID:"",slideEditorOptions:{}},t),this.editor=new N2Classes.EditorSlide(this,this.options.sliderElementID,this.options.slideEditorOptions),N2Classes.Form.prototype.constructor.call(this),N2R("documentReady",this.onReady.bind(this))}return((t.prototype=Object.create(N2Classes.Form.prototype)).constructor=t).prototype.onReady=function(){"create"===this.options.nextendAction&&this.initBackgroundOpen(),this.setID("#n2-ss-form-slide-edit"),N2Classes.Form.prototype.onReady.call(this),this.initPreview()},t.prototype.initBackgroundOpen=function(){N2R("windowLoad",function(t){t(".n2_form__tab_button[data-related-tab=n2_form__tab_slide_slide-background]").trigger("click")})},t.prototype.resetChangeTracker=function(){this.hasChange=!1,document.addEventListener("historyChange",this.onChangeCallback,{passive:!0,capture:!0}),this.$saveButton.addClass("n2_button--inactive")},t.prototype.onChange=function(){this.hasChange=!0,this.$saveButton.removeClass("n2_button--inactive"),document.removeEventListener("historyChange",this.onChangeCallback,{passive:!0,capture:!0})},t.prototype.initButtons=function(){this.$saveButton=s(".n2_slide_settings_save").on("click",this.actionSave.bind(this)),s(".n2_slide_settings_back").on("click",this.actionCancel.bind(this)),s(".n2_slide_generator_static_save").on("click",function(t){this.actionSave(t,!0)}.bind(this))},t.prototype.actionSave=function(t,e){t&&t.preventDefault(),N2Classes.LayerNavigationTimeline.get().timelineControl.exitPreviewMode();var i=this.editor.getFormData();if(!0===e&&(i.generatorStatic="1"),this.options.slideAsFile&&typeof window.FormData!==o&&window.File!==o){var s,n=new FormData;try{n.append("slide",new Blob([i.slide]),"slide.txt")}catch(t){try{n.append("slide",new Blob([i.slide]))}catch(t){try{n.append("slide",new File([i.slide],"slide.txt"))}catch(t){N2Classes.Notification.notice('Your browser does not support File api, please disable "Send slide as file" option in the global settings.')}}}for(s in delete i.slide,i)n.append(s,i[s]);N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.options.ajaxUrl),type:"POST",data:n,contentType:!1,processData:!1}).done(this.afterSave.bind(this))}else N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.options.ajaxUrl),data:i,dataType:"json"}).done(this.afterSave.bind(this))},t.prototype.actionCancel=function(t){t&&t.preventDefault(),window.location=t.currentTarget.href},t.prototype.afterSave=function(){var t=this.editor.fragmentEditor.mainContainer,e=s(".n2_admin_editor__ui_slide_manager .n2_slide_box--currently-edited ");e.find(".n2_slide_box__footer_title").text(t.getProperty("title")),e.find(".n2_slide_box__content").css("background-image","url("+nextend.imageHelper.fixed(this.editor.generator.fill(t.getProperty("thumbnail")||t.getProperty("backgroundImage")||"$ss3-frontend$/images/placeholder/image.png"))+")");var i=[];parseInt(t.getProperty("desktopLandscape"))||i.push(n2_("Large desktop")),parseInt(t.getProperty("desktopPortrait"))||i.push(n2_("Desktop")),parseInt(t.getProperty("tabletLandscape"))||i.push(n2_("Large tablet")),parseInt(t.getProperty("tabletPortrait"))||i.push(n2_("Tablet")),parseInt(t.getProperty("mobileLandscape"))||i.push(n2_("Large mobile")),parseInt(t.getProperty("mobilePortrait"))||i.push(n2_("Mobile"));t="";i.length&&(t=n2_sprintf(n2_("This slide is hidden on the following devices: %s"),i.join(", "))),e.find(".n2_slide_box__footer_status_hidden").data("n2tip",t),N2Classes.Form.prototype.afterSave.call(this)},t.prototype.initPreview=function(){this.options.previewInNewWindow||(this.modal=new N2Classes.ModalIframe("preview-slider")),s("#n2-ss-preview").on("click",function(t){t.preventDefault(),this.options.previewInNewWindow?N2Classes.PreviewPopup("","preview-slider"):this.modal.show();var e=s('<form style="display:none;"></form>').attr({method:"post",action:N2Classes.AjaxHelper.makeAjaxUrl(this.options.previewUrl,{nextendaction:"slide",frame:this.options.previewInNewWindow?0:1}),target:"preview-slider"}).appendTo("body"),t=this.editor.getFormData();s('<input name="slide" />').val(t.slide).appendTo(e),e.submit()}.bind(this))},t}),N2D("EditorAbstract",function(s,n){function t(t,e){var i;(i=function(){var t=navigator.userAgent.toLowerCase();return-1!==t.indexOf("msie")&&parseInt(t.split("msie")[1])}())&&i<10&&alert(window.ss2lang.The_editor_was_tested_under_Internet_Explorer_10_Firefox_and_Chrome_Please_use_one_of_the_tested_browser),this.readyDeferred=s.Deferred(),this.sliderElementID=t,this.readyDeferred.done(function(){N2D("SSEditor",function(){return this}.bind(this))}.bind(this)),this.options=s.extend({isUploadDisabled:!0,uploadUrl:"",uploadDir:"",settingsGoProUrl:"",sectionLibraryFree:!0,sectionLibraryUrl:"",sectionLibraryGoProUrl:""},e),(nextend.currentEditor=this).frontend=null,this.generator=null,this.fragmentEditor=null,this.$editedElement=null,this.editedInstance=null,N2R("documentReady",function(t){nextend.fontsDeferred!==n?nextend.fontsDeferred.done(this.startEditor.bind(this)):this.startEditor()}.bind(this))}return t.prototype.startEditor=function(){},t.prototype.ready=function(t){this.readyDeferred.done(t)},t.prototype.getSelf=function(){return this},t.prototype.getAvailableDeviceModes=function(){return{desktopPortrait:1,desktopLandscape:0,tabletPortrait:1,tabletLandscape:0,mobilePortrait:1,mobileLandscape:0}},t.prototype.getGeneratorVariables=function(){return this.$editedElement.data("variables")},t.prototype.getMainContainerElement=function(){return this.$editedElement.find(".n2-ss-layers-container").addBack().last()},t}),N2D("EditorSlide",["EditorAbstract"],function(s,t){function e(t,e,i){this.slideEdit=t,N2Classes.EditorAbstract.prototype.constructor.call(this,e,s.extend({slideBackgroundMode:"fill"},i))}return((e.prototype=Object.create(N2Classes.EditorAbstract.prototype)).constructor=e).prototype.startEditor=function(){N2R("#"+this.sliderElementID,function(t,e){this.frontend=e,this.frontend.editor=this,nextend.pre="div#"+this.frontend.elementID+" ",this.frontend.visible(this.sliderStarted.bind(this))}.bind(this))},e.prototype.sliderStarted=function(){s("body").addClass("n2-ss-slider-visible"),this.$editedElement=this.frontend.sliderElement.find(".n2-ss-currently-edited-slide"),this.editedInstance=this.$editedElement.data("slide"),this.generator=new N2Classes.Generator(this),this.generator.registerGlobalField("slide","name","#layerslide-title"),this.generator.registerGlobalField("slide","description","#layerslide-description"),this.getMainContainerElement().on({updateSize:this.updateSize.bind(this),interaction:this.updateSize.bind(this)}),this.fragmentEditor=new N2Classes.FragmentEditor(this,this.getFrontendSlide().$element,this.options),this.getFrontendElement().on({SliderResize:this.fragmentEditor.onResize.bind(this.fragmentEditor),SliderDeviceOrientation:this.fragmentEditor.onChangeDeviceOrientation.bind(this.fragmentEditor)}),this.readyDeferred.resolve()},e.prototype.getFormData=function(){return{guides:N2Classes.Base64.encode(JSON.stringify(this.fragmentEditor.canvasSettings.ruler.toArray())),slide:N2Classes.Base64.encode(nextend.UnicodeToHTMLEntity(JSON.stringify(this.fragmentEditor.getData())))}},e.prototype.getAvailableDeviceModes=function(){return this.frontend.responsive.parameters.enabledDevices},e.prototype.getSlideBackground=function(){return this.$editedElement.data("slideBackground")},e.prototype.getFrontendElement=function(){return this.frontend.sliderElement},e.prototype.getFrontendSlide=function(){return this.editedInstance},e.prototype.getHorizontalRatio=function(){return this.frontend.responsive.ratios.slideW},e.prototype.getVerticalRatio=function(){return this.frontend.responsive.ratios.slideH},e.prototype.updateSize=function(){this.frontend.responsive.resizeStage2Height()},e.prototype.getDeviceMode=function(){return this.frontend.responsive.getNormalizedModeString()},e}),N2D("Generator",["EditorAbstract"],function(o,l){"use strict";function t(t){this.editor=t,this._refreshTimeout=null,this.modal=!1,this.group=0;t=(this.editor.generator=this).editor.getGeneratorVariables();if(t){for(var e in this.variables=t,this.variables)!isNaN(parseFloat(e))&&isFinite(e)&&(this.group=Math.max(this.group,parseInt(e)+1));this.fill=this.generatorFill,0<this.group&&(this.registerField=this.generatorRegisterField,this.button=o('<div class="n2_field_generator_data_button"><div class="n2_field_generator_data_button_icon"><i class="ssi_16 ssi_16--data"></i></div><div class="n2_field_generator_data_button_label">'+n2_("Data")+"</div></div>").on("click",function(t){this.showModal()}.bind(this)),o("body").addClass("n2_ss_body--dynamic-slide"))}else this.variables=null}return t.prototype.isDynamicSlide=function(){return 0<this.group},t.prototype.splitTokens=function(t){for(var e=[],i="",s=0,n=0;n<t.length;n++){var o=t[n];","===o&&0===s?(e.push(i),i=""):(i+=o,"("===o?s++:")"===o&&s--)}return i.length&&e.push(i),e},t.prototype.fill=function(t){return t},t.prototype.generatorFill=function(t){return"string"==typeof t?t.replace(/{((([a-z]+)\(([^}]+)\))|([a-zA-Z0-9][a-zA-Z0-9_\/]*))}/g,this.parseFunction.bind(this)):t},t.prototype.parseFunction=function(t,e,i,s,n,o){if(o!==l)return this.parseVariable(o);for(var a=this.splitTokens(n),r=0;r<a.length;r++)a[r]=this.parseVariable(a[r]);return"function"==typeof this[s]?this[s].apply(this,a):t},t.prototype.parseVariable=function(t){var e=t.match(/^("|')(.*)("|')$/);if(e)return e[2];var i=t.match(/((([a-z]+)\(([^}]+)\)))/);if(i)return this.parseFunction.apply(this,i);var s=t.match(/([a-zA-Z][0-9a-zA-Z_]*)(\/([0-9a-z]+))?/);if(s){e=s[3];return e===l?e=0:(i=parseInt(e),isNaN(i)||(e=Math.max(e,1)-1)),this.variables[e]!==l&&this.variables[e][s[1]]!==l?this.variables[e][s[1]]:""}return t},t.prototype.fallback=function(t,e){return""==t?e:t},t.prototype.cleanhtml=function(t){return this.stripTags(t,"<p><a><b><br /><br/><i>")},t.prototype.stripTags=function(t,i){i=(((i||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");return t.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,"").replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,function(t,e){return-1<i.indexOf("<"+e.toLowerCase()+">")?t:""})},t.prototype.removehtml=function(t){return o("<div>"+t+"</div>").text()},t.prototype.splitbychars=function(t,e,i){return t.substr(e,i)},t.prototype.splitbywords=function(t,e,i){var s=t,n=s.length,t=Math.max(0,0==e?0:s.indexOf(" ",e)),e=Math.max(0,n<i?n:s.indexOf(" ",i));return 0==e&&i<=n&&(e=n),s.substr(t,e)},t.prototype.findimage=function(t,e){var i,s=t,n=/(<img.*?src=[\'"](.*?)[\'"][^>]*>)|(background(-image)??\s*?:.*?url\((["|\']?)?(.+?)(["|\']?)?\))/gi,o=[];for(e=e!==l?parseInt(e)-1:0;i=n.exec(s);)i[2]!==l?o.push(i[2]):i[6]!==l&&o.push(i[6]);return o.length?o.length>e?o[e]:o[o.length-1]:""},t.prototype.findlink=function(t,e){var i,s=t,n=/href=["\']?([^"\'>]+)["\']?/gi,o=[];for(e=e!==l?parseInt(e)-1:0;i=n.exec(s);)i[1]!==l&&o.push(i[1]);return o.length?o.length>e?o[e]:o[o.length-1]:""},t.prototype.removevarlink=function(t){return String(t).replace(/<a href=\"(.*?)\">(.*?)<\/a>/g,"")},t.prototype.removelinebreaks=function(t){return String(t).replace(/\r?\n|\r/g,"")},t.prototype.registerFields=function(t){for(var e=0;e<t.length;e++)this.registerField(t[e])},t.prototype.registerGlobalField=function(t,e,i){null!==this.variables&&(i=o(i).on("outsideChange",function(){this.variables[t][e]=i.val(),this.refresh()}.bind(this)))},t.prototype.registerField=function(t){},t.prototype.generatorRegisterField=function(t){var e=(t=o(t)).parent();e.on({mouseenter:function(){this.activeField=t,this.button.prependTo(e)}.bind(this)})},t.prototype.getModal=function(){var e,i,s,t,n;return this.selectVariableModal||(e={key:"",group:1,filter:"no",split:"no",splitStart:0,splitLength:300,findImage:0,findImageIndex:1,findLink:0,findLinkIndex:1,removeVarLink:0,removelinebreaks:0},i=function(){var t=e.key+"/"+e.group;return 0!=e.findImage&&(t="findimage("+t+","+Math.max(1,e.findImageIndex)+")"),0!=e.findLink&&(t="findlink("+t+","+Math.max(1,e.findLinkIndex)+")"),0!=e.removeVarLink&&(t="removevarlink("+t+")"),0!=e.removelinebreaks&&(t="removelinebreaks("+t+")"),"no"!=e.filter&&(t=e.filter+"("+t+")"),"no"!=e.split&&0<=e.splitStart&&0<e.splitLength&&(t=e.split+"("+t+","+e.splitStart+","+e.splitLength+")"),"{"+t+"}"},s=function(){t.text(this.fill(i()))}.bind(this),this.selectVariableModal=new N2Classes.ModalSimple("generator-insert-variable",{width:760}),this.selectVariableModal.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--data","blue")),1<this.group&&N2Classes.UI.modalGeneratorVariableList(this.selectVariableModal,this.group,"Select group","group","Groups",function(t){e.group=t,s()}),N2Classes.UI.modalGeneratorVariableList(this.selectVariableModal,this.variables[0],"Insert variable","variable","Variables",function(t){e.key=t,s()}),e.key=Object.keys(this.variables[0])[0],n=N2Classes.UI.modalFormRow(),this.selectVariableModal.addContent(n),N2Classes.UI.modalSelect(n,"filter-select",n2_("Filter"),{no:n2_("No"),cleanhtml:n2_("Clean HTML"),removehtml:n2_("Remove HTML")},"no").on("nextendChange",function(){e.filter=o(this).val(),s()}),N2Classes.UI.modalSelect(n,"split-select",n2_("Split by Chars"),{no:n2_("No"),splitbychars:n2_("Strict"),splitbywords:n2_("Respect words")},"no").on("nextendChange",function(){e.split=o(this).val(),s()}),N2Classes.UI.modalNumber(n,"split-start","",0,{wide:2,sublabel:"start"}).on("nextendChange",function(){e.splitStart=o(this).val(),s()}),N2Classes.UI.modalNumber(n,"split-length","",300,{wide:3,sublabel:"length"}).on("nextendChange",function(){e.splitLength=o(this).val(),s()}),n=N2Classes.UI.modalFormRow(),this.selectVariableModal.addContent(n),N2Classes.UI.modalOnOff(n,"find-image",n2_("Find image"),0).on("nextendChange",function(){e.findImage=o(this).val(),s()}),N2Classes.UI.modalNumber(n,"find-image-index","",1,{wide:2,sublabel:"index"}).on("nextendChange",function(){e.findImageIndex=o(this).val(),s()}),N2Classes.UI.modalOnOff(n,"find-link",n2_("Find link"),0).on("nextendChange",function(){e.findLink=o(this).val(),s()}),N2Classes.UI.modalNumber(n,"find-link-index","",1,{wide:2,sublabel:"index"}).on("nextendChange",function(){e.findLinkIndex=o(this).val(),s()}),N2Classes.UI.modalOnOff(n,"remove-link",n2_("Remove links"),0).on("nextendChange",function(){e.removeVarLink=o(this).val(),s()}),N2Classes.UI.modalOnOff(n,"remove-line-break",n2_("Remove line breaks"),0).on("nextendChange",function(){e.removelinebreaks=o(this).val(),s()}),n=N2Classes.UI.modalFormRow(!0),this.selectVariableModal.addContent(n),n=N2Classes.UI.modalFieldWrapper(n,"result",n2_("Result")),t=o('<div class="n2_generator_result"></div>').appendTo(n.$element),n=N2Classes.UI.modalButton(n2_("Insert"),"green"),this.selectVariableModal.addButton(n),n.on("click",function(t){t.preventDefault(),this.insert(i()),this.selectVariableModal.hide()}.bind(this)),s()),this.selectVariableModal},t.prototype.showModal=function(){this.getModal().show()},t.prototype.insert=function(t){this.activeField.val(t).trigger("change")},t.prototype.refresh=function(){this._refreshTimeout&&(clearTimeout(this._refreshTimeout),this._refreshTimeout=null),this._refreshTimeout=setTimeout(this._refresh.bind(this),100)},t.prototype._refresh=function(){for(var t=this.editor.fragmentEditor.mainContainer.container.getAllLayers(),e=0;e<t.length;e++)"layer"===t[e].type&&t[e].item.reRender()},t}),N2D("Historical",function(t,e){"use strict";function i(t){for(var e in i.prototype)t.prototype[e]=i.prototype[e]}return i.prototype.setSelf=function(t){t===e&&console.error(t),this.self!==e&&this.self!==this&&this.self.setSelf(t),this.self=t,this.onSelfChange()},i.prototype.getSelf=function(){return this.self===e?this.self=this:this.self!==this&&(this.self=this.self.getSelf()),this.self},i.prototype.onSelfChange=function(){},i}),N2D("History",function(t,e){"use strict";function i(){this.historyStates=50,this.enabled=0!==this.historyStates,this.historyActionInProgress=!1,this.historyAddAllowed=!0,this.isBatched=!1,(this.currentBatch=this).index=-1,this.stackedOff=[],this.tasks=[],this.preventUndoRedo=!1,this.undoBTN=t(".n2_ss_history_action--undo").on({click:this.undo.bind(this)}),this.redoBTN=t(".n2_ss_history_action--redo").on({click:this.redo.bind(this)})}var s;function n(t){this.parent=t,this.tasks=[]}function o(t){"skipForwardUndos"===t&&(this.undo=function(){return!1})}function a(t,e,i,s){this.that=t,this.undoAction=e,this.redoAction=i,this.context=s||[]}function r(){a.prototype.constructor.apply(this,arguments)}return N2R("documentReady",function(){s=new i}),i.get=function(){return s},i.prototype.updateUI=function(){this.undoBTN.toggleClass("n2_ss_history_action--allowed",0!==this.index&&0<this.tasks.length),this.redoBTN.toggleClass("n2_ss_history_action--allowed",-1<this.index&&this.index<this.tasks.length),document.dispatchEvent(new CustomEvent("historyChange",{cancelable:!1,bubbles:!1}))},i.prototype.throttleUndoRedo=function(){return!!this.preventUndoRedo||(this.preventUndoRedo=!0,setTimeout(function(){this.preventUndoRedo=!1}.bind(this),100),!1)},i.prototype.isEnabled=function(){return this.enabled&&this.historyAddAllowed},i.prototype.startBatch=function(){if(this.isEnabled()){var t=new n(this.currentBatch);return this.currentBatch._add(t),this.currentBatch=t}return!1},i.prototype.endBatch=function(){this.isEnabled()&&(this.currentBatch.parent,this.currentBatch=this.currentBatch.parent)},i.prototype.addControl=function(t){return this.currentBatch._add(new o(t))},i.prototype.addSimple=function(t,e,i,s){return!!this.isEnabled()&&this.currentBatch._add(new a(t,e,i,s))},i.prototype.addValue=function(t,e,i){if(this.isEnabled()){if(this.isBatched||this.currentBatch!==this)for(var s=this.getCurrentBatchStack(),n=0;n<s.length;n++)if(s[n].isEqual(t,e,i))return s.push(s.splice(n,1)[0]),s[s.length-1];return this.currentBatch._add(new r(t,e,e,i))}return!1},i.prototype.getCurrentBatchStack=function(){return this.currentBatch!==this?this.currentBatch.tasks:this.tasks[this.tasks.length-1]},i.prototype._add=function(t){return-1!==this.index&&this.tasks.splice(this.index,this.tasks.length),this.index=-1,this.isBatched?this.tasks[this.tasks.length-1].push(t):(this.tasks.push([t]),this.isBatched=!0,setTimeout(function(){this.isBatched=!1}.bind(this),100)),this.tasks.length>this.historyStates&&this.tasks.shift(),this.updateUI(),t},i.prototype.off=function(){this.historyAddAllowed=!1,this.stackedOff.push(1)},i.prototype.on=function(){this.stackedOff.pop(),0===this.stackedOff.length&&(this.historyAddAllowed=!0)},i.prototype.undo=function(t){if(t&&t.preventDefault(),this.throttleUndoRedo())return!1;if(this.historyActionInProgress=!0,this.off(),-1===this.index?this.index=this.tasks.length-1:this.index--,0<=this.index)for(var e=this.tasks[this.index],i=e.length-1;0<=i&&e[i].undo();i--);else this.index=0;return this.on(),this.historyActionInProgress=!1,this.updateUI(),!0},i.prototype.redo=function(t){if(t&&t.preventDefault(),this.throttleUndoRedo())return!1;if(this.historyActionInProgress=!0,this.off(),-1!==this.index&&this.index<this.tasks.length){var e=this.tasks[this.index];this.index++;for(var i=0;i<e.length&&e[i].redo();i++);}return this.on(),this.historyActionInProgress=!1,this.updateUI(),!0},i.prototype.actionInProgress=function(){return this.historyActionInProgress},n.prototype._add=function(t){return this.tasks.push(t),t},n.prototype.undo=function(){for(var t=0;t<this.tasks.length&&this.tasks[t].undo();t++);return!0},n.prototype.redo=function(){for(var t=0;t<this.tasks.length&&this.tasks[t].redo();t++);return!0},n.prototype.isEqual=function(){return!1},o.prototype.undo=function(){return!0},o.prototype.redo=function(){return!0},o.prototype.isEqual=function(){return!1},a.prototype.undo=function(){return this.undoAction.apply(this.that.getSelf(),this.context),!0},a.prototype.redo=function(){return this.redoAction.apply(this.that.getSelf(),this.context),!0},a.prototype.isEqual=function(){return!1},((r.prototype=Object.create(a.prototype)).constructor=r).prototype.setValues=function(t,e){this.undoValue=t,this.redoValue=e},r.prototype.undo=function(){return this.context.unshift(this.undoValue),this.undoAction.apply(this.that.getSelf(),this.context),this.context.shift(),!0},r.prototype.redo=function(){return this.context.unshift(this.redoValue),this.redoAction.apply(this.that.getSelf(),this.context),this.context.shift(),!0},r.prototype.isEqual=function(t,e,i){if(t!==this.that||e!==this.undoAction)return!1;for(var s=0;s<i.length;s++)if(i[s]!==this.context[s])return!1;return this.setValues=function(t,e){this.redoValue=e}.bind(this),!0},i}),N2D("InlineTextEditor",function(i,t){function e(t,e){this.destroyed=!1,(this.el=t).contentEditable=!0,this.options=i.extend({onSave:function(){},onCancel:function(){},onTab:function(t){},filter:!1},e),this.listeners=[],this.selectAll(),this.addListener("blur",this.onBlur.bind(this),window),this.addListener("input",this.onInput.bind(this)),this.addListener("blur",this.onBlur.bind(this)),this.addListener("keydown",this.onKeydown.bind(this)),this.addListener("mousedown",this.stopPropagation.bind(this)),this.addListener("mouseup",this.stopPropagation.bind(this)),this.addListener("click",this.stopPropagation.bind(this))}return e.prototype.addListener=function(t,e,i){(i=i||this.el).addEventListener(t,e),this.listeners.push({el:i,eventName:t,callback:e})},e.prototype.stopPropagation=function(t){t.stopPropagation()},e.prototype.onBlur=function(){this.destroy();var t=this.filterText(this.el.textContent);this.el.scrollLeft=0,this.el.scrollTop=0,this.options.onSave(t)},e.prototype.cancel=function(){this.destroy(),this.options.onCancel()},e.prototype.destroy=function(){this.selectNone();for(var t=0;t<this.listeners.length;t++)this.listeners[t].el.removeEventListener(this.listeners[t].eventName,this.listeners[t].callback);this.el.contentEditable=!1},e.prototype.onKeydown=function(t){t.defaultPrevented||(13===t.keyCode?(this.onBlur(),t.preventDefault()):27===t.keyCode?(this.cancel(),t.preventDefault()):9===t.keyCode&&(this.onBlur(),this.options.onTab(t),t.preventDefault()))},e.prototype.onInput=function(){var t=this.el.textContent,e=function t(e){for(var i=[],s=0;s<e.childNodes.length;s++)e.childNodes[s].childNodes.length?i.push.apply(i,t(e.childNodes[s])):i.push(e.childNodes[s].textContent);return i}(this.el),i=this.filterText(e.join(" "));this.el.innerHTML!==i&&(e=this.getCaretPosition(),t=t.length,this.el.innerHTML=i.replace(/ /g,"&nbsp;"),this.setCaretPosition(e-(t-i.length)))},e.prototype.filterText=function(t){return t=t.replace(/[\s]/gi," ").replace(/\s+/g," "),this.options.filter&&(t=this.options.filter(t)),t},e.prototype.getCaretPosition=function(){var t=window.getSelection().getRangeAt(0),e=t.toString().length,i=t.cloneRange();return i.selectNodeContents(this.el),i.setEnd(t.endContainer,t.endOffset),i.toString().length-e},e.prototype.setCaretPosition=function(t){t=Math.max(0,Math.min(this.el.textContent.length,t));var e=window.getSelection(),i=document.createRange();i.setStart(this.el.childNodes.length?this.el.childNodes[0]:this.el,t),i.collapse(!0),e.removeAllRanges(),e.addRange(i)},e.prototype.selectAll=function(){var t=this.el;this.el.childNodes.length&&(t=this.el.childNodes[0]);var e=window.getSelection(),i=document.createRange();i.setStart(t,0),i.setEnd(t,this.el.textContent.length),e.removeAllRanges(),e.addRange(i)},e.prototype.selectNone=function(){window.getSelection().removeAllRanges()},e}),N2D("SlideEditorPopup34",function(s,t){var n="ss-slider-editor-popup34";function e(){var e=new N2Classes.ModalSimple("slide-editor-popup34",{destroyOnHide:!0,width:1e3,hasClose:!1}),t=s('<div class="n2_slide_editor_popup34"></div>');e.addContent(t),s('<div class="n2_slide_editor_popup34__heading"></div>').text(n2_("Most important changes in version 3.4")).appendTo(t),s('<div class="n2_slide_editor_popup34__sub_heading"></div>').text(n2_("To help you get started with the new version, we've put together the most important changes.")).appendTo(t);var i=s('<div class="n2_slide_editor_popup34__boxes"></div>').appendTo(t),t=s('<div class="n2_slide_editor_popup34__box"></div>').appendTo(i);s('<img src="'+nextend.imageHelper.fixed("$ss3-admin$/images/popup34/slidebackground.png")+'" alt=""></img>').appendTo(t),s('<div class="n2_slide_editor_popup34__box_heading"></div>').text(n2_("Slide background")).appendTo(t),s('<div class="n2_slide_editor_popup34__box_sub_heading"></div>').text(n2_("You can find the Slide Background option in the Layer Window! Click on the Slide Label at the top of the Canvas to find them.")).appendTo(t),s('<a href="https://www.youtube.com/watch?v=JAX0i5Zl-8I" class="n2_slide_editor_popup34__box_link n2_button n2_button--small n2_button--grey" target="_blank"></a>').text(n2_("Watch video")).appendTo(t);i=s('<div class="n2_slide_editor_popup34__box"></div>').appendTo(i);s('<img src="'+nextend.imageHelper.fixed("$ss3-admin$/images/popup34/absoluteposition.png")+'" alt=""></img>').appendTo(i),s('<div class="n2_slide_editor_popup34__box_heading"></div>').text(n2_("Absolute position")).appendTo(i),s('<div class="n2_slide_editor_popup34__box_sub_heading"></div>').text(n2_("Canvas layers are now called Absolute! In the Add Panel switch to Absolute before you create the layer.")).appendTo(i),s('<a href="https://smartslider.helpscoutdocs.com/article/1916-slide-editing-in-smart-slider-3#absolute" class="n2_slide_editor_popup34__box_link n2_button n2_button--small n2_button--grey" target="_blank"></a>').text(n2_("Read docs")).appendTo(i);i=N2Classes.UI.modalButton(n2_("Got it"),"blue").on("click",function(t){e.hide(t),localStorage.setItem(n,1)});e.addButton(i),e.show()}return localStorage.getItem(n)||N2R("windowLoad",function(){s(".n2_admin_editor").length&&e()}),e}),N2D("SmartSliderAdminSlideBackgroundColor",["SmartSliderSlideBackgroundColor"],function(t,e){function i(t,e){N2Classes.SmartSliderSlideBackgroundColor.prototype.constructor.apply(this,arguments)}return((i.prototype=Object.create(N2Classes.SmartSliderSlideBackgroundColor.prototype)).constructor=i).prototype.update=function(t,e,i,s){t=this.fixColor(t),this.$el.css({background:""}),this.$el.attr("data-overlay",parseInt(s)?1:0),"off"!==e?this.updateGradient(t,e,i):this.updateColor(t)},i.prototype.updateColor=function(t){"00"!==t.substr(6,8)&&this.$el.css("background","#"+t.substr(0,6)).css("background",N2Color.hex2rgbaCSS(t))},i.prototype.updateGradient=function(t,e,i){switch(this.$el.css({background:""}),i=this.fixColor(i),e){case"horizontal":this.$el.css("background","linear-gradient(to right, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)");break;case"vertical":this.$el.css("background","linear-gradient(to bottom, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)");break;case"diagonal1":this.$el.css("background","linear-gradient(45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)");break;case"diagonal2":this.$el.css("background","linear-gradient(135deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)")}},i.prototype.fixColor=function(t){return t.length&&"#"===t.charAt(0)&&6===(t=t.substring(1)).length&&(t+="ff"),t},i}),N2D("SmartSliderAdminSlideBackgroundImage",["SmartSliderSlideBackgroundImage"],function(i,t){function e(t,e,i,s){this.hash=s.data("hash"),N2Classes.SmartSliderSlideBackgroundImage.prototype.constructor.apply(this,arguments),this.loadAllowed=!0,this.listenImageManager()}return((e.prototype=Object.create(N2Classes.SmartSliderSlideBackgroundImage.prototype)).constructor=e).prototype.listenImageManager=function(){""!==this.hash&&i(window).on(this.hash,this.onImageManagerChanged.bind(this))},e.prototype.notListenImageManager=function(){""!==this.hash&&i(window).off(this.hash,null,this.onImageManagerChanged.bind(this))},e.prototype.onImageManagerChanged=function(t,e){this.tabletSrc=e.tablet.image,this.mobileSrc=e.mobile.image,this.updateBackgroundToDevice(this.manager.device)},e.prototype.preLoadAdmin=function(t){this.preLoad(),""!==t&&this.background.allowVisualLoad&&(this.notListenImageManager(),this.deferred.done(function(){i.when(nextend.imageManager.getVisual(t)).done(function(t){this.onImageManagerChanged(null,t.value),this.listenImageManager()}.bind(this))}.bind(this)))},e.prototype.setDesktopSrc=function(t){var e;this.notListenImageManager(),this.desktopSrc=t,this.hash=md5(t),""!==t&&this.background.allowVisualLoad?((e=new Image).addEventListener("load",function(){i.when(nextend.imageManager.getVisual(t)).done(function(t){this.onImageManagerChanged(null,t.value),this.listenImageManager()}.bind(this))}.bind(this),!1),e.src=nextend.imageHelper.fixed(t)):(this.tabletSrc="",this.mobileSrc="",this.setSrc(nextend.imageHelper.fixed(t)))},e.prototype.setSrc=function(t){N2Classes.SmartSliderSlideBackgroundImage.prototype.setSrc.call(this,nextend.imageHelper.fixed(t))},e.prototype.startFixed=function(){},e.prototype.updateMode=function(t,e){"blurfit"===t&&1===this.$background.length&&(this.$background=this.$background.add(this.$background.clone().insertAfter(this.$background)),this.$background.first().css({margin:"-14px",padding:"14px"}).css(window.n2FilterProperty,"blur(7px)")),"blurfit"===e&&"blurfit"!==t&&(this.$background.eq(1).remove(),this.$background=this.$background.eq(0),this.updateBlur(this.blur))},e.prototype.updateFocus=function(t,e){this.$background.css("background-position",t+"% "+e+"%")},e.prototype.updateOpacity=function(t){this.$background.css("opacity",t/100)},e.prototype.updateBlur=function(t){window.n2FilterProperty&&(0<t?this.$background.last().css({margin:"-"+2*t+"px",padding:2*t+"px"}).css(window.n2FilterProperty,"blur("+t+"px)"):this.$background.last().css({margin:"",padding:""}).css(window.n2FilterProperty,"")),this.blur=t},e.prototype.kill=function(){this.notListenImageManager(),this.$background.remove()},e}),N2D("SmartSliderAdminSlideBackgroundVideo",["SmartSliderSlideBackgroundVideo"],function(t,e){function i(t,e,i){N2Classes.SmartSliderSlideBackgroundVideo.prototype.constructor.apply(this,arguments)}return((i.prototype=Object.create(N2Classes.SmartSliderSlideBackgroundVideo.prototype)).constructor=i).prototype.onReady=function(){var t;this.isReady||(this.isReady=!0,t=this.$video,this.safePause(),t.data("ratio")||(0<t[0].videoWidth?t.data("ratio",t[0].videoWidth/t[0].videoHeight):t.data("ratio",t[0].offsetWidth/t[0].offsetHeight),t.addClass("n2-active"),this.slider.stages.done("BeforeShow",this.onResize.bind(this)),this.slider.ready(function(){this.$video.one("n2playvideo",function(){this.background.fadeOut()}.bind(this)),this.slider.sliderElement.on("SliderResize",this.onResize.bind(this)),this.isResized||this.onResize(),this.setState("ready",!0),this.setState("scroll",!0)}.bind(this))))},i.prototype.updateVideoMode=function(t){this.$video.data("mode",t).attr("data-mode",t),this.resizeVideo()},i.prototype.updateOpacity=function(t){this.$video.css("opacity",t/100)},i.prototype.kill=function(){this.$video.remove()},i}),N2D("LayerContainer",function(n,r){"use strict";function t(t){this.component=t,this.$ul=n('<div class="n2_layer_navigation_list_layer__children"></div>').data("container",this),this.childrenSelector="> .n2-ss-layer",this.layerContainerElement=t.layer}return t.prototype.setLayerContainerElement=function(t){this.layerContainerElement=t},t.prototype.startWithExistingNodes=function(t){for(var e=this.layerContainerElement.find(this.childrenSelector),i=0;i<e.length;i++)this._loadNode(e.eq(i),t);this.component.onChildCountChange()},t.prototype._loadNode=function(t,e){var i;switch(t.data("sstype")){case"content":i=new N2Classes.Content(this.component.fragmentEditor,this.component);break;case"layer":i=new N2Classes.Layer(this.component.fragmentEditor,this.component);break;case"row":i=new N2Classes.Row(this.component.fragmentEditor,this.component);break;case"col":i=new N2Classes.Col(this.component.fragmentEditor,this.component)}return!!i&&(i.load(t,e),e||i.sync(),i)},t.prototype.getLayerCount=function(){return this.layerContainerElement.find(this.childrenSelector).length},t.prototype.getLayerIndex=function(t){return this.layerContainerElement.find(this.childrenSelector).index(t)},t.prototype.getSortedLayers=function(){var i=[];return this.layerContainerElement.find(this.childrenSelector).each(function(t,e){e=n(e).data("layerObject");e!==r&&i.push(e)}),i},t.prototype.append=function(t){t.appendTo(this.layerContainerElement);t=this._loadNode(t,!1);return this.component.onChildCountChange(),t},t.prototype.insertAt=function(t,e){var i=this.getSortedLayers();e>=i.length?t.appendTo(this.layerContainerElement):t.insertBefore(i[e].layer);t=this._loadNode(t,!1);return this.component.onChildCountChange(),t},t.prototype.insert=function(t){t.getRootElement().appendTo(this.layerContainerElement)},t.prototype.insertLayerAt=function(t,e){var i=this.getSortedLayers(),s=t.group,n=i.indexOf(t);-1<n&&n<e&&e++,e>=i.length?t.getRootElement().appendTo(this.layerContainerElement):t.getRootElement().insertBefore(i[e].getRootElement()),this.syncLayerRow(t),s!==this.component&&(s.onChildCountChange(),t.layer.triggerHandler("LayerAbsoluteUnavailable")),s.triggerLayerResized(),this.component.triggerLayerResized()},t.prototype.syncLayerRow=function(t){var e="slide"===this.component.type,i=(e?t.getRootElement().prevAll(".n2-ss-layer"):t.getRootElement().nextAll(".n2-ss-layer")).first().data("layerObject");i!==r?t.layerRow.insertBefore(i.layerRow):this.$ul.append(t.layerRow),t.animations&&t.animations.syncRow(i,e)},t.prototype.getChildLayersRecursive=function(t){for(var e=this.getSortedLayers(),i=[],s=0;s<e.length;s++)t?i.push(e[s].layer[0]):i.push(e[s]),e[s].container&&i.push.apply(i,e[s].container.getChildLayersRecursive(t));return i},t.prototype.moveLayersToGroup=function(t,e){e=e||[];for(var i=[],s=0;s<t.length;s++){var n=t[s],o=n.group,a=n.getIndex();e[s]!==r?this.insertLayerAt(n,e[s]):this.insert(n),n.changeGroup(a,this.component),this!==o&&-1===i.indexOf(o)&&i.push(o)}for(s=0;s<i.length;s++)i[s].update()},t.prototype.activateFirst=function(){var t=this.getSortedLayers();0<t.length&&t[t.length-1].activate()},t.prototype.resetModes=function(t){for(var e=this.getSortedLayers(),i=0;i<e.length;i++)e[i].resetMode(t),e[i].container!==r&&e[i].container.resetModes(t)},t.prototype.copyModes=function(t,e){for(var i=this.getSortedLayers(),s=0;s<i.length;s++)i[s].copyMode(t,e),i[s].container!==r&&i[s].container.copyModes(t,e)},t.prototype.changeEditorModes=function(t){for(var e=this.getSortedLayers(),i=0;i<e.length;i++)e[i].changeEditorMode(t),e[i].container!==r&&e[i].container.changeEditorModes(t)},t.prototype.renderModeProperties=function(){for(var t=this.getSortedLayers(),e=0;e<t.length;e++)t[e].renderModeProperties(),t[e].container!==r&&t[e].container.renderModeProperties()},t.prototype.getAllLayers=function(t){t=t||[];for(var e=this.getSortedLayers(),i=0;i<e.length;i++)t.push(e[i]),e[i].container!==r&&e[i].container.getAllLayers(t);return t},t.prototype.getData=function(t){t=n.extend({layersIncluded:!0,itemsIncluded:!0},t);var e=[],i=this.getSortedLayers();if("slide"===this.component.type)for(var s=i.length-1;0<=s;s--)e.push(i[s].getData(t));else for(s=0;s<i.length;s++)e.push(i[s].getData(t));return e},t.prototype.getHTML=function(t){for(var e=this.getSortedLayers(),i=[],s=0;s<e.length;s++)i.push(e[s].getHTML(t));return i},t.prototype.getDroppables=function(t){for(var e,i=[],s=this.getSortedLayers(),n=0;n<s.length;n++)s[n]!==t&&("object"==typeof(e=s[n].getDroppable())&&i.push(e),"hidden"!==e&&s[n].container&&i.push.apply(i,s[n].container.getDroppables(t)));return i},t.prototype.getLLDroppables=function(t){var e=[],i=this.component.getLLDroppable(t);i&&e.push(i);for(var s=this.getSortedLayers(),n=0;n<s.length;n++)s[n].container&&s[n]!==t&&e.push.apply(e,s[n].container.getLLDroppables(t));return e},t}),N2D("EditorContextualBarAbstract",function(e,t){function i(t){this.interactionManager=t,this.forceEnabledCounter=0,this.disabledCounter=1,this.component=!1,this.$contextual=e('<div class="n2_layer_contextual"></div>').on({contextmenu:this.interactionManager.handleContextMenu.bind(this.interactionManager)}).appendTo(this.interactionManager.$containerInner);t=e('<div class="n2_layer_contextual__inner"></div>').appendTo(this.$contextual);this.$contextualLabel=e('<div class="n2_layer_contextual__label"></i></div>').appendTo(t),this.$buttonResponsiveTools=e('<div class="n2_layer_contextual__button n2_layer_contextual__button--responsive-tools"><i class="ssi_16 ssi_16--fontresize"></i></div>').appendTo(t),this.$buttonMore=e('<div class="n2_layer_contextual__button"><i class="ssi_16 ssi_16--more"></i></div>').appendTo(t)}return i.prototype.enableActiveForced=function(){this.forceEnabledCounter++,this._enable()},i.prototype.disableActiveForced=function(){this.forceEnabledCounter=Math.max(0,this.forceEnabledCounter-1),this._disable()},i.prototype.disable=function(){this.disabledCounter++,this._disable()},i.prototype._disable=function(){0===this.forceEnabledCounter&&1===this.disabledCounter&&this.blurComponent()},i.prototype.enable=function(){this.disabledCounter=Math.max(0,this.disabledCounter-1),this._enable()},i.prototype._enable=function(){(0<this.forceEnabledCounter||0===this.disabledCounter)&&this.focusComponent()},i.prototype.refreshPosition=function(){(this.interactionManager.isHover&&0===this.disabledCounter||0<this.forceEnabledCounter)&&this.component&&!this.component.isDeleted&&this.positionBar()},i.prototype.positionBar=function(){var t=this.component.layer[0].getBoundingClientRect(),e={top:t.top-this.interactionManager.innerOffset.top};e.top<28?(e.top+=28,this.$contextual.addClass("n2_layer_contextual--invert")):this.$contextual.removeClass("n2_layer_contextual--invert"),"left"===this.component.contextualBarPosition?e.left=t.left-this.interactionManager.innerOffset.left:"center"===this.component.contextualBarPosition&&(e.left=Math.floor(t.left-this.interactionManager.innerOffset.left+t.width/2-this.$contextual.width()/2)),this.$contextual.css(e)},i.prototype.onProxyMouseDown=function(t){this.component&&(t=t.originalEvent,this.component.layer[0].dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,screenX:t.screenX,screenY:t.screenY,clientX:t.clientX,clientY:t.clientY,button:t.button,buttons:t.buttons})))},i}),N2D("EditorContextualBarActive","EditorContextualBarAbstract",function(t,e){"use strict";function i(t){this.contextualMenuActive=!1,this.responsiveToolsActive=!1,N2Classes.EditorContextualBarAbstract.prototype.constructor.call(this,t),this.$contextual.addClass("n2_layer_contextual--active").on("mousedown",this.onProxyMouseDown.bind(this)),this.$contextualLabel.on("click",this.actionDisplayLayerWindow.bind(this)),this.$buttonResponsiveTools.on("click",this.actionResponsiveTools.bind(this)),this.$buttonMore.on("click",this.actionContextualMenu.bind(this))}return((i.prototype=Object.create(N2Classes.EditorContextualBarAbstract.prototype)).constructor=i).prototype.changeActiveComponent=function(t){this.blurComponent(),this.component=t,this.$contextualLabel.text(this.component.getUILabel()),this.$contextual.data("layerObject",this.component).toggleClass("n2_layer_contextual--has-responsive-tools",this.component.hasResponsiveTools()),this.focusComponent(),this.component.hasResponsiveTools()&&this.responsiveToolsActive&&this.showResponsiveTools()},i.prototype.blurComponent=function(){this.component&&!this.component.isDeleteStarted&&(this.$contextual.removeClass("n2_layer_contextual--visible"),this.component.layer.removeClass("n2_layer_contextual_active_layer"),this.component.editorUI.normalSizing&&this.component.editorUI.normalSizing.removeClass("nui-enabled"),this.component.editorUI.margin&&this.component.editorUI.margin.removeClass("nui-enabled"),this.component.editorUI.padding&&this.component.editorUI.padding.removeClass("nui-enabled"),this.component.editorUI.absoluteCC&&this.component.editorUI.absoluteCC.removeClass("nui-enabled"),this.component.editorUI.resize&&this.component.editorUI.resize.removeClass("nui-enabled"),this.component.editorUI.columns&&this.component.editorUI.columns.hideHandles(),this.component.layer.off(".contextualBarActive"))},i.prototype.focusComponent=function(){var t;(0===this.disabledCounter||0<this.forceEnabledCounter)&&!this.component.isDeleted&&(this.positionBar(),t="blue",this.component.isAbsolute()&&(t="purple"),this.$contextual.attr("data-color",t).addClass("n2_layer_contextual--visible"),this.component.layer.addClass("n2_layer_contextual_active_layer"),this.component.editorUI.normalSizing&&this.component.editorUI.normalSizing.addClass("nui-enabled"),this.component.editorUI.margin&&this.component.editorUI.margin.addClass("nui-enabled"),this.component.editorUI.padding&&this.component.editorUI.padding.addClass("nui-enabled"),this.component.editorUI.absoluteCC&&this.component.editorUI.absoluteCC.addClass("nui-enabled"),this.component.editorUI.resize&&this.component.editorUI.resize.addClass("nui-enabled"),this.component.editorUI.columns&&this.component.editorUI.columns.showHandles(),this.component.layer.on({"LayerDeleted.contextualBarActive":this.onLayerDelete.bind(this),"interaction.contextualBarActive":this.onLayerChange.bind(this),"LayerShowChange.contextualBarActive":this.onLayerChange.bind(this)}))},i.prototype.onLayerDelete=function(){this.$contextual.removeClass("n2_layer_contextual--visible")},i.prototype.onLayerChange=function(){this.refreshPosition()},i.prototype.actionDisplayLayerWindow=function(){this.interactionManager.fragmentEditor.layerWindow.show(this.component)},i.prototype.actionResponsiveTools=function(){this.responsiveToolsActive?this.hideResponsiveTools():this.showResponsiveTools()},i.prototype.showResponsiveTools=function(){this.hideResponsiveToolsTimeout&&clearTimeout(this.hideResponsiveToolsTimeout),this.$buttonResponsiveTools.hasClass("n2_layer_contextual__button--active")||(this.responsiveToolsActive=!0,this.$buttonResponsiveTools.addClass("n2_layer_contextual__button--active"),this.component.onContextResponsiveTools(this.$contextual[0],function(){this.$buttonResponsiveTools.removeClass("n2_layer_contextual__button--active"),this.hideResponsiveToolsTimeout=setTimeout(this.hideResponsiveTools.bind(this),300)}.bind(this)))},i.prototype.hideResponsiveTools=function(){this.responsiveToolsActive=!1,this.$buttonResponsiveTools.removeClass("n2_layer_contextual__button--active")},i.prototype.actionContextualMenu=function(){this.contextualMenuActive?this.hideContextualMenu():this.showContextualMenu()},i.prototype.showContextualMenu=function(t){this.hideContextualMenuTimeout&&clearTimeout(this.hideContextualMenuTimeout),!t&&this.$buttonMore.hasClass("n2_layer_contextual__button--active")||(this.contextualMenuActive=!0,this.$buttonMore.addClass("n2_layer_contextual__button--active"),this.component.onContextMenu(this.$contextual[0],{onClose:function(){this.hideContextualMenuTimeout=setTimeout(this.hideContextualMenu.bind(this),300)}.bind(this)}))},i.prototype.hideContextualMenu=function(){this.contextualMenuActive=!1,this.$buttonMore.removeClass("n2_layer_contextual__button--active")},i}),N2D("EditorContextualBarHoverSection","EditorContextualBarHover",function(i,s){"use strict";function t(t){N2Classes.EditorContextualBarHover.prototype.constructor.call(this,t),this.$contextual.addClass("n2_layer_contextual--hover-section")}return((t.prototype=Object.create(N2Classes.EditorContextualBarHover.prototype)).constructor=t).prototype.handleMouseOver=function(t){this.processHoveredElement(this.findRelatedSection(t.target))},t.prototype.processMouseCoordinates=function(t,e){this.processHoveredElement(this.findRelatedSection(document.elementFromPoint(t,e)))},t.prototype.findRelatedSection=function(t){var e,t=i(t);if("slide"===t.attr("data-sstype"))e=t;else if(!(e=t.closest('.n2-ss-layer[data-sstype="slide"]')).length){t=t.hasClass("n2_layer_contextual")?t:t.closest(".n2_layer_contextual");return t.length?this.findRelatedSection(t.data("layerObject").layer[0]):this.component||!1}return e!==s&&e.data("layerObject")},t.prototype.blurComponent=function(){this.$contextual.removeClass("n2_layer_contextual--visible")},t.prototype.focusComponent=function(){0===this.disabledCounter&&this.component&&(this.positionBar(),this.refreshActiveState(),this.$contextual.attr("data-color","grey").addClass("n2_layer_contextual--visible"))},t}),N2D("EditorContextualBarHover","EditorContextualBarAbstract",function(t,e){"use strict";function i(t){this.namespace=this.namespace||"contextualBarHover",N2Classes.EditorContextualBarAbstract.prototype.constructor.call(this,t),this.$contextual.addClass("n2_layer_contextual--hover").on("mousedown",this.onProxyMouseDown.bind(this)),this.$contextualLabel.on("click",this.actionActivate.bind(this)),this.$buttonResponsiveTools.on("click",this.actionActivateWithResponsiveTools.bind(this)),this.$buttonMore.on("click",this.actionActivateWithContextualMenu.bind(this)),this.interactionManager.$container[0].addEventListener("mouseover",this.handleMouseOver.bind(this),{passive:!0,capture:!0})}return((i.prototype=Object.create(N2Classes.EditorContextualBarAbstract.prototype)).constructor=i).prototype.handleMouseOver=function(t){this.processHoveredElement(this.interactionManager.findRelatedComponent(t.target))},i.prototype.processMouseCoordinates=function(t,e){this.processHoveredElement(this.interactionManager.findRelatedComponent(document.elementFromPoint(t,e)))},i.prototype.processHoveredElement=function(t){t!==this.component&&(this.blurComponent(),this.component=t,this.component&&(this.$contextualLabel.text(this.component.getUILabel()),this.$contextual.data("layerObject",this.component).toggleClass("n2_layer_contextual--has-responsive-tools",this.component.hasResponsiveTools()),this.focusComponent()))},i.prototype.blurComponent=function(){this.$contextual.removeClass("n2_layer_contextual--visible"),this.component&&!this.component.isDeleteStarted&&(this.component.layer.removeClass("n2_layer_contextual_hover_layer"),this.component.layer.off("interaction."+this.namespace),this.component.markOut())},i.prototype.focusComponent=function(){var t;(0===this.disabledCounter||0<this.forceEnabledCounter)&&this.component&&!this.component.isDeleted&&(this.positionBar(),this.refreshActiveState(),this.component.layer.addClass("n2_layer_contextual_hover_layer"),t="grey",this.component.isAbsolute()&&(t="purple"),this.$contextual.attr("data-color",t).addClass("n2_layer_contextual--visible"),this.component.layer.on("LayerDeleted."+this.namespace,this.onLayerDelete.bind(this)),this.component.layer.on("interaction."+this.namespace,this.onLayerInteraction.bind(this)),this.component.markOver())},i.prototype.onLayerDelete=function(){this.$contextual.removeClass("n2_layer_contextual--visible")},i.prototype.onLayerInteraction=function(){this.refreshPosition()},i.prototype.actionActivate=function(t){this.component.activate(t)},i.prototype.actionActivateWithResponsiveTools=function(t){this.component.activate(!1),this.interactionManager.contextualBarActive.showResponsiveTools()},i.prototype.actionActivateWithContextualMenu=function(t){this.interactionManager.contextualBarActive.responsiveToolsActive&&this.interactionManager.contextualBarActive.hideResponsiveTools(),this.component.activate(!1),this.interactionManager.contextualBarActive.showContextualMenu(!0)},i.prototype.refreshActiveState=function(){this.$contextual.toggleClass("n2_layer_contextual--hover-active",this.interactionManager.activeComponent===this.component)},i}),N2D("LayerDataStorage",function(s,a){"use strict";function t(){this.isDeviceProp={},this.propertyScope={},this.property={},this.deviceProperty={desktopPortrait:{},desktopLandscape:{},tabletPortrait:{},tabletLandscape:{},mobilePortrait:{},mobileLandscape:{}},this.advancedProperties={}}return t.prototype.getMode=function(){return this.fragmentEditor.getMode()},t.prototype.getProperties=function(){var t,e,i,s={};for(t in this.property)this.advancedProperties[t]!==a?t===this.advancedProperties[t].getName()&&(e=this.property[t],i=this.advancedProperties[t].getBaseName(),this.property[t]===a&&(e=this.property[i]),s[i]=e):s[t]=this.property[t];return s},t.prototype.getRawProperty=function(t){if(this.isDeviceProp[t]){var e=this.getMode(),e=this.deviceProperty[e];return e[t]!==a?e[t]:a}return this.property[t]},t.prototype.getProperty=function(t){if(this.isDeviceProp[t]){var e=this.getMode(),i=this.deviceProperty[e],e=this.deviceProperty.desktopPortrait;if(i[t]!==a)return i[t];if(e[t]!==a)return e[t]}return this.property[t]},t.prototype.historyStore=function(t,e,i){this.isDeleteStarted||(this.store(i,e,t,!0,"history"),this.isDeviceProp[e]&&i!==this.getMode()||this.$.trigger("propertyChanged",[e,this.getProperty(e)]))},t.prototype.store=function(t,e,i,s,n){var o,a;t=t||this.getMode(),a=this.isDeviceProp[e]?(o=this.deviceProperty[t][e],this.getProperty(e)):o=this.property[e];var r=N2Classes.History.get().addValue(this,this.historyStore,[e,t]);r&&r.setValues(o,i),this.property[e]=i,this.isDeviceProp[e]&&(this.deviceProperty[t][e]=i),s&&this.render(e,a,n)},t.prototype.render=function(t,e,i){this.propertyScope[t]["_sync"+t]!==a&&this.propertyScope[t]["_sync"+t](e,i)},t.prototype.isDimensionPropertyAccepted=function(t){return(t+"").match(/[0-9]+%/)||"auto"===t},t.prototype.changeEditorMode=function(t){var e=parseInt(this.property[t]);this.layer.triggerHandler("LayerShowChange",[t,e]),this.renderModeProperties(!1)},t.prototype.renderModeProperties=function(t){for(var e in this.isDeviceProp)this.isDeviceProp[e]&&(this.property[e]=this.getProperty(e),this.$.trigger("propertyChanged",[e,this.property[e]]))},t.prototype.historyResetMode=function(t,e){this.deviceProperty[e]=s.extend({},t),e===this.fragmentEditor.getMode()&&this.renderModeProperties(!0)},t.prototype.resetMode=function(t){if("desktopPortrait"!==t){var e,i=N2Classes.History.get().addValue(this,this.historyResetMode,[t]);for(e in i&&i.setValues(s.extend({},this.deviceProperty[t]),{}),this.deviceProperty[t])this.deviceProperty[t][e]=void 0;t===this.fragmentEditor.getMode()&&this.renderModeProperties(!0),this.animations&&this.animations.clearDeviceSpecific(t)}},t.prototype.copyMode=function(t,e){var i;t!==e&&(i=this.deviceProperty[e],this.deviceProperty[e]=s.extend({},this.deviceProperty[e],this.deviceProperty[t]),(t=N2Classes.History.get().addValue(this,this.historyResetMode,[e]))&&t.setValues(i,this.deviceProperty[e]))},t.prototype._getDefault=function(t,e){return this.originalProperties[t]!==a?this.originalProperties[t]:e},t.prototype.createProperty=function(t,e,i,s){this.isDeviceProp[t]=!1,this.propertyScope[t]=s||this,i?(this.property[t]=i.data(t.toLowerCase()),this.property[t]!==a&&null!==this.property[t]||(this.property[t]=this._getDefault(t,e))):this.property[t]=this._getDefault(t,e)},t.prototype.createAdvancedProperty=function(t,e,i){var s,n=t.getNames();for(s in n)this.advancedProperties[s]=t,this.createProperty(s,n[s],e,i)},t.prototype.syncAdvancedField=function(t){var e=this.advancedProperties[t].getName(),i=this.property[e];this.property[e]===a&&(i=this.property[t]),this.fragmentEditor.layerOptions.updateField(t,i)},t.prototype.createDeviceProperty=function(t,e,i,s){var n,o;if(this.isDeviceProp[t]=!0,this.propertyScope[t]=s||this,i){for(n in this.deviceProperty)this.deviceProperty[n][t]=i.data(n.toLowerCase()+t.toLowerCase()),""===this.deviceProperty[n][t]&&(this.deviceProperty[n][t]=a);for(n in this.deviceProperty)this.deviceProperty[n][t]!==a&&""!==this.deviceProperty[n][t]||(o=this._getDefault(n.toLowerCase()+t.toLowerCase()))!==a&&(this.deviceProperty[n][t]=o);for(n in e)this.deviceProperty[n][t]!==a&&""!==this.deviceProperty[n][t]||(this.deviceProperty[n][t]=e[n])}else{for(n in e)this.deviceProperty[n][t]=e[n];for(n in this.deviceProperty)(o=this._getDefault(n.toLowerCase()+t.toLowerCase()))!==a&&(this.deviceProperty[n][t]=o)}this.property[t]=this.deviceProperty.desktopPortrait[t]},t.prototype.removeProperty=function(t){if(delete this.property[t],this.layer.removeData(t.toLowerCase()).removeAttr("data-"+t.toLowerCase()),this.isDeviceProp[t])for(var e in this.deviceProperty)delete this.deviceProperty[e][t],this.layer.removeData(e.toLowerCase()+t.toLowerCase()).removeAttr("data-"+e.toLowerCase()+t.toLowerCase());delete this.isDeviceProp[t],delete this.propertyScope[t]},t.prototype.removeProperties=function(t){for(var e=0;e<t.length;e++)this.removeProperty(t[e])},t.prototype.getPropertiesData=function(t){for(var e={},i=0;i<t.length;i++){var s=t[i];if(this.property[s]!==a&&(e[s]=this.property[s]),this.isDeviceProp[s])for(var n in this.deviceProperty)this.deviceProperty[n][s]!==a&&(e[n.toLowerCase()+s]=this.deviceProperty[n][s])}return e},t.prototype.setProperty=function(t,e,i){this.advancedProperties[t]!==a&&(t=this.advancedProperties[t].getName()),this.propertyScope[t]!==a?"function"==typeof this.propertyScope[t]["setProperty"+t]?this.propertyScope[t]["setProperty"+t](t,e,i):this._setProperty(t,e,i):"function"==typeof this["setProperty"+t]&&this["setProperty"+t](t,e,i)},t.prototype._setProperty=function(t,e,i){this.store(a,t,e,!0,i),"manager"!==i&&this.$.trigger("propertyChanged",[t,this.getProperty(t)])},t.prototype.onSyncFields=function(){},t.prototype.resetStyleMode=function(t){for(var e in this.advancedProperties)this.advancedProperties[e].resetMode(t)},t.prototype.outsideStoreProperty=function(t,e,i,s){this.store(t,e,i,!0,s),t!==a&&t!==this.getMode()||this.$.trigger("propertyChanged",[e,this.getProperty(e)])},t}),N2D("FragmentEditorHotkey",function(u,e){"use strict";var f={97:"left",98:"center",99:"right",100:"left",101:"center",102:"right",103:"left",104:"center",105:"right"},m={97:"bottom",98:"bottom",99:"bottom",100:"middle",101:"middle",102:"middle",103:"top",104:"top",105:"top"};function t(t){this.fragmentEditor=t,this.keysPressed={},this.keyIntervals={},document.addEventListener("keydown",this.onKeyDown.bind(this),{capture:!0}),document.addEventListener("keyup",this.onKeyUp.bind(this),{capture:!0})}return t.prototype.onKeyDown=function(t){if(!t.defaultPrevented){var e=!1,i=N2Classes.LayerNavigationTimeline.get(),e=i.timelineControl&&i.timelineControl.isActivated();if("TEXTAREA"!==t.target.tagName&&"INPUT"!==t.target.tagName&&!t.target.isContentEditable&&!e&&"main"===N2Classes.WindowManager.getCurrentWindow()){var s,n,o,a,r=this.fragmentEditor.activeLayer,l=t.keyCode,i=!1;if(49<=l&&l<=57&&3===(t.location||t.keyLocation||0)&&(l+=48),t.shiftKey&&!t.ctrlKey&&!t.metaKey)if(69===l){var d=[];t.altKey?(d=["desktopLandscape","tabletLandscape","tabletPortrait","mobileLandscape","mobilePortrait"],N2Classes.Notification.success(n2_("Clear device specific settings")+" - "+n2_("Current layer, all devices"))):(d.push(this.fragmentEditor.getMode()),N2Classes.Notification.success(n2_("Clear device specific settings")+" - "+n2_("Current layer, current device")));for(var h=0;h<d.length;h++)r.resetMode(d[h]);i=!0}else if(82===l){var d=[],p=this.fragmentEditor.mainContainer.container.getAllLayers();p.unshift(this.fragmentEditor.mainContainer),t.altKey?(d=["desktopLandscape","tabletLandscape","tabletPortrait","mobileLandscape","mobilePortrait"],N2Classes.Notification.success(n2_("Clear device specific settings")+" - "+n2_("All layers, all devices"))):(d.push(this.fragmentEditor.getMode()),N2Classes.Notification.success(n2_("Clear device specific settings")+" - "+n2_("All layers, current device")));for(var c=0;c<p.length;c++)for(h=0;h<d.length;h++)p[c].resetMode(d[h]);i=!0}(t.ctrlKey||t.metaKey)&&(90===l?t.shiftKey?N2Classes.History.get().redo()&&(i=!0):N2Classes.History.get().undo()&&(i=!0):67===l?0===window.getSelection().toString().length&&(this.fragmentEditor.clipboard.copy(),i=!0):86===l?(this.fragmentEditor.clipboard.paste(),i=!0):49===l?(u("#n2-ss-preview").trigger("click"),i=!0):50===l?((s=u('.n2_device_tester_devices__device[data-device="desktopPortrait"]')).hasClass("n2_device_tester_devices__device--active")?(e=u('.n2_device_tester_devices__device[data-device="desktopLandscape"]')).length&&e.trigger("click"):s.trigger("click"),i=!0):51===l?((n=u('.n2_device_tester_devices__device[data-device="tabletPortrait"]')).hasClass("n2_device_tester_devices__device--active")?(s=u('.n2_device_tester_devices__device[data-device="tabletLandscape"]')).length&&s.trigger("click"):n.trigger("click"),i=!0):52===l&&((a=u('.n2_device_tester_devices__device[data-device="mobilePortrait"]')).hasClass("n2_device_tester_devices__device--active")?(o=u('.n2_device_tester_devices__device[data-device="mobileLandscape"]')).length&&o.trigger("click"):a.trigger("click"),i=!0)),!i&&r&&(t.ctrlKey||t.metaKey?68===l&&(this.fragmentEditor.duplicate(),i=!0):46===l||8===l?(this.fragmentEditor.delete(),i=!0):16===l?this.keysPressed[l]=1:38===l?"absolute"===r.placement.getType()&&(this.keyIntervals[l]||(this.layerMoveUp(),this.keyIntervals[l]=setInterval(this.layerMoveUp.bind(this),100)),i=!0):40===l?"absolute"===r.placement.getType()&&(this.keyIntervals[l]||(this.layerMoveDown(),this.keyIntervals[l]=setInterval(this.layerMoveDown.bind(this),100)),i=!0):37===l?"absolute"===r.placement.getType()&&(this.keyIntervals[l]||(this.layerMoveLeft(),this.keyIntervals[l]=setInterval(this.layerMoveLeft.bind(this),100)),i=!0):39===l?"absolute"===r.placement.getType()&&(this.keyIntervals[l]||(this.layerMoveRight(),this.keyIntervals[l]=setInterval(this.layerMoveRight.bind(this),100)),i=!0):97<=l&&l<=105&&"absolute"===r.placement.getType()&&(n=f[l],o=m[l],a=!1,this.fragmentEditor.layerOptions.forms.placement.absolute.align.val()===n&&this.fragmentEditor.layerOptions.forms.placement.absolute.valign.val()===o&&(a=!0),this.fragmentEditor.layerOptions.layerFeatures.horizontalAlign(n,a),this.fragmentEditor.layerOptions.layerFeatures.verticalAlign(o,a),i=!0)),i||t.ctrlKey||t.metaKey||(81===l?this.fragmentEditor.addLayer.visible||(r.activate(!0),this.fragmentEditor.layerWindow.tab.displayTab("content"),i=!0):87===l?this.fragmentEditor.addLayer.visible||(r.activate(!0),this.fragmentEditor.layerWindow.tab.displayTab("style"),i=!0):69===l?this.fragmentEditor.addLayer.visible||(r.activate(!0),this.fragmentEditor.layerWindow.tab.displayTab("animations"),i=!0):65===l?(this.fragmentEditor.addLayer.toggleActive(),i=!0):83===l?this.fragmentEditor.addLayer.visible||(r.activate(!0),this.fragmentEditor.layerWindow.toggleLayerList(),i=!0):68===l&&(this.fragmentEditor.addLayer.visible||this.fragmentEditor.layerWindow.isLayerListAttached||(this.fragmentEditor.layerNavigation.toggleActive(),i=!0))),i&&t.preventDefault()}}},t.prototype.onKeyUp=function(t){this.keyIntervals[t.keyCode]!==e&&(clearInterval(this.keyIntervals[t.keyCode]),delete this.keyIntervals[t.keyCode]),16===t.keyCode&&this.keysPressed[16]!==e&&(this.keysPressed[16]=0)},t.prototype.layerMoveUp=function(){this.fragmentEditor.activeLayer.moveY(-1*(this.keysPressed[16]?10:1))},t.prototype.layerMoveDown=function(){this.fragmentEditor.activeLayer.moveY(this.keysPressed[16]?10:1)},t.prototype.layerMoveLeft=function(){this.fragmentEditor.activeLayer.moveX(-1*(this.keysPressed[16]?10:1))},t.prototype.layerMoveRight=function(){this.fragmentEditor.activeLayer.moveX(this.keysPressed[16]?10:1)},t}),N2D("EditorInteractionManager",function(i,s){"use strict";function t(t){this.fragmentEditor=t,this.isHover=!1,this.state={drag:!1},this.$container=i(".n2_admin_editor__content").on({click:this.handleMouseClick.bind(this)}),this.$containerInner=this.$container.find(".n2_slide_editor_slider__editor_inner").one("mouseover",this.mouseEnter.bind(this)).on({mouseenter:this.mouseEnter.bind(this),mouseleave:this.mouseLeave.bind(this),dblclick:this.handleDoubleClick.bind(this),contextmenu:this.handleContextMenu.bind(this)}),this.storeInnerOffset(),document.addEventListener("mousemove",this.onMouseMove.bind(this),{passive:!0,capture:!0}),this.contextualBarHoverSection=new N2Classes.EditorContextualBarHoverSection(this),this.contextualBarHover=new N2Classes.EditorContextualBarHover(this),this.contextualBarActive=new N2Classes.EditorContextualBarActive(this),window.addEventListener("resize",this.refreshPosition.bind(this),{passive:!0,capture:!0}),document.addEventListener("scroll",this.refreshPosition.bind(this),{passive:!0,capture:!0}),document.addEventListener("EditorInvalidated",this.refreshPosition.bind(this)),this.fragmentEditor.editor.frontend.sliderElement.on("SliderResize",this.refreshPosition.bind(this))}return t.prototype.changeActiveComponent=function(t){this.activeComponent=t,this.contextualBarActive.changeActiveComponent(t),this.contextualBarHoverSection.refreshActiveState(),this.contextualBarHover.refreshActiveState(),this.lastMouseMoveEvent!==s&&(this.contextualBarHoverSection.processMouseCoordinates(this.lastMouseMoveEvent.clientX,this.lastMouseMoveEvent.clientY),this.contextualBarHover.processMouseCoordinates(this.lastMouseMoveEvent.clientX,this.lastMouseMoveEvent.clientY))},t.prototype.onMouseMove=function(t){this.lastMouseMoveEvent=t},t.prototype.refreshPosition=function(){this.storeInnerOffset(),this.contextualBarActive.refreshPosition(),this.contextualBarHover.refreshPosition(),this.contextualBarHoverSection.refreshPosition()},t.prototype.mouseEnter=function(){this.isHover||(this.isHover=!0,this.enable(),this.syncHover())},t.prototype.mouseLeave=function(){this.isHover&&(this.isHover=!1,this.disable(),this.syncHover())},t.prototype.enable=function(){this.contextualBarHoverSection.enable(),this.contextualBarHover.enable(),this.contextualBarActive.enable()},t.prototype.disable=function(){this.contextualBarActive.disable(),this.contextualBarHover.disable(),this.contextualBarHoverSection.disable()},t.prototype.syncHover=function(){this.$container.toggleClass("n2_admin_editor__content--hover",this.isHover)},t.prototype.storeInnerOffset=function(){this.innerOffset=this.$containerInner[0].getBoundingClientRect()},t.prototype.handleMouseClick=function(t){var e;N2Classes.WindowManager.isActionPrevented("ComponentActivate")||((e=this.findRelatedComponent(i(t.target)))?e.activate(t):this.fragmentEditor.layerWindow.requestHide())},t.prototype.handleDoubleClick=function(t){var e=i(t.target);!e.closest(".n2-ss-layer").length||(e=this.findRelatedComponent(e))&&e===this.activeComponent&&this.activeComponent.doubleClick(t)},t.prototype.handleContextMenu=function(t){var e=this.findRelatedComponent(i(t.target));e&&(t.preventDefault(),e.onContextMenu(t))},t.prototype.findRelatedComponent=function(t){var e,t=i(t);return t.hasClass("n2-ss-layer")?e=t:(e=t.closest(".n2-ss-layer")).length||(e=t.hasClass("n2_layer_contextual")?t:t.closest(".n2_layer_contextual")),e!==s&&e.data("layerObject")},t}),N2D("FragmentClipboard",function(t,n){"use strict";function e(t){this.fragmentEditor=t}return e.prototype.copy=function(){var t=this.fragmentEditor.activeLayer;this.fragmentEditor.isSectionSlide(t)?this.sectionCopy():this.componentCopy(t)},e.prototype.paste=function(){var t=this.fragmentEditor.activeLayer;this.fragmentEditor.isSectionSlide(t)?this.sectionPaste():this.componentPaste(t)},e.prototype.sectionHasClipboard=function(){return!!localStorage.getItem("clipboardSection")},e.prototype.sectionCopy=function(){var t=this.fragmentEditor.getSectionData();localStorage.setItem("clipboardSection",JSON.stringify(t))},e.prototype.sectionPaste=function(){var t=localStorage.getItem("clipboardSection");t&&(t=JSON.parse(t),this.fragmentEditor.manipulator.sectionReplace(this.fragmentEditor.mainContainer,t))},e.prototype.componentHasClipboard=function(){return!!localStorage.getItem("clipboardLayers")},e.prototype.componentCopy=function(t){this.fragmentEditor.isSectionSlide(t)?alert("copy section"):(t=this.fragmentEditor.isCol(t)||this.fragmentEditor.isContent(t)?t.container.getSortedLayers():[t],(t=this.getComponentsData(t)).length&&localStorage.setItem("clipboardLayers",JSON.stringify(t)))},e.prototype.componentPaste=function(t){var e,i,s=localStorage.getItem("clipboardLayers");!s||(e=JSON.parse(s)).length&&("normal"===(s=e[0].pm)?(i=t===n?this.fragmentEditor.mainContainer.getTargetGroupDefault():this.fragmentEditor.isCol(t)||this.fragmentEditor.isContent(t)?t:this.fragmentEditor.isRow(t)?t.container.getSortedLayers()[0]:"normal"===t.placement.getType()?t.group:this.fragmentEditor.mainContainer.getTargetGroupDefault(),this.fragmentEditor.manipulator.addLayers(e,i)):"absolute"===s&&(i=t===n?this.fragmentEditor.mainContainer.getTargetGroupAbsolute():t.container?t:t.group,this.fragmentEditor.manipulator.addLayers(e,i)))},e.prototype.getComponentsData=function(t){if(t===n)return[];for(var e=[],i=[],s=0;s<t.length;s++)t[s].getDataWithChildren(e,i);return e},e}),N2D("FragmentEditor",function(o,t){"use strict";function e(t,e,i){this.mode="desktopPortrait",this.editor=t,this.$editedElement=e,this.ready=o.Deferred(),this.$=o(this),t.fragmentEditor=this,o(".n2_slide_editor_slider__editor").attr("dir",o("html").attr("dir")),this.addLayer=new N2Classes.AddLayer(this),this.layerWindow=new N2Classes.LayerWindow(this),this.layerOptions=new N2Classes.ComponentSettings(this),this.layerNavigation=new N2Classes.LayerNavigation(this),this.manipulator=new N2Classes.FragmentManipulator(this),this.clipboard=new N2Classes.FragmentClipboard(this),this.mainContainer=new N2Classes.SectionSlide(this),this.canvasUIManager=new N2Classes.UICanvas(this.mainContainer.layer,this),this.itemEditor=new N2Classes.ItemManager(this,i),this.mainContainer.lateInit(),this._initDeviceModeChange(),this.canvasSettings=new N2Classes.CanvasSettings(this),this.layerOptions.startFeatures(),this.pointerManager=new N2Classes.EditorInteractionManager(this),new N2Classes.FragmentEditorHotkey(this),this.mainContainer.activate(!0)}return e.prototype.getMode=function(){return this.mode},e.prototype.getResponsiveRatioHorizontal=function(){return this.editor.getHorizontalRatio()},e.prototype.getResponsiveRatioVertical=function(){return this.editor.getVerticalRatio()},e.prototype.isRow=function(t){return t instanceof N2Classes.Row},e.prototype.isCol=function(t){return t instanceof N2Classes.Col},e.prototype.isLayer=function(t){return t instanceof N2Classes.Layer},e.prototype.isContent=function(t){return t instanceof N2Classes.Content},e.prototype.isSectionSlide=function(t){return t instanceof N2Classes.SectionSlide},e.prototype._initDeviceModeChange=function(){o("#layer-clear-device-specific-changes, #layer-slide-clear-device-specific-changes").on("click",this.onClearDeviceSpecificChanges.bind(this));var t=this.editor.getAvailableDeviceModes();o("#layerslide-show").data("field").setAvailableDevices(t),o("#layershow").data("field").setAvailableDevices(t),this.refreshMode(),this.ready.resolve()},e.prototype.refreshMode=function(){this.mode=this.editor.getDeviceMode(),this.mainContainer.changeEditorMode(this.mode)},e.prototype.onChangeDeviceOrientation=function(){this.refreshMode()},e.prototype.onResize=function(t){this.mainContainer.onResize(t),this.canvasSettings.ruler&&this.canvasSettings.ruler.onResize()},e.prototype.onClearDeviceSpecificChanges=function(){var t;this.activeLayer&&(t=this.getMode(),this.activeLayer.resetMode(t))},e.prototype.copyOrResetMode=function(t){var e=this.getMode();"desktopPortrait"===e?"desktopPortrait"!==t&&this.mainContainer.container.resetModes(t):t===e?this.mainContainer.container.resetModes(t):this.mainContainer.container.copyModes(e,t)},e.prototype.getSnap=function(t,e){var i=o();if(this.canvasSettings.get("n2-ss-snap-to-enabled")){this.mainContainer===t&&(i=i.add(".n2-ruler-user-guide"));for(var s=t.container.getSortedLayers(),n=0;n<s.length;n++)"absolute"===s[n].placement.getType()&&(i=i.add(s[n].layer))}return i.filter(":visible").not(e.layer)},e.prototype.getHTML=function(){for(var t=o("<div></div>"),e=this.mainContainer.container.getAllLayers(),i=0;i<e.length;i++)t.append(e[i].getHTML(!0));return t.html()},e.prototype.getData=function(){return this.mainContainer.getData()},e.prototype.getSectionData=function(){return this.mainContainer.getSectionData()},e.prototype.loadComponentWithNode=function(t,e,i,s){e=t.container.append(e);return s&&this.refreshMode(),e},e.prototype.insertComponentWithNode=function(t,e,i,s,n){i=t.container.insertAt(e,i);return n&&this.refreshMode(),i},e.prototype.resetActiveLayer=function(){var t=this.mainContainer.container.getSortedLayers();t.length&&t[t.length-1].activate()},e.prototype.changeActiveLayer=function(s){var t=this.activeLayer;t&&!t.isDeleted&&(t.$.off("propertyChanged.editor").off(".active"),t.deActivate()),this.activeLayer=s,(nextend.activeLayer=s)&&(this.pointerManager.changeActiveComponent(s),this.layerOptions.changeActiveComponent(s,s.type,s.getSubType(),s.placement.getType(),s.getProperties()),s.$.on({"propertyChanged.editor":this.layerOptions.onUpdateField.bind(this.layerOptions),"placementChanged.active":function(t,e,i){this.layerOptions.changeActiveComponentPlacement(e,s.property)}.bind(this)})),this.$.trigger("activeLayerChanged")},e.prototype.getActiveLayer=function(){return this.activeLayer},e.prototype.highlight=function(t){this.pointerManager.contextualBarHover.enableActiveForced(),this.pointerManager.contextualBarHover.processHoveredElement(t),this.hoverZIndexInterval&&clearInterval(this.hoverZIndexInterval),this.hoverZIndexInterval=setInterval(function(){this.toggleClass("n2_layer_layer_list_hover--force-zindex")}.bind(t.layer),800)},e.prototype.deHighlight=function(t){this.pointerManager.contextualBarHover.disableActiveForced(),this.hoverZIndexInterval&&clearInterval(this.hoverZIndexInterval),t.isDeleted||t.layer.removeClass("n2_layer_layer_list_hover--force-zindex")},e.prototype.delete=function(){this.activeLayer.delete()},e.prototype.duplicate=function(){this.activeLayer.duplicate(!0)},e.prototype.getSelf=function(){return this},e}),N2D("FragmentManipulator",function(c,u){function t(t){this.fragmentEditor=t}return t.prototype.deleteLayers=function(){for(var t=this.fragmentEditor.mainContainer.container.getSortedLayers(),e=0;e<t.length;e++)t[e].delete()},t.prototype.sectionReplace=function(t,e){var i=c.extend(!0,{},e),s=t.container;this._idTranslation={};var n=this.dataToLayers(c.extend(!0,[],i.layers).reverse()),o=[];this.deleteLayers(),t.mainContent.remove();for(var a=0;a<n.length;a++)o.push(s.append(n[a]));N2Classes.History.get().startBatch();var r,l,d,h={};for(r in t.removeProperty("padding"),t.createDeviceProperty("padding",{desktopPortrait:"10|*|10|*|10|*|10"}),t.deviceProperty)for(var p in t.isDeviceProp)t.isDeviceProp[p]&&(i[l=r.toLowerCase()+p]!==u?(h[p]=!0,t.outsideStoreProperty(r,p,i[l],!0,"sectionReplace"),delete i[l]):!0===h[p]&&t.outsideStoreProperty(r,p,u,!0,"sectionReplace"));for(d in t.property)i[d]!==u&&(t.outsideStoreProperty(u,d,i[d],!0,"sectionReplace"),delete i[d]);return N2Classes.History.get().addSimple(this,this.historyDeleteAll,this.historyReplaceLayers,[t,i,o,s.getAllLayers()]),N2Classes.History.get().endBatch(),this.fragmentEditor.refreshMode(),s.layerContainerElement.n2imagesLoaded().always(this.fragmentEditor.refreshMode.bind(this.fragmentEditor)),this.fragmentEditor.getActiveLayer()||0<o.length&&o[0].activate(),o},t.prototype.historyDeleteAll=function(t,e,i){for(var s=0;s<i.length;s++)i[s].getSelf().delete();t.mainContent.getSelf().remove()},t.prototype.historyReplaceLayers=function(t,e,i,s){this.sectionReplace(t,e);for(var n=t.container.getAllLayers(),o=0;o<s.length;o++)s[o].setSelf(n[o])},t.prototype.addLayers=function(t,e){this._idTranslation={};for(var i=this.dataToLayers(c.extend(!0,[],t)),s=[],n=0;n<i.length;n++)s.push(e.container.append(i[n]));return this.fragmentEditor.refreshMode(),N2Classes.History.get().addSimple(this,this.historyDeleteLayers,this.historyAddLayers,[t,s,e]),s},t.prototype.historyDeleteLayers=function(t,e,i){for(var s=0;s<e.length;s++)e[s].getSelf().delete()},t.prototype.historyAddLayers=function(t,e,i){for(var s=this.addLayers(t,i.getSelf()),n=0;n<e.length;n++)e[n].setSelf(s[n])},t.prototype.dataToLayers=function(t,e){for(var i=[],s=0;s<t.length;s++)switch(t[s].type){case"row":i.push(this.buildRowNode(t[s],e));break;case"col":i.push(this.buildColNode(t[s],e));break;case"content":i.push(this.buildContentNode(t[s],e));break;case"layer":default:i.push(this.buildLayerNode(t[s],e))}return i},t.prototype._buildNodePrepareID=function(t,e){var i,s;if(e.id&&(i=c.fn.uid(),s=!1,"object"==typeof this._idTranslation[e.id]&&(s=this._idTranslation[e.id]),this._idTranslation[e.id]=i,e.id=i,t.attr("id",i),s&&s.resolve(e.id,i)),e.parentid)switch(typeof this._idTranslation[e.parentid]){case"string":e.parentid=this._idTranslation[e.parentid];break;case"undefined":this._idTranslation[e.parentid]=c.Deferred();case"object":this._idTranslation[e.parentid].done(function(t,e,i){t.data("parentid",i)}.bind(this,t));break;default:e.parentid=""}},t.prototype._buildNodeAnimations=function(t){"object"==typeof t.animations&&(t.animations=JSON.stringify(t.animations))},t.prototype.buildContentNode=function(t,e){var i,s=c("<div class='n2-ss-layer' data-sstype='content'></div>"),n=c("<div class='n2-ss-section-main-content n2-ss-layer-content'></div>").appendTo(s);for(i in this._buildNodeAnimations(t),t)s.data(i,t[i]);return e!==u&&s.appendTo(e),this.dataToLayers(t.layers,n),s},t.prototype.buildRowNode=function(t,e){var i,s=c("<div class='n2-ss-layer' data-sstype='row'></div>"),n=c("<div class='n2-ss-layer-row'></div>").appendTo(s);for(i in this._buildNodePrepareID(s,t),this._buildNodeAnimations(t),t)s.data(i,t[i]);return e!==u&&s.appendTo(e),this.dataToLayers(t.cols,n),s},t.prototype.buildColNode=function(t,e){var i,s=c("<div class='n2-ss-layer' data-sstype='col'></div>"),n=c("<div class='n2-ss-layer-col n2-ss-layer-content'></div>").appendTo(s);for(i in this._buildNodeAnimations(t),t)s.data(i,t[i]);return e!==u&&s.appendTo(e),this.dataToLayers(t.layers,n),s},t.prototype.buildLayerNode=function(t,e){var i,s=c("<div class='n2-ss-layer' data-sstype='layer'></div>").attr("style",t.style);for(i in this._buildNodePrepareID(s,t),t.items!==u&&(t.item=t.items[0],delete t.items),c('<div class="n2-ss-item n2-ss-item-'+t.item.type+'"></div>').data("item",t.item.type).data("itemvalues",t.item.values).appendTo(s),delete t.style,delete t.item,this._buildNodeAnimations(t),t)s.data(i,t[i]);return e!==u&&s.appendTo(e),s},t.prototype.getSelf=function(){return this},t}),N2D("AddLayer",function(h,e){function t(t){this.fragmentEditor=t,this.sectionLibraryFree=t.editor.options.sectionLibraryFree,this.sectionLibraryUrl=t.editor.options.sectionLibraryUrl,this.sectionLibraryGoProUrl=t.editor.options.sectionLibraryGoProUrl;try{localStorage.removeItem("SectionFreeThemeorion_dark"),localStorage.removeItem("SectionFreeThemeorion_darkMetaDate"),localStorage.removeItem("SectionFreeThemeorion_light"),localStorage.removeItem("SectionFreeThemeorion_lightMetaDate"),localStorage.removeItem("SectionFreeThemes"),localStorage.removeItem("SectionFreeThemesMetaDate"),localStorage.removeItem("SectionProThemeorion_dark"),localStorage.removeItem("SectionProThemeorion_darkMetaDate"),localStorage.removeItem("SectionProThemeorion_light"),localStorage.removeItem("SectionProThemeorion_lightMetaDate"),localStorage.removeItem("SectionProThemes"),localStorage.removeItem("SectionProThemesMetaDate")}catch(t){}this.visible=!1,this.$editor=h(".n2_admin_editor"),this.$editorOverlay=h(".n2_admin_editor_overlay"),this.$addLayer=h(".n2_add_layer"),h(".n2_add_layer__bar_button_add").on("click",function(t){t.preventDefault(),this.toggleActive()}.bind(this)),this.$addLayer.find(".n2_add_layer_box"),this.hideInteractionCallback=this.hideInteraction.bind(this),this.onKeyDownCallback=this.onKeyDown.bind(this),this.initTabs(),this.initPositionChanger()}return t.prototype.hide=function(){this.visible=!0,this.toggleActive()},t.prototype.hideInteraction=function(t){h.contains(this.$addLayer[0],t.target)||this.$addLayer.is(t.target)||this.hide()},t.prototype.onKeyDown=function(t){27===t.keyCode&&(t.stopImmediatePropagation(),t.preventDefault(),this.hide())},t.prototype.toggleActive=function(){this.visible=!this.visible,h("body").toggleClass("n2_body--show-add-more",this.visible),this.$editorOverlay.toggleClass("n2_admin_editor_overlay--show-add-more",this.visible),this.visible?(this.$editor[0].addEventListener("click",this.hideInteractionCallback,{capture:!0}),document.addEventListener("keydown",this.onKeyDownCallback,{capture:!0})):(this.$editor[0].removeEventListener("click",this.hideInteractionCallback,{capture:!0}),document.removeEventListener("keydown",this.onKeyDownCallback,{capture:!0}),this.setPosition("default"))},t.prototype.initTabs=function(){this.$buttons=h(".n2_add_layer__more_tab_button").on("click"),this.$tabs=h(".n2_add_layer__more_tab"),this.valuesDict={};for(var t=0;t<this.$buttons.length;t++){var e=this.$buttons.eq(t),i=e.data("related-tab");this.valuesDict[i]={index:t,$button:e,$tab:this.$tabs.filter('[data-tab="'+i+'"]')},e.on("click",this.displayTab.bind(this,i))}this.displayTab("layers")},t.prototype.displayTab=function(t,e){e&&e.preventDefault(),this.activeTabName!==t&&(this.activeTabName=t,this.$buttons.removeClass("n2_add_layer__more_tab_button--active"),this.$tabs.removeClass("n2_add_layer__more_tab--active"),this.valuesDict[t].$button.addClass("n2_add_layer__more_tab_button--active"),this.valuesDict[t].$tab.addClass("n2_add_layer__more_tab--active"),"library"===t&&this.initLibrary())},t.prototype.initPositionChanger=function(){this.currentPosition="default",this.$position=this.$addLayer.find(".n2_add_layer_position"),this.$position.find(".n2_add_layer_position__default_label").on("click",this.setPosition.bind(this,"default")),this.$position.find(".n2_add_layer_position__absolute_label").on("click",this.setPosition.bind(this,"absolute")),this.$position.find(".n2_add_layer_position__switch").on("click",this.togglePosition.bind(this))},t.prototype.setPosition=function(t){this.currentPosition=t,this.$position.attr("data-position",t)},t.prototype.togglePosition=function(){this.setPosition("default"===this.currentPosition?"absolute":"default")},t.prototype.getPosition=function(){return this.currentPosition},t.prototype.initLibrary=function(){this.initLibrary=function(){},this.activeThemeID=!1,this.themes={},this.$themesTitle=h('<div class="n2_add_layer_library__title"></div>').appendTo(this.valuesDict.library.$tab),h('<div class="n2_add_layer_library__title_label"></div>').text(n2_("Theme")).appendTo(this.$themesTitle),this.displayThemes()},t.prototype.displayThemes=function(){N2Classes.AjaxHelper.ajax({type:"GET",url:this.sectionLibraryUrl+"/themes/",dataType:"json"}).done(function(t){this.onThemesLoaded(t.themes)}.bind(this))},t.prototype.onThemesLoaded=function(t){for(var e=h('<div class="n2_field_select"></div>').appendTo(this.$themesTitle),i=h('<select name="library-theme" autocomplete="off"></select>').appendTo(e),s=0;s<t.length;s++)i.append('<option value="'+t[s].id+'">'+t[s].label+"</option>");this.displayTheme(t[0].id),i.on("change",function(){this.displayTheme(i.val())}.bind(this))},t.prototype.displayTheme=function(t){this.activeThemeID!==t&&(this.activeThemeID&&this.themes[this.activeThemeID].removeClass("n2_add_layer_library__theme--active"),this.activeThemeID=t,this.themes[t]===e?N2Classes.AjaxHelper.ajax({type:"GET",url:this.sectionLibraryUrl+"/theme/"+t,dataType:"json"}).done(function(t,e){this.onThemeLoaded(e.theme)}.bind(this,t)):this.themes[t].addClass("n2_add_layer_library__theme--active"))},t.prototype.onThemeLoaded=function(t){if(function(t,e){t=t.split("."),e=e.split(".");for(var i=Math.min(t.length,e.length),s=0;s<i;++s){if(t[s]=parseInt(t[s],10),e[s]=parseInt(e[s],10),t[s]>e[s])return 1;if(t[s]<e[s])return}return t.length===e.length||t.length>=e.length}(N2SS3VERSION,t.version)){var e=h('<div class="n2_add_layer_library__theme n2_add_layer_library__theme--active"></div>').appendTo(this.valuesDict.library.$tab);this.themes[t.id]=e;for(var i=0;i<t.categories.length;i++){var s=t.categories[i],n=h('<div class="n2_add_layer_library_tag"></div>').appendTo(e),o=h('<div class="n2_add_layer_library_tag__title"></div>').on("click",function(t){t.toggleClass("n2_add_layer_library_tag--active")}.bind(this,n)).appendTo(n);h('<div class="n2_add_layer_library_tag__title_label"></div>').text(s.label).appendTo(o),h('<div class="n2_add_layer_library_tag__title_opener"><i class="ssi_16 ssi_16--buttonarrow"></i></div>').appendTo(o);for(var a=h('<div class="n2_add_layer_library_tag__sections"></div>').appendTo(n),r=0;r<s.sections.length;r++){var l=s.sections[r],d=h('<div class="n2_add_layer_library_tag__section"><img src="'+l.thumbnail+'" alt=""/></div>').appendTo(a);l.isPro&&d.append('<div class="n2_add_layer_library_tag__section_pro">Pro</div>'),!l.isPro||l.isPro&&!this.sectionLibraryFree?d.addClass("n2_add_layer_library_tag__section--available").on("click",this.insertSection.bind(this,l.data)):d.append('<div class="n2_add_layer_library_tag__section_overlay"><div>'+n2_("This section requires activated Pro version.")+"</div></div>")}}}else this.activeThemeID=!1,N2Classes.Notification.error(n2_sprintf(n2_("%s or newer required for this feature."),"Smart Slider "+t.version))},t.prototype.insertSection=function(t){this.fragmentEditor.manipulator.sectionReplace(this.fragmentEditor.mainContainer,t)},t}),N2D("LayerFeatures",function(t,e){"use strict";var i={left:0,center:1,right:2,top:0,middle:1,bottom:2};function s(t,e){this.fields=t,this.fragmentEditor=e,this.layerDefault={align:null,valign:null}}return s.prototype.horizontalAlign=function(t,e){this.fields.align.val()!=t?this.fields.align.data("field").options.eq(i[t]).trigger("click"):e&&this.fields.left.val(0).trigger("change"),nextend.activeLayer.layer.trigger("interaction")},s.prototype.verticalAlign=function(t,e){this.fields.valign.val()!=t?this.fields.valign.data("field").options.eq(i[t]).trigger("click"):e&&this.fields.top.val(0).trigger("change"),nextend.activeLayer.layer.trigger("interaction")},s}),N2D("LayerNavigation",function(i,e){"use strict";function t(t){this.fragmentEditor=t,this.forceOpened=[],this.scrollBarHeight=0,this.visible=!1,this.tlHeight=parseInt(localStorage.getItem("ssLayersHeight")||200),this.$editorContent=i(".n2_admin_editor__content"),this.$editorOverlay=i(".n2_admin_editor_overlay"),this.$layerNavigation=this.$container=i('<div class="n2_layer_navigation" dir="ltr"></div>').appendTo(this.$editorOverlay),this.$scrollPanes=i('<div class="n2_layer_navigation_list"></div>').appendTo(this.$layerNavigation);var e=i('<div class="n2_layer_navigation_list_title"></div>').appendTo(this.$scrollPanes);i('<div class="n2_layer_navigation_list_title__hide n2_slide_editor_timeline_toggle n2_slide_editor_timeline_toggle--hide"><i class="ssi_16 ssi_16--remove"></i></div>').appendTo(e),i(".n2_slide_editor_timeline_toggle ").on("click",function(t){t.preventDefault(),this.toggleActive()}.bind(this)),i('<div class="n2_layer_navigation_list_title__label">'+n2_("Timeline")+"</div>").appendTo(e),this.$layerListContainer=i('<div class="n2_layer_navigation_list_layers"></div>').appendTo(this.$scrollPanes),this.layerNavigationTimeline=new N2Classes.LayerNavigationTimeline(t,this),this.fixScroll(),this.topBar=i(".n2_layer_navigation_list_title"),i(".n2_layer_navigation_list_title__label").on("mousedown",this.resizeStart.bind(this)),"1"===localStorage.getItem("ssLayersShown")&&this.show(),this.interaction=new N2Classes.LayerNavigationInteraction(this,this.fragmentEditor,this.$layerNavigation)}return t.prototype.onAttach=function(t){this.attachedToLayerWindow=t,this.scrollToActiveLayer()},t.prototype.onDetach=function(){delete this.attachedToLayerWindow,this.scrollToActiveLayer()},t.prototype.addScrollPane=function(t){this.$scrollPanes=this.$scrollPanes.add(t)},t.prototype.setScrollTop=function(t){this.$scrollPanes.each(function(){this.scrollTop=t})},t.prototype.scrollToActiveLayer=function(){this.onActivateLayer(this.fragmentEditor.activeLayer)},t.prototype.onActivateLayer=function(t){if(this.forceOpened.length)for(var e=0;e<this.forceOpened.length;e++)this.forceOpened[e].removeForceOpen();this.forceOpened=[];for(var i=t.group;i;)"row"!==i.type&&"col"!==i.type&&"content"!==i.type||(this.forceOpened.push(i),i.forceOpen()),i=i.group;for(var s=this.$scrollPanes.scrollTop(),n=0,o=t;n+=o.layerRow.get(0).offsetTop,o=o.group,o;);(n<s||n>s+this.$scrollPanes.height()-66-this.scrollBarHeight)&&this.setScrollTop(n)},t.prototype.fixScroll=function(){0<this.scrollBarHeight&&this.$layerListContainer.css("padding-bottom",this.scrollBarHeight),this.$scrollPanes.on({wheel:this.onWheel.bind(this),scroll:this.onScroll.bind(this)})},t.prototype.onScroll=function(t){t.preventDefault(),this.setScrollTop(i(t.currentTarget).scrollTop())},t.prototype.onWheel=function(t){var e;t.shiftKey||(t.preventDefault(),e=this.$scrollPanes.scrollTop(),0<t.originalEvent.deltaY?e+=33:e-=33,e=33*Math.round(e/33),this.setScrollTop(e))},t.prototype.resizeStart=function(t){t.preventDefault(),this.startY=t.clientY,this.height=this.$layerNavigation.height(),i("body").on({"mousemove.n2-ss-tl-resize":this.resizeMove.bind(this),"mouseup.n2-ss-tl-resize":this.resizeStop.bind(this),"mouseleave.n2-ss-tl-resize":this.resizeStop.bind(this)})},t.prototype.resizeMove=function(t){t.preventDefault(),this.setLayerNavigationHeight(this._calculateDesiredHeight(t))},t.prototype.resizeStop=function(t){t.preventDefault(),i("body").off(".n2-ss-tl-resize");t=this._calculateDesiredHeight(t);this.setLayerNavigationHeight(t),this.tlHeight=t,localStorage.setItem("ssLayersHeight",t+""),i("#n2-admin").triggerHandler("resize")},t.prototype._calculateDesiredHeight=function(t){t=this.startY-t.clientY+this.height-24;return this.__calculateDesiredHeight(t)},t.prototype.__calculateDesiredHeight=function(t){t=Math.max(1,Math.round(Math.min(t,window.innerHeight/2)/33)-1);return this.scrollBarHeight+33*t+48},t.prototype.hide=function(){this.visible=!0,this.toggleActive()},t.prototype.show=function(){this.visible=!1,this.toggleActive()},t.prototype.toggleActive=function(){this.visible=!this.visible,this.$editorOverlay.toggleClass("n2_admin_editor_overlay--show-layer-navigation",this.visible),this.visible?(this.fragmentEditor.addLayer.hide(),this.setLayerNavigationHeight(this.tlHeight)):this.$editorContent.css("paddingBottom",0),localStorage.setItem("ssLayersShown",this.visible?"1":"0")},t.prototype.setLayerNavigationHeight=function(t){t=Math.max(48,t),this.$layerNavigation.height(t),this.$editorContent.css("paddingBottom",t),this.layerNavigationTimeline!==e&&this.layerNavigationTimeline.onResize(),nextend.triggerResize()},t}),N2D("LayerNavigationInteraction",function(i,t){"use strict";function e(t,e,i){this.hoveredComponent=!1,this.layerNavigation=t,this.fragmentEditor=e,this.$container=i.on({click:this.handleMouseClick.bind(this),mouseleave:this.handleMouseLeave.bind(this),contextmenu:this.handleContextMenu.bind(this)}),i[0].addEventListener("mouseover",this.handleMouseOver.bind(this),{passive:!0,capture:!0})}return e.prototype.handleMouseClick=function(t){var e;N2Classes.WindowManager.isActionPrevented("ComponentRowActivate")||(e=this.findRelatedComponent(t.target))&&(e.activate(t),this.detachFromLayerWindow())},e.prototype.detachFromLayerWindow=function(){this.layerNavigation.attachedToLayerWindow&&this.layerNavigation.attachedToLayerWindow.detachLayerList()},e.prototype.handleMouseLeave=function(){this.hoveredComponent&&(this.fragmentEditor.deHighlight(this.hoveredComponent),this.hoveredComponent=!1)},e.prototype.handleMouseOver=function(t){this.hoveredComponent&&this.fragmentEditor.deHighlight(this.hoveredComponent),this.hoveredComponent=this.findRelatedComponent(t.target),this.hoveredComponent&&this.fragmentEditor.highlight(this.hoveredComponent)},e.prototype.handleContextMenu=function(t){var e=this.findRelatedComponent(t.target);e&&(t.preventDefault(),e.onContextMenu(t))},e.prototype.findRelatedComponent=function(t){var e,t=i(t);if(t.hasClass("n2_layer_navigation_list_layer"))e=t;else if(!(e=t.closest(".n2_layer_navigation_list_layer")).length)if(t.hasClass("n2_timeline_layer__animations"))e=t;else if(!(e=t.closest(".n2_timeline_layer__animations")).length)return!1;return e.data("layer")},e}),N2D("LayerWindow",function(a,t){"use strict";function e(t){this.admin=a("#n2-admin"),this.$editorOverlay=a(".n2_admin_editor_overlay"),this.sidebar=a("#n2-ss-layer-window"),this.title=this.sidebar.find(".n2_ss_layer_window__title_inner"),this.$inner=this.sidebar.find(".n2_ss_layer_window__crop"),this.fragmentEditor=t,this.tab=new N2Classes.LayerWindowTab(this),this.initLayerList();t=this.sidebar.find(".n2_ss_layer_window__title_nav_right");a('<div class="n2_ss_layer_window__title_nav_button"><i class="ssi_16 ssi_16--remove"></i></div>').on("click",function(t){this.hide()}.bind(this)).appendTo(t),new N2Classes.UILayerWindow(this.sidebar),this.initDeviceSwitcherShortcut()}return e.prototype.show=function(t){this.cancelHideRequest(),this.setTitle(t),a("body").addClass("n2_body--layer-window-visible")},e.prototype.requestHide=function(){this.cancelHideRequest(),this.hideRequestID=requestAnimationFrame(this.hide.bind(this))},e.prototype.cancelHideRequest=function(){this.hideRequestID!==t&&(cancelAnimationFrame(this.hideRequestID),delete this.hideRequestID)},e.prototype.hide=function(){delete this.hideRequestID,a("body").removeClass("n2_body--layer-window-visible")},e.prototype.setTitle=function(t){this.title.html(t.getName())},e.prototype.initLayerList=function(){this.isLayerListAttached=!1;var t=this.sidebar.find(".n2_ss_layer_window__title_nav_left");a('<div class="n2_ss_layer_window__title_nav_button n2_ss_layer_window__title_nav_button_layer_list"><i class="ssi_16 ssi_16--layer"></i></div>').attr("data-n2tip",n2_("Layer List")).on("click",this.toggleLayerList.bind(this)).appendTo(t),nextend.tooltip.add(t),this.detachLayerListClickCallback=this.detachLayerListClick.bind(this)},e.prototype.toggleLayerList=function(t){this.isLayerListAttached?this.detachLayerList():this.attachLayerList()},e.prototype.attachLayerList=function(){a("body").addClass("n2_body--attached-layer-list"),this.$editorOverlay.addClass("n2_admin_editor_overlay--attached-layer-list"),this.fragmentEditor.layerNavigation.$container.appendTo(this.$inner),this.fragmentEditor.layerNavigation.onAttach(this),document.addEventListener("click",this.detachLayerListClickCallback,{passive:!0,capture:!0}),this.isLayerListAttached=!0},e.prototype.detachLayerList=function(){this.fragmentEditor.layerNavigation.$container[0].dispatchEvent(new MouseEvent("mouseover",{view:window})),this.$editorOverlay.removeClass("n2_admin_editor_overlay--attached-layer-list"),a("body").removeClass("n2_body--attached-layer-list"),this.fragmentEditor.layerNavigation.$container.insertAfter(this.sidebar),this.fragmentEditor.layerNavigation.onDetach(),document.removeEventListener("click",this.detachLayerListClickCallback,{passive:!0,capture:!0}),this.isLayerListAttached=!1},e.prototype.detachLayerListClick=function(t){a.contains(this.sidebar[0],t.target)||this.sidebar.is(t.target)||a(t.target).closest(".n2_context_menu").length||this.detachLayerList()},e.prototype.initDeviceSwitcherShortcut=function(){var t,e=a('<div id="n2-ss-devicespecific-settings"></div>'),i=this.fragmentEditor.editor.getAvailableDeviceModes(),s={desktopLandscape:"ssi_16--desktoplandscape",desktopPortrait:"ssi_16--desktopportrait",tabletLandscape:"ssi_16--tabletportraitlarge",tabletPortrait:"ssi_16--tabletportrait",mobileLandscape:"ssi_16--mobileportraitlarge",mobilePortrait:"ssi_16--mobileportrait"};for(t in i)i[t]&&e.append('<i class="ssi_16 '+s[t]+'" data-device="'+t+'"></i>');var n={mouseenter:function(t){e.appendTo(t.currentTarget)}.bind(this),mouseleave:function(t){e.detach()}.bind(this)},o=this.sidebar.find("[data-devicespecific] label").parent(),n=a('<div class="n2_field__label_modifier ssi_16 ssi_16--minidesktopportrait"></div>').on(n);o.prepend(n),e.find(".ssi_16").on({click:function(t){t.preventDefault();t=a(t.currentTarget);a('.n2_device_tester_devices__device[data-device="'+t.data("device")+'"]').trigger("click")}.bind(this)})},e}),N2D("LayerWindowTab",function(a,r){"use strict";function t(t){this.layerWindow=t,this.activeTabName="",this.activePanelNames=[],this.$buttons=a(".n2_ss_layer_window__tab_button"),this.$buttonsContainer=this.$buttons.parent(),this.$scrollable=a(".n2_ss_layer_window__tab_container"),this.$tabs=a(".n2_ss_layer_window__tab"),this.valuesDict={};for(var e=0;e<this.$buttons.length;e++){var i=this.$buttons.eq(e),s=i.data("related-tab");this.valuesDict[s]={index:e,$button:i,$tab:this.$tabs.filter('[data-tab="'+s+'"]')},i.on("click",this.displayTab.bind(this,s))}this.panels={};for(var n=this.$tabs.find(".n2_ss_layer_window__tab_panel"),e=0;e<n.length;e++){var o=n.eq(e).data("panel");this.panels[o]===r?this.panels[o]=n.eq(e):this.panels[o]=this.panels[o].add(n[e])}}return t.prototype.displayTab=function(t,e){e&&e.preventDefault(),nextend.basicCSS.deActivate(),this.activeTabName!==t&&this.valuesDict[t]&&this.valuesDict[t].$tab.hasClass("n2_ss_layer_window__tab--allowed")&&(this.$buttons.removeClass("n2_ss_layer_window__tab_button--active"),this.$tabs.removeClass("n2_ss_layer_window__tab--active"),this.valuesDict[t].$button.addClass("n2_ss_layer_window__tab_button--active"),this.valuesDict[t].$tab.addClass("n2_ss_layer_window__tab--active"),this.activeTabName=t,N2Classes.LayerNavigationTimeline.get().layerWindowEditor.loadDataForLayer(),this.$scrollable.scrollTop(0))},t.prototype.setPanel=function(t,e){for(var i=0;i<this.activePanelNames.length;i++)this.panels[this.activePanelNames[i]].removeClass("n2_ss_layer_window__tab_panel--active");for(this.activePanelNames=t,i=0;i<this.activePanelNames.length;i++)this.panels[this.activePanelNames[i]].addClass("n2_ss_layer_window__tab_panel--active");this.setAllowedTabs(e)},t.prototype.setAllowedTabs=function(t){for(var e in this.$buttons.removeClass("n2_ss_layer_window__tab_button--allowed"),this.valuesDict)this.valuesDict[e].$tab.removeClass("n2_ss_layer_window__tab--allowed");for(var i=!1,s=0;s<t.length;s++){var n=t[s];this.valuesDict[n]!==r&&(n===this.activeTabName&&(i=!0),this.valuesDict[n].$button.addClass("n2_ss_layer_window__tab_button--allowed"),this.valuesDict[n].$tab.addClass("n2_ss_layer_window__tab--allowed"))}i||this.valuesDict[t[0]].$button.trigger("click"),this.$buttonsContainer.attr("data-visible-tabs",t.length)},t.prototype.getActiveTabName=function(){return this.activeTabName},t}),N2D("PositionDisplay",function(t,s){"use strict";function e(){this.currentSource="",t(window).ready(this._ready.bind(this))}return e.prototype._ready=function(){this.$body=t("body"),this.$el=t('<div class="n2_tooltip n2_tooltip_position"></div>').appendTo(".n2_admin_editor_overlay,.n2_admin")},e.prototype.show=function(t){""===this.currentSource&&(this.currentSource=t,this.$el.addClass("n2_tooltip--active"),this.$body.addClass("n2_body--tooltip-position-active"))},e.prototype.update=function(t,e,i){this.currentSource===e&&(i!==s&&this.$el.html(i),this.$el.css({left:t.clientX+10,top:t.clientY+10}))},e.prototype.hide=function(t){this.currentSource!==t&&t!==s||(this.$body.removeClass("n2_body--tooltip-position-active"),this.$el.removeClass("n2_tooltip--active"),this.currentSource="")},e.get=function(){var t=new e;return e.get=function(){return t},t},e}),N2D("Ruler",function(r,l){"use strict";function t(t,e){this.editor=t,this.showGuides=1,this.guides=[],this.scale=10,this.$scrollArea=r(".n2_admin_editor__content_inner"),r('<div class="n2_ruler_corner"></div>').on("click",function(){this.editor.fragmentEditor.canvasSettings.toggle("n2-ss-ruler-enabled")}.bind(this)).appendTo(".n2_admin_editor_overlay__middle_center");function s(){return i===l&&(i={top:o.scrollTop,left:o.scrollLeft,behavior:"auto"}),n&&clearTimeout(n),n=setTimeout(function(){i=l},500),i}var i,n,o=this.$scrollArea[0];this.vertical=r('<div class="n2_ruler n2_ruler--vertical"></div>').on("wheel",function(t){t.preventDefault();var e=1;1!==t.originalEvent.deltaMode&&2!==t.originalEvent.deltaMode||(e=40);var i=s();t.originalEvent.deltaY&&(t.originalEvent.shiftKey?i.left+=t.originalEvent.deltaY*e:i.top+=t.originalEvent.deltaY*e),t.originalEvent.deltaX&&(i.left+=t.originalEvent.deltaX*e),i.left=Math.min(Math.max(0,i.left),o.scrollWidth-o.clientWidth),i.top=Math.min(Math.max(0,i.top),o.scrollHeight-o.clientHeight),o.scrollTo(i)}.bind(this)).appendTo(".n2_admin_editor_overlay__middle_center"),this.$verticalInner=r('<div class="n2_ruler__inner"></div>').prependTo(this.vertical),this.horizontal=r('<div class="n2_ruler n2_ruler--horizontal"></div>').on("wheel",function(t){t.preventDefault();var e=1;1!==t.originalEvent.deltaMode&&2!==t.originalEvent.deltaMode||(e=40);var i=s();t.originalEvent.deltaY&&(t.originalEvent.shiftKey?i.left+=t.originalEvent.deltaY*e:i.top+=t.originalEvent.deltaY*e),t.originalEvent.deltaX&&(i.left+=t.originalEvent.deltaX*e),i.left=Math.min(Math.max(0,i.left),o.scrollWidth-o.clientWidth),i.top=Math.min(Math.max(0,i.top),o.scrollHeight-o.clientHeight),o.scrollTo(i)}.bind(this)).appendTo(".n2_admin_editor_overlay__middle_center"),this.$horizontalInner=r('<div class="n2_ruler__inner"></div>').prependTo(this.horizontal),this.verticalMarks=r(),this.horizontalMarks=r(),this.onResize(),r(window).on("resize",this.onResize.bind(this)),this.$scrollArea.on("scroll",this.syncScroll.bind(this)),this.syncScroll(),this.$horizontalInner.on("mousedown",function(t){this.showGuides&&new d(this,this.horizontal,this.$horizontalInner,t)}.bind(this)),this.$verticalInner.on("mousedown",function(t){this.showGuides&&new h(this,this.vertical,this.$verticalInner,t)}.bind(this));try{e=r.extend({vertical:[],horizontal:[]},JSON.parse(N2Classes.Base64.decode(e)));for(var a=0;a<e.horizontal.length;a++)new d(this,this.horizontal,this.$horizontalInner).setPosition(e.horizontal[a]);for(a=0;a<e.vertical.length;a++)new h(this,this.vertical,this.$verticalInner).setPosition(e.vertical[a])}catch(t){}this.measureToolVertical(),this.measureToolHorizontal()}function e(t,e,i,s){this.ruler=t,this.container=e,this.containerInner=i,this.position=0,this.guide=r('<div class="n2_ruler__guide n2-ruler-user-guide"><div class="n2_ruler__guide_border"></div></div>').appendTo(e),r('<div class="n2_ruler__guide_handle"><i class="ssi_missing ssi_16 ssi_16--remove"></i></div>').on("mousedown",function(t){t.preventDefault(),t.stopPropagation(),this.delete()}.bind(this)).appendTo(this.guide),this.ruler.addGuide(this),s&&this.create(s)}function d(){e.prototype.constructor.apply(this,arguments)}function h(){e.prototype.constructor.apply(this,arguments)}return t.prototype.addGuide=function(t){this.guides.push(t)},t.prototype.removeGuide=function(t){this.guides.splice(this.guides.indexOf(t),1)},t.prototype.clearGuides=function(){for(var t=this.guides.length-1;0<=t;t--)this.guides[t].delete()},t.prototype.syncScroll=function(){this.horizontal[0].scrollLeft=this.$scrollArea[0].scrollLeft,this.vertical[0].scrollTop=this.$scrollArea[0].scrollTop},t.prototype.onResize=function(){for(var t=this.$scrollArea[0].scrollWidth,e=this.$scrollArea[0].scrollHeight,i=Math.round(Math.max(t+100,this.$scrollArea.width()-this.vertical.width()-30)/this.scale),s=this.horizontalMarks.length;s<i;s++){var n=r('<div class="n2_ruler_mark"></div>').appendTo(this.$horizontalInner);s%10==0?n.addClass("n2_ruler_mark--large").append('<div class="n2_ruler_mark__label">'+s/10*100+"</div>"):n.addClass("n2_ruler_mark--small")}for(s=i;s<this.horizontalMarks.length;s++)this.horizontalMarks.eq(s).remove();this.horizontalMarks=this.$horizontalInner.find(".n2_ruler_mark");for(var o=Math.round((e+100)/this.scale),s=this.verticalMarks.length;s<o;s++){n=r('<div class="n2_ruler_mark"></div>').appendTo(this.$verticalInner);s%10==0?n.addClass("n2_ruler_mark--large").append('<div class="n2_ruler_mark__label">'+s/10*100+"</div>"):n.addClass("n2_ruler_mark--small")}for(s=o;s<this.verticalMarks.length;s++)this.verticalMarks.eq(s).remove();this.verticalMarks=this.$verticalInner.find(".n2_ruler_mark")},t.prototype.toArray=function(){for(var t={horizontal:[],vertical:[]},e=0;e<this.guides.length;e++)this.guides[e]instanceof d?t.horizontal.push(this.guides[e].position):this.guides[e]instanceof h&&t.vertical.push(this.guides[e].position);return t},t.prototype.measureToolVertical=function(){var i,s=r('<div class="n2_ruler__guide n2_ruler__guide--measure"><div class="n2_ruler__guide_border"></div></div>').css("display","none").appendTo(this.vertical),t=!1,e=function(){t||(t=!0,s.css("display",""),N2Classes.PositionDisplay.get().show("Guide"))}.bind(this),n=function(){t&&(t=!1,s.css("display","none"),N2Classes.PositionDisplay.get().hide("Guide"))}.bind(this),o=function(t){i=t;var e=Math.max(t.pageY-this.$verticalInner[0].getBoundingClientRect().top,0);s.css("top",e),N2Classes.PositionDisplay.get().update(t,"Guide",e+"px")}.bind(this);this.vertical.on({mouseenter:function(t){this.showGuides&&(e(),this.vertical.on({"mousemove.n2-ruler-measure-tool":o,"scroll.n2-ruler-measure-tool":function(){o(i)}}))}.bind(this),mouseleave:function(){this.vertical.off(".n2-ruler-measure-tool"),n()}.bind(this)})},t.prototype.measureToolHorizontal=function(){var i,s=r('<div class="n2_ruler__guide n2_ruler__guide--measure"><div class="n2_ruler__guide_border"></div></div>').css("display","none").appendTo(this.horizontal),t=!1,e=function(){t||(t=!0,s.css("display",""),N2Classes.PositionDisplay.get().show("Guide"))}.bind(this),n=function(){t&&(t=!1,s.css("display","none"),N2Classes.PositionDisplay.get().hide("Guide"))}.bind(this),o=function(t){i=t;var e=Math.max(t.pageX-this.$horizontalInner[0].getBoundingClientRect().left,0);s.css("left",e),N2Classes.PositionDisplay.get().update(t,"Guide",e+"px")}.bind(this);this.horizontal.on({mouseenter:function(t){this.showGuides&&(e(),this.horizontal.on({"mousemove.n2-ruler-measure-tool":o,"scroll.n2-ruler-measure-tool":function(){o(i)}}))}.bind(this),mouseleave:function(){this.horizontal.off(".n2-ruler-measure-tool"),n()}.bind(this)})},e.prototype._position=function(t,e){return Math.max(0,t)},e.prototype.setPosition=function(t){this.position=t,this.positionRender(this.position)},e.prototype.delete=function(){this.ruler.removeGuide(this),this.guide.remove()},e.prototype.create=function(t){},((d.prototype=Object.create(e.prototype)).constructor=d).prototype.create=function(t){this.position=this._position(t.pageX-this.containerInner[0].getBoundingClientRect().left,t),this.positionRender(this.position)},d.prototype.rawPositionRender=function(t){this.guide.css("left",Math.max(0,t))},d.prototype.positionRender=function(t){this.guide.css("left",Math.max(0,t))},((h.prototype=Object.create(e.prototype)).constructor=h).prototype.create=function(t){this.position=this._position(t.pageY-this.containerInner[0].getBoundingClientRect().top,t),this.positionRender(this.position)},h.prototype.rawPositionRender=function(t){this.guide.css("top",Math.max(0,t))},h.prototype.positionRender=function(t){this.guide.css("top",Math.max(0,t))},t}),N2D("CanvasSettings",function(e,t){"use strict";function i(t){this.$button=e('<a class="n2_button_plain_icon n2_button_plain_icon--medium" href="#"><i class="ssi_24 ssi_24--more"></i></a>').on("click",this.onContextMenu.bind(this)).prependTo(".n2_add_layer__bar_bottom"),nextend.tooltip.addElement(this.$button,n2_("Editor settings"),10,-20),this.fragmentEditor=t,this.settings={},this.callbacks={},this.guideSubItems=[],this.snapTo(),this.roundTo(),this.startRuler()}return i.prototype.onContextMenu=function(t){t.preventDefault(),this.$button.addClass("n2_button_plain_icon--active");t=[];t.push({priority:30,label:n2_("Guide settings"),icon:"ssi_16 ssi_16--grid",items:this.guideSubItems}),t.push({priority:50,label:n2_("Keyboard shortcuts"),icon:"ssi_16 ssi_16--keyboard",action:function(){N2Classes.ModalHotkey.show()}}),N2Classes.ContextMenu(this.$button[0],t,{verticalAlign:"bottom",x:35,y:-30,onClose:function(){this.$button.removeClass("n2_button_plain_icon--active")}.bind(this)})},i.prototype._addSettings=function(t,e,i,s){this.settings[t]=parseInt(localStorage.getItem(t)||i),this.callbacks[t]=s,this.guideSubItems.push({type:"onoff",label:e,isOn:function(t){return this.settings[t]}.bind(this,t),action:function(t,e){this.set(t,e)}.bind(this,t)}),s(this.settings[t],!0)},i.prototype._addAction=function(t,e,i,s){this.guideSubItems.push({label:e,icon:i,action:s})},i.prototype.set=function(t,e){e=e?1:0,this.settings[t]=e,localStorage.setItem(t,e),this.callbacks[t].call(this,e,!1)},i.prototype.toggle=function(t){this.set(t,!this.settings[t])},i.prototype.get=function(t){return this.settings[t]},i.prototype.snapTo=function(){this._addSettings("n2-ss-snap-to-enabled",n2_("Smart snap"),1,function(t){})},i.prototype.roundTo=function(){this._addSettings("n2-ss-round-to-enabled",n2_("Round to 5px"),1,function(t){nextend.roundTo=1===t?5:1})},i.prototype.startRuler=function(){this.ruler=new N2Classes.Ruler(this.fragmentEditor.editor,e("#slideguides").val()),this._addSettings("n2-ss-ruler-enabled",n2_("Ruler"),1,function(t){e("body").toggleClass("n2_body--ruler",1===t)}.bind(this)),this._addAction("n2-ss-clear-guides",n2_("Clear guides"),"ssi_16 ssi_16--delete",function(){this.ruler.clearGuides()}.bind(this))},i}),N2D("UICanvasItem",["UIMouse"],function(i,t){"use strict";function e(t,e){this.element=t,this.widgetName=this.widgetName||"UICanvasItem",this.widgetEventPrefix="canvasItem",this.options=i.extend({canvasUIManager:null,layer:!1,$layer:null,distance:5},this.options,e),N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this.create()}return((e.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=e).prototype.create=function(){"function"==typeof this.options.$layer&&(this.options.$layer=this.options.$layer.call(this,this)),this._mouseInit()},e.prototype._mouseCapture=function(t,e){return this.options.canvasUIManager._mouseCapture(t,e)},e.prototype._mouseStart=function(t,e,i){t=this.options.canvasUIManager._mouseStart(t,this.options.$layer,this.options.layer);return this._trigger("start"),t},e.prototype._mouseDrag=function(t){return this.options.canvasUIManager._mouseDrag(t)},e.prototype._mouseStop=function(t,e){this._trigger("end");e=this.options.canvasUIManager._mouseStop(t,e);return N2Classes.WindowManager.actionPrevent("ComponentActivate"),e},e.prototype.destroy=function(){return this._mouseDestroy(),this},e}),N2D("UICanvas",["UIWidgetBase"],function(a,o){"use strict";function t(t,e){this.element=t,this.fragmentEditor=e,this.widgetName=this.widgetName||"UICanvas",a(this.element).data("UICanvas",this),this.widgetEventPrefix="canvas",this._scrollCallback=this._scroll.bind(this),N2Classes.UIWidgetBase.prototype.constructor.apply(this,arguments)}function s(t,e,i,s,n){this.uiCanvas=t,this.fragmentEditor=t.fragmentEditor,this.onKeyDownCallback=this.onKeyDown.bind(this),this.fragmentEditor.pointerManager.disable(),this.context={action:"move",placement:"default",placeholder:a('<div class="n2-ss-layer-placeholder"></div>'),scroll:this.uiCanvas.getScrollOffset(),scrollOffsetModifier:{left:0,top:0},mouse:{offset:{left:e.pageX,top:e.pageY}},$layer:i,layer:s};t={position:"absolute",right:"auto",bottom:"auto"};if(s?("absolute"===s.placement.getType()?(this.context.placement="absolute",this.context.relativeToGroup=s.group,this.context.$relativeToParent=i.parent()):(this.context.relativeToGroup=n,this.context.$relativeToParent=this.context.relativeToGroup.layer),i.addClass("n2_layer_drag__dragging"),this.context.layerOffset=i.offset(),this.context.originalIndex=s.getIndex(),"default"===this.context.placement&&(t.width=i.width()+1,this.context.$clone=a('<div class="n2-ss-layer-clone"></div>').height(i.outerHeight(!0)).insertAfter(i),i.appendTo(n.layer))):(this.context.action="create",this.context.placement=e.ctrlKey||e.metaKey?"absolute":this.fragmentEditor.addLayer.getPosition(),this.context.relativeToGroup=n,this.context.$relativeToParent=this.context.relativeToGroup.layer,this.context.layerOffset={left:0,top:0},i.appendTo("body")),this.context.canvas={offset:this.context.$relativeToParent.offset(),size:{width:this.context.$relativeToParent.outerWidth(),height:this.context.$relativeToParent.outerHeight()}},i.addClass("n2-ss-layer--drag").css(t),this.margins={left:parseInt(i.css("marginLeft"),10)||0,top:parseInt(i.css("marginTop"),10)||0},this.context.size={width:i.outerWidth(),height:i.outerHeight()},this.context.droppables=n.getDroppables(this.context.placement,s),"default"===this.context.placement)for(var o=0;o<this.context.droppables.length;o++)this.context.droppables[o].layer.layer.addClass("n2_layer_drag_target_groups");this._cacheContainers(),this.snapStart(),document.addEventListener("keydown",this.onKeyDownCallback,{capture:!0})}((t.prototype=Object.create(N2Classes.UIWidgetBase.prototype)).constructor=t).prototype.getScrollOffset=function(){return this.getScrollOffsetRecursive(this.element[0],{top:0,left:0})},t.prototype.getScrollOffsetRecursive=function(t,e){return null===t||t.scrollTop===o||t.scrollLeft===o?e:(e.top+=t.scrollTop,e.left+=t.scrollLeft,this.getScrollOffsetRecursive(t.parentNode,e))},t.prototype._scroll=function(){var t=this.getScrollOffset();this.interaction.setScrollOffset(t.top,t.left)},t.prototype._mouseCapture=function(t){return 0===a(t.target).closest(".nui_resize_absolute__handle, .nui_resize_normal__handle, .nui_spacing__handle").length},t.prototype._mouseStart=function(t,e,i){document.addEventListener("scroll",this._scrollCallback,{passive:!0,capture:!0}),a("body").addClass("n2_body--drag-layer"),this.interaction=new s(this,t,e,i,this.fragmentEditor.mainContainer),this.interaction.drag(t)},t.prototype._mouseDrag=function(t){this.interaction&&this.interaction.drag(t)},t.prototype._mouseStop=function(t){document.removeEventListener("scroll",this._scrollCallback,{passive:!0,capture:!0}),this.interaction&&this.interaction.stop(t),a("body").removeClass("n2_body--drag-layer"),delete this.interaction},t.prototype.cancel=function(){delete this.interaction},s.prototype.drag=function(t){var e={x:(this.lastEvent=t).pageX-this.context.scrollOffsetModifier.left,y:t.pageY-this.context.scrollOffsetModifier.top},i="create"===this.context.action?{top:t.pageY-this.context.canvas.offset.top-20,left:t.pageX-this.context.canvas.offset.left-20}:{top:this.context.layerOffset.top-this.context.canvas.offset.top+t.pageY-this.context.mouse.offset.top-this.context.scrollOffsetModifier.top-this.margins.top,left:this.context.layerOffset.left-this.context.canvas.offset.left+t.pageX-this.context.mouse.offset.left-this.context.scrollOffsetModifier.left-this.margins.left},s=this._findInnerContainer(e.x,e.y);!1===s&&"move"===this.context.action&&(s=this.context.droppables[0]),s&&"normal"===s.placement?(s.layers===o&&(s.layers=this._cacheContainerLayers(s)),0<(e=this._findNormalIndex(e,s))?(this.context.placeholder.css("order",s.layers[e-1].layer.layer.css("order")),this.context.placeholder.insertAfter(s.layers[e-1].layer.layer)):(this.context.placeholder.css("order",0),this.context.placeholder.prependTo(s.$container)),this.context.targetIndex=e):this.context.placeholder.detach(),this.context.targetContainer&&this.context.targetContainer!==s&&this.context.targetContainer.layer.layer.removeClass("n2_layer_drag_target_group"),(this.context.targetContainer=s)&&s.layer.layer.addClass("n2_layer_drag_target_group"),this.context.layer&&"absolute"===this.context.placement&&this.context.layer.placement.current.triggerLayerResized(),"create"===this.context.action&&(i.left+=this.context.canvas.offset.left,i.top+=this.context.canvas.offset.top),this.snapDrag(t,{left:i.left+this.context.canvas.offset.left,top:i.top+this.context.canvas.offset.top},i),i.left=Math.round(i.left),i.top=Math.round(i.top),this.context.$layer.css(i),this.displayPosition(t,i)},s.prototype.stop=function(t){var e=a.Deferred();this.ended(e);var i=this.context.targetIndex,s=this.context.targetContainer;if("create"===this.context.action)s?this.fragmentEditor.itemEditor.createWithDrag(t,e,this.context.placement,this.context.$layer,s,i):e.resolve(),this.context.$layer.detach();else if("move"===this.context.action){if(s===o&&(s=this.fragmentEditor.mainContainer.layer),"absolute"===this.context.placement){var n=parseInt(this.context.$layer.css("left")),t=parseInt(this.context.$layer.css("top"));this.context.$layer.css({position:"",right:"",bottom:""}),this.context.layer.placement.current.setPosition(n,t)}else if("default"===this.context.placement)switch(this.context.$layer.css({position:"relative",width:"",left:"",top:""}),s.layer.type){case"content":case"col":0<i?this.context.$layer.insertAfter(s.layers[i-1].layer.layer):this.context.$layer.prependTo(s.$container),this.context.layer.onCanvasUpdate(this.context.originalIndex,s.layer,i)}e.resolve()}this.context.layer&&this.context.layer.placement.current.triggerLayerResized()},s.prototype.ended=function(t){if(document.removeEventListener("keydown",this.onKeyDownCallback,{capture:!0}),this.context.placeholder.remove(),"default"===this.context.placement){for(var e=0;e<this.context.droppables.length;e++)this.context.droppables[e].layer.layer.removeClass("n2_layer_drag_target_groups");"move"===this.context.action&&this.context.$clone.remove()}this.context.targetContainer&&this.context.targetContainer.layer.layer.removeClass("n2_layer_drag_target_group"),this.context.$layer.removeClass("n2-ss-layer--drag"),this.context.$layer.removeClass("n2_layer_drag__dragging"),this.snapStop(),this.hidePosition(),t!==o?t.done(function(){this.fragmentEditor.pointerManager.enable()}.bind(this)):(this.fragmentEditor.pointerManager.enable(),this.uiCanvas.cancel())},s.prototype.refresh=function(){this.drag(this.lastEvent)},s.prototype.setScrollOffset=function(t,e){this.context.scrollOffsetModifier.top=this.context.scroll.top-t,this.context.scrollOffsetModifier.left=this.context.scroll.left-e,this.refresh()},s.prototype.displayPosition=function(t,e){this.context.targetContainer&&"absolute"===this.context.targetContainer.placement?(N2Classes.PositionDisplay.get().show("Canvas"),"create"===this.context.action&&(e.left-=this.context.canvas.offset.left,e.top-=this.context.canvas.offset.top),N2Classes.PositionDisplay.get().update(t,"Canvas","L: "+(parseInt(e.left)||0)+"px<br />T: "+(parseInt(e.top)||0)+"px")):this.hidePosition()},s.prototype.hidePosition=function(){N2Classes.PositionDisplay.get().hide("Canvas")},s.prototype._cacheContainers=function(){for(var t=0;t<this.context.droppables.length;t++){var e=this.context.droppables[t];e.offset=e.$container.offset(),e.size={width:e.$container.outerWidth(),height:e.$container.outerHeight()},e.offset.right=e.offset.left+e.size.width,e.offset.bottom=e.offset.top+e.size.height}},s.prototype._findInnerContainer=function(t,e){for(var i=this.context.droppables.length-1;0<=i;i--){var s=this.context.droppables[i];if(s.offset.left<=t&&s.offset.right>=t&&s.offset.top<=e&&s.offset.bottom>=e)return s}return!1},s.prototype._cacheContainerLayers=function(t){for(var e=[],i=t.layer.container.getSortedLayers(),s=0;s<i.length;s++){var n={layer:i[s]};n.offset=n.layer.layer.offset(),n.size={width:n.layer.layer.outerWidth(),height:n.layer.layer.outerHeight()},n.offset.right=n.offset.left+n.size.width/2,n.offset.bottom=n.offset.top+n.size.height/2,e.push(n)}return e},s.prototype._findNormalIndex=function(t,e){var i=-1;switch(e.axis){case"y":for(var s=0;s<e.layers.length;s++){var n=e.layers[s];if(t.y<=n.offset.bottom){i=s;break}}break;case"x":for(s=0;s<e.layers.length;s++){n=e.layers[s];if(t.x<=n.offset.right){i=s;break}}}return-1===i&&(i=e.layers.length),i},s.prototype.onKeyDown=function(t){27===t.keyCode&&(t.stopImmediatePropagation(),t.preventDefault(),"move"===this.context.action&&("absolute"===this.context.placement?this.context.layer.placement.updatePosition():"default"===this.context.placement&&this.context.$layer.css({position:"relative",width:"",left:"",top:""}).insertAfter(this.context.$clone)),this.ended())},s.prototype.snapStart=function(){var t,e;"move"===this.context.action&&"absolute"===this.context.placement&&(this.$gridHorizontal=a('<div class="n2_smartguide n2_smartguide--vertical"></div>').appendTo(this.context.$relativeToParent),this.$gridVertical=a('<div class="n2_smartguide n2_smartguide--horizontal"></div>').appendTo(this.context.$relativeToParent),this.elements=[],this.$snapLayers=a(),(e=this.fragmentEditor.getSnap(this.context.relativeToGroup,this.context.layer))&&e.length&&e.each(function(t,e){var i=a(e),s=i.offset();this.elements.push({item:e,width:i.outerWidth(),height:i.outerHeight(),top:Math.round(s.top),left:Math.round(s.left),backgroundColor:""}),i.hasClass("n2-ss-layer")&&(this.$snapLayers=this.$snapLayers.add(i))}.bind(this)),this.$snapLayers.addClass("n2_layer_drag_snap_to"),t=this.context.$relativeToParent.offset(),e=this.context.$relativeToParent[0].getBoundingClientRect(),this.elements.push({width:e.width,height:e.height,top:Math.round(t.top),left:Math.round(t.left),backgroundColor:"#ff4aff"}))};return s.prototype.snapDrag=function(t,e,i){if("move"===this.context.action&&"absolute"===this.context.placement){var s=!1,n=!1,o=5,a=5;if(this.$gridVertical.css({display:"none"}),this.$gridHorizontal.css({display:"none"}),this.context.targetContainer&&"absolute"===this.context.targetContainer.placement){var r=t.ctrlKey||t.metaKey,t=t.altKey;if(!r||!t){r?s=!0:t&&(n=!0);var l=e.left,d=l+this.context.size.width,h=e.top,p=h+this.context.size.height,c=(l+d)/2,u=(h+p)/2;if(!s)for(var f=this.elements.length-1;0<=f&&0!==o;f--){var m=this.elements[f].left,g=m+this.elements[f].width,y=(m+g)/2,v=!0;(_=Math.abs(m-d))<o?(i.left=m-this.context.size.width-this.context.canvas.offset.left,this.setSnapHorizontalLine(i.left+this.context.size.width)):(_=Math.abs(m-l))<o?(i.left=m-this.context.canvas.offset.left,this.setSnapHorizontalLine(i.left)):(_=Math.abs(g-l))<o?(i.left=g-this.context.canvas.offset.left,this.setSnapHorizontalLine(i.left)):(_=Math.abs(g-d))<o?(i.left=g-this.context.size.width-this.context.canvas.offset.left,this.setSnapHorizontalLine(i.left+this.context.size.width)):(_=Math.abs(y-d))<o?(i.left=y-this.context.size.width-this.context.canvas.offset.left,this.setSnapHorizontalLine(i.left+this.context.size.width)):(_=Math.abs(y-l))<o?(i.left=y-this.context.canvas.offset.left,this.setSnapHorizontalLine(i.left)):(_=Math.abs(y-c))<o?(i.left=y-this.context.size.width/2-this.context.canvas.offset.left,this.setSnapHorizontalLine(i.left+this.context.size.width/2)):v=!1,v&&(s=this.elements[f],o=Math.min(_,o))}if(!n)for(f=this.elements.length-1;0<=f&&0!==a;f--){var _,b=this.elements[f].top,C=b+this.elements[f].height,w=(b+C)/2,x=!0;(_=Math.abs(b-p))<a?(i.top=b-this.context.size.height-this.context.canvas.offset.top,this.setSnapVerticalLine(i.top+this.context.size.height)):(_=Math.abs(b-h))<a?(i.top=b-this.context.canvas.offset.top,this.setSnapVerticalLine(i.top)):(_=Math.abs(C-h))<a?(i.top=C-this.context.canvas.offset.top,this.setSnapVerticalLine(i.top)):(_=Math.abs(C-p))<a?(i.top=C-this.context.size.height-this.context.canvas.offset.top,this.setSnapVerticalLine(i.top+this.context.size.height)):(_=Math.abs(w-p))<a?(i.top=w-this.context.size.height-this.context.canvas.offset.top,this.setSnapVerticalLine(i.top+this.context.size.height)):(_=Math.abs(w-h))<a?(i.top=w-this.context.canvas.offset.top,this.setSnapVerticalLine(i.top)):(_=Math.abs(w-u))<a?(i.top=w-this.context.size.height/2-this.context.canvas.offset.top,this.setSnapVerticalLine(i.top+this.context.size.height/2)):x=!1,x&&(n=this.elements[f],a=Math.min(_,a))}s&&!0!==s&&this.$gridHorizontal.css("backgroundColor",s.backgroundColor),n&&!0!==n&&this.$gridVertical.css("backgroundColor",n.backgroundColor)}}}},s.prototype.setSnapHorizontalLine=function(t){this.$gridHorizontal.css({left:t,display:"block"})},s.prototype.setSnapVerticalLine=function(t){this.$gridVertical.css({top:t,display:"block"})},s.prototype.snapStop=function(){"move"===this.context.action&&"absolute"===this.context.placement&&(this.$snapLayers.removeClass("n2_layer_drag_snap_to"),this.$gridVertical.remove(),this.$gridHorizontal.remove())},t}),N2D("UIColumns",["UIMouse"],function(o,e){"use strict";function t(t,e,i){this.element=t,this.fragmentEditor=e,this.active=0,this.created=!1,this.invalidated=!1,this.isHandlesVisible=!1,this.widgetName=this.widgetName||"UIColumns",this.widgetEventPrefix="columns",this.options=o.extend({columns:"1",gutter:0,denominators:{1:100,2:100,3:144,4:100,5:100,6:144},drag:null,start:null,stop:null},this.options,i),N2Classes.UIMouse.prototype.constructor.apply(this,arguments)}return((t.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=t).prototype.showHandles=function(){this.isHandlesVisible=!0,this.handles&&this.handles.addClass("ui-column-width-handle--visible")},t.prototype.hideHandles=function(){this.isHandlesVisible=!1,this.handles&&this.handles.removeClass("ui-column-width-handle--visible")},t.prototype.create=function(){this.created||(this.created=!0,this._setupHandles(),o(window).on("resize",this._resize.bind(this)),this._mouseInit())},t.prototype.destroy=function(){return this._mouseDestroy(),this.element.removeData("uiNextendColumns").off(".columns").find("> .ui-column-width-handle").remove(),this},t.prototype.getDenominator=function(t){return this.options.denominators[t]===e&&(this.options.denominators[t]=15*t),this.options.denominators[t]},t.prototype._setupHandles=function(){var t,e=this.options;this.fractions=[];for(var i=e.columns.split("+"),s=0;s<i.length;s++)this.fractions.push(new Fraction(i[s]));this.currentDenominator=this.getDenominator(this.fractions.length);var n=0;for(s=0;s<this.fractions.length-1;s++)t=o("<div class='ui-column-width-handle'>"),n+=100*this.fractions[s].valueOf(),t.data("i",s).data("percent",n).appendTo(this.element).on("mousedown",this._mouseDown.bind(this));this.handles=this.element.find("> .ui-column-width-handle"),this.handles.toggleClass("ui-column-width-handle--visible",this.isHandlesVisible),this._resize()},t.prototype._resize=function(){if(this.active){this.paddingLeft=parseInt(this.element.css("paddingLeft")),this.paddingRight=parseInt(this.element.css("paddingRight"));var t=this.element.width();this.outerWidth=t+this.paddingLeft+this.paddingRight,this.innerWidth=t-this.handles.length*this.options.gutter;for(var e=0;e<this.handles.length;e++){var i=this.handles.eq(e).data("percent");this._updateResizer(e,i)}}else this.invalidated=!0},t.prototype._updateResizer=function(t,e){this.handles.eq(t).css({left:e+"%",marginLeft:-2+this.paddingLeft+(t+.5)*this.options.gutter+(this.innerWidth-this.outerWidth)*e/100})},t.prototype._removeHandles=function(){this.handles.remove()},t.prototype.setOption=function(t,e){switch(N2Classes.UIWidgetBase.prototype.setOption.apply(this,arguments),t){case"active":this.active=e,this.active&&(this.create(),this.invalidated&&this._resize());break;case"columns":this.created&&(this._removeHandles(),this._setupHandles());break;case"gutter":this._resize()}},t.prototype._mouseCapture=function(t){for(var e=!1,i=0;i<this.handles.length;i++)this.handles[i]===t.target&&(e=!0);return!this.options.disabled&&e},t.prototype._mouseStart=function(t){this.fragmentEditor.pointerManager.contextualBarHover.disable();var e=o(t.target).data("i"),i=this.element.offset().left+10,s=this.element.width()-20;this.resizeContext={index:e,cLeft:i,containerWidth:s,startX:Math.max(0,Math.min(t.clientX-i,s))},this.currentFractions=[],this.currentPercent=[];for(var n=0;n<this.fractions.length;n++)this.currentFractions.push(this.fractions[n].clone()),this.currentPercent.push(this.fractions[n].valueOf());return this.resizing=!0,o("body").css("cursor","ew-resize"),this.element.addClass("ui-column-width-resizing"),this._trigger("start",t,this.ui()),!0},t.prototype._mouseDrag=function(t){var e=Math.max(0,Math.min(t.clientX-this.resizeContext.cLeft,this.resizeContext.containerWidth)),e=new Fraction(Math.round((e-this.resizeContext.startX)/(this.resizeContext.containerWidth/this.currentDenominator)),this.currentDenominator);e.compare(this.fractions[this.resizeContext.index].clone().mul(-1))<0&&(e=this.fractions[this.resizeContext.index].clone().mul(-1)),0<e.compare(this.fractions[this.resizeContext.index+1])&&(e=this.fractions[this.resizeContext.index+1].clone()),this.currentFractions[this.resizeContext.index]=this.fractions[this.resizeContext.index].add(e),this.currentFractions[this.resizeContext.index+1]=this.fractions[this.resizeContext.index+1].sub(e);var i=0;this.currentPercent=[];for(var s=0;s<this.currentFractions.length;s++){var n=this.currentFractions[s].valueOf();this.currentPercent.push(n),i+=100*n,this._updateResizer(s,i)}this._trigger("colwidth",t,this.ui()),this._triggerInteraction()},t.prototype._mouseStop=function(t){return this.resizing=!1,o("body").css("cursor","auto"),this._trigger("stop",t,this.ui()),this.fractions=this.currentFractions,this._triggerInteraction(),this.fragmentEditor.pointerManager.contextualBarHover.enable(),N2Classes.WindowManager.actionPrevent("ComponentActivate"),!1},t.prototype.ui=function(){return{element:this.element,originalFractions:this.fractions,currentFractions:this.currentFractions,currentPercent:this.currentPercent,index:this.resizeContext.index}},t}),N2D("UILayerListItem",["UIMouse"],function(i,t){"use strict";function e(t,e){this.element=t,this.widgetName=this.widgetName||"UILayerListItem",this.widgetEventPrefix="layerListItem",this.options=i.extend({UIManager:null,layer:!1,$layer:null,distance:2},this.options,e),N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this.create()}return((e.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=e).prototype.create=function(){this._mouseInit()},e.prototype._mouseCapture=function(t,e){return this.options.UIManager._mouseCapture(this.options,t,e)},e.prototype._mouseStart=function(t,e,i){return this._trigger("start"),this.options.UIManager._mouseStart(this.options,t,e,i)},e.prototype._mouseDrag=function(t){return this.options.UIManager._mouseDrag(this.options,t)},e.prototype._mouseStop=function(t,e){return this.options.UIManager._mouseStop(this.options,t,e)},e.prototype.destroy=function(){return this._mouseDestroy(),this},e}),N2D("UILayerList",["UIWidgetBase"],function(n,o){"use strict";function t(t,e){this.element=t,this.widgetName=this.widgetName||"UILayerList",this.widgetEventPrefix="layerList",this.options=n.extend({mainContainer:null,$scrolled:null},this.options,e),this.interaction=!1,this.onKeyDownCallback=this.onKeyDown.bind(this),N2Classes.UIWidgetBase.prototype.constructor.apply(this,arguments),this.create()}return((t.prototype=Object.create(N2Classes.UIWidgetBase.prototype)).constructor=t).prototype.create=function(){this.scrollTimeout=null},t.prototype._mouseCapture=function(t,e,i){return t.$item[0]!==this.options.mainContainer.layerRow[0]},t.prototype._mouseStart=function(t,e,i,s){this.interaction=!0,this.scrolledTop=this.options.$scrolled.offset().top,this.scrolledHeight=this.options.$scrolled.height(),this.scrolledScroll=this.options.$scrolled.scrollTop(),this.scrolledMaxHeight=this.options.$scrolled[0].scrollHeight-this.scrolledHeight,this.context={placeholder:n('<div class="n2_layer_navigation_list_layers__sortable_placeholder"></div>'),mouse:{y:e.pageY,topModifier:t.$item.offset().top-e.pageY},$item:t.$item,$clone:t.$item.clone()},this.context.$clone.addClass("n2_layer_navigation_list_layer--sorted").appendTo(this.options.$scrolled),this.context.droppables=this.options.mainContainer.getLLDroppables(t.layer),this._cacheContainers(),document.addEventListener("keydown",this.onKeyDownCallback,{capture:!0}),this._trigger("start",e),this._mouseDrag(t,e)},t.prototype._scrollUp=function(){0<this.scrolledTop&&null===this.scrollTimeout&&(this.scrollTimeout=setInterval(function(){this.scrolledScroll-=33,this.options.$scrolled.scrollTop(this.scrolledScroll)}.bind(this),150),this.scrolledScroll-=33,this.options.$scrolled.scrollTop(this.scrolledScroll))},t.prototype._scrollDown=function(){null===this.scrollTimeout&&(this.scrollTimeout=setInterval(function(){this.scrolledScroll+=33,this.options.$scrolled.scrollTop(Math.min(this.scrolledScroll,this.scrolledMaxHeight))}.bind(this),150),this.scrolledScroll+=33,this.options.$scrolled.scrollTop(Math.min(this.scrolledScroll,this.scrolledMaxHeight)))},t.prototype._mouseDrag=function(t,e){var i,s;this.interaction&&(this.scrolledTop=this.options.$scrolled.offset().top,140<this.scrolledHeight&&(e.pageY<this.scrolledTop+33+48?this._scrollUp():e.pageY>this.scrolledTop+this.scrolledHeight-33?this._scrollDown():(clearInterval(this.scrollTimeout),this.scrollTimeout=null)),this.scrolledScroll=this.options.$scrolled.scrollTop(),i=e.pageY-this.scrolledTop+this.scrolledScroll,!1===(s=this._findInnerContainer(i))&&(s=this.context.droppables[0]),s.layers===o&&(s.layers=this._cacheContainerLayers(s)),0<(e=this._findNormalIndex(i,s))?this.context.placeholder.insertAfter(s.layers[e-1].layer.layerRow):this.context.placeholder.prependTo(s.$container),this.context.targetIndex=e,this.context.targetContainer&&this.context.targetContainer!==s&&this.context.targetContainer.layer.layerRow.removeClass("n2_layer_navigation_list_layer--drop"),this.context.targetContainer=s,this.context.targetContainer.layer.layerRow.addClass("n2_layer_navigation_list_layer--drop"),this.context.$clone.css({top:i+this.context.mouse.topModifier}))},t.prototype._mouseStop=function(t,e,i){var s,n,o,a,r;this.interaction&&(this.ended(!0),s=this.context.targetIndex,n=this.context.targetContainer,o=-1,0===this.context.targetContainer.layers.length?o=0:(a=r=!1,this.context.targetContainer.layers[s]&&(r=this.context.targetContainer.layers[s].layer),this.context.targetContainer.layers[s-1]&&(a=this.context.targetContainer.layers[s-1].layer),r===t.layer||a===t.layer?o=-1:"slide"===n.layer.type?r?o=r.getIndex()+1:a&&(o=a.getIndex()):a?o=a.getIndex()+1:r&&(o=r.getIndex())),0<=o&&(r=t.layer.getIndex(),n.layer===t.layer.group&&r<o&&o--,"col"===t.layer.type?n.layer.moveCol(r,o):(n.layer.container.insertLayerAt(t.layer,o),t.layer.onCanvasUpdate(r,n.layer,o))),delete this.context,this._trigger("stop",e)),N2Classes.WindowManager.actionPrevent("ComponentRowActivate"),this.interaction=!1},t.prototype.cancel=function(){this.interaction=!1,delete this.context},t.prototype.ended=function(t){document.removeEventListener("keydown",this.onKeyDownCallback,{capture:!0}),null!==this.scrollTimeout&&(clearInterval(this.scrollTimeout),this.scrollTimeout=null),this.context.placeholder.remove(),this.context.$clone.remove(),this.context.targetContainer.layer.layerRow.removeClass("n2_layer_navigation_list_layer--drop"),t||this.cancel()},t.prototype.onKeyDown=function(t){27===t.keyCode&&(t.stopImmediatePropagation(),t.preventDefault(),this.ended())},t.prototype._cacheContainers=function(){for(var t=0;t<this.context.droppables.length;t++){var e=this.context.droppables[t];e.top=e.$container.offset().top-this.scrolledTop+this.scrolledScroll-15,e.height=e.$container.outerHeight(),e.bottom=e.top+e.height+15}},t.prototype._findInnerContainer=function(t){for(var e=this.context.droppables.length-1;0<=e;e--){var i=this.context.droppables[e];if(i.top<=t&&i.bottom>=t)return i}return!1},t.prototype._cacheContainerLayers=function(t){for(var e=[],i=t.layer.container.getSortedLayers(),s=0;s<i.length;s++){var n={layer:i[s]};n.top=n.layer.layerRow.offset().top-this.scrolledTop+this.scrolledScroll,n.height=n.layer.layerRow.outerHeight(),n.bottom=n.top+n.height/2,n.index=s,e.push(n)}return"slide"===t.layer.type&&e.reverse(),e},t.prototype._findNormalIndex=function(t,e){for(var i=0;i<e.layers.length;i++)if(t<=e.layers[i].bottom)return i;return e.layers.length},t}),N2D("UIDragTooltip",function(t,e){"use strict";function i(t){this.name=t,this.isShown=!1,this.isShownForHover=!1,this.isShownForDrag=!1,this.e=null,this.hoverTipCallback=null,this.tip=N2Classes.PositionDisplay.get()}return i.prototype.hoverShow=function(t,e){this.e=t,this.hoverTipCallback=e,this.isShownForHover=!0,this.show()},i.prototype.hoverUpdatePosition=function(t){this.isShownForHover&&!this.isShownForDrag&&(this.e=t,this.tip.update(this.e,this.name))},i.prototype.hoverHide=function(){this.isShownForHover=!1,this.hide()},i.prototype.dragShow=function(){this.isShownForDrag=!0,this.show()},i.prototype.dragUpdate=function(t,e){this.e=t,this.tip.update(t,this.name,e)},i.prototype.dragHide=function(){this.isShownForDrag=!1,this.hide(),this.isShownForHover&&this.tip.update(this.e,this.name,this.hoverTipCallback.call())},i.prototype.show=function(){this.isShown||(this.tip.show(this.name),this.isShownForDrag||this.tip.update(this.e,this.name,this.hoverTipCallback.call()),this.isShown=!0)},i.prototype.hide=function(){!this.isShown||this.isShownForHover||this.isShownForDrag||(this.tip.hide(this.name),this.isShown=!1)},i}),N2D("UIResizeAbsolute",["UIMouse"],function(w,t){"use strict";function e(t,e,i){this.element=t,this.fragmentEditor=e,this.widgetName=this.widgetName||"UIResizeAbsolute",w(this.element).data("UIResizeAbsolute",this),this.widgetEventPrefix="resize",this.options=w.extend({alsoResize:!1,containment:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,resize:null,start:null,stop:null},this.options,i),N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this.create()}return((e.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=e).plugins={},e.prototype._num=function(t){return parseFloat(t)||0},e.prototype._isNumber=function(t){return!isNaN(parseFloat(t))},e.prototype.create=function(){this.element.addClass("nui_resize_absolute"),this._setupHandles(),this._mouseInit(),this._trigger("create",null,{})},e.prototype._setupHandles=function(){this.options;var t,e,i,s=["n","e","s","w","se","sw","ne","nw"],n=this;this.$handles=w(),this.handles={};for(var o=0;o<s.length;o++)e="nui_resize_absolute__handle--"+(t=s[o]),i=w("<div>").addClass("nui_resize_absolute__handle "+e).attr("data-handle",t).on("mousedown",this._mouseDown.bind(this)),this.handles[t]=i,this.$handles=this.$handles.add(i),this.element.append(i);this.$handles.on("mouseover",function(){n.resizing||(this.className&&(i=this.className.match(/nui_resize_absolute__handle--(se|sw|ne|nw|n|e|s|w)/i)),n.axis=i&&i[1]?i[1]:"se")})},e.prototype._mouseCapture=function(t){var e,i,s=!1;for(e in this.handles)(i=this.handles[e][0])!==t.target&&!w.contains(i,t.target)||(s=!0);return!this.options.disabled&&s},e.prototype._removeHandles=function(){this.$handles.remove()},e.prototype._mouseStart=function(t){w("body").addClass("n2_body--resize-absolute").css("cursor",this.axis+"-resize").addClass("n2_body--inherit-cursor"),this.element.addClass("nui_resize_absolute--resizing"),this.fragmentEditor.pointerManager.disable();var e=this.element.position();this.element.css({left:e.left,top:e.top,right:"auto",bottom:"auto"});var i,s=this.options,n=this.element;return this.resizing=!0,this.helper=this.element,i=this._num(this.helper.css("left")),e=this._num(this.helper.css("top")),s.containment&&(i+=w(s.containment).scrollLeft()||0,e+=w(s.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:e},this.size={width:n.width(),height:n.height()},this.originalSize={width:n.width(),height:n.height()},this.sizeDiff={width:n.outerWidth()-n.width(),height:n.outerHeight()-n.height()},this.originalPosition={left:i,top:e},this.originalMousePosition={left:t.pageX,top:t.pageY},e=this.handles[this.axis].css("cursor"),w("body").css("cursor","auto"===e?this.axis+"-resize":e),this._propagate("start",t),!0},e.prototype._mouseDrag=function(t){var e=this.originalMousePosition,i=this.axis,s=t.pageX-e.left||0,e=t.pageY-e.top||0,i=this._change[i];return this._updatePrevProperties(),i&&(e=i.apply(this,[t,s,e]),this._updateVirtualBoundaries(),e=this._respectSize(e,t),this._updateCache(e),this._propagate("resize",t),e=this._applyChanges(),w.isEmptyObject(e)||(this._updatePrevProperties(),this._trigger("resize",t,this.ui()),this._applyChanges())),!1},e.prototype._mouseStop=function(t){return this.resizing=!1,this._propagate("stop",t),this.fragmentEditor.pointerManager.enable(),this.element.removeClass("nui_resize_absolute--resizing"),w("body").removeClass("n2_body--resize-absolute").css("cursor","").removeClass("n2_body--inherit-cursor"),N2Classes.WindowManager.actionPrevent("ComponentActivate"),!1},e.prototype._updatePrevProperties=function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},e.prototype._applyChanges=function(){var t={};return this.position.top!==this.prevPosition.top&&(t.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(t.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(t.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(t.height=this.size.height+"px"),this.helper.css(t),t},e.prototype._updateVirtualBoundaries=function(){var t=this.options,t={minWidth:this._isNumber(t.minWidth)?t.minWidth:0,maxWidth:this._isNumber(t.maxWidth)?t.maxWidth:1/0,minHeight:this._isNumber(t.minHeight)?t.minHeight:0,maxHeight:this._isNumber(t.maxHeight)?t.maxHeight:1/0};this._vBoundaries=t},e.prototype._updateCache=function(t){this.offset=this.helper.offset(),this._isNumber(t.left)&&(this.position.left=t.left),this._isNumber(t.top)&&(this.position.top=t.top),this._isNumber(t.height)&&(this.size.height=t.height),this._isNumber(t.width)&&(this.size.width=t.width)},e.prototype._respectSize=function(t){var e=this._vBoundaries,i=this.axis,s=this._isNumber(t.width)&&e.maxWidth&&e.maxWidth<t.width,n=this._isNumber(t.height)&&e.maxHeight&&e.maxHeight<t.height,o=this._isNumber(t.width)&&e.minWidth&&e.minWidth>t.width,a=this._isNumber(t.height)&&e.minHeight&&e.minHeight>t.height,r=this.originalPosition.left+this.originalSize.width,l=this.originalPosition.top+this.originalSize.height,d=/sw|nw|w/.test(i),i=/nw|ne|n/.test(i);return o&&(t.width=e.minWidth),a&&(t.height=e.minHeight),s&&(t.width=e.maxWidth),n&&(t.height=e.maxHeight),o&&d&&(t.left=r-e.minWidth),s&&d&&(t.left=r-e.maxWidth),a&&i&&(t.top=l-e.minHeight),n&&i&&(t.top=l-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},e.prototype._change={e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var i=this.originalSize;return{left:this.originalPosition.left+e,width:i.width-e}},n:function(t,e,i){var s=this.originalSize;return{top:this.originalPosition.top+i,height:s.height-i}},s:function(t,e,i){return{height:this.originalSize.height+i}},se:function(t,e,i){return w.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,e,i]))},sw:function(t,e,i){return w.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,e,i]))},ne:function(t,e,i){return w.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,e,i]))},nw:function(t,e,i){return w.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,e,i]))}},e.prototype._propagate=function(t,e){this.callPlugin(t,[e,this.ui()]),"resize"!==t&&this._trigger(t,e,this.ui())},e.prototype.ui=function(){return{element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition,axis:this.axis}},e.prototype.destroy=function(){for(var t in this._mouseDestroy(),this.element.removeClass("nui_resize_absolute").removeData(this.widgetName),this.handles)this.handles[t].remove();return this},N2Classes.UIWidgetBase.addPlugin(e,"smartguides",{start:function(t,e){var i,s,n=w(this).data("UIResizeAbsolute"),o=n.options;n.gridH=w('<div class="n2_smartguide n2_smartguide--horizontal"></div>').appendTo(o._containment),n.gridV=w('<div class="n2_smartguide n2_smartguide--vertical"></div>').appendTo(o._containment),n.gridH2=w('<div class="n2_smartguide n2_smartguide--horizontal"></div>').appendTo(o._containment),n.gridV2=w('<div class="n2_smartguide n2_smartguide--vertical"></div>').appendTo(o._containment),n.elements=[],n.$snapLayers=w(),"function"!=typeof o.smartguides||(s=o.smartguides())&&(i=o._containment.offset(),s.each(function(){var t=w(this),e=t.offset();this!==n.element[0]&&(n.elements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:Math.round(e.top-i.top),left:Math.round(e.left-i.left)}),t.hasClass("n2-ss-layer")&&(n.$snapLayers=n.$snapLayers.add(t)))}),n.$snapLayers.addClass("n2_layer_resize_snap_to"),s=o._containment[0].getBoundingClientRect(),n.elements.push({item:o._containment,width:s.width,height:s.height,top:0,left:0}))},stop:function(t,e){var i=w(this).data("UIResizeAbsolute");i.$snapLayers.removeClass("n2_layer_resize_snap_to"),i.gridH.remove(),i.gridV.remove(),i.gridH2.remove(),i.gridV2.remove()},resize:function(t,e){var i=w(this).data("UIResizeAbsolute"),s=i.options.tolerance;i.gridV.css({display:"none"}),i.gridH.css({display:"none"}),i.gridV2.css({display:"none"}),i.gridH2.css({display:"none"});var n=i.elements[i.elements.length-1];function o(t){i.gridV.css({left:Math.min(t,n.width-1),display:"block"})}function a(t){i.gridV2.css({left:Math.min(t,n.width-1),display:"block"})}function r(t){i.gridH.css({top:Math.min(t,n.height-1),display:"block"})}function l(t){i.gridH2.css({top:Math.min(t,n.height-1),display:"block"})}var d=t.ctrlKey||t.metaKey,h=t.altKey;if(!d||!h){for(var p=e.position.left,c=p+e.size.width,u=e.position.top,f=u+e.size.height,m=i.elements.length-1;0<=m;m--){var g,y,v=i.elements[m].left,_=v+i.elements[m].width,b=i.elements[m].top,C=b+i.elements[m].height;d||(g=(v+_)/2,Math.abs(v-c)<=s?(e.size.width=v-e.position.left,o(e.position.left+e.size.width)):Math.abs(v-p)<=s?(y=e.position.left-v,e.position.left=v,e.size.width+=y,o(e.position.left)):Math.abs(g-p)<=s&&(y=e.position.left-g,e.position.left=g,e.size.width+=y,o(e.position.left)),Math.abs(_-p)<=s?(y=e.position.left-_,e.position.left=_,e.size.width+=y,a(e.position.left)):Math.abs(_-c)<=s?(e.size.width=_-e.position.left,a(e.position.left+e.size.width)):Math.abs(g-c)<=s&&(e.size.width=g-e.position.left,a(e.position.left+e.size.width))),h||(g=(b+C)/2,Math.abs(b-f)<=s?(e.size.height=b-e.position.top,r(b)):Math.abs(b-u)<=s?(y=e.position.top-b,e.position.top=b,e.size.height+=y,r(e.position.top)):Math.abs(g-u)<=s&&(y=e.position.top-g,e.position.top=g,e.size.height+=y,r(e.position.top)),Math.abs(C-u)<=s?(y=e.position.top-C,e.position.top=C,e.size.height+=y,l(e.position.top)):Math.abs(C-f)<=s?(e.size.height=C-e.position.top,l(e.position.top+e.size.height)):Math.abs(g-f)<=s&&(e.size.height=g-e.position.top,l(e.position.top+e.size.height)))}e.size.width=Math.round(e.size.width),e.size.height=Math.round(e.size.height)}}}),e}),N2D("UIResizeNormal",["UIMouse","UIDragTooltip"],function(o,t){"use strict";var s=new N2Classes.UIDragTooltip("NormalSizing");function e(t,e,i){this.element=t,this.fragmentEditor=e,this.widgetName=this.widgetName||"UIResizeNormal",this.widgetEventPrefix="normalsizing",this.multiplier=1,this.options=o.extend({maxWidth:!0,height:!1,syncWidth:!1,start:null,resizeMaxWidth:null,resizeHeight:null,stopMaxWidth:null,stopHeight:null},this.options,i),N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this.create()}return((e.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=e).prototype.setMaxWidth=function(t){this.handles.e.toggleClass("nui_resize_normal__handle--none",t<0),this.handles.w.toggleClass("nui_resize_normal__handle--none",t<0)},e.prototype.create=function(){this._setupHandles(),this._mouseInit()},e.prototype.destroy=function(){for(var t in this._mouseDestroy(),this.element.removeData(this.widgetName),this.handles)this.handles[t].remove();return this},e.prototype._setupHandles=function(){var t,e=this.options,i=[];for(e.maxWidth&&(i.push("w"),i.push("e")),e.height&&i.push("s"),this.handles={},this.$handles=o(),t=0;t<i.length;t++){var s=i[t],n=o('<div class="nui_resize_normal__handle nui_resize_normal__handle--'+s+'">').on("mouseenter",this.onMouseEnter.bind(this,s));this.handles[s]=n,this.$handles=this.$handles.add(n),this.element.append(n)}},e.prototype.onMouseEnter=function(e,t){var i=t;this.timeout=setTimeout(function(){delete this.timeout,s.hoverShow(i,function(){if("e"===e||"w"===e){var t=this.element.css("maxWidth");return"Max width: "+("px"===t.substr(-2)?t:"none")}if("s"===e)return"Height: "+this.element.height()+"px"}.bind(this))}.bind(this),500),this.handles[e].on({"mousemove.tooltip":function(t){i=t,s.hoverUpdatePosition(t)},"mouseleave.tooltip":function(){this.timeout&&(clearTimeout(this.timeout),delete this.timeout),this.handles[e].off(".tooltip"),s.hoverHide()}.bind(this)})},e.prototype._removeHandles=function(){this.$handles.remove()},e.prototype._mouseCapture=function(t){for(var e in this.handles)if(this.handles[e][0]===t.target)return this.currentHandle=e,!this.options.disabled;return!1},e.prototype._mouseStart=function(t){switch(this.fragmentEditor.pointerManager.contextualBarHover.disable(),s.dragShow(),this.originalMousePosition={left:t.pageX,top:t.pageY},this.currentHandle){case"w":case"e":this.originalValue=this.element.width(),this.maxWidth=this.element.parent().width(),this._trigger("start",t,"maxwidth"),"center"===this.element.css("align-self")?this.multiplier=2:this.multiplier=1,o("body").css("cursor",this.currentHandle+"-resize").addClass("n2_body--inherit-cursor");break;case"s":this.originalValue=this.element.height(),this._trigger("start",t,"height"),o("body").css("cursor","s-resize").addClass("n2_body--inherit-cursor")}return!0},e.prototype._parse_movement_s=function(t){return t.pageY-this.originalMousePosition.top},e.prototype._parse_movement_e=function(t){return(t.pageX-this.originalMousePosition.left)*this.multiplier},e.prototype._parse_movement_w=function(t){return(this.originalMousePosition.left-t.pageX)*this.multiplier},e.prototype._mouseDrag=function(t){var e=this.options;switch(this.currentValue=nextend.roundHelper(this.originalValue+this["_parse_movement_"+this.currentHandle].call(this,t)),this.currentHandle){case"w":case"e":this.currentValue<=this.maxWidth?(this.element.css("maxWidth",this.currentValue+"px"),e.syncWidth&&this.element.css("width",this.currentValue+"px"),this.setMaxWidth(this.currentValue)):(this.element.css("maxWidth","none"),e.syncWidth&&this.element.css("width",""),this.currentValue=0,this.setMaxWidth(-1)),s.dragUpdate(t,"Max width: "+(0===this.currentValue?"none":this.currentValue+"px"));break;case"s":this.currentValue=Math.max(1,this.currentValue),this.element.height(this.currentValue),s.dragUpdate(t,"Height: "+this.currentValue+"px")}this._triggerInteraction()},e.prototype._mouseStop=function(t){var e=this.options;switch(this.currentValue=nextend.roundHelper(this.originalValue+this["_parse_movement_"+this.currentHandle].call(this,t)),s.dragHide(),this.currentHandle){case"w":case"e":this.currentValue<=this.maxWidth?(this.element.css("maxWidth",this.currentValue+"px"),e.syncWidth&&this.element.css("width",""),this.setMaxWidth(this.currentValue)):(this.element.css("maxWidth","none"),e.syncWidth&&this.element.css("width",""),this.currentValue=0,this.setMaxWidth(-1)),this._trigger("stopMaxWidth",t,{value:this.currentValue});break;case"s":this.currentValue=Math.max(1,this.currentValue),this.element.height(this.currentValue),this._trigger("stopHeight",t,{value:this.currentValue})}return o("body").css("cursor","").removeClass("n2_body--inherit-cursor"),this._triggerInteraction(),this.fragmentEditor.pointerManager.contextualBarHover.enable(),N2Classes.WindowManager.actionPrevent("ComponentActivate"),!1},e}),N2D("UISpacingMargin",["UISpacing"],function(s,t){"use strict";function e(t,e,i){this.options=s.extend({mode:"margin",label:"Margin",sync:{n:"margin-top",e:"margin-right",s:"margin-bottom",w:"margin-left"}},i),N2Classes.UISpacing.prototype.constructor.call(this,t,e)}return(e.prototype=Object.create(N2Classes.UISpacing.prototype)).constructor=e}),N2D("UISpacingPadding",["UISpacing"],function(s,t){"use strict";function e(t,e,i){this.options=s.extend({mode:"padding",label:"Padding",sync:{n:"padding-top",e:"padding-right",s:"padding-bottom",w:"padding-left"}},i),N2Classes.UISpacing.prototype.constructor.call(this,t,e)}return((e.prototype=Object.create(N2Classes.UISpacing.prototype)).constructor=e).prototype.limitValue=function(t){return Math.max(0,t)},e}),N2D("UISpacing",["UIMouse","UIDragTooltip"],function(n,t){"use strict";var s=new N2Classes.UIDragTooltip("Spacing");function e(t,e){this.element=t,this.fragmentEditor=e,this.widgetName=this.widgetName||"UISpacing",this.widgetEventPrefix="spacing",this.options=n.extend({syncInv:{n:"s",e:"w",s:"n",w:"e"},side:{n:"top",e:"right",s:"bottom",w:"left"},size:{n:"height",e:"width",s:"height",w:"width"},drag:null,start:null,stop:null},this.options),N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this.create()}return((e.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=e).prototype.create=function(){this._setupHandles(),this._mouseInit()},e.prototype.destroy=function(){for(var t in this._mouseDestroy(),this.element.removeData(this.widgetName),this.handles)this.handles[t].remove();return this},e.prototype._setupHandles=function(){var t=["n","e","s","w"];this.handles={},this.$handles=n();for(var e=0;e<t.length;e++){var i=t[e],s=n("<div>").addClass("nui_spacing__handle nui_spacing__handle--"+this.options.mode+" nui_spacing__handle--"+i).on("mouseenter",this.onMouseEnter.bind(this,i)).on("mousedown",this._mouseDown.bind(this)).appendTo(this.element);this.handles[i]=s,this.$handles=this.$handles.add(s)}},e.prototype.onMouseEnter=function(t,e){var i=e;this.timeout=setTimeout(function(){delete this.timeout,s.hoverShow(i,function(){return this.options.label+" "+this.options.side[t]+": "+this.element.css(this.options.sync[t])}.bind(this))}.bind(this),500),this.handles[t].on({"mousemove.tooltip":function(t){i=t,s.hoverUpdatePosition(t)},"mouseleave.tooltip":function(){this.timeout&&(clearTimeout(this.timeout),delete this.timeout),this.handles[t].off(".tooltip"),s.hoverHide()}.bind(this)})},e.prototype._removeHandles=function(){this.$handles.remove()},e.prototype._parse_movement_n=function(t){return t.pageY-this.originalMousePosition.top},e.prototype._parse_movement_w=function(t){return t.pageX-this.originalMousePosition.left},e.prototype._parse_movement_s=function(t){return t.pageY-this.originalMousePosition.top},e.prototype._parse_movement_e=function(t){return this.originalMousePosition.left-t.pageX},e.prototype._mouseCapture=function(t){var e,i,s=!1;for(i in this.handles)((e=this.handles[i][0])===t.target||n.contains(e,t.target))&&n(e).hasClass("nui-enabled")&&(s=!0);return!this.options.disabled&&s},e.prototype.updatePositionDisplay=function(t){var e=this.options.label+" "+this.options.side[this.direction]+": "+this.currentValue+"px<br>";this.wasShiftPressed&&(e+=this.options.label+" "+this.options.side[this.options.syncInv[this.direction]]+": "+this.currentValue+"px<br>"),s.dragUpdate(t,e)},e.prototype._mouseStart=function(t){var e,i;for(i in this.fragmentEditor.pointerManager.contextualBarActive.enableActiveForced(),this.fragmentEditor.pointerManager.contextualBarHover.disable(),s.dragShow(),this.wasShiftPressed=!1,this.handles)if((e=this.handles[i][0])===t.target||n.contains(e,t.target)){this.direction=i;break}return this.syncProperty=this.options.sync[this.direction],this.originalValue=parseInt(this.element.css(this.syncProperty)),this.invSyncProperty=this.options.sync[this.options.syncInv[this.direction]],this.invOriginalValue=parseInt(this.element.css(this.invSyncProperty)),this.resizing=!0,this.originalMousePosition={left:t.pageX,top:t.pageY},this.currentValue=this.originalValue,this.handles[this.direction].addClass("nui_spacing__handle--spacing"),n("body").css("cursor",this.direction+"-resize").addClass("n2_body--inherit-cursor"),n("body").on("keydown."+this.widgetEventPrefix,this._keyDown.bind(this)).on("keyup."+this.widgetEventPrefix,this._keyUp.bind(this)),this._trigger("start",t,this.ui()),!0},e.prototype._keyDown=function(t){t.shiftKey&&!this.wasShiftPressed&&(this.wasShiftPressed=!0,this.element.css(this.invSyncProperty,this.currentValue),this.setSize(this.options.syncInv[this.direction],this.currentValue),this._trigger("spacing",t,this.ui()),this.updatePositionDisplay(t),this._triggerInteraction())},e.prototype._keyUp=function(t){!t.shiftKey&&this.wasShiftPressed&&(this.wasShiftPressed=!1,this.element.css(this.invSyncProperty,this.invOriginalValue),this.setSize(this.options.syncInv[this.direction],this.invOriginalValue),this._trigger("spacing",t,this.ui()),this.updatePositionDisplay(t),this._triggerInteraction())},e.prototype._mouseDrag=function(t){this.movement=this["_parse_movement_"+this.direction].call(this,t),this.currentValue=this.limitValue(nextend.roundHelper(this.originalValue+this.movement)),this.element.css(this.syncProperty,this.currentValue),this.setSize(this.direction,this.currentValue),t.shiftKey?(this.wasShiftPressed=!0,this.element.css(this.invSyncProperty,this.currentValue),this.setSize(this.options.syncInv[this.direction],this.currentValue)):this.wasShiftPressed&&(this.wasShiftPressed=!1,this.element.css(this.invSyncProperty,this.invOriginalValue),this.setSize(this.options.syncInv[this.direction],this.invOriginalValue)),this._trigger("spacing",t,this.ui()),this._triggerInteraction(),this.updatePositionDisplay(t)},e.prototype._mouseStop=function(t){return this.movement=this["_parse_movement_"+this.direction].call(this,t),this.currentValue=this.limitValue(nextend.roundHelper(this.originalValue+this.movement)),this.element.css(this.syncProperty,this.currentValue),t.shiftKey?this.element.css(this.invSyncProperty,this.currentValue):this.wasShiftPressed&&this.element.css(this.invSyncProperty,this.invOriginalValue),this.resizing=!1,n("body").off("."+this.widgetEventPrefix),this.handles[this.direction].removeClass("nui_spacing__handle--spacing"),n("body").css("cursor","").removeClass("n2_body--inherit-cursor"),this._trigger("stop",t,this.ui()),s.dragHide(),this._triggerInteraction(),this.fragmentEditor.pointerManager.contextualBarActive.disableActiveForced(),this.fragmentEditor.pointerManager.contextualBarHover.enable(),N2Classes.WindowManager.actionPrevent("ComponentActivate"),!1},e.prototype.limitValue=function(t){return t},e.prototype.ui=function(){var t={};return t[this.options.side[this.direction]]=this.currentValue,this.wasShiftPressed&&(t[this.options.side[this.options.syncInv[this.direction]]]=this.currentValue),{element:this.element,changed:t}},e.prototype.setOption=function(t,e){N2Classes.UIWidgetBase.prototype.setOption.apply(this,arguments),"current"===t&&(e=e.split(" "),this.setSize("n",e[0]),this.setSize("e",e[1]),this.setSize("s",e[2]),this.setSize("w",e[3]))},e.prototype.setSize=function(t,e){var i=!1;"number"==typeof e?e<0&&(i=!0,e*=-1):"-"===e.substr(0,1)&&(i=!0,e=e.substr(1)),this.handles[t].css(this.options.size[t],e),this.handles[t].toggleClass("nui_spacing__handle--negative",i),this.handles[t].toggleClass("nui_spacing__handle--zero",0===parseFloat(e))},e}),N2D("PlacementAbsolute",["PlacementAbstract"],function(s,l){"use strict";var n={raf:!1,ratios:null,isThrottled:!1,layers:[]};function t(t,e,i){this.type="absolute",this.transferredProperties={},N2Classes.PlacementAbstract.prototype.constructor.apply(this,arguments),this.doThrottledTheResize=this.doTheResize,this.parentIsVisible=!0}return((t.prototype=Object.create(N2Classes.PlacementAbstract.prototype)).constructor=t).getRegistryDataToFields=function(t){return{parentid:s("#layerparentid"),parentalign:s("#layerparentalign"),parentvalign:s("#layerparentvalign"),left:s("#layerleft"),top:s("#layertop"),responsiveposition:s("#layerresponsive-position"),width:s("#layerwidth"),height:s("#layerheight"),responsivesize:s("#layerresponsive-size"),align:s("#layeralign"),valign:s("#layervalign")}},t.prototype.start=function(){this.$layer=this.layer.layer,this.$layerRow=this.layer.layerRow},t.prototype.preActivation=function(t){"normal"!==t.type||0<(t=this.layer.getProperty("height"))&&(this.transferredProperties.height=t)},t.prototype.activated=function(t){var e=this.$layer.data("parentid");e?0<s("#"+e).length?this.activatedAfterParentReady(t):setTimeout(function(){this.activatedAfterParentReady(t)}.bind(this),300):this._activated(t)},t.prototype.activatedAfterParentReady=function(i){var t,e=this.$layer.data("parentid");e?0<(t=s("#"+e)).length?(e=t.data("layerObject"))?e.readyDeferred.done(this._activated.bind(this,i)):t.on("layerStarted",function(t,e){e.readyDeferred.done(this._activated.bind(this,i))}.bind(this)):(this.$layer.data("parentid",""),this._activated(i)):this._activated(i)},t.prototype._activated=function(t){this.loadProperties(s.extend(t,this.transferredProperties)),this.transferredProperties={},this.___makeLayerAlign(),this.___makeLayerResizeable(),this.layer.layerRow.addClass("n2_layer_navigation_list_layer--absolute"),s('<div class="n2_layer_navigation_list_layer__title_action"><div class="n2_layer_navigation_list_layer__title_absolute_marker" data-n2tip="Absolute">A</div></div>').prependTo(this.layer.layerTitle.find(".n2_layer_navigation_list_layer__title_actions"))},t.cleanLayer=function(t){var e=["desktopPortrait","desktopLandscape","tabletPortrait","tabletLandscape","mobilePortrait","mobileLandscape"];t.removeAttr("data-align").removeAttr("data-valign").css({left:"",top:"",right:"",bottom:"",width:"",height:"","text-align":""});for(var i=["parentid","responsiveposition","responsivesize","parentalign","parentvalign","align","valign","left","top","width","height"],s={},n=0;n<i.length;n++){var o=i[n].toLowerCase();s[o]=t.data(o),t.removeAttr(o),t.removeData(o);for(var a=0;a<e.length;a++){var r=e[a].toLowerCase();s[r+o]=t.data(r+o),t.removeAttr(r+o),t.removeData(r+o)}}return s},t.prototype.deActivated=function(t){this.layer.layerRow.removeClass("n2_layer_navigation_list_layer--absolute"),this.layer.layerTitle.find(".n2_layer_navigation_list_layer__title_absolute_marker").remove();var e=this.layer.getProperty("parentid");e&&""!=e&&(this.$layer.removeAttr("data-parentid"),this.unSubscribeParent()),this.$layer.removeAttr("data-align").removeAttr("data-valign").css({left:"",top:"",right:"",bottom:"",width:"",height:"","text-align":""}),this.alignMarker.remove(),this.uiResizeAbsolute.destroy(),this.$layer.off(".n2-ss-absolute"),this.$layer.triggerHandler("LayerAbsoluteUnavailable");var i=["parentid","responsiveposition","responsivesize","parentalign","parentvalign","align","valign","left","top","width","height"],e=this.layer.getPropertiesData(i);return this.layer.removeProperties(i),e},t.prototype.loadProperties=function(t){this.layer.createProperty("parentid",null,this.layer.layer,this),this.layer.createProperty("responsiveposition",1,this.layer.layer,this),this.layer.createProperty("responsivesize",1,this.layer.layer,this),this.layer.createDeviceProperty("parentalign",{desktopPortrait:"center"},this.layer.layer,this),this.layer.createDeviceProperty("parentvalign",{desktopPortrait:"middle"},this.layer.layer,this),this.layer.createDeviceProperty("align",{desktopPortrait:t.align||"center"},this.layer.layer,this),this.layer.createDeviceProperty("valign",{desktopPortrait:t.valign||"middle"},this.layer.layer,this),this.layer.createDeviceProperty("left",{desktopPortrait:t.left||0},this.layer.layer,this),this.layer.createDeviceProperty("top",{desktopPortrait:t.top||0},this.layer.layer,this),this.layer.createDeviceProperty("width",{desktopPortrait:t.width||"auto"},this.layer.layer,this),this.layer.createDeviceProperty("height",{desktopPortrait:t.height||"auto"},this.layer.layer,this);t=this.layer.layer;this.subscribeParentCallbacks={},this.layer.getProperty("parentid")&&this.subscribeParent(),t.attr({"data-align":this.layer.getProperty("align"),"data-valign":this.layer.getProperty("valign")})},t.prototype.___makeLayerAlign=function(){this.alignMarker=s('<div class="n2-ss-layer-cc"></div>').attr("data-handle","cc").appendTo(this.$layer),this.layer.editorUI.absoluteCC=this.alignMarker},t.prototype.___makeLayerResizeable=function(){this._resizableJustClick=!1,this.uiResizeAbsolute=new N2Classes.UIResizeAbsolute(this.$layer,this.layer.fragmentEditor,{_containment:this.fragmentEditor.mainContainer.layer,start:this.____makeLayerResizeableStart.bind(this),resize:this.____makeLayerResizeableResize.bind(this),stop:this.____makeLayerResizeableStop.bind(this),create:function(){this.$layer.find(".nui_resize_absolute__handle, .n2-ss-layer-cc").on({mousedown:function(t){this._resizableJustClick=[t.clientX,t.clientY]}.bind(this),mouseup:function(t){if(this._resizableJustClick&&Math.abs(Math.sqrt(Math.pow(this._resizableJustClick[0]-t.clientX,2)+Math.pow(this._resizableJustClick[1]-t.clientY,2)))<1){var t=s(t.currentTarget),e=this.fragmentEditor.layerOptions.layerFeatures;switch(t.data("handle")){case"nw":e.horizontalAlign("left",!1),e.verticalAlign("top",!1);break;case"w":e.horizontalAlign("left",!1),e.verticalAlign("middle",!1);break;case"sw":e.horizontalAlign("left",!1),e.verticalAlign("bottom",!1);break;case"n":e.horizontalAlign("center",!1),e.verticalAlign("top",!1);break;case"cc":e.horizontalAlign("center",!1),e.verticalAlign("middle",!1);break;case"s":e.horizontalAlign("center",!1),e.verticalAlign("bottom",!1);break;case"ne":e.horizontalAlign("right",!1),e.verticalAlign("top",!1);break;case"e":e.horizontalAlign("right",!1),e.verticalAlign("middle",!1);break;case"se":e.horizontalAlign("right",!1),e.verticalAlign("bottom",!1)}}this._resizableJustClick=!1}.bind(this)})}.bind(this),smartguides:function(){return this.fragmentEditor.getSnap(this.layer.group,this.layer)}.bind(this),tolerance:5}),this.layer.editorUI.resize=this.uiResizeAbsolute.$handles,this.$layer.on({"mousedown.n2-ss-absolute":function(t){0===t.button&&0===s(t.target).closest(".nui_resize_absolute__handle, .nui_resize_normal__handle, .nui_spacing__handle").length&&(N2Classes.PositionDisplay.get().show("Canvas"),N2Classes.PositionDisplay.get().update(t,"Canvas","W: "+parseInt(this.$layer.width())+"px<br />H: "+parseInt(this.$layer.height())+"px"),document.activeElement&&document.activeElement.blur(),document.addEventListener("mouseup",function(){N2Classes.PositionDisplay.get().hide("Canvas")},{capture:!0,once:!0}))}.bind(this)})},t.prototype.____makeLayerResizeableStart=function(t,e){this._resizableJustClick&&(this._resizableJustClick=!1),this.____makeLayerResizeableResize(t,e),N2Classes.PositionDisplay.get().show("Canvas")},t.prototype.____makeLayerResizeableResize=function(t,e){N2Classes.PositionDisplay.get().update(t,"Canvas","W: "+e.size.width+"px<br />H: "+e.size.height+"px"),this.triggerLayerResized()},t.prototype.____makeLayerResizeableStop=function(t,e){var i=!1;"n"!==e.axis&&"s"!==e.axis&&e.originalSize.width!=e.size.width||(a=this.layer.getProperty("width"),this.layer.isDimensionPropertyAccepted(a)&&(i=!0,this._syncwidth()));var s=!1;"e"!==e.axis&&"w"!==e.axis&&e.originalSize.height!=e.size.height||(a=this.layer.getProperty("height"),this.layer.isDimensionPropertyAccepted(a)&&(s=!0,this._syncheight()));var n=this.fragmentEditor.getResponsiveRatioHorizontal(),o=this.isSingleAxis()?this.fragmentEditor.getResponsiveRatioHorizontal():this.fragmentEditor.getResponsiveRatioVertical();parseInt(this.layer.getProperty("responsivesize"))||(n=o=1);var a=null;i||(a=Math.round(e.size.width*(1/n)));n=null;s||(n=Math.round(e.size.height*(1/o))),this._setPosition(null,null,e.position.left,e.position.top,a,n,!0),this.triggerLayerResized(),N2Classes.PositionDisplay.get().hide("Canvas")},t.prototype._setPosition=function(t,e,i,s,n,o,a){var r=this.layer.getMode();null===t&&(t=this.layer.getProperty("align")),null===e&&(e=this.layer.getProperty("valign")),null===i?i=this.layer.getProperty("left"):a&&(i=this.calculatePositionLeft(t,i)),null===s?s=this.layer.getProperty("top"):a&&(s=this.calculatePositionTop(e,s)),null===n&&(n=this.layer.getProperty("width")),null===o&&(o=this.layer.getProperty("height"));r=N2Classes.History.get().addValue(this.layer,this.layer.historyStoreOnPlacement,["historyStorePosition",r]);r&&r.setValues({align:this.layer.getRawProperty("align"),valign:this.layer.getRawProperty("valign"),left:this.layer.getRawProperty("left"),top:this.layer.getRawProperty("top"),width:this.layer.getRawProperty("width"),height:this.layer.getRawProperty("height")},{align:t,valign:e,left:i,top:s,width:n,height:o}),N2Classes.History.get().off(),this.layer.store(l,"width",n,!0,"layer"),this.layer.$.trigger("propertyChanged",["width",n]),this.layer.store(l,"height",o,!0,"layer"),this.layer.$.trigger("propertyChanged",["height",o]),this.layer.store(l,"align",t,!0,"layer"),this.layer.$.trigger("propertyChanged",["align",t]),this.layer.store(l,"valign",e,!0,"layer"),this.layer.$.trigger("propertyChanged",["valign",e]),this.layer.store(l,"left",i,!0,"layer"),this.layer.$.trigger("propertyChanged",["left",i]),this.layer.store(l,"top",s,!0,"layer"),this.layer.$.trigger("propertyChanged",["top",s]),N2Classes.History.get().on()},t.prototype.historyStorePosition=function(t,e){this.layer.historyStore(t.align,"align",e),this.layer.historyStore(t.valign,"valign",e),this.layer.historyStore(t.width,"width",e),this.layer.historyStore(t.height,"height",e),this.layer.historyStore(t.left,"left",e),this.layer.historyStore(t.top,"top",e),this.triggerLayerResized()},t.prototype.calculatePositionLeft=function(t,e){var i=this.fragmentEditor.getResponsiveRatioHorizontal();parseInt(this.layer.getProperty("responsiveposition"))||(i=1);var s={left:0,leftMultiplier:1};if(this.parent&&this.parent.layer.is(":visible")){var n=this.parent.layer.position();switch(this.layer.getProperty("parentalign")){case"right":s.left=n.left+this.parent.layer[0].offsetWidth;break;case"center":s.left=n.left+Math.round(this.parent.layer[0].offsetWidth/2);break;default:s.left=n.left}s.left+=parseInt(this.parent.layer.css("marginLeft"))}else{var o=this.$layer.parent();switch(t){case"center":s.left+=Math.round(o[0].offsetWidth/2);break;case"right":s.left+=o[0].offsetWidth}}switch(t){case"left":e=-Math.round((s.left-e)*(1/i));break;case"center":e=-Math.round((s.left-e-this.$layer.width()/2)*(1/i));break;case"right":e=-Math.round((s.left-e-this.$layer.width())*(1/i))}return e},t.prototype.calculatePositionTop=function(t,e){var i=this.isSingleAxis()?this.fragmentEditor.getResponsiveRatioHorizontal():this.fragmentEditor.getResponsiveRatioVertical();parseInt(this.layer.getProperty("responsiveposition"))||(i=1);var s={top:0,topMultiplier:1};if(this.parent&&this.parent.layer.is(":visible")){var n=this.parent.layer.position();switch(this.layer.getProperty("parentvalign")){case"bottom":s.top=n.top+this.parent.layer[0].offsetHeight;break;case"middle":s.top=n.top+Math.round(this.parent.layer[0].offsetHeight/2);break;default:s.top=n.top}s.top+=parseInt(this.parent.layer.css("marginTop"))}else{var o=this.$layer.parent();switch(t){case"middle":s.top+=Math.round(o[0].offsetHeight/2);break;case"bottom":s.top+=o[0].offsetHeight}}switch(t){case"top":e=-Math.round((s.top-e)*(1/i));break;case"middle":e=-Math.round((s.top-e-this.$layer.height()/2)*(1/i));break;case"bottom":e=-Math.round((s.top-e-this.$layer.height())*(1/i))}return e},t.prototype.moveX=function(t){this._setPosition(null,null,this.layer.getProperty("left")+t,null,null,null,!1)},t.prototype.moveY=function(t){this._setPosition(null,null,null,this.layer.getProperty("top")+t,null,null,!1)},t.prototype.setPositionLeft=function(t){t=this.calculatePositionLeft(this.layer.getProperty("align"),t),this.layer.store(l,"left",t,!0),this.layer.$.trigger("propertyChanged",["left",t])},t.prototype.setPositionTop=function(t){t=this.calculatePositionTop(this.layer.getProperty("valign"),t),this.layer.store(l,"top",t,!0),this.layer.$.trigger("propertyChanged",["top",t])},t.prototype.setPosition=function(t,e){this.setPositionLeft(t),this.setPositionTop(e)},t.prototype.setDeviceBasedAlign=function(){var t=this.layer.getMode();this.layer.deviceProperty[t].align===l&&this.layer.setProperty("align",this.layer.getProperty("align"),"layer"),this.layer.deviceProperty[t].valign===l&&this.layer.setProperty("valign",this.layer.getProperty("valign"),"layer")},t.prototype.setPropertyresponsiveposition=t.prototype.setPropertyresponsivesize=function(t,e,i){this.layer._setProperty(t,parseInt(e),i)},t.prototype.setPropertywidth=t.prototype.setPropertyheight=function(t,e,i){var s=e;this.layer.isDimensionPropertyAccepted(e)||(s=~~e)!=e&&this.layer.$.trigger("propertyChanged",[t,s]),setTimeout(function(){this.onResize(!1)}.bind(this),50),this.layer._setProperty(t,s,i)},t.prototype.setPropertyleft=t.prototype.setPropertytop=function(t,e,i){var s=~~e;s!=e&&this.layer.$.trigger("propertyChanged",[t,s]),this.layer._setProperty(t,s,i)},t.prototype.render=function(t){this["_sync"+t]()},t.prototype.renderWithModifier=function(e,t,i){try{"width"!=e&&"height"!=e||!this.layer.isDimensionPropertyAccepted(t)?this["_sync"+e](Math.round(t*i)):this["_sync"+e](t)}catch(t){console.error("_sync"+e)}},t.prototype.startResize=function(){this.doTheResize({slideW:this.fragmentEditor.getResponsiveRatioHorizontal(),slideH:this.isSingleAxis()?this.fragmentEditor.getResponsiveRatioHorizontal():this.fragmentEditor.getResponsiveRatioVertical()},!0,!0)},t.prototype.onResize=function(t){this.resize({slideW:this.fragmentEditor.getResponsiveRatioHorizontal(),slideH:this.isSingleAxis()?this.fragmentEditor.getResponsiveRatioHorizontal():this.fragmentEditor.getResponsiveRatioVertical()},t)},t.prototype.resize=function(t,e){this.parent&&!e||this.addToResizeCollection(this,t,!1)},t.prototype.addToResizeCollection=function(t,e,i){n.ratios=e,n.isThrottled=i;for(var s=0;s<n.layers.length;s++)if(n.layers[s]===this){n.layers.splice(s,1);break}n.layers.push(t),!1===n.raf&&(n.raf=!0,requestAnimationFrame(function(){var t=n;n={raf:!1,ratios:null,isThrottled:!1,layers:[]};for(var e=0;e<t.layers.length;e++)t.layers[e].isDeleted||t.layers[e].doTheResize(t.ratios,!0,t.isThrottled)})),this.triggerLayerResized(i,e)},t.prototype._syncresponsiveposition=function(){this.onResize(!0)},t.prototype._syncwidth=function(){var t=this.layer.getProperty("width");this.layer.isDimensionPropertyAccepted(t)||(parseInt(this.layer.getProperty("responsivesize"))&&(t*=this.fragmentEditor.getResponsiveRatioHorizontal()),t+="px"),this.$layer.css("width",t)},t.prototype._syncheight=function(){var t=this.layer.getProperty("height");this.layer.isDimensionPropertyAccepted(t)||(parseInt(this.layer.getProperty("responsivesize"))&&(t*=this.isSingleAxis()?this.fragmentEditor.getResponsiveRatioHorizontal():this.fragmentEditor.getResponsiveRatioVertical()),t+="px"),this.$layer.css("height",t)},t.prototype._syncparentalign=function(){var t=this.layer.getProperty("parentalign");this.$layer.data("parentalign",t);t=this.getParent();t&&t.placement.current.onResize(!1)},t.prototype._syncparentvalign=function(){var t=this.layer.getProperty("parentvalign");this.$layer.data("parentvalign",t);t=this.getParent();t&&t.placement.current.onResize(!1)},t.prototype._syncleft=function(){var t=this.layer.getProperty("left");if(parseInt(this.layer.getProperty("responsiveposition"))&&(t*=this.fragmentEditor.getResponsiveRatioHorizontal()),this.parent&&this.parentIsVisible){var e=this.parent.layer.position(),i=this.layer.getProperty("align"),s=0;switch(this.layer.getProperty("parentalign")){case"right":s=e.left+this.parent.layer[0].offsetWidth;break;case"center":s=e.left+Math.round(this.parent.layer[0].offsetWidth/2);break;default:s=e.left}switch(s+=parseInt(this.parent.layer.css("marginLeft")),i){case"right":this.$layer.css({left:"auto",right:this.$layer.parent()[0].offsetWidth-s-t+"px"});break;case"center":this.$layer.css({left:Math.round(s+t-this.$layer.width()/2)+"px",right:"auto"});break;default:this.$layer.css({left:s+t+"px",right:"auto"})}}else switch(this.layer.getProperty("align")){case"right":this.$layer.css({left:"auto",right:-t+"px"});break;case"center":this.$layer.css({left:Math.round(this.$layer.parent()[0].offsetWidth/2+t-this.$layer.width()/2)+"px",right:"auto"});break;default:this.$layer.css({left:t+"px",right:"auto"})}this.triggerLayerResized()},t.prototype._synctop=function(){var t=this.layer.getProperty("top");if(parseInt(this.layer.getProperty("responsiveposition"))&&(t*=this.isSingleAxis()?this.fragmentEditor.getResponsiveRatioHorizontal():this.fragmentEditor.getResponsiveRatioVertical()),this.parent&&this.parentIsVisible){var e=this.parent.layer.position(),i=this.layer.getProperty("valign"),s=0;switch(this.layer.getProperty("parentvalign")){case"bottom":s=e.top+this.parent.layer[0].offsetHeight;break;case"middle":s=e.top+Math.round(this.parent.layer[0].offsetHeight/2);break;default:s=e.top}switch(s+=parseInt(this.parent.layer.css("marginTop")),i){case"bottom":this.$layer.css({top:"auto",bottom:this.$layer.parent()[0].offsetHeight-s-t+"px"});break;case"middle":this.$layer.css({top:Math.round(s+t-this.$layer.height()/2)+"px",bottom:"auto"});break;default:this.$layer.css({top:s+t+"px",bottom:"auto"})}}else switch(this.layer.getProperty("valign")){case"bottom":this.$layer.css({top:"auto",bottom:-t+"px"});break;case"middle":this.$layer.css({top:Math.round(this.$layer.parent()[0].offsetHeight/2+t-this.$layer.height()/2)+"px",bottom:"auto"});break;default:this.$layer.css({top:t+"px",bottom:"auto"})}this.triggerLayerResized()},t.prototype._syncresponsivesize=function(){this.onResize(!0)},t.prototype.historyStoreDoubleProp=function(t,e,i,s){e==this.layer.getMode()?(this.layer._setProperty(i,t.value,"history"),this.layer._setProperty(s,t.value2,"history")):(this.layer.deviceProperty[e][i]=t.value,this.layer.deviceProperty[e][s]=t.value2,this.layer.$.trigger("propertyChanged",[i,this.layer.getProperty(i)]),this.layer.$.trigger("propertyChanged",[s,this.layer.getProperty(s)]),this.layer.render(i,null,"history"),this.layer.render(s,null,"history"))},t.prototype.setPropertyalign=function(t,e,i){var s=this.layer.getProperty(t),n=this.layer.getRawProperty("left");N2Classes.History.get().off(),this.layer._setProperty(t,e,i),N2Classes.History.get().on();i=N2Classes.History.get().addValue(this.layer,this.layer.historyStoreOnPlacement,["historyStoreDoubleProp",this.layer.getMode(),"align","left"]);i&&i.setValues({value:s,value2:n},{value:e,value2:this.layer.getRawProperty("left")})},t.prototype.setPropertyvalign=function(t,e,i){var s=this.layer.getProperty(t),n=this.layer.getRawProperty("top");N2Classes.History.get().off(),this.layer._setProperty(t,e,i),N2Classes.History.get().on();i=N2Classes.History.get().addValue(this.layer,this.layer.historyStoreOnPlacement,["historyStoreDoubleProp",this.layer.getMode(),"valign","top"]);i&&i.setValues({value:s,value2:n},{value:e,value2:this.layer.getRawProperty("top")})},t.prototype._syncalign=function(t,e){var i=this.layer.getProperty("align");this.$layer.attr("data-align",i),"history"!==e&&i!=t&&this.setPositionLeft(this.$layer.position().left)},t.prototype._syncvalign=function(t,e){var i=this.layer.getProperty("valign");this.$layer.attr("data-valign",i),"history"!==e&&i!=t&&this.setPositionTop(this.$layer.position().top)},t.prototype.fit=function(){var t=this.$layer.get(0);this.$layer.position();0<t.scrollWidth&&0<t.scrollHeight&&(t=!1,this.layer.item&&(t=this.layer.item.fitLayer()),t||(this.layer.setProperty("width","auto","layer"),this.layer.setProperty("height","auto","layer"),t=this.$layer.width(),Math.abs(this.fragmentEditor.mainContainer.layer.width()-this.$layer.position().left-t)<2&&this.layer.setProperty("width",t,"layer")))},t.prototype.hide=function(t){this.layer.store(l,t||this.layer.getMode(),0,!0)},t.prototype.show=function(t){this.layer.store(l,t||this.layer.getMode(),1,!0)},t.prototype.changeStatus=function(t,e){},t.prototype.getParent=function(){return!!this.layer.getProperty("parentid")&&s("#"+this.layer.getProperty("parentid")).data("layerObject")},t.prototype.subscribeParent=function(){var t=s("#"+this.layer.property.parentid);this.parent&&!t.is(this.parent.layer)&&(this.parent.layer.off(this.subscribeParentCallbacks),this.parent=!1),this.parent||(this.subscribeParentCallbacks={LayerResized:function(){this.resizeParent.apply(this,arguments)}.bind(this),LayerDeleted:function(t){this.layer.setProperty("parentid","","layer")}.bind(this),LayerAbsoluteUnavailable:function(){this.onLayerAbsoluteUnavailable()}.bind(this),LayerShowChange:function(t,e,i){this.layer.getMode()===e&&(this.parentIsVisible=i)}.bind(this),"n2-ss-activate":function(){this.$layerRow.addClass("n2-parent-active")}.bind(this),"n2-ss-deactivate":function(){this.$layerRow.removeClass("n2-parent-active")}.bind(this),LayerGetDataWithChildren:function(t,e,i){this.layer.getDataWithChildren(e,i)}.bind(this)},this.parent=t.data("layerObject"),this.parent.layer.on(this.subscribeParentCallbacks),this.$layer.on("LayerAbsoluteUnavailable.absolute",this.onLayerAbsoluteUnavailable.bind(this)),this.$layer.addClass("n2-ss-layer-has-parent"))},t.prototype.onLayerAbsoluteUnavailable=function(){this.layer.setProperty("parentid","","layer")},t.prototype.unSubscribeParent=function(t){this.$layerRow.removeClass("n2-parent-active"),this.$layer.removeClass("n2-ss-layer-has-parent"),this.parent&&(this.$layer.off("LayerAbsoluteUnavailable.absolute"),this.parent.layer.off(this.subscribeParentCallbacks),this.parent=!1,this.subscribeParentCallbacks={},"delete"!==t&&(t=this.$layer.position(),this._setPosition(null,null,t.left,t.top,null,null,!0)))},t.prototype.unlink=function(t){t&&t.preventDefault(),this.layer.setProperty("parentid","","layer")},t.prototype.parentPicked=function(t,e,i,s,n){var o,a;for(a in this.layer.setProperty("parentid","","layer"),this.layer.setProperty("align",s,"layer"),this.layer.setProperty("valign",n,"layer"),this.layer.setProperty("parentalign",e,"layer"),this.layer.setProperty("parentvalign",i,"layer"),this.layer.setProperty("parentid",t.requestID(),"layer"),this.layer.deviceProperty)"desktopPortrait"!==a&&(this.layer.deviceProperty[a].left=o,this.layer.deviceProperty[a].top=o,this.layer.deviceProperty[a].valign=o,this.layer.deviceProperty[a].align=o)},t.prototype._syncparentid=function(){var t=this.layer.getProperty("parentid");t&&""!==t?N2Classes.History.get().actionInProgress()?setTimeout(this._linkToParentID.bind(this,t,!0),100):this._linkToParentID(t,!1):(this.$layer.removeAttr("data-parentid"),this.unSubscribeParent())},t.prototype._linkToParentID=function(t,e){0===s("#"+t).length?this.layer.setProperty("parentid","","layer"):(this.$layer.attr("data-parentid",t).addClass("n2-ss-layer-has-parent"),this.subscribeParent(),e?(N2Classes.History.get().off(),this._setPosition(null,null,null,null,null,null,!0),N2Classes.History.get().on()):(e=this.$layer.position(),this._setPosition(null,null,e.left,e.top,null,null,!0)))},t.prototype._renderModeProperties=function(t){this.$layer.attr("data-align",this.layer.property.align),this.$layer.attr("data-valign",this.layer.property.valign),t&&this.onResize(!0)},t.prototype.doLinearResize=function(t){this.doThrottledTheResize(t,!0)},t.prototype.doTheResize=function(t,e,i){this.render("width"),this.render("height"),this.render("left"),this.render("top"),e||this.triggerLayerResized(i,t)},t.prototype.resizeParent=function(t,e,i){this.addToResizeCollection(this,e,i)},t.prototype.resizeParentLocal=function(){this.resizeParent(l,{slideW:this.fragmentEditor.getResponsiveRatioHorizontal(),slideH:this.isSingleAxis()?this.fragmentEditor.getResponsiveRatioHorizontal():this.fragmentEditor.getResponsiveRatioVertical()},!1)},t.prototype.updatePosition=function(){var t,e;"center"===this.layer.getProperty("align")&&(t=0,t=this.parent?this.parent.layer.position().left+this.parent.layer[0].offsetWidth/2:this.$layer.parent()[0].offsetWidth/2,e=this.fragmentEditor.getResponsiveRatioHorizontal(),parseInt(this.layer.getProperty("responsiveposition"))||(e=1),this.$layer.css("left",Math.round(t-this.$layer.width()/2+this.layer.getProperty("left")*e))),"middle"===this.layer.getProperty("valign")&&(t=0,t=this.parent?this.parent.layer.position().top+this.parent.layer[0].offsetHeight/2:this.$layer.parent()[0].offsetHeight/2,e=this.isSingleAxis()?this.fragmentEditor.getResponsiveRatioHorizontal():this.fragmentEditor.getResponsiveRatioVertical(),parseInt(this.layer.getProperty("responsiveposition"))||(e=1),this.$layer.css("top",Math.round(t-this.$layer.height()/2+this.layer.getProperty("top")*e))),this.triggerLayerResized()},t.prototype.sync=function(){this._syncalign(null,"history"),this._syncvalign(null,"history"),this._syncwidth(),this._syncheight(),this._synctop(),this._syncleft(),this._syncparentid()},t.prototype.delete=function(){this.layer.getProperty("parentid")&&this.unSubscribeParent("delete")},t}),N2D("PlacementContent",["PlacementAbstract"],function(t,e){"use strict";function i(t,e,i){this.type="content",N2Classes.PlacementAbstract.prototype.constructor.apply(this,arguments)}return(i.prototype=Object.create(N2Classes.PlacementAbstract.prototype)).constructor=i}),N2D("PlacementDefault",["PlacementAbstract"],function(t,e){"use strict";function i(t,e,i){this.type="default",N2Classes.PlacementAbstract.prototype.constructor.apply(this,arguments)}return(i.prototype=Object.create(N2Classes.PlacementAbstract.prototype)).constructor=i}),N2D("PlacementNormal",["PlacementAbstract"],function(r,t){"use strict";function e(t,e,i){this.type="normal",this.transferredProperties={},N2Classes.PlacementAbstract.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.PlacementAbstract.prototype)).constructor=e).getRegistryDataToFields=function(t){return{margin:r("#layernormal-margin"),height:r("#layernormal-height"),maxwidth:r("#layernormal-maxwidth"),selfalign:r("#layernormal-selfalign")}},e.prototype.preActivation=function(t){"absolute"===t.type&&this.layer.item&&this.layer.item.needHeight&&((t=this.layer.getProperty("height")).match&&t.match(/[0-9]+%$/)?this.transferredProperties.height=Math.max(100,parseInt(this.$layer.parent()[0].offsetHeight*parseInt(t)/100)):0<t&&(this.transferredProperties.height=t))},e.prototype.activated=function(t){this.loadProperties(r.extend(t,this.transferredProperties)),this.transferredProperties={},this.layer.$.on("baseSizeUpdated.placementnormal",this._syncmargin.bind(this)),this.layer.$.on("baseSizeUpdated.placementnormal",this._syncheight.bind(this)),this.startUISpacing(),this.startUISizing(),this.$layer.on({mousedown:function(t){t.stopPropagation()}})},e.prototype.loadProperties=function(t){this.layer.createDeviceProperty("margin",{desktopPortrait:"0|*|0|*|0|*|0|*|px+"},this.layer.layer,this),this.layer.createDeviceProperty("height",{desktopPortrait:t.height||0},this.layer.layer,this),this.layer.createDeviceProperty("maxwidth",{desktopPortrait:0},this.layer.layer,this),this.layer.createDeviceProperty("selfalign",{desktopPortrait:"inherit"},this.layer.layer,this)},e.cleanLayer=function(t){var e=["desktopPortrait","desktopLandscape","tabletPortrait","tabletLandscape","mobilePortrait","mobileLandscape"];t.attr("data-has-maxwidth","0").removeAttr("data-cssselfalign").css({position:"",margin:"",height:"",maxWidth:""});for(var i=["margin","height","maxwidth","selfalign"],s={},n=0;n<i.length;n++){var o=i[n].toLowerCase();s[o]=t.data(o),t.removeAttr(o),t.removeData(o);for(var a=0;a<e.length;a++){var r=e[a].toLowerCase();s[o]=t.data(r+o),t.removeAttr(r+o),t.removeData(r+o)}}return s},e.prototype.deActivated=function(t){this.layer.$.off(".placementnormal"),this.uiSpacing.destroy(),delete this.layer.editorUI.normalSizing,this.uiResizeNormal.destroy(),this.layer.layer.attr("data-has-maxwidth","0"),this.layer.layer.removeAttr("data-cssselfalign"),this.layer.layer.removeAttr("data-custom-height");var e=["margin","height","maxwidth","selfalign"],i=this.layer.getPropertiesData(e);return this.layer.removeProperties(e),this.layer.layer.css({position:"",margin:"",height:"",maxWidth:""}),i},e.prototype._renderModeProperties=function(t){this._syncmargin(),this._syncheight(),this._syncmaxwidth(),this._syncselfalign()},e.prototype._syncmargin=function(){var t=(s=this.layer.getProperty("margin").split("|*|")).pop(),e=this.layer.baseSize;if("px+"==t&&0<e){t="em";for(var i=0;i<s.length;i++)s[i]=parseInt(s[i])/e}var s=s.join(t+" ")+t;this.layer.layer.css("margin",s),this.layer.update(),this.uiSpacing.setOption("current",s)},e.prototype.startUISpacing=function(){this.uiSpacing=new N2Classes.UISpacingMargin(this.$layer,this.layer.fragmentEditor,{stop:this.onSpacingStop.bind(this)}),this.layer.editorUI.margin=this.uiSpacing.$handles},e.prototype.onSpacingStop=function(t,e){var i,s=this.layer.getProperty("margin").split("|*|"),n=1,o=1;for(i in"px+"==s[s.length-1]&&1<Math.abs(parseFloat(this.$layer.css("fontSize"))-this.layer.baseSize)&&(n=this.fragmentEditor.getResponsiveRatioHorizontal(),o=this.fragmentEditor.getResponsiveRatioVertical()),e.changed){var a=e.changed[i];switch(i){case"top":s[0]=Math.round(a/o);break;case"right":s[1]=Math.round(a/n);break;case"bottom":s[2]=Math.round(a/o);break;case"left":s[3]=Math.round(a/n)}}this.layer.setProperty("margin",s.join("|*|")),r("#layernormal-margin").data("field").insideChange(s.join("|*|"))},e.prototype.startUISizing=function(){var t=!1;this.layer.item&&this.layer.item.needHeight&&(t=!0),this.uiResizeNormal=new N2Classes.UIResizeNormal(this.$layer,this.layer.fragmentEditor,{height:t,syncWidth:!0,start:function(t,e){"maxwidth"===e&&this.layer.layer.attr("data-has-maxwidth","1")}.bind(this),stopMaxWidth:function(t,e){this.layer.setProperty("maxwidth",e.value)}.bind(this),stopHeight:function(t,e){var i=1;parseInt(this.$layer.css("fontSize"))!=this.layer.baseSize&&(i=this.fragmentEditor.getResponsiveRatioHorizontal());Math.round(void 0/i);this.layer.setProperty("height",e.value)}.bind(this)}),this.layer.editorUI.normalSizing=this.uiResizeNormal.$handles},e.prototype._syncheight=function(){var t,e,i=parseInt(this.layer.getProperty("height"));0<i?(t="px",0<(e=this.layer.baseSize)&&(t="em",i=parseInt(i)/e),this.layer.layer.css("height",i+t).attr("data-custom-height",1)):this.layer.layer.css("height","").removeAttr("data-custom-height"),this.layer.update()},e.prototype._syncmaxwidth=function(){var t=parseInt(this.layer.getProperty("maxwidth"));t<=0||isNaN(t)?(this.layer.layer.css("maxWidth","").attr("data-has-maxwidth","0"),this.uiResizeNormal.setMaxWidth(-1)):(this.layer.layer.css("maxWidth",t+"px").attr("data-has-maxwidth","1"),this.uiResizeNormal.setMaxWidth(t)),this.layer.update()},e.prototype._syncselfalign=function(){this.layer.layer.attr("data-cssselfalign",this.layer.getProperty("selfalign")),this.layer.update()},e.prototype.sync=function(){this._syncmargin(),this._syncheight(),this._syncmaxwidth()},e}),N2D("Placement",function(t,n){"use strict";function e(t){this.layer=t,this.fragmentEditor=t.fragmentEditor,this.modes={},this.current=n,this.updatePositionThrottled=NextendDeBounce(function(){this.layer.isDeleteStarted||(this.updatePosition(),this.layer.layer.trigger("interaction"))}.bind(this),200)}return e.prototype.allow=function(t){switch(t){case"default":this.modes.default=new N2Classes.PlacementDefault(this,this.layer,this.fragmentEditor);break;case"absolute":this.modes.absolute=new N2Classes.PlacementAbsolute(this,this.layer,this.fragmentEditor);break;case"normal":this.modes.normal=new N2Classes.PlacementNormal(this,this.layer,this.fragmentEditor)}},e.prototype.start=function(){for(var t in this.modes)this.modes[t].start()},e.prototype.setMode=function(t,e){var i,s=!1;return e=e||{},this.modes[t]!==n?this.current!==this.modes[t]&&(this.current&&(this.modes[t].preActivation(this.current),i=this.current.type,s=this.current.deActivated(this.modes[t])),this.current=this.modes[t],this.layer.layer.attr("data-pm",this.current.type),this.current.activated(e),this.layer.$.triggerHandler("placementChanged",[this.current.type,i])):console.error("Layer placement("+t+") not allowed for this component",this.layer),s},e.prototype.getType=function(){return this.current.type},e.prototype.startResize=function(){this.current.startResize()},e.prototype.onResize=function(t){"function"==typeof this.current.onResize&&this.current.onResize(t)},e.prototype.updatePosition=function(){this.current.updatePosition()},e.prototype.doLinearResize=function(t){this.current.doLinearResize(t)},e.prototype.sync=function(){this.current.sync()},e.prototype.renderModeProperties=function(t){this.layer.adjustFontSize(!1),this.current._renderModeProperties(t)},e.prototype.delete=function(){this.current.delete()},e}),N2D("PlacementAbstract",["Placement"],function(t,e){"use strict";function i(t,e,i){this.placement=t,this.layer=e,this.fragmentEditor=i,this._triggerLayerResizedThrottled=NextendThrottle(this._triggerLayerResized,30)}return i.prototype.start=function(){this.$layer=this.layer.layer},i.prototype.startResize=function(){},i.prototype.preActivation=function(t){},i.prototype.activated=function(){},i.prototype.deActivated=function(t){return!1},i.prototype.updatePosition=function(){this.layer.group.update()},i.prototype._renderModeProperties=function(t){},i.prototype._hide=function(){},i.prototype._show=function(){},i.prototype.doLinearResize=function(t){},i.prototype.sync=function(){},i.prototype.delete=function(){},i.prototype.changeStatus=function(t,e){},i.prototype.onResize=function(t){this.triggerLayerResized(t)},i.prototype.isSingleAxis=function(){if("slide"===this.layer.group.type){if(!this.parent)return!1;if("absolute"===this.parent.placement.getType())return!1}return!0},i.prototype.triggerLayerResized=function(t,e){t?this._triggerLayerResized(t,e):this._triggerLayerResizedThrottled(!0,e)},i.prototype._triggerLayerResized=function(t,e){this.layer.isDeleted||this.$layer.triggerHandler("LayerResized",[e||{slideW:this.fragmentEditor.getResponsiveRatioHorizontal(),slideH:this.isSingleAxis()?this.fragmentEditor.getResponsiveRatioHorizontal():this.fragmentEditor.getResponsiveRatioVertical()},t||!1])},i}),N2D("AnimatedHeadingItemAdmin",["FrontendItemAnimatedHeading"],function(e,t){"use strict";function i(t,e){N2Classes.FrontendItemAnimatedHeading.prototype.constructor.call(this,t,e)}return((i.prototype=Object.create(N2Classes.FrontendItemAnimatedHeading.prototype)).constructor=i).prototype.kill=function(){this.timeline&&(this.timeline.kill(),delete this.timeline);for(var t=0;t<this.garbage.length;t++)this.garbage[t].call(this);this.garbage=[]},i.prototype.delete=function(){this.$layer.off(".animatedHeading"),this.extraAnimation&&(this.extraAnimation.remove(),delete this.extraAnimation),this.kill()},i.prototype.start=function(){this.$layer.triggerHandler("deleteAnimatedHeading"),N2R("SSEditor",this.started.bind(this))},i.prototype.started=function(){N2Classes.FrontendItemAnimatedHeading.prototype.started.apply(this,arguments),this.layer=this.$layer.data("layerObject"),this.layer.$.on("textAlignUpdated.animatedHeading",this.refreshJustifyContent.bind(this)),this.layer.$.on("baseSizeUpdated.animatedHeading",this.onResize.bind(this)),this.$layer.on("deleteAnimatedHeading.animatedHeading",this.delete.bind(this)),this.getTimeline(),this.$layer.on("AnimationSetZero.animatedHeading",this.setZero.bind(this));var t="in";1===parseInt(this.loop)&&(t="loop"),this.layer.readyDeferred.done(function(){this.extraAnimation=new N2Classes.TimelineAnimationExtra(this.layer,"animatedHeading",t,{label:n2_("Animated heading"),delay:this.delay,duration:this.totalDuration,setDelay:this.changeIn.bind(this)})}.bind(this))},i.prototype.changeIn=function(t){e("#item_animatedHeadingdelay").val(1e3*t).trigger("change")},i.prototype.setZero=function(){this.timeline.time(0).invalidate()},i}),N2D("CounterItemAdmin",["FrontendItemCounter"],function(e,t){"use strict";function i(){N2Classes.FrontendItemCounter.prototype.constructor.apply(this,arguments)}return((i.prototype=Object.create(N2Classes.FrontendItemCounter.prototype)).constructor=i).prototype.delete=function(){this.$layer.off(".counter"),this.extraAnimation&&(this.extraAnimation.remove(),delete this.extraAnimation)},i.prototype.start=function(){this.$layer.triggerHandler("deleteCounter"),N2R("SSEditor",this.started.bind(this))},i.prototype.started=function(){N2Classes.FrontendItemCounter.prototype.started.apply(this,arguments),this.layer=this.$layer.data("layerObject"),this.$layer.on("deleteCounter.counter",this.delete.bind(this)),this.setZero(),this.$layer.on("AnimationSetZero.counter",this.setZero.bind(this)),this.layer.readyDeferred.done(function(){this.extraAnimation=new N2Classes.TimelineAnimationExtra(this.layer,"counter","in",{label:"Counter",delay:this.delay,duration:this.timeline.totalDuration(),setDelay:this.changeDelay.bind(this),setDuration:this.changeDuration.bind(this)})}.bind(this))},i.prototype.changeDelay=function(t){e("#item_"+this.data.name+"animationdelay").val(1e3*t).trigger("change")},i.prototype.changeDuration=function(t){e("#item_"+this.data.name+"animationduration").val(1e3*t).trigger("change")},i.prototype.setZero=function(t){this.timeline.progress(1)},i.prototype.extendTimeline=function(t,e,i){this.timeline.time(0),N2Classes.FrontendItemCounter.prototype.extendTimeline.apply(this,arguments)},i}),N2D("HighlightedHeadingItemAdmin",["FrontendItemHighlightedHeading"],function(e,t){"use strict";function i(t,e){N2Classes.FrontendItemHighlightedHeading.prototype.constructor.call(this,t,e)}return((i.prototype=Object.create(N2Classes.FrontendItemHighlightedHeading.prototype)).constructor=i).prototype.delete=function(){this.$layer.off(".highlightedHeading"),this.extraAnimation&&(this.extraAnimation.remove(),delete this.extraAnimation)},i.prototype.clean=function(){this.$layer.triggerHandler("deleteHeadingHighlight")},i.prototype.start=function(){N2R("SSEditor",this.started.bind(this))},i.prototype.started=function(){N2Classes.FrontendItemHighlightedHeading.prototype.started.apply(this,arguments),this.layer=this.$layer.data("layerObject"),this.layer.$.on("textAlignUpdated",this.refreshJustifyContent.bind(this)),this.$layer.on("deleteHeadingHighlight.highlightedHeading",this.delete.bind(this)),this.setZero(),this.$layer.on("AnimationSetZero.highlightedHeading",this.setZero.bind(this));var t="in";1===parseInt(this.loop)&&(t="loop"),this.layer.readyDeferred.done(function(){this.extraAnimation=new N2Classes.TimelineAnimationExtra(this.layer,"highlight",t,{label:n2_("Highlighted heading"),delay:this.delay,duration:this.totalDuration,setDelay:this.changeIn.bind(this)})}.bind(this))},i.prototype.changeIn=function(t){e("#item_highlightedHeadingdelay").val(1e3*t).trigger("change")},i.prototype.setZero=function(){for(var t=0;t<this.$paths.length;t++){var e=Math.round(1.05*(this.$paths[t].getTotalLength()||2e3));NextendTween.set(this.$paths[t],{opacity:1,"stroke-dasharray":e+" "+e})}},i.prototype.getLoopTimeline=function(){return this.getTimeline().invalidate()},i.prototype.extendTimeline=function(t,e,i){var s=this.getTimeline();s.time(0),t.add(s,0),s.invalidate().paused(!1)},i}),N2D("Item",function(s,n){"use strict";function t(t,e,i){this.type===n&&(this.type=t.data("item")),this.needWidth=this.constructor.needWidth||!1,this.needHeight=this.constructor.needHeight||!1,this.fragmentEditor=i.fragmentEditor,this.generator=this.fragmentEditor.editor.generator,(this.self=this).$item=t,this.layer=e,this.itemEditor=i,this.css=[],this.fonts=[],this.styles=[],this.needFill=[],this.values=this.$item.data("itemvalues"),"object"!=typeof this.values&&(this.values=s.parseJSON(this.values)),this.pre="div#"+this.fragmentEditor.editor.frontend.elementID+" ",this.defaultValues=i.getItemForm(this.type).values,this.added(),this.$item.data("item",this),this.$item.appendTo(this.layer.getContent()),0===(this.layer.item=this).$item.children().length&&this.reRender(),s("<div></div>").addClass("n2-ss-item-overlay").css("zIndex",89).appendTo(this.$item),this.$item.find("a").on("click",function(t){t.preventDefault()}),s(window).trigger("ItemCreated")}return t.needWidth=!1,t.needHeight=!1,N2Classes.Historical(t),t.prototype.getLabel=function(){return this.type},t.prototype.hasTextScale=function(){return!0},t.prototype.changeValue=function(t,e){this===this.itemEditor.activeItem?s("#item_"+this.type+t).data("field").insideChange(e):this.values[t]=e},t.prototype.activate=function(t,e){this.itemEditor.setActiveItem(this,t,e)&&(nextend.basicCSS.activate("ss3item"+this.type,this.values,{font:this.fonts,style:this.styles}),this.itemEditor.lastValues[this.type]=this.values)},t.prototype.deActivate=function(){nextend.basicCSS.deActivate()},t.prototype.render=function(t,e){this.layer.layer.triggerHandler("itemRender"),this.$item.html(""),this.parseAll(t),this._render(t),this.itemEditor.lastValues[this.type]=this.values=e,s("<div></div>").addClass("n2-ss-item-overlay").css("zIndex",89).appendTo(this.$item),this.layer.update(),this.$item.find("a").on("click",function(t){t.preventDefault()})},t.prototype._render=function(t){},t.prototype.reRender=function(t){this.values=s.extend({},this.getDefault(),this.values,t),this.render(s.extend({},this.values),this.values)},t.prototype.delete=function(){this.$item.remove(),this.itemEditor.activeItem==this&&(this.itemEditor.activeItem=null)},t.prototype.getHTML=function(t){return t?"["+this.type+' values="'+N2Classes.Base64.encode(JSON.stringify(this.values))+'"]':s('<div class="n2-ss-item n2-ss-item-'+this.type+'"></div>').attr("data-item",this.type).attr("data-itemvalues",JSON.stringify(this.values))},t.prototype.getData=function(){return{type:this.type,values:this.values}},t.prototype.getDefault=function(){return{}},t.prototype.added=function(){},t.prototype.addedFont=function(t,e){var i=s("#item_"+this.type+e);i.length&&this.fonts.push({mode:t,name:e,field:i.data("field"),def:this.defaultValues[e]})},t.prototype.addedStyle=function(t,e){var i=s("#item_"+this.type+e);i.length&&this.styles.push({mode:t,name:e,field:i.data("field"),def:this.defaultValues[e]})},t.prototype.parseAll=function(t){for(var e=0;e<this.css.length;e++)this.css[e].destroy();this.css=[];for(e=0;e<this.fonts.length;e++)""===t[this.fonts[e].name]?t[this.fonts[e].name+"class"]=this.fonts[e].className="":(t[this.fonts[e].name+"class"]=this.fonts[e].className=N2Classes.CSSRendererFont.getClass(),this.css.push(N2Classes.CSSRendererFont.addCSS(window.nextend.pre,this.fonts[e].className,t[this.fonts[e].name],N2Classes.CSSRendererFont.rendererModes[this.fonts[e].mode])));for(e=0;e<this.styles.length;e++)""===t[this.styles[e].name]?t[this.styles[e].name+"class"]=this.styles[e].className="":(t[this.styles[e].name+"class"]=this.styles[e].className=N2Classes.CSSRendererStyle.getClass(),this.css.push(N2Classes.CSSRendererStyle.addCSS(window.nextend.pre,this.styles[e].className,t[this.styles[e].name],N2Classes.CSSRendererStyle.rendererModes[this.styles[e].mode])));for(e=0;e<this.needFill.length;e++)t[this.needFill[e]]!==n&&(t[this.needFill[e]]=this.generator.fill(t[this.needFill[e]]+""))},t.prototype.resizeLayerToImage=function(t){var n=this.layer,o=s("<img/>").attr("src",t).on("load",function(){var t,e,i=o[0].width,s=o[0].height;0<i&&0<s&&((t=(e=this.fragmentEditor.editor.getMainContainerElement()).width())<i&&(s=s*t/i,i=t),(e=e.height())<s&&(i=i*e/s),N2Classes.History.get().off(),n.setProperty("width",i),n.setProperty("height","auto"),N2Classes.History.get().on())}.bind(this))},t.prototype.fitLayer=function(t){return!1},t}),N2D("ItemManager",function(l,i){"use strict";function t(t,i){this.suppressChange=!1,this.activeItemOriginalData=null,this.fragmentEditor=t,this.lastValues={},this.startItems(),this.forms={},this.activeForm=!1,i.isUploadDisabled||(t=l("#n2-ss-slide-canvas-container"),new N2Classes.UIFileUpload(t,{url:i.uploadUrl,pasteZone:!1,dropZone:t,dataType:"json",paramName:"image",add:function(t,e){e.formData={path:"/"+i.uploadDir},e.submit()},done:function(t,e){var i=e.result;i.data&&i.data.name?((e=this.createLayerItem(this.fragmentEditor.mainContainer.getTargetGroupDefault(),{item:"image"})).item.reRender({image:i.data.url}),e.item.activate()):N2Classes.AjaxHelper.notification(i)}.bind(this),fail:function(t,e){N2Classes.AjaxHelper.notification(e.jqXHR.responseJSON)},start:function(){N2Classes.LoadingScreen.startLoading()},stop:function(){setTimeout(function(){N2Classes.LoadingScreen.stopLoading()},100)}}))}return t.prototype.setActiveItem=function(t,e,i){if(t!==this.activeItem||i){this.activeItemOriginalData=null;var s=t.type;this.activeItem&&this.activeItem.deActivate(),this.activeForm=this.getItemForm(s);var n,o=l.extend({},this.activeForm.values,t.values);for(n in this.activeItem=t,this.suppressChange=!0,o){var a=l("#item_"+s+n).data("field");a&&a.insideChange(o[n])}return this.suppressChange=!1,e&&this.focusFirst(),!0}return!1},t.prototype.focusFirst=function(){var t=this.activeForm.fields.eq(0).data("field");this.fragmentEditor.editor.generator.isDynamicSlide()&&t.connectedField&&t.connectedField instanceof N2Classes.FormElementImage||t.focus(!0)},t.prototype.startItems=function(){for(var t=l(".n2_add_layer_box"),e=0;e<t.length;e++)new N2Classes.UICanvasItem(t.eq(e),{canvasUIManager:this.fragmentEditor.canvasUIManager,$layer:function(){return this.element.clone()},start:function(){this.fragmentEditor.addLayer.hide()}.bind(this)});t.on("click",function(t){var e="absolute"===(t.ctrlKey||t.metaKey?"absolute":this.fragmentEditor.addLayer.getPosition())?this.fragmentEditor.mainContainer.getTargetGroupAbsolute():this.fragmentEditor.mainContainer.getTargetGroupDefault();this.createLayerItem(e,l(t.currentTarget).data(),"click"),this.fragmentEditor.addLayer.hide()}.bind(this)),l(".n2_add_layer__bar_button[data-add-layer-shortcut]").on({click:function(t){t.preventDefault(),l('.n2_add_layer_box[data-item="'+l(t.currentTarget).data("add-layer-shortcut")+'"]').trigger(t)}.bind(this),mousedown:function(t){l('.n2_add_layer_box[data-item="'+l(t.currentTarget).data("add-layer-shortcut")+'"]').trigger(t)}.bind(this)})},t.prototype.createWithDrag=function(i,s,t,e,n,o){var a,r;"absolute"===t?(a=this.fragmentEditor.mainContainer.layer[0].getBoundingClientRect(),(r=this.createLayerItem(n.layer,e.data(),"click")).layer.one("LayerCreated",function(){var t="auto"===r.layer[0].style.width,e=i.clientX-a.left;t&&(e=Math.min(e,r.group.layer.width()-r.layer.width()-5)),r.placement.current.setPosition(e,i.clientY-a.top),s.resolve()}.bind(this))):(N2Classes.History.get().startBatch(),r=this.createLayerItem(n.layer,e.data(),"click"),N2Classes.History.get().addControl("skipForwardUndos"),n.layer.container.insertLayerAt(r,o),r.changeGroup(!1,n.layer),N2Classes.History.get().endBatch(),s.resolve())},t.prototype.createLayerItem=function(t,e,i,s){var n,o,a,r=e.item;return r.match(/^structure-/)?((a=new N2Classes.Row(this.fragmentEditor,t,{})).create(r),a.layer.one("LayerCreated",function(){a.highlightStructure()})):(n=this.getItemForm(r),o={},"image"===r&&("slide"===t.type?o.size="100%|*|auto":o.size="auto|*|auto"),o=l("<div></div>").attr("data-item",r).data("itemvalues",l.extend(!0,{},n.values,this.getLastValues(r),o)).addClass("n2-ss-item n2-ss-item-"+r),a=this._createLayer(o,t,l.extend(l('.n2_add_layer_box[data-item="'+r+'"]').data("layerproperties"),s)),N2Classes.History.get().addSimple(this,this.historyDelete,this.historyCreate,[t,a,e])),a.layer.one("LayerCreated",function(){"click"===i?a.activate(!0):a.activate(),this.fragmentEditor.layerWindow.tab.displayTab("content")}.bind(this)),a},t.prototype.getLastValues=function(t){return this.lastValues[t]!==i?this.lastValues[t]:{}},t.prototype.getItemClass=function(t){t="Item"+N2Classes.StringHelper.capitalize(t);return N2Classes[t]===i?"Item":t},t.prototype._createLayer=function(t,e,i){var s,n=this.fragmentEditor.layerOptions.layerFeatures.layerDefault;for(s in n)null!==n[s]&&(i[s]=n[s]);e=new N2Classes.Layer(this.fragmentEditor,e,i);return e.create(e._createLayer().append(t)),e},t.prototype.getItemForm=function(t){var e;return this.forms[t]===i&&((e={form:e=l('.n2_ss_layer_window__tab_panel[data-panel="item/'+t+'"]'),values:window["itemValues/"+t],fields:e.find('[name^="item_"]'),fieldNameRegexp:new RegExp("item_"+t+"\\[(.*?)\\]","")}).fields.on({nextendChange:this.updateCurrentItem.bind(this),keydown:this.updateCurrentItemDeBounced.bind(this)}),this.forms[t]=e),this.forms[t]},t.prototype.updateCurrentItem=function(t){var s,n;this.suppressChange||(null===this.activeItemOriginalData&&(this.activeItemOriginalData=l.extend({},this.activeItem.values)),s={},n={},this.activeForm.fields.each(function(t,e){var i=(e=l(e)).attr("name").match(this.activeForm.fieldNameRegexp)[1];n[i]=s[i]=e.val()}.bind(this)),t&&"nextendChange"===t.type&&((t=N2Classes.History.get().addValue(this,this.historyUpdateCurrentItem,[this.activeItem]))&&t.setValues(this.activeItemOriginalData,l.extend({},n)),this.activeItemOriginalData=null),this.activeItem.render(l.extend({},this.activeItem.getDefault(),s),n))},t.prototype.historyUpdateCurrentItem=function(t,e){e=e.getSelf();e.reRender(l.extend(!0,{},t)),e.values=t,this.activeItem===e&&e.activate(!1,!0)},t.prototype.updateCurrentItemDeBounced=NextendDeBounce(function(t){this.updateCurrentItem(t)},100),t.prototype.historyDelete=function(t,e){e.getSelf().delete()},t.prototype.historyCreate=function(t,e,i){i=this.createLayerItem(t.getSelf(),i);e.setSelf(i)},t.prototype.getSelf=function(){return this},t}),N2D("HeadingItemSplitTextAdmin",["FrontendItemHeadingSplitText"],function(l,t){"use strict";function e(t,e,i,s,n,o,a,r){if(""!=n)try{n=JSON.parse(N2Classes.Base64.decode(n))}catch(t){n=!1}else n=!1;if(""!=a)try{a=JSON.parse(N2Classes.Base64.decode(a))}catch(t){a=!1}else a=!1;n||l("#"+e).closest(".n2-ss-layer").triggerHandler("layerExtraAnimationRemoved"),(n||a)&&N2Classes.FrontendItemHeadingSplitText.prototype.constructor.call(this,t,e,i,s,n,o,a,r)}return((e.prototype=Object.create(N2Classes.FrontendItemHeadingSplitText.prototype)).constructor=e).prototype.delete=function(){this.$layer.off(".splitText"),this.extraAnimationIn&&(this.extraAnimationIn.remove(),delete this.extraAnimationIn),this.extraAnimationOut&&(this.extraAnimationOut.remove(),delete this.extraAnimationOut)},e.prototype.start=function(t,e,i,s,n,o){this.$layer.triggerHandler("deleteSplitText"),N2R("SSEditor",this.started.bind(this,t,e,i,s,n,o))},e.prototype.started=function(t,e,i,s,n,o){N2Classes.FrontendItemHeadingSplitText.prototype.started.apply(this,arguments),this.$layer.on("deleteSplitText.splitText",this.delete.bind(this)),this.setZero(),this.$layer.on("AnimationSetZero.splitText",this.setZero.bind(this)),this.layer=this.$layer.data("layerObject"),i&&this.layer.readyDeferred.done(function(){this.extraAnimationIn=new N2Classes.TimelineAnimationExtra(this.layer,"splitText","in",{label:n2_("Text animation in"),delay:s,duration:this.in.totalDuration,setDelay:this.changeIn.bind(this),click:this.editIn.bind(this)})}.bind(this)),n&&this.layer.readyDeferred.done(function(){this.extraAnimationOut=new N2Classes.TimelineAnimationExtra(this.layer,"splitText","out",{label:n2_("Text animation out"),delay:o,duration:this.out.totalDuration,setDelay:this.changeOut.bind(this),click:this.editOut.bind(this)})}.bind(this))},e.prototype.changeIn=function(t){l("#item_headingsplit-text-delay-in").val(1e3*t).trigger("change")},e.prototype.editIn=function(t){l("#item_headingsplit-text-animation-in").parent().find(".n2-form-element-button").trigger("click")},e.prototype.changeOut=function(t){l("#item_headingsplit-text-delay-out").val(1e3*t).trigger("change")},e.prototype.editOut=function(t){l("#item_headingsplit-text-animation-out").parent().find(".n2-form-element-button").trigger("click")},e.prototype.setZero=function(t,e){for(var i=0;i<this.modes.length;i++)NextendTween.set(this.splitText[this.modes[i]],{opacity:1,scale:1,x:0,y:0,rotationX:0,rotationY:0,rotationZ:0});this.in.invalidate=!0,this.out.invalidate=!0},e}),N2D("PluginAnimatable",function(t,e){"use strict";function i(t){(this.component=t).isAnimatable=!0}return i.prototype.addProperties=function(t){this.component.createProperty("mouseenter","",t),this.component.createProperty("click","",t),this.component.createProperty("mouseleave","",t),this.component.createProperty("play","",t),this.component.createProperty("pause","",t),this.component.createProperty("stop","",t)},i}),N2D("PluginShowOn",function(t,e){"use strict";function i(t){this.component=t}return i.prototype.addProperties=function(t){this.component.createProperty("desktopPortrait",1,t,this),this.component.createProperty("desktopLandscape",1,t,this),this.component.createProperty("tabletPortrait",1,t,this),this.component.createProperty("tabletLandscape",1,t,this),this.component.createProperty("mobilePortrait",1,t,this),this.component.createProperty("mobileLandscape",1,t,this)},i.prototype._syncdesktopPortrait=function(){var t=this.component.getProperty("desktopPortrait");this.component.syncShowOnDevice("desktopPortrait",t)},i.prototype._synctabletPortrait=function(){var t=this.component.getProperty("tabletPortrait");this.component.syncShowOnDevice("tabletPortrait",t)},i.prototype._syncmobilePortrait=function(){var t=this.component.getProperty("mobilePortrait");this.component.syncShowOnDevice("mobilePortrait",t)},i.prototype._syncdesktopLandscape=function(){var t=this.component.getProperty("desktopLandscape");this.component.syncShowOnDevice("desktopLandscape",t)},i.prototype._synctabletLandscape=function(){var t=this.component.getProperty("tabletLandscape");this.component.syncShowOnDevice("tabletLandscape",t)},i.prototype._syncmobileLandscape=function(){var t=this.component.getProperty("mobileLandscape");this.component.syncShowOnDevice("mobileLandscape",t)},i}),N2D("Col",["ContentAbstract"],function(i,l){"use strict";function t(t,e,i){this.label="Column",this.type="col",this.innerContainer="> .n2-ss-layer-col",this.localStyle=[{group:"normal",selector:"-inner",css:{transition:"transition:all .3s;transition-property:border,background-image,background-color,border-radius,box-shadow;"}},{group:"hover",selector:"-inner:HOVER",css:{}}],N2Classes.ContentAbstract.prototype.constructor.call(this,t,e,i),this.placement.allow("default")}return((t.prototype=Object.create(N2Classes.ContentAbstract.prototype)).constructor=t).getRegistryDataToFields=function(t){var e={maxwidth:i("#layercol-maxwidth"),padding:i("#layercol-padding"),inneralign:i("#layercol-inneralign"),verticalalign:i("#layercol-verticalalign"),href:i("#layercol-href"),"href-target":i("#layercol-href-target"),bgimage:i("#layercol-background-image"),bgimagex:i("#layercol-background-focus-x"),bgimagey:i("#layercol-background-focus-y"),stylemode:i("#layerfields-col-background-mode"),bgcolor:i("#layercol-background-color"),bgcolorgradient:i("#layercol-background-gradient"),bgcolorgradientend:i("#layercol-background-color-end"),borderradius:i("#layercol-border-radius"),boxshadow:i("#layercol-boxshadow"),borderwidth:i("#layercol-border-width"),borderstyle:i("#layercol-border-style"),bordercolor:i("#layercol-border-color"),opened:i("#layercol-opened"),colwidth:i("#layercol-colwidth"),order:i("#layercol-order")};return t.initStyleMode("column",e.stylemode,["#layerfields-col-border-mode"]),t.fragmentEditor.editor.generator.registerField(e.href),t.fragmentEditor.editor.generator.registerField(e.bgimage),t.fragmentEditor.editor.generator.registerField(e.bgcolor),t.fragmentEditor.editor.generator.registerField(e.bgcolorgradientend),e},t.prototype.getIcon=function(){return"ssi_16 ssi_16--column"},t.prototype._createLayer=function(){return i('<div class="n2-ss-layer"><div class="n2-ss-layer-content n2-ss-layer-col"></div></div>').attr("data-sstype",this.type)},t.prototype.addProperties=function(t){N2Classes.ContentAbstract.prototype.addProperties.call(this,t),this.createProperty("colwidth","1",t),this.createProperty("href","",t),this.createProperty("href-target","_self",t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("borderradius",0,{"-hover":l},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("boxshadow","0|*|0|*|0|*|0|*|00000080",{"-hover":l},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("borderwidth","0|*|0|*|0|*|0",{"-hover":l},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("borderstyle","solid",{"-hover":l},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bordercolor","ffffffff",{"-hover":l},this,"stylemode"),t),this.createDeviceProperty("order",{desktopPortrait:0},t)},t.prototype.create=function(t){N2Classes.ContentAbstract.prototype.create.apply(this,arguments),this._syncorder(),this._syncborder(),this._syncborderradius(),this._syncboxshadow(),this._onReady()},t.prototype.load=function(t,e){N2Classes.ContentAbstract.prototype.load.call(this,t,e),this._syncorder(),this._syncborder(),this._syncborderradius(),this._syncboxshadow(),this._onReady();t=t.data("rowcolumns")+"";if(t!=l&&"resolved"==this.group.readyDeferred.state()){for(var i=t.split("+"),s=0;s<i.length;s++)i[s]=new Fraction(i[s]);this.group.setColsWidth(i)}},t.prototype.createRow=function(){this.$content=this.layer.find(".n2-ss-layer-content:first"),this.container=new N2Classes.LayerContainer(this),this.container.setLayerContainerElement(this.$content),this.addClassElement(this.layer),this.addClassElement(this.$content,"-inner"),this._createLayerListRow();var t=i('<div class="n2_layer_navigation_list_layer__title_label_folder" data-action="open-close"><i class="ssi_16"></i></div>').prependTo(this.$rowLabel).on("click",this.switchOpened.bind(this));nextend.tooltip.addElement(t,n2_("Open/Close")),this.container.$ul.appendTo(this.layerRow),this.readyDeferred.done(this._syncopened.bind(this))},t.prototype.getPlacement=function(){return"default"},t.prototype._start=function(t){N2Classes.ContentAbstract.prototype._start.call(this,t),t&&(this.layer.addClass("n2_layer_col_highlight"),setTimeout(function(){this.isDeleted||this.layer.removeClass("n2_layer_col_highlight")}.bind(this),2e3))},t.prototype.getRealOrder=function(){var t=this.getProperty("order");return 0==t?10:t},t.prototype._syncorder=function(){var t=this.getProperty("order");0==t?this.layer.css("order",""):this.layer.css("order",2*t),this.group.refreshUI()},t.prototype._synccolwidth=function(){this.widthPercentage=100*new Fraction(this.getProperty("colwidth")).valueOf(),this.group.refreshUI()},t.prototype.getWidthPercentage=function(){return this.widthPercentage},t.prototype._synchref=t.prototype["_synchref-target"]=function(){},t.prototype._syncborderradius=t.prototype["_syncborderradius-hover"]=function(){var t=this.getProperty("borderradius");0<=t&&this.addLocalStyle("normal","borderradius","border-radius:"+t+"px;");var e=this.getProperty("borderradius-hover");e&&e!=t&&this.addLocalStyle("hover","borderradius","border-radius:"+e+"px;")},t.prototype._syncborderwidth=t.prototype._syncbordercolor=t.prototype._syncborderstyle=t.prototype["_syncborderstyle-hover"]=t.prototype["_syncbordercolor-hover"]=t.prototype["_syncborderwidth-hover"]=function(){this._syncborder()},t.prototype._syncborder=function(){var t=this.getProperty("borderstyle"),e=this.getProperty("bordercolor"),i=this.getProperty("borderwidth");this.addLocalStyle("normal","border",this.getBorderCSS(t,e,i));var s="",n=!1,o=this.getProperty("borderstyle-hover"),a=this.getProperty("bordercolor-hover"),r=this.getProperty("borderwidth-hover");o!==l&&o!=t&&(n=!0),a!==l&&a!=e&&(n=!0),r!==l&&r!=i&&(n=!0),n&&(o===l&&(o=t),a===l&&(a=e),r===l&&(r=i),s=this.getBorderCSS(o,a,r)),this.addLocalStyle("hover","border",s),this.update()},t.prototype.getBorderCSS=function(t,e,i){var s="";return"none"!==t&&(s+="border-color:"+N2Color.hex2rgbaCSS(e)+";",s+="border-style:"+t+";",s+="border-width:"+(i=i.split("|*|")).join("px ")+"px;"),s},t.prototype._syncboxshadow=t.prototype["_syncboxshadow-hover"]=function(){var t=this.getProperty("boxshadow");this.addLocalStyle("normal","boxshadow",this.getBoxShadowCSS(t.split("|*|")));var e="",i=this.getProperty("boxshadow-hover");i!==l&&i!=t&&(e=this.getBoxShadowCSS(i.split("|*|"))),this.addLocalStyle("hover","boxshadow",e)},t.prototype.getBoxShadowCSS=function(t){return 0==t[0]&&0==t[1]&&0==t[2]&&0==t[3]||0==N2Color.hex2alpha(t[4])?"":"box-shadow:"+t[0]+"px "+t[1]+"px "+t[2]+"px "+t[3]+"px "+N2Color.hex2rgbaCSS(t[4])+";"},t.prototype.delete=function(){1<this.group.container.getLayerCount()?this._delete():this.group.delete()},t.prototype.getHTML=function(t){t=N2Classes.ContentAbstract.prototype.getHTML.call(this,t);return t.attr("data-rowcolumns",this.group.getColumns()),t},t.prototype.renderModeProperties=function(t){this._syncorder(),N2Classes.ContentAbstract.prototype.renderModeProperties.call(this,t)},t.prototype.update=function(){this.group._syncwrapafter(),N2Classes.ContentAbstract.prototype.update.call(this)},t.prototype.setPropertystylemode=function(){N2Classes.ContentAbstract.prototype.setPropertystylemode.apply(this,arguments),this.syncAdvancedField("borderradius"),this.syncAdvancedField("boxshadow"),this.syncAdvancedField("borderwidth"),this.syncAdvancedField("borderstyle"),this.syncAdvancedField("bordercolor")},t.prototype.getOrderedIndex=function(){return this.group.getOrderedColumns().indexOf(this)},t.prototype.getContextMenuItems=function(){var t=N2Classes.ComponentCommonAbstract.prototype.getContextMenuItems.call(this);return t.push({priority:55,label:n2_("Duplicate"),icon:"ssi_16 ssi_16--duplicate",action:this.duplicate.bind(this)}),t.push({priority:1e3,label:n2_("Delete"),icon:"ssi_16 ssi_16--delete",action:this.delete.bind(this),color:"red"}),t},t});var dependencies=["Historical","LayerDataStorage"];N2D("ComponentAbstract",dependencies,function(r,l){"use strict";var n=0;function o(t,e,i){this.supports=this.supports||[],this.supports.push("PluginShowOn"),this.isActive=!1,this.isAnimatable=!1,this.container=l,this.plugins=[];for(var s=0;s<this.supports.length;s++)this.plugins.push(new N2Classes[this.supports[s]](this));this.isRenameAllowed=this.isRenameAllowed!==l&&this.isRenameAllowed,this.contextualBarPosition=this.contextualBarPosition||"left",this.editorUI={},this.showsOnCurrent=!0,this.counter=++n,((window.layers[this.counter]=this).self=this).originalProperties=i||{},N2Classes.LayerDataStorage.prototype.constructor.call(this),this.readyDeferred=r.Deferred(),this.isDeleteStarted=!1,this.isDeleted=!1,this.$=r(this),this.proxyRefreshBaseSize=this.refreshBaseSize.bind(this),this.proxyRefreshTextAlign=this.refreshTextAlign.bind(this),this.status=o.STATUS.UNDEFINED,this.fragmentEditor=t,this.group=e,this.classElements=[],this.localStyleSyncThrottled=NextendThrottle(this.localStyleSync,50),this.placement=new N2Classes.Placement(this)}return window.layers=[],o.STATUS={UNDEFINED:0,NORMAL:1,LOCKED:2,HIDDEN:3},o.STATUS_INV={0:"UNDEFINED",1:"NORMAL",2:"LOCKED",3:"HIDDEN"},(o.prototype=Object.create(N2Classes.LayerDataStorage.prototype)).constructor=o,N2Classes.Historical(o),o.prototype.onSelfChange=function(){this.animations.setSelf(this.self.animations)},o.prototype.getUILabel=function(){return this.label},o.prototype.hasUp=function(){return!1},o.prototype.up=function(t){t.stopImmediatePropagation()},o.prototype.addProperties=function(t){this.createProperty("adaptivefont",0,t),this.createDeviceProperty("fontsize",{desktopPortrait:100},t),this.callPlugin("addProperties",t)},o.prototype.callPlugin=function(t){for(var e=Array.prototype.slice.call(arguments,1),i=0;i<this.plugins.length;i++)this.plugins[i][t]!==l&&this.plugins[i][t].apply(this.plugins[i],e)},o.prototype.getSubType=function(){return""},o.prototype._hide=function(){this.layer.css("display","none"),this.showsOnCurrent=!1,this.update()},o.prototype._show=function(){parseInt(this.property[this.fragmentEditor.getMode()])&&(this.layer.css("display",""),this.showsOnCurrent=!0),this.update()},o.prototype.getRootElement=function(){return this.layer},o.prototype.create=function(t){this.addProperties(!1),this.layer=t,this.animations=new N2Classes.BackendLayerAnimationController(this),this.layer.addClass("n2_layer--creation-in-progress"),this.layer.data("layerObject",this),this.layer.triggerHandler("layerStarted",[this]),this.group.container.insert(this),this.group.onChildCountChange(),this.onBeforeStart(),this.$.triggerHandler("create"),this._start(!0)},o.prototype.load=function(t,e){this.addProperties(t),this.layer=t.data("layerObject",this),this.animations=new N2Classes.BackendLayerAnimationController(this),this.layer.triggerHandler("layerStarted",[this]),this.onBeforeStart(),this.$.triggerHandler("load"),this._start(!1);t=t.data("status");null!==t&&t!==l?this.changeStatus(t):this.changeStatus(o.STATUS.NORMAL),e||this.regenerateUniqueClass()},o.prototype.onBeforeStart=function(){},o.prototype._start=function(t){},o.prototype.afterStart=function(t){t?this.layer.n2imagesLoaded().always(function(){this.isDeleteStarted||(this.placement.startResize(),this.layer.css("visibility",""),this.layer.triggerHandler("LayerCreated"),this.layer.removeClass("n2_layer--creation-in-progress"),document.dispatchEvent(new CustomEvent("EditorInvalidated")))}.bind(this)):(this.placement.startResize(),this.layer.css("visibility",""))},o.prototype.updateAnimations=function(){},o.prototype.createLayerAnimations=function(t,e){var i=[];if(this.container)for(var s=this.container.getSortedLayers(),n=0;n<s.length;n++)i.push.apply(i,s[n].createLayerAnimations(t,e));return i},o.prototype._onReady=function(){this.originalProperties={},this.readyDeferred.resolve()},o.prototype.isReady=function(){return"resolved"===this.readyDeferred.state()},o.prototype.getLabel=function(){return this.label},o.prototype.getName=function(){return this.getDefaultName()},o.prototype.getIcon=function(){return"ssi_16 ssi_16--layer"},o.prototype.getDefaultName=function(){return this.label},o.prototype.setGroup=function(t){this.group.$.off("baseSizeUpdated.sslayer"+this.counter),this.group.$.off("textAlignUpdated.sslayer"+this.counter),(this.group=t).container.syncLayerRow(this),this.isReady()&&this.refreshBaseSize(),this.group.$.on("baseSizeUpdated.sslayer"+this.counter,this.proxyRefreshBaseSize),this.group.$.on("textAlignUpdated.sslayer"+this.counter,this.proxyRefreshTextAlign)},o.prototype.changeGroup=function(t,e){var i=this.group;i.$.off("baseSizeUpdated.sslayer"+this.counter),i.$.off("textAlignUpdated.sslayer"+this.counter),(this.group=e).container.syncLayerRow(this),this.refreshBaseSize(),e.$.on("baseSizeUpdated.sslayer"+this.counter,this.proxyRefreshBaseSize),e.$.on("textAlignUpdated.sslayer"+this.counter,this.proxyRefreshTextAlign),this.userGroupChange(i,t,e,this.getIndex()),i.update()},o.prototype.userGroupChange=function(t,e,i,s){var n;t===i?this.userIndexChange(e,s):(n=N2Classes.History.get().addValue(this,this.historyUserGroupChange,[]))&&n.setValues({historyGroup:t,index:e},{historyGroup:i,index:s})},o.prototype.historyUserGroupChange=function(t){var e=this.group,i=t.historyGroup.getSelf(),t=t.index;i.container.insertLayerAt(this,t),this.group.$.off("baseSizeUpdated.sslayer"+this.counter),this.group.$.off("refreshTextAlign.sslayer"+this.counter),(this.group=i).container.syncLayerRow(this),this.refreshBaseSize(),this.group.$.on("baseSizeUpdated.sslayer"+this.counter,this.proxyRefreshBaseSize),this.group.$.on("refreshTextAlign.sslayer"+this.counter,this.proxyRefreshBaseSize),i.onChildCountChange(),e.update()},o.prototype.userIndexChange=function(t,e){var i=N2Classes.History.get().addValue(this,this.historyUserIndexChange);i&&i.setValues(t,e),this.group.container.insertLayerAt(this,e)},o.prototype.historyUserIndexChange=function(t){this.group.container.insertLayerAt(this,t)},o.prototype.getLayerListParent=function(){return this.group.container.$ul},o.prototype._createLayerListRow=function(t){this.layerRow=r('<div class="n2_layer_navigation_list_layer"></div>').attr("data-type",this.type).data("layer",this).appendTo(this.getLayerListParent()),this.$rowLabel=r('<div class="n2_layer_navigation_list_layer__title_label"></div>'),this.layerTitleSpan=r('<div class="n2_layer_navigation_list_layer__title_label_text">'+this.getName()+"</div>").appendTo(this.$rowLabel),this.layerTitle=r('<div class="n2_layer_navigation_list_layer__title"></div>').append(this.$rowLabel).appendTo(this.layerRow),this.$layerRowActions=r('<div class="n2_layer_navigation_list_layer__title_actions"></div>').appendTo(this.layerTitle),t!==l&&this.$layerRowActions.append(t),this.$layerRowMore=r('<div class="n2_layer_navigation_list_layer__title_action"><i class="ssi_16 ssi_16--more"></i></div>').on("click",function(){N2Classes.WindowManager.actionPrevent("ComponentRowActivate"),this.onContextMenu(this.$layerRowMore[0],{y:6})}.bind(this)).appendTo(this.$layerRowActions),nextend.tooltip.add(this.layerRow),new N2Classes.UILayerListItem(this.layerRow,{UIManager:this.fragmentEditor.mainContainer.layerListUIManager,layer:this,$item:this.layerRow}),this.$layerRowIcon=r('<div class="n2_layer_navigation_list_layer__title_label_icon"><i class="'+this.getIcon()+'"></i></div>').prependTo(this.$rowLabel)},o.prototype.update=function(){this.readyDeferred.done(this.placement.updatePositionThrottled.bind(this.placement))},o.prototype.updateThrottled=function(){this.placement.updatePositionThrottled()},o.prototype.getHTML=function(t){var e,i,s=this._createLayer();for(e in s.attr("data-pm",this.placement.getType()),this.property)"width"!=e&&"height"!=e&&"left"!=e&&"top"!=e&&s.attr("data-"+e.toLowerCase(),this.property[e]);for(e in this.deviceProperty)for(var n in this.deviceProperty[e])s.attr("data-"+e.toLowerCase()+n,this.deviceProperty[e][n]);for(e in this.deviceProperty.desktop)s.css(e,this.deviceProperty.desktop[e]+"px");this.container!==l&&(i=s,this.innerContainer!==l&&(i=s.find(this.innerContainer)),i.append(this.container.getHTML(t)));t=this.getProperty("id");return""!==t&&s.attr("id",t),this.status>N2Classes.ComponentAbstract.STATUS.NORMAL&&s.attr("data-status",this.status),s.attr("data-animv2",this.animations.getAnimationsCode()),s},o.prototype.duplicate=function(t){var e,i=this.getHTML(!1);"absolute"===this.placement.getType()&&((e=i.attr("id"))&&(e=r.fn.uid(),i.attr("id",e),i.attr("data-id",e)),i.attr("data-parentid")?(i.data("desktopportraittop",0),i.data("desktopportraitleft",0)):(i.data("desktopportraittop",i.data("desktopportraittop")+40),i.data("desktopportraitleft",i.data("desktopportraitleft")+40)),i.attr("data-parentid",""));i=this.fragmentEditor.insertComponentWithNode(this.group,i,this.getIndex()+1,!1,!0);return this.layerRow.trigger("mouseleave"),t&&i.activate(),N2Classes.History.get().addSimple(this,this.historyDeleteDuplicated,this.historyDuplicate,[i,!!i.container&&i.container.getAllLayers()]),i},o.prototype.historyDeleteDuplicated=function(t){t.getSelf().delete()},o.prototype.historyDuplicate=function(t,e){var i=this.duplicate(!1);if(t.setSelf(i),e)for(var s=i.container.getAllLayers(),n=0;n<s.length;n++)e[n].setSelf(s[n])},o.prototype.historyDelete=function(){this.delete()},o.prototype.historyRestore=function(t,e,i,s){i=this.fragmentEditor.insertComponentWithNode(this.group.getSelf(),t.clone(),i,!1,!0);if(this.setSelf(i),s)for(var n=i.container.getAllLayers(),o=0;o<n.length;o++)s[o].setSelf(n[o])},o.prototype.delete=function(){N2Classes.PositionDisplay.get().hide(),nextend.tooltip.onLeave(),this._delete()},o.prototype._delete=function(){if(this.isDeleteStarted=!0,this.fragmentEditor.getActiveLayer()===this&&(N2Classes.WindowManager.actionPrevent("ComponentRowActivate"),this.fragmentEditor.mainContainer.activate()),N2Classes.History.get().startBatch(),N2Classes.History.get().addSimple(this,this.historyRestore,this.historyDelete,[this.getHTML(!1),this.group,this.getIndex(),!!this.container&&this.container.getAllLayers()]),this.deActivate(),this.container!==l){N2Classes.History.get().off();for(var t=this.container.getSortedLayers(),e=0;e<t.length;e++)t[e]._delete();N2Classes.History.get().on()}N2Classes.History.get().endBatch(),this.item!==l&&this.item.delete(),this.placement.delete(),this.layer.trigger("mouseup"),this.isDeleted=!0,this.fragmentEditor.mainContainer.layerDeleted(this),this.layer.triggerHandler("LayerDeleted"),this.getRootElement().remove(),this.layerRow.remove(),this.group.isDeleteStarted||(this.group.update(),this.group.$.off("baseSizeUpdated.sslayer"+this.counter),this.group.$.off("refreshTextAlign.sslayer"+this.counter)),this.$.trigger("layerDeleted"),delete this.layer,delete this.itemEditor,delete this.animation,this.group.onChildCountChange()},o.prototype.getData=function(t){var e={type:this.type,pm:this.placement.getType()};e.animv2=this.animations.getData(),this.status>N2Classes.ComponentAbstract.STATUS.NORMAL&&(e.status=this.status);var i,s,n=r.extend({},this.property);for(i in this.deviceProperty)for(var o in this.deviceProperty[i]){delete n[o];var a=this.deviceProperty[i][o];if(a!==l){switch(o){case"width":case"height":this.isDimensionPropertyAccepted(a)||(a=parseFloat(a));break;case"fontsize":case"left":case"top":case"gutter":case"wrap":a=parseFloat(a)}e[i.toLowerCase()+o]=a}}for(s in n)e[s.toLowerCase()]=n[s];return e},o.prototype.onChildCountChange=function(){},o.prototype.getDataWithChildren=function(t,e){return-1===e.indexOf(this)&&(e.push(this),t.push(this.getData({layersIncluded:!0,itemsIncluded:!0})),this.layer.triggerHandler("LayerGetDataWithChildren",[t,e])),t},o.prototype.markOver=function(){this.layer.addClass("n2-ss-mouse-over"),this.group&&this.group.markEnter()},o.prototype.markOut=function(){this.layer.removeClass("n2-ss-mouse-over"),this.group&&this.group.markLeave()},o.prototype.markEnter=function(t){this.layer.addClass("n2-ss-mouse-hover"),this.group.markEnter()},o.prototype.markLeave=function(t){this.layer.removeClass("n2-ss-mouse-hover"),this.group.markLeave()},o.prototype.sync=function(){if(this._syncid(),this.container)for(var t=this.container.getSortedLayers(),e=0;e<t.length;e++)t[e].sync();this.placement.sync()},o.prototype._syncid=function(){var t=this.getProperty("id");""===t?this.layer.removeAttr("id"):this.layer.attr("id",t)},o.prototype.requestID=function(){var t=this.getProperty("id");return""===t&&(t=r.fn.uid(),this.setProperty("id",t,"layer")),t},o.prototype.requestUniqueClass=function(){var t=this.getProperty("uniqueclass");return t||(t=r.fn.generateUniqueClass("n-uc-"),N2Classes.History.get().off(),this.setProperty("uniqueclass",t,"layer"),N2Classes.History.get().on()),t},o.prototype.regenerateUniqueClass=function(){this.getProperty("uniqueclass")&&this.setProperty("uniqueclass",r.fn.generateUniqueClass("n-uc-"),"layer")},o.prototype._syncuniqueclass=function(){for(var t=this.getProperty("uniqueclass"),e=0;e<this.classElements.length;e++)this.classElements[e].$el.removeClass(function(t,e){return(e.match(/n-uc-[a-z0-9\-]+/gi)||[]).join(" ")}).addClass(t+this.classElements[e].postfix)},o.prototype.adjustFontSize=function(t){this.refreshBaseSize(),t&&this.update()},o.prototype.getFontSize=function(){return parseInt(this.getProperty("fontsize"))},o.prototype.isAdaptiveFont=function(){return parseInt(this.getProperty("adaptivefont"))},o.prototype._syncfontsize=function(){this.adjustFontSize(!0)},o.prototype._syncadaptivefont=function(){this.adjustFontSize(!0)},o.prototype.refreshBaseSize=function(){var t=this.getFontSize();this.baseSize=this.group.baseSize*t/100,this.isAdaptiveFont()?this.layer.css("font-size",this.baseSize+"px"):this.layer.css("font-size",t+"%"),this.$.triggerHandler("baseSizeUpdated")},o.prototype.refreshTextAlign=function(){this.$.triggerHandler("textAlignUpdated")},o.prototype.setPropertydesktopPortrait=o.prototype.setPropertydesktopLandscape=o.prototype.setPropertytabletPortrait=o.prototype.setPropertytabletLandscape=o.prototype.setPropertymobilePortrait=o.prototype.setPropertymobileLandscape=function(t,e,i){this._setProperty(t,parseInt(e),i)},o.prototype.formSetdesktopPortrait=function(t,e){t.currentForm.desktopPortrait.data("field").insideChange(e)},o.prototype.formSetdesktopLandscape=function(t,e){t.currentForm.desktopLandscape.data("field").insideChange(e)},o.prototype.formSettabletPortrait=function(t,e){t.currentForm.tabletPortrait.data("field").insideChange(e)},o.prototype.formSettabletLandscape=function(t,e){t.currentForm.tabletLandscape.data("field").insideChange(e)},o.prototype.formSetmobilePortrait=function(t,e){t.currentForm.mobilePortrait.data("field").insideChange(e)},o.prototype.formSetmobileLandscape=function(t,e){t.currentForm.mobileLandscape.data("field").insideChange(e)},o.prototype.getContents=function(){return!1},o.prototype.renderModeProperties=function(t){N2Classes.LayerDataStorage.prototype.renderModeProperties.call(this),this.placement.renderModeProperties(t)},o.prototype.getIndex=function(){return this.group.container.getLayerIndex(this.layer)},o.prototype.toString=function(){return this.type+" #"+this.counter},o.prototype.historyStoreOnPlacement=function(){var t=Array.prototype.slice.call(arguments);t.splice(1,1),this.placement.current[arguments[1]].apply(this.placement.current,t)},o.prototype.getDroppable=function(){return!1},o.prototype.onCanvasUpdate=function(t,e,i){if(this.group===e)t!==i&&this.userIndexChange(t,i);else{var s;if(this.fragmentEditor.isCol(this.group))for(s=this;s&&(!s.placement||"absolute"!==s.placement.getType());)s=s.group;this.changeGroup(t,e),e.onChildCountChange();for(var n=this;n&&(!n.placement||"absolute"!==n.placement.getType());)n=n.group;s&&s!==n&&s.placement.updatePosition(),n&&n.placement.updatePosition()}},o.prototype.toggleHideShow=function(){N2Classes.WindowManager.actionPrevent("ComponentRowActivate"),this.status===N2Classes.ComponentAbstract.STATUS.HIDDEN?this.setStatusNormal():this.changeStatus(N2Classes.ComponentAbstract.STATUS.HIDDEN)},o.prototype.setStatusNormal=function(){this.changeStatus(o.STATUS.NORMAL)},o.prototype.changeStatus=function(t){var e=this.status;t===this.status&&(t=o.STATUS.NORMAL),this.status===o.STATUS.HIDDEN&&(this.getRootElement().removeAttr("data-visibility"),this.layerTitle.removeClass("n2_layer_navigation_list_layer__title--hidden")),this.status=t,this.status===o.STATUS.HIDDEN&&(this.getRootElement().attr("data-visibility","hidden"),this.layerTitle.addClass("n2_layer_navigation_list_layer__title--hidden")),this.placement.current.changeStatus(e,this.status)},o.prototype.moveX=function(t){"absolute"===this.placement.getType()&&(this.placement.current.moveX(t),this.fragmentEditor.pointerManager.refreshPosition())},o.prototype.moveY=function(t){"absolute"===this.placement.getType()&&(this.placement.current.moveY(t),this.fragmentEditor.pointerManager.refreshPosition())},o.prototype.localStyleSync=function(){if(this.localStyle!==l){var t=[],e="";this.$localStyle!==l&&(this.$localStyle.remove(),delete this.$localStyle);for(var i=0;i<this.localStyle.length;i++){var s="@rule"+this.localStyle[i].selector,n="";if(t.push(s),1!==Object.keys(this.localStyle[i].css).length||this.localStyle[i].css.transition===l){for(var o in this.localStyle[i].css)n+=this.localStyle[i].css[o];""!==n&&(e+=s+"{"+n+"}")}}var a=this.getProperty("uniqueclass");if(a)for(i=0;i<t.length;i++)nextend.css.deleteRule(t[i].replace(/@rule/g,window.nextend.pre+"."+a));""!==e&&(a=a||this.requestUniqueClass(),this.$localStyle=r("<style>"+e.replace(/@rule/g,window.nextend.pre+"."+a)+"</style>").appendTo("head"))}},o.prototype.addLocalStyle=function(t,e,i){for(var s=0;s<this.localStyle.length;s++)if(this.localStyle[s].group===t){""===i?this.localStyle[s].css[e]!==l&&delete this.localStyle[s].css[e]:this.localStyle[s].css[e]=i,this.localStyleSyncThrottled();break}},o.prototype.addClassElement=function(t,e){arguments.length<2&&(e=""),this.classElements.push({$el:t,postfix:e})},o.prototype.setState=function(t,e){},o.prototype.activate=function(t,e){t?this.fragmentEditor.layerWindow.show(this):this.fragmentEditor.layerWindow.setTitle(this),this.fragmentEditor.getActiveLayer()!==this&&(this.layerRow.addClass("n2_layer_navigation_list_layer--active"),this.layer.addClass("n2-active"),this.layer.triggerHandler("n2-ss-activate"),this.fragmentEditor.changeActiveLayer(this),this.fragmentEditor.layerNavigation.onActivateLayer(this)),this.isActive=!0},o.prototype.deActivate=function(){this.isActive=!1,this.layer===l&&console.error(),this.layer.removeClass("n2-active"),this.layerRow.removeClass("n2_layer_navigation_list_layer--active"),this.layer.triggerHandler("n2-ss-deactivate")},o.prototype.isAbsolute=function(){return"absolute"===this.placement.getType()},o.prototype.doubleClick=function(){},o.prototype.hasResponsiveTools=function(){return!1},o.prototype.onContextMenu=function(t,e){e=e||{};var i=this.getContextMenuItems();this.isActive||this.activate(),this.fragmentEditor.pointerManager.contextualBarActive.enableActiveForced(),e.onClose===l?e.onClose=this.onContextMenuBlur.bind(this):e.onClose=function(t){t.call(),this.onContextMenuBlur()}.bind(this,e.onClose),N2Classes.ContextMenu(t,i,e)},o.prototype.onContextMenuBlur=function(){this.fragmentEditor.pointerManager.contextualBarActive.disableActiveForced()},o.prototype.getContextMenuItems=function(){var t=[],e=this.getContextMenuCopySubItems(),i=this.getContextMenuPasteSubItems();if(e.length&&t.push({priority:60,label:n2_("Copy"),icon:"ssi_16 ssi_16--copy",items:e}),i.length&&t.push({priority:70,label:n2_("Paste"),icon:"ssi_16 ssi_16--paste",items:i}),this.group){for(var i={priority:50,label:n2_("Parent"),icon:"ssi_16 ssi_16--up",action:function(){this.group.activate(!0)}.bind(this),focus:function(){this.group.layer.addClass("n2_layer_context_menu_target")}.bind(this),blur:function(){this.group.layer.removeClass("n2_layer_context_menu_target")}.bind(this)},s=[],n=this.group,o=0;o<6&&n;o++)s.push({label:n.getLabel(),icon:n.getIcon(),action:function(){this.activate(!0)}.bind(n),focus:function(t){t.layer.addClass("n2_layer_context_menu_target")}.bind(this,n),blur:function(t){t.layer.removeClass("n2_layer_context_menu_target")}.bind(this,n)}),n=n.group;s.length&&(i.items=s),t.push(i)}return t},o.prototype.getContextMenuCopySubItems=function(){return[]},o.prototype.getContextMenuPasteSubItems=function(){var t=[];return this.fragmentEditor.clipboard.componentHasClipboard()&&t.push({label:n2_("Layer(s)"),icon:"ssi_16 ssi_16--layer",action:function(){this.fragmentEditor.clipboard.componentPaste(this)}.bind(this)}),t},o.prototype.syncShowOnDevice=function(t,e){this.getMode()===t&&((e=parseInt(e))?this._show():this._hide(),this.layer.triggerHandler("LayerShowChange",[t,e]),this.placement.current.triggerLayerResized())},o.prototype.triggerLayerResized=function(){if(this.container)for(var t=this.container.getSortedLayers(),e=0;e<t.length;e++)t[e].triggerLayerResized();this.placement.current.triggerLayerResized()},o}),N2D("ComponentCommonAbstract",["ComponentAbstract"],function(r,s){"use strict";function t(t,e,i){this.supports=this.supports||[],this.supports.push("PluginAnimatable"),this.isRenameAllowed=this.isRenameAllowed===s||this.isRenameAllowed,this.wraps={},this._lastClasses=!1,N2Classes.ComponentAbstract.prototype.constructor.call(this,t,e,i)}return((t.prototype=Object.create(N2Classes.ComponentAbstract.prototype)).constructor=t).getRegistryDataToFields=function(t){var e=t.fragmentEditor.editor.getAvailableDeviceModes(),i={id:r("#layerid"),uniqueclass:r("#layeruniqueclass"),desktopPortrait:r("#layershow-desktop-portrait"),tabletPortrait:r("#layershow-tablet-portrait"),mobilePortrait:r("#layershow-mobile-portrait"),zindex:r("#layerzindex"),class:r("#layerclass"),generatorvisible:r("#layergenerator-visible"),crop:r("#layercrop"),rotation:r("#layerrotation"),parallax:r("#layerparallax"),fontsize:r("#layerfont-size"),adaptivefont:r("#layeradaptive-font"),mouseenter:r("#layeronmouseenter"),click:r("#layeronclick"),mouseleave:r("#layeronmouseleave"),play:r("#layeronplay"),pause:r("#layeronpause"),stop:r("#layeronstop")};return i.desktopLandscape=r("#layershow-desktop-landscape"),i.tabletLandscape=r("#layershow-tablet-landscape"),i.mobileLandscape=r("#layershow-mobile-landscape"),t.fragmentEditor.editor.generator.registerField(i.class),t.fragmentEditor.editor.generator.registerField(i.generatorvisible),e.tabletPortrait||i.tabletPortrait.closest(".n2_field_radio__option").css("display","none"),e.mobilePortrait||i.mobilePortrait.closest(".n2_field_radio__option").css("display","none"),e.desktopLandscape||i.desktopLandscape.closest(".n2_field_radio__option").css("display","none"),e.tabletLandscape||i.tabletLandscape.closest(".n2_field_radio__option").css("display","none"),e.mobileLandscape||i.mobileLandscape.closest(".n2_field_radio__option").css("display","none"),i},t.prototype.hasUp=function(){return!0},t.prototype.up=function(t){t.stopImmediatePropagation(),this.group.activate(t)},t.prototype.addProperties=function(t){this.createProperty("id","",t,this),this.createProperty("uniqueclass",null,t,this),this.createProperty("generatorvisible","",t),this.createProperty("zindex",2,t),this.createProperty("class","",t),this.createProperty("crop","visible",t),this.createProperty("rotation",0,t),this.createProperty("parallax",0,t),N2Classes.ComponentAbstract.prototype.addProperties.call(this,t)},t.prototype.onBeforeStart=function(){this.isRenameAllowed&&(this.createProperty("name",this.getName(),this.layer),this.createProperty("nameSynced",1,this.layer))},t.prototype.hasTextScale=function(){return!0},t.prototype.hasResponsiveTools=function(){return!0},t.prototype.onContextResponsiveTools=function(t,e){this.isActive||this.activate();var a=N2Classes.ContextMenu(t,[{type:"raw",render:function(t){var e,i,s,n=r('<div class="n2_layer_contextual_responsive_tools"></div>').appendTo(t),o=r('<div class="n2_layer_contextual_responsive_tools__hide"><i class="ssi_16"></i></div>').toggleClass("n2_layer_contextual_responsive_tools__hide--hidden",!this.getRawProperty(this.getMode())).appendTo(n).on("click",function(){var t=this.getMode(),e=this.getProperty(t)?0:1;this.setProperty(t,e),o.toggleClass("n2_layer_contextual_responsive_tools__hide--hidden",!e)}.bind(this));this.hasTextScale()&&(e=r('<div class="n2_layer_contextual_responsive_tools__text_scale"></div>').appendTo(n),i=this.fragmentEditor.layerOptions.currentForm.fontsize,t=this.getFontSize(),n=r("<div></div>").width(50).appendTo(e),s=r('<input type="number" min="10" max="990" step="10"/>').on("change",function(){i.val(this.value).trigger("change")}).width(26).val(t).appendTo(e),r('<div class="n2_layer_contextual_responsive_tools__text_scale_percent">%</div>').appendTo(e),new N2Classes.UISlider(n,r.extend({start:function(){this.fragmentEditor.pointerManager.disable(),a.lock()}.bind(this),stop:function(t,e){s.val(e.value).trigger("change"),this.fragmentEditor.pointerManager.enable(),a.unlock()}.bind(this),cancel:function(){this.fragmentEditor.pointerManager.enable(),a.unlock()}.bind(this),sliding:function(t,e){s.val(e.value).trigger("change")}.bind(this)},{min:30,max:120,step:10,value:t})))}.bind(this)}],{forceLtr:!0,verticalAlign:"top",onClose:function(){e!==s&&e.call()}.bind(this)})},t.prototype.getContextMenuItems=function(){var t,e=N2Classes.ComponentAbstract.prototype.getContextMenuItems.call(this),i={desktopPortrait:n2_("Desktop"),desktopLandscape:n2_("Large desktop"),tabletPortrait:n2_("Tablet"),tabletLandscape:n2_("Large tablet"),mobilePortrait:n2_("Mobile"),mobileLandscape:n2_("Large mobile")},s=this.fragmentEditor.editor.getAvailableDeviceModes(),n=[],o=function(e,i){return{label:i,icon:"ssi_16 ssi_16--eye",action:function(t){return t.setData(a(e,i)),this.setProperty(e,0),!1}.bind(this)}}.bind(this),a=function(e,i){return{label:i,icon:"ssi_16 ssi_16--hide",action:function(t){return t.setData(o(e,i)),this.setProperty(e,1),!1}.bind(this)}}.bind(this);for(t in s)s[t]&&(parseInt(this.getProperty(t))?n.push(o(t,i[t])):n.push(a(t,i[t])));return e.push({priority:57,label:n2_("Hide on"),icon:"ssi_16 ssi_16--hide",items:n}),e},t.prototype.getName=function(){return!this.property.nameSynced&&this.property.name||this.getDefaultName()},t.prototype.editName=function(){this.activate(!1),new N2Classes.InlineTextEditor(this.layerTitleSpan[0],{onSave:function(t){this.rename(t,!0)}.bind(this),onCancel:function(){this.layerTitleSpan.text(this.getName())}.bind(this),onTab:function(t){for(var e=r(".n2_layer_navigation_list_layer__title_label_rename"),i=0;i<e.length;i++)if(this.$layerRowRename.is(e[i])){t.shiftKey?i--:i++;break}i<0?i=e.length-1:i>=e.length&&(i=0),e.eq(i).trigger("click")}.bind(this)})},t.prototype.rename=function(t,e){(this.property.nameSynced||e)&&(e&&(this.property.nameSynced=0),""===t&&(e&&(this.property.nameSynced=1),t=this.getDefaultName()),t=t.trim().substr(0,35),this.property.name!==t&&(this.property.name=t,this.$.trigger("layerRenamed",t)),this.layerTitleSpan.text(t),this===this.fragmentEditor.activeLayer&&this.fragmentEditor.layerWindow.setTitle(this))},t.prototype.getPlacement=function(){var t=this.layer.data("pm");return t!==s?t:"slide"===this.group.type?"absolute":"normal"},t.prototype._start=function(t){this.createRow();var e=this.layer.find("> .n2-ss-layer-mask");e.length&&(this.wraps.mask=e),this._synccrop(),this._syncrotation(),this._synczindex(),this.placement.start(),this.placement.setMode(this.getPlacement(),this.originalProperties),this.animations.init(),this.setGroup(this.group),this.fragmentEditor.$.triggerHandler("layerCreated",this),this.animations.load(),t&&(this.refreshBaseSize(),this.$.triggerHandler("created")),this.afterStart(t)},t.prototype._createLayerListRow=function(t){N2Classes.ComponentAbstract.prototype._createLayerListRow.call(this,t),this.isRenameAllowed&&(this.$layerRowRename=r('<div class="n2_layer_navigation_list_layer__title_label_rename"><i class="ssi_16 ssi_16--rename"></i></div>').on("click",function(){N2Classes.WindowManager.actionPrevent("ComponentRowActivate"),this.editName()}.bind(this)).insertAfter(this.$layerRowIcon),nextend.tooltip.addElement(this.$layerRowRename,n2_("Rename"))),this.$layerRowIcon.attr("data-action","hide-show").on("click",this.toggleHideShow.bind(this)),nextend.tooltip.addElement(this.$layerRowIcon,n2_("Show/Hide in editor"))},t.prototype.updateAnimations=function(){N2Classes.LayerNavigationTimeline.get().layerWindowEditor.update(this),this.layerTitle.toggleClass("n2_layer_navigation_list_layer__title--has-animations",this.animations.hasAnimation())},t.prototype.createLayerAnimations=function(t,e){var i,s=[];if(!this.animations||(i=new N2Classes.FrontendLayerAnimationManager(this,this.layer,this.fragmentEditor.editor.frontend.getPerspective())).setLinear(this,this.fragmentEditor.editor.getDeviceMode(),t,e)&&s.push(i),this.container)for(var n=this.container.getSortedLayers(),o=0;o<n.length;o++)s.push.apply(s,n[o].createLayerAnimations(t,e));return s},t.prototype.changeEditorMode=function(t){parseInt(this.property[t])?this._show():this._hide(),N2Classes.LayerDataStorage.prototype.changeEditorMode.call(this,t)},t.prototype._synccrop=function(){var t=this.getProperty("crop");"auto"===t&&(t="hidden"),"mask"===t?(t="hidden",this.addWrap("mask","<div class='n2-ss-layer-mask'></div>")):(this.removeWrap("mask"),this.layer.data("animatableselector",null)),this.layer.css("overflow",t)},t.prototype._syncrotation=function(){var t,e=parseFloat(this.getProperty("rotation"));e/360!=0?(t=this.addWrap("rotation","<div class='n2-ss-layer-rotation'></div>"),NextendTween.set(t[0],{rotationZ:e})):this.removeWrap("rotation")},t.prototype._synczindex=function(){var t=parseInt(this.getProperty("zindex"));isNaN(t)||2===t?this.layer.css("zIndex",""):this.layer.css("zIndex",t)},t.prototype._syncclass=function(){!1!==this._lastClasses&&this.layer.removeClass(this._lastClasses);var t=this.fragmentEditor.editor.generator.fill(this.getProperty("class"));t&&""!=t?(this.layer.addClass(t),this._lastClasses=t):this._lastClasses=!1},t.prototype.addWrap=function(t,e){if(this.wraps[t]===s){var i=r(e);switch(this.wraps[t]=i,t){case"mask":i.appendTo(this.layer),this.wraps.rotation!==s?i.append(this.wraps.rotation):i.append(this.getContents()),this.layer.data("animatableselector",".n2-ss-layer-mask:first");break;case"rotation":this.wraps.mask!==s?i.appendTo(this.wraps.mask):i.appendTo(this.layer),i.append(this.getContents())}}return this.wraps[t]},t.prototype.removeWrap=function(t){if(this.wraps[t]!==s){switch(t){case"mask":this.wraps.rotation!==s?this.layer.append(this.wraps.rotation):this.layer.append(this.getContents());break;case"rotation":(this.wraps.mask!==s?this.wraps.mask:this.layer).append(this.getContents())}this.wraps[t].remove(),delete this.wraps[t]}},t.prototype.getContextMenuCopySubItems=function(){var t=N2Classes.ComponentAbstract.prototype.getContextMenuCopySubItems.call(this);return this.isAnimatable&&this.animations.hasAnimation()&&t.push({label:n2_("Animation"),icon:"ssi_16 ssi_16--animation",action:function(){localStorage.setItem("layerAnimationCopied",JSON.stringify(this.animations.getData()))}.bind(this)}),t},t.prototype.getContextMenuPasteSubItems=function(){var t,e=N2Classes.ComponentAbstract.prototype.getContextMenuPasteSubItems.call(this);return!this.isAnimatable||null!==(t=localStorage.getItem("layerAnimationCopied"))&&e.push({label:n2_("Animation"),icon:"ssi_16 ssi_16--animation",action:function(){this.animations.loadData(JSON.parse(t))}.bind(this)}),e},t.prototype.convertToNormal=function(){if("layer"===this.type||"row"===this.type){for(var t=this.fragmentEditor.mainContainer.mainContent,e=this.group;e;){if("content"===e.type||"col"===e.type){t=e;break}e=e.group}this.layer.css({position:"relative",width:"",left:"",top:""}),t!==this.group&&(s=this.getIndex(),t.container.insertLayerAt(this,0),this.onCanvasUpdate(s,t,0));var i=this.placement.setMode("normal"),s=N2Classes.History.get().addValue(this,this.historyConvertPlacement,[]);s&&s.setValues({placement:"absolute",placementData:i},{placement:"normal"})}},t.prototype.convertToAbsolute=function(){var t,e,i,s;"layer"!==this.type&&"row"!==this.type||(this.getIndex(),this.group,t=this.layer.width(),e=this.layer.height(),N2Classes.History.get().startBatch(),i=this.placement.setMode("absolute"),(s=N2Classes.History.get().addValue(this,this.historyConvertPlacement,[]))&&s.setValues({placement:"normal",placementData:i},{placement:"absolute"}),N2Classes.History.get().addControl("skipForwardUndos"),"layer"===this.type&&this.item&&(this.item.needWidth||t++,this.item.needHeight||(e="auto")),this.placement.current._setPosition("center","middle",0,0,t,e,!1),N2Classes.History.get().endBatch())},t.prototype.historyConvertPlacement=function(t){t.placementData&&this.layer.data(t.placementData),this.placement.setMode(t.placement),t.placementData&&this.placement.sync()},t}),N2D("Content",["ContentAbstract"],function(s,t){"use strict";function e(t,e,i){this.label=n2_("Content"),this.type="content",this.isRenameAllowed=!1,this.innerContainer="> .n2-ss-layer-content",this._defaults=s.extend({verticalalign:"center",selfalign:"center"},this._defaults),this.localStyle=[{group:"normal",selector:"-inner",css:{transition:"transition:all .3s;transition-property:border,background-image,background-color,border-radius,box-shadow;"}},{group:"hover",selector:"-inner:HOVER",css:{}}],N2Classes.ContentAbstract.prototype.constructor.call(this,t,e,i),this.placement.allow("default"),e.setMainContent(this)}return((e.prototype=Object.create(N2Classes.ContentAbstract.prototype)).constructor=e).getRegistryDataToFields=function(t){var e={maxwidth:s("#layercontent-maxwidth"),selfalign:s("#layercontent-selfalign"),padding:s("#layercontent-padding"),inneralign:s("#layercontent-inneralign"),verticalalign:s("#layercontent-verticalalign"),stylemode:s("#layerfields-content-background-mode"),bgcolor:s("#layercontent-background-color"),bgimage:s("#layercontent-background-image"),bgimagex:s("#layercontent-background-focus-x"),bgimagey:s("#layercontent-background-focus-y"),bgcolorgradient:s("#layercontent-background-gradient"),bgcolorgradientend:s("#layercontent-background-color-end"),opened:s("#layercontent-opened")};return t.initStyleMode("content",e.stylemode,[]),t.fragmentEditor.editor.generator.registerField(e.bgimage),t.fragmentEditor.editor.generator.registerField(e.bgcolor),t.fragmentEditor.editor.generator.registerField(e.bgcolorgradientend),e},e.prototype.getIcon=function(){return"ssi_16 ssi_16--content"},e.prototype.addProperties=function(t){N2Classes.ContentAbstract.prototype.addProperties.call(this,t),this.createDeviceProperty("selfalign",{desktopPortrait:this._defaults.selfalign||"inherit"},t)},e.prototype.getRootElement=function(){return this.layer},e.prototype.getBackgroundElement=function(){return this.layer},e.prototype.getPlacement=function(){return"default"},e.prototype._createLayer=function(){return s('<div class="n2-ss-layer n2-ss-content-empty"><div class="n2-ss-section-main-content n2-ss-layer-content"></div></div>').attr("data-sstype",this.type)},e.prototype.createRow=function(){this.$content=this.layer.find(".n2-ss-layer-content:first"),this.addClassElement(this.layer),this.addClassElement(this.$content,"-inner"),this.container=new N2Classes.LayerContainer(this),this.container.setLayerContainerElement(this.$content),this._createLayerListRow();var t=s('<div class="n2_layer_navigation_list_layer__title_label_folder" data-action="open-close"><i class="ssi_16"></i></div>').on("click",this.switchOpened.bind(this)).prependTo(this.$rowLabel);nextend.tooltip.addElement(t,n2_("Open/Close")),this.container.$ul.appendTo(this.layerRow),this.readyDeferred.done(this._syncopened.bind(this))},e.prototype.create=function(){this.originalProperties.adaptivefont=1,N2Classes.ContentAbstract.prototype.create.call(this),this._syncselfalign(),this._onReady()},e.prototype.load=function(t,e){N2Classes.ContentAbstract.prototype.load.call(this,t,e),this._syncselfalign(),this._onReady()},e.prototype.delete=function(){for(var t=this.container.getSortedLayers(),e=0;e<t.length;e++)t[e].delete()},e.prototype.remove=function(){this._delete()},e.prototype.update=function(){this.group.update()},e.prototype.onChildCountChange=function(){var t=this.container.getSortedLayers();this.layer.toggleClass("n2-ss-content-empty",0===t.length)},e.prototype.renderModeProperties=function(t){N2Classes.ContentAbstract.prototype.renderModeProperties.call(this,t),this._syncselfalign()},e.prototype._syncselfalign=function(){this.layer.attr("data-cssselfalign",this.getProperty("selfalign")),this.update()},e.prototype.duplicate=function(t){},e}),N2D("ContentAbstract",["LayerContainer","ComponentCommonAbstract"],function(r,h){"use strict";function t(t,e,i){this._defaults=r.extend({verticalalign:"center"},this._defaults),this._syncbgThrottled=NextendThrottle(this._syncbgThrottled,50),this.stylemode="",N2Classes.ComponentCommonAbstract.prototype.constructor.call(this,t,e,i)}return((t.prototype=Object.create(N2Classes.ComponentCommonAbstract.prototype)).constructor=t).prototype.addProperties=function(t){this.createProperty("opened",1,t,this),N2Classes.ComponentCommonAbstract.prototype.addProperties.call(this,t),this.createProperty("bgimage","",t),this.createProperty("bgimagex",50,t),this.createProperty("bgimagey",50,t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolor","00000000",{"-hover":h},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolorgradient","off",{"-hover":h},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolorgradientend","00000000",{"-hover":h},this,"stylemode"),t),this.createDeviceProperty("verticalalign",{desktopPortrait:this._defaults.verticalalign},t),this.createDeviceProperty("maxwidth",{desktopPortrait:0},t),this.createDeviceProperty("inneralign",{desktopPortrait:"inherit"},t),this.createDeviceProperty("padding",{desktopPortrait:"10|*|10|*|10|*|10|*|px+"},t),this.$.on("baseSizeUpdated.contentAbstract",this._syncpadding.bind(this))},t.prototype.getBackgroundElement=function(){return this.$content},t.prototype.getPaddingElement=function(){return this.$content},t.prototype.create=function(t){N2Classes.ComponentCommonAbstract.prototype.create.apply(this,arguments),this.initUI(),this._syncverticalalign(),this._syncmaxwidth(),this._syncpadding(),this._syncinneralign(),this._syncbgThrottled()},t.prototype.load=function(t,e){N2Classes.ComponentCommonAbstract.prototype.load.call(this,t,e),this.initUI(),this._syncverticalalign(),this._syncmaxwidth(),this._syncpadding(),this._syncinneralign(),this._syncbgThrottled(),this.container.startWithExistingNodes(e)},t.prototype.initUI=function(){this.uiSpacing=new N2Classes.UISpacingPadding(this.getPaddingElement(),this.fragmentEditor,{stop:this.onSpacingStop.bind(this)}),this.editorUI.padding=this.uiSpacing.$handles,this.uiResizeNormal=new N2Classes.UIResizeNormal(this.layer,this.fragmentEditor,{start:function(t,e){"maxwidth"===e&&this.layer.attr("data-has-maxwidth","1")}.bind(this),stopMaxWidth:function(t,e){this.setProperty("maxwidth",e.value)}.bind(this)}),this.editorUI.normalSizing=this.uiResizeNormal.$handles},t.prototype.doubleClick=function(){r('[data-tab="layer"]').trigger("click")},t.prototype.onSpacingStop=function(t,e){var i,s=this.getPadding().split("|*|"),n=1,o=1;for(i in"px+"===s[s.length-1]&&1<Math.abs(parseFloat(this.layer.css("fontSize"))-this.baseSize)&&(n=this.fragmentEditor.getResponsiveRatioHorizontal(),o=this.fragmentEditor.getResponsiveRatioVertical()),e.changed){var a=e.changed[i];switch(i){case"top":s[0]=Math.round(a/o);break;case"right":s[1]=Math.round(a/n);break;case"bottom":s[2]=Math.round(a/o);break;case"left":s[3]=Math.round(a/n)}}this.setProperty("padding",s.join("|*|")),r("#layercol-padding").data("field").insideChange(s.join("|*|"))},t.prototype.switchOpened=function(t){t.preventDefault(),N2Classes.WindowManager.actionPrevent("ComponentRowActivate"),this.layerRow.hasClass("n2_layer_navigation_list_layer--closed")?this.setProperty("opened",1):this.setProperty("opened",0)},t.prototype._syncopened=function(){this.getProperty("opened")?(this.layerRow.removeClass("n2_layer_navigation_list_layer--closed"),this.container.$ul.css("display",""),this.layer.triggerHandler("opened")):(this.layerRow.addClass("n2_layer_navigation_list_layer--closed"),this.container.$ul.css("display","none"),this.layer.triggerHandler("closed"))},t.prototype.forceOpen=function(){this.layerRow.hasClass("n2_layer_navigation_list_layer--closed")&&(this.layerRow.removeClass("n2_layer_navigation_list_layer--closed"),this.container.$ul.css("display",""),this.layer.triggerHandler("opened"))},t.prototype.removeForceOpen=function(){this.getProperty("opened")||this.layerRow.hasClass("n2_layer_navigation_list_layer--closed")||(this.layerRow.addClass("n2_layer_navigation_list_layer--closed"),this.container.$ul.css("display","none"),this.layer.triggerHandler("closed"))},t.prototype.getPadding=function(){return this.getProperty("padding")},t.prototype._syncpadding=function(){var t=this.getPadding().split("|*|"),e=t.pop(),i=this.baseSize;if("px+"===e&&0<i){e="em";for(var s=0;s<t.length;s++)t[s]=parseInt(t[s])/i}e=t.join(e+" ")+e;this.getPaddingElement().css("padding",e),this.update(),this.uiSpacing&&this.uiSpacing.setOption("current",e)},t.prototype._syncmaxwidth=function(){var t=parseInt(this.getProperty("maxwidth"));t<=0||isNaN(t)?(this.layer.css("maxWidth","").attr("data-has-maxwidth","0"),this.uiResizeNormal.setMaxWidth(-1)):(this.layer.css("maxWidth",t+"px").attr("data-has-maxwidth","1"),this.uiResizeNormal.setMaxWidth(t)),this.update()},t.prototype.getInnerAlign=function(){return this.getProperty("inneralign")},t.prototype._syncinneralign=function(){this.layer.attr("data-csstextalign",this.getInnerAlign()),this.refreshTextAlign(),this.update()},t.prototype.getVerticalAlign=function(){return this.getProperty("verticalalign")},t.prototype._syncverticalalign=function(){this.$content.attr("data-verticalalign",this.getVerticalAlign()),this.update()},t.prototype._syncbgimage=t.prototype._syncbgimagex=t.prototype._syncbgimagey=t.prototype._syncbgcolor=t.prototype._syncbgcolorgradient=t.prototype._syncbgcolorgradientend=t.prototype["_syncbgcolor-hover"]=t.prototype["_syncbgcolorgradient-hover"]=t.prototype["_syncbgcolorgradientend-hover"]=function(){this._syncbgThrottled()},t.prototype._syncbgThrottled=function(){var t="",e=this.fragmentEditor.editor.generator.fill(this.getProperty("bgimage")),i="";""!==e&&(l=parseInt(this.getProperty("bgimagex")),isFinite(l)||(l=50),d=parseInt(this.getProperty("bgimagey")),isFinite(d)||(d=50),t+='URL("'+nextend.imageHelper.fixed(e)+'") '+l+"% "+d+"% / cover no-repeat",i=" "+l+"% "+d+"% / cover no-repeat");var s=this.fragmentEditor.editor.generator.fill(this.getProperty("bgcolor")),n=this.getProperty("bgcolorgradient"),o=this.fragmentEditor.editor.generator.fill(this.getProperty("bgcolorgradientend")),a=this.getBackgroundCSS(s,n,o,t,i);this.addLocalStyle("normal","bgcolor",a);var r="",e=!1,l=this.getProperty("bgcolor-hover"),d=this.getProperty("bgcolorgradient-hover"),a=this.getProperty("bgcolorgradientend-hover");l!==h&&l!==s&&(e=!0),d!==h&&d!==n&&(e=!0),a!==h&&a!==o&&(e=!0),e&&(l===h&&(l=s),d===h&&(d=n),a===h&&(a=o),r=this.getBackgroundCSS(l,d,a,t,i)),this.addLocalStyle("hover","bgcolor",r)},t.prototype.getBackgroundCSS=function(t,e,i,s,n){if(0!==N2Color.hex2alpha(t)||"off"!==e&&0!==N2Color.hex2alpha(i)){var o=""!==s?n+","+s:"";switch(e){case"horizontal":return"background:linear-gradient(to right, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"vertical":return"background:linear-gradient(to bottom, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"diagonal1":return"background:linear-gradient(45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"diagonal2":return"background:linear-gradient(135deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"off":default:return""!==s?"background: linear-gradient("+N2Color.hex2rgbaCSS(t)+", "+N2Color.hex2rgbaCSS(t)+")"+o+";":"background:"+N2Color.hex2rgbaCSS(t)+";"}}else if(""!==s)return"background:"+s+";";return""},t.prototype.getData=function(t){var e=N2Classes.ComponentCommonAbstract.prototype.getData.call(this,t);return t.layersIncluded&&(e.layers=this.container.getData(t)),e},t.prototype.onChildCountChange=function(){this.layer.toggleClass("n2-ss-content-empty",0===this.container.getLayerCount()),this.update()},t.prototype.renderModeProperties=function(t){N2Classes.ComponentCommonAbstract.prototype.renderModeProperties.call(this,t),this._syncverticalalign(),this._syncmaxwidth(),this._syncpadding(),this._syncinneralign()},t.prototype.getDroppable=function(){return this.layer.is(":visible")&&this.status!==N2Classes.ComponentAbstract.STATUS.HIDDEN?{$container:this.$content,layer:this,placement:"normal",axis:"y"}:"hidden"},t.prototype.getLLDroppable=function(t){if(this.getProperty("opened")){if("absolute"===t.placement.getType())return{$container:this.container.$ul,layer:this};if("normal"===t.placement.getType())switch(t.type){case"layer":case"row":return{$container:this.container.$ul,layer:this}}}return!1},t.prototype.getContents=function(){return this.$content},t.prototype.setPropertystylemode=function(t,e,i){this.stylemode=e,this.syncAdvancedField("bgcolor"),this.syncAdvancedField("bgcolorgradient"),this.syncAdvancedField("bgcolorgradientend")},t.prototype.onSyncFields=function(){this.fragmentEditor.layerOptions.updateField("stylemode",this.stylemode)},t.prototype.getContextMenuCopySubItems=function(){var t=N2Classes.ComponentCommonAbstract.prototype.getContextMenuCopySubItems.call(this);return t.push({label:n2_("Child layers"),icon:"ssi_16 ssi_16--layer",action:function(){this.fragmentEditor.clipboard.componentCopy(this)}.bind(this)}),t},t}),N2D("Layer",["ComponentCommonAbstract"],function(t,e){"use strict";function i(t,e,i){this.label=n2_("Layer"),this.type="layer",this.item=null,this.parent=!1,this.itemEditor=t.itemEditor,N2Classes.ComponentCommonAbstract.prototype.constructor.call(this,t,e,i),this.placement.allow("normal"),this.placement.allow("absolute")}return((i.prototype=Object.create(N2Classes.ComponentCommonAbstract.prototype)).constructor=i).prototype.getSubType=function(){return this.item.type},i.prototype.getLabel=function(){return this.item.getLabel()},i.prototype.hasTextScale=function(){return this.item.hasTextScale()},i.prototype.create=function(){N2Classes.ComponentCommonAbstract.prototype.create.apply(this,arguments),this._onReady()},i.prototype.load=function(t,e){N2Classes.ComponentCommonAbstract.prototype.load.call(this,t,e),this._onReady()},i.prototype.onBeforeStart=function(){var t=this.layer.find(".n2-ss-item");new N2Classes[this.itemEditor.getItemClass(t.data("item"))](t,this,this.itemEditor),new N2Classes.UICanvasItem(this.layer,{canvasUIManager:this.fragmentEditor.canvasUIManager,layer:this,$layer:this.layer}),this.item.needWidth&&this.layer.addClass("n2-ss-layer--need-width"),this.item.needHeight&&this.layer.addClass("n2-ss-layer--need-height"),N2Classes.ComponentCommonAbstract.prototype.onBeforeStart.call(this)},i.prototype.doubleClick=function(){t('[data-related-tab="content"]').trigger("click"),this.item.itemEditor.focusFirst()},i.prototype.getDefaultName=function(){return this.item.getLabel()},i.prototype.getContent=function(){var t=this.layer,e=t.data("animatableselector");return e&&(t=t.find(e)),t},i.prototype._createLayer=function(){return t('<div class="n2-ss-layer"></div>').attr("data-sstype",this.type)},i.prototype.createRow=function(){this._createLayerListRow()},i.prototype.activate=function(t,e){N2Classes.ComponentCommonAbstract.prototype.activate.call(this,t,e),this.item?this.item.activate(e):console.error("The layer do not have item on it!")},i.prototype.getHTML=function(t){var e=N2Classes.ComponentCommonAbstract.prototype.getHTML.call(this,t),t=this.item.getHTML(t);return e.attr("style",e.attr("style")+this.getStyleText()).append(t),e},i.prototype.getData=function(t){var e=N2Classes.ComponentCommonAbstract.prototype.getData.call(this,t);return t.itemsIncluded&&(e.item=this.item.getData()),e},i.prototype.getStyleText=function(){var t="",e=this.property.crop;return"auto"!==e&&"mask"!==e||(e="hidden"),t+="overflow:"+e+";"},i.prototype.getContents=function(){return this.item.$item},i.prototype.onSelfChange=function(){N2Classes.ComponentCommonAbstract.prototype.onSelfChange.call(this),this.item.setSelf(this.self.item)},i.prototype.getContextMenuItems=function(){var t=N2Classes.ComponentCommonAbstract.prototype.getContextMenuItems.call(this);return t.push({priority:55,label:n2_("Duplicate"),icon:"ssi_16 ssi_16--duplicate",action:this.duplicate.bind(this)}),t.push({priority:1e3,label:n2_("Delete"),icon:"ssi_16 ssi_16--delete",action:this.delete.bind(this),color:"red"}),t},i.prototype.getContextMenuCopySubItems=function(){var t=N2Classes.ComponentCommonAbstract.prototype.getContextMenuCopySubItems.call(this);return t.unshift({label:n2_("Layer"),icon:"ssi_16 ssi_16--layer",action:function(){this.fragmentEditor.clipboard.componentCopy(this)}.bind(this)}),t},i}),N2D("LayerAdvancedProperty",function(t,e){"use strict";function i(t,e,i,s,n){this.basename=t,this.def=e,this.modesDef=i,this.obj=s,this.propName=n}return i.prototype.getBaseName=function(){return this.basename},i.prototype.getNames=function(){var t,e={};for(t in e[this.basename]=this.def,this.modesDef)e[this.basename+t]=this.modesDef[t];return e},i.prototype.getCurrentMode=function(){return this.obj[this.propName]},i.prototype.getName=function(){var t=this.getCurrentMode();return""!==t?this.basename+t:this.basename},i.prototype.getDefault=function(){var t=this.getCurrentMode();return""!==t?this.modesDef[t]:this.def},i.prototype.resetMode=function(t){var e;this.propName!==t||""!==(e=this.getCurrentMode())&&(t=this.obj.property[this.basename+e],this.obj.property[this.basename+e]=this.modesDef[e],this.obj.syncAdvancedField(this.basename),this.obj.render(this.basename+e,t,"manager"))},i}),N2D("Row",["LayerContainer","ComponentCommonAbstract"],function(r,p){"use strict";function t(t,e,i){this.label=n2_("Row"),this.type="row",this._syncbgThrottled=NextendThrottle(this._syncbgThrottled,50),this.innerContainer="> .n2-ss-layer-row > .n2-ss-layer-row-inner",this.localStyle=[{group:"normal",selector:"-inner",css:{transition:"transition:all .3s;transition-property:border,background-image,background-color,border-radius,box-shadow;"}},{group:"hover",selector:"-inner:HOVER",css:{}}],this.columnsField=r("#layerrow-columns").data("field"),this.refreshUI=NextendDeBounce(this.refreshUI,100),this.stylemode="",N2Classes.ComponentCommonAbstract.prototype.constructor.call(this,t,e,i),this.placement.allow("normal"),this.placement.allow("absolute")}return((t.prototype=Object.create(N2Classes.ComponentCommonAbstract.prototype)).constructor=t).getRegistryDataToFields=function(t){var e={padding:r("#layerrow-padding"),gutter:r("#layerrow-gutter"),fullwidth:r("#layerrow-fullwidth"),stretch:r("#layerrow-stretch"),wrapafter:r("#layerrow-wrap-after"),inneralign:r("#layerrow-inneralign"),href:r("#layerrow-href"),"href-target":r("#layerrow-href-target"),bgimage:r("#layerrow-background-image"),bgimagex:r("#layerrow-background-focus-x"),bgimagey:r("#layerrow-background-focus-y"),stylemode:r("#layerfields-row-background-mode"),bgcolor:r("#layerrow-background-color"),bgcolorgradient:r("#layerrow-background-gradient"),bgcolorgradientend:r("#layerrow-background-color-end"),borderwidth:r("#layerrow-border-width"),borderstyle:r("#layerrow-border-style"),bordercolor:r("#layerrow-border-color"),borderradius:r("#layerrow-border-radius"),boxshadow:r("#layerrow-boxshadow"),opened:r("#layerrow-opened")};return t.initStyleMode("row",e.stylemode,["#layerfields-row-border-mode"]),t.fragmentEditor.editor.generator.registerField(e.href),t.fragmentEditor.editor.generator.registerField(e.bgimage),t.fragmentEditor.editor.generator.registerField(e.bgcolor),t.fragmentEditor.editor.generator.registerField(e.bgcolorgradientend),e},t.prototype.getIcon=function(){return"ssi_16 ssi_16--row"},t.prototype.addProperties=function(t){this.createProperty("opened",1,t,this),N2Classes.ComponentCommonAbstract.prototype.addProperties.call(this,t),this.createProperty("href","",t),this.createProperty("href-target","_self",t),this.createProperty("bgimage","",t),this.createProperty("bgimagex",50,t),this.createProperty("bgimagey",50,t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolor","00000000",{"-hover":p},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolorgradient","off",{"-hover":p},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolorgradientend","00000000",{"-hover":p},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("borderwidth","0|*|0|*|0|*|0",{"-hover":p},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("borderstyle","solid",{"-hover":p},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bordercolor","ffffffff",{"-hover":p},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("borderradius",0,{"-hover":p},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("boxshadow","0|*|0|*|0|*|0|*|00000080",{"-hover":p},this,"stylemode"),t),this.createProperty("fullwidth",1,t),this.createProperty("stretch",0,t),this.createDeviceProperty("inneralign",{desktopPortrait:"inherit"},t),this.createDeviceProperty("padding",{desktopPortrait:"10|*|10|*|10|*|10|*|px+"},t),this.createDeviceProperty("gutter",{desktopPortrait:20},t),this.createDeviceProperty("wrapafter",{desktopPortrait:0,mobilePortrait:1,mobileLandscape:1},t),this.$.on("baseSizeUpdated.row",this._syncpadding.bind(this))},t.prototype.historyDeleteSelf=function(){this.delete()},t.prototype.historyCreateSelf=function(t,e,i){t=new N2Classes.Row(this.fragmentEditor,t.getSelf(),{});t.create(e),this.setSelf(t);for(var s=t.container.getSortedLayers(),n=0;n<s.length;n++)i[n].setSelf(s[n])},t.prototype.create=function(t){function e(t){return r("<div class='n2-ss-layer'></div>").append(r("<div class='n2-ss-layer-row'></div>").append(r("<div class='n2-ss-layer-row-inner'></div>").append(t))).attr("data-sstype","row")}function i(t){return r("<div class='n2-ss-layer' data-sstype='col'></div>").append(r("<div class='n2-ss-layer-col n2-ss-layer-content'></div>").append(t))}var s;switch(t){case"structure-2col":s=e([i(),i()]);break;case"structure-3col":s=e([i(),i(),i()]);break;case"structure-1col":default:s=e([i()])}"slide"===this.group.type&&(this.originalProperties=r.extend({width:"100%",align:"center",valign:"top",top:20},this.originalProperties)),N2Classes.ComponentCommonAbstract.prototype.create.call(this,s),this.initUI(),this.container.startWithExistingNodes(!1),this._syncpadding(),this._syncinneralign(),this._syncfullwidth(),this._syncstretch(),this._syncbgThrottled(),this._syncborder(),this._syncborderradius(),this._syncboxshadow(),this.renderModeProperties(),this.container.renderModeProperties(),N2Classes.History.get().addSimple(this,this.historyDeleteSelf,this.historyCreateSelf,[this.group,t,this.container.getSortedLayers()]),this._onReady()},t.prototype.load=function(t,e){N2Classes.ComponentCommonAbstract.prototype.load.call(this,t,e),this.initUI(),this.container.startWithExistingNodes(e),this._syncpadding(),this._syncinneralign(),this._syncfullwidth(),this._syncstretch(),this._syncbgThrottled(),this._syncborder(),this._syncborderradius(),this._syncboxshadow(),this._onReady()},t.prototype.initUI=function(){new N2Classes.UICanvasItem(this.layer,{canvasUIManager:this.fragmentEditor.canvasUIManager,layer:this,$layer:this.layer}),this.uiSpacing=new N2Classes.UISpacingPadding(this.$row,this.fragmentEditor,{stop:this.____makeLayerResizeableStop.bind(this)}),this.editorUI.padding=this.uiSpacing.$handles,this.editorUI.columns=this.uiColumns=new N2Classes.UIColumns(this.$row,this.fragmentEditor,{columns:"1",gutter:this.getGutter(),start:function(t,e){N2Classes.PositionDisplay.get().show("Columns")}.bind(this),colwidth:function(t,e){this.updateColumnWidth(e.currentPercent),N2Classes.PositionDisplay.get().update(t,"Columns",Math.round(100*e.currentPercent[e.index])+"% &mdash; "+Math.round(100*e.currentPercent[e.index+1])+"%")}.bind(this),stop:function(t,e){N2Classes.PositionDisplay.get().hide("Columns"),this.setRealColsWidth(e.currentFractions)}.bind(this)})},t.prototype.doubleClick=function(){r('[data-tab="row"]').trigger("click")},t.prototype.____makeLayerResizeableStop=function(t,e){var i,s=this.getPadding().split("|*|"),n=1,o=1;for(i in"px+"==s[s.length-1]&&1<Math.abs(parseFloat(this.layer.css("fontSize"))-this.baseSize)&&(n=this.fragmentEditor.getResponsiveRatioHorizontal(),o=this.fragmentEditor.getResponsiveRatioVertical()),e.changed){var a=e.changed[i];switch(i){case"top":s[0]=Math.round(a/o);break;case"right":s[1]=Math.round(a/n);break;case"bottom":s[2]=Math.round(a/o);break;case"left":s[3]=Math.round(a/n)}}this.setProperty("padding",s.join("|*|")),r("#layerrow-padding").data("field").insideChange(s.join("|*|"))},t.prototype._createLayer=function(){return r('<div class="n2-ss-layer"><div class="n2-ss-layer-row"><div class="n2-ss-layer-row-inner"></div></div></div>').attr("data-sstype",this.type)},t.prototype.historyDeleteCol=function(t,e){e.getSelf().delete()},t.prototype.historyCreateCol=function(t,e){t=t.getSelf().createCol();e.setSelf(t)},t.prototype.createCol=function(){var t=new N2Classes.Col(this.fragmentEditor,this,{});return N2Classes.History.get().addSimple(this,this.historyDeleteCol,this.historyCreateCol,[this,t]),t.create(t._createLayer()),this.isReady()&&this.placement.updatePosition(),t},t.prototype.createRow=function(){this.$row=this.layer.find(".n2-ss-layer-row:first"),this.$rowInner=this.$row.find(".n2-ss-layer-row-inner:first"),0===this.$rowInner.length&&(this.$rowInner=r('<div class="n2-ss-layer-row-inner"></div>').append(this.$row.find("> *")).appendTo(this.$row)),this.container=new N2Classes.LayerContainer(this),this.container.setLayerContainerElement(this.$rowInner),this.addClassElement(this.layer),this.addClassElement(this.$row,"-inner"),this._createLayerListRow();var t=r('<div class="n2_layer_navigation_list_layer__title_label_folder" data-action="open-close"><i class="ssi_16"></i></div>').prependTo(this.$rowLabel).on("click",this.switchOpened.bind(this));nextend.tooltip.addElement(t,n2_("Open/Close")),this.container.$ul.appendTo(this.layerRow),this.readyDeferred.done(this._syncopened.bind(this))},t.prototype.activate=function(){N2Classes.ComponentCommonAbstract.prototype.activate.apply(this,arguments),this.columnsField.setRow(this),this.uiColumns.setOption("active",1)},t.prototype.deActivate=function(){this.uiColumns.setOption("active",0),N2Classes.ComponentCommonAbstract.prototype.deActivate.apply(this,arguments)},t.prototype.switchOpened=function(t){t.preventDefault(),N2Classes.WindowManager.actionPrevent("ComponentRowActivate"),this.layerRow.hasClass("n2_layer_navigation_list_layer--closed")?this.setProperty("opened",1):this.setProperty("opened",0)},t.prototype._syncopened=function(){this.getProperty("opened")?(this.layerRow.removeClass("n2_layer_navigation_list_layer--closed"),this.container.$ul.css("display",""),this.layer.triggerHandler("opened")):(this.layerRow.addClass("n2_layer_navigation_list_layer--closed"),this.container.$ul.css("display","none"),this.layer.triggerHandler("closed"))},t.prototype.forceOpen=function(){this.layerRow.hasClass("n2_layer_navigation_list_layer--closed")&&(this.layerRow.removeClass("n2_layer_navigation_list_layer--closed"),this.container.$ul.css("display",""),this.layer.triggerHandler("opened"))},t.prototype.removeForceOpen=function(){this.getProperty("opened")||this.layerRow.hasClass("n2_layer_navigation_list_layer--closed")||(this.layerRow.addClass("n2_layer_navigation_list_layer--closed"),this.container.$ul.css("display","none"),this.layer.triggerHandler("closed"))},t.prototype.getSortedColumns=function(){for(var t=this.container.getSortedLayers(),e=[],i=0;i<t.length;i++)t[i]instanceof N2Classes.Col&&e.push(t[i]);return e},t.prototype.getColumns=function(){for(var t=this.getSortedColumns(),e=[],i=0;i<t.length;i++)e.push(t[i].getProperty("colwidth"));return e.join("+")},t.prototype.getColumnsOrdered=function(){for(var t=this.getOrderedColumns(),e=[],i=0;i<t.length;i++)e.push(t[i].getProperty("colwidth"));return e.join("+")},t.prototype._synccolumns=function(){for(var t=this.getSortedColumns(),e=0;e<t.length;e++)t[e]._synccolwidth();this.update()},t.prototype.getPadding=function(){return this.getProperty("padding")},t.prototype._syncpadding=function(){var t=this.getPadding().split("|*|"),e=t.pop(),i=this.baseSize;if("px+"===e&&0<i){e="em";for(var s=0;s<t.length;s++)t[s]=parseInt(t[s])/i}e=t.join(e+" ")+e;this.$row.css("padding",e),this.uiSpacing&&this.uiSpacing.setOption("current",e),this.update()},t.prototype.getGutter=function(){return this.getProperty("gutter")},t.prototype._syncgutter=function(){var t=this.getGutter(),e=t/2,i=this.getSortedColumns();if(0<i.length)for(var s=i.length-1;0<=s;s--)i[s].layer.css("margin",e+"px");this.$rowInner.css({width:"calc(100% + "+(t+1)+"px)",margin:-e+"px"}),this.uiColumns.setOption("gutter",this.getGutter()),this._syncwrapafter(),this.update()},t.prototype._syncwrapafter=function(){if(!this.isDeleted&&!this.isDeleteStarted){var t=parseInt(this.getProperty("wrapafter")),e=this.getOrderedColumns(),i=!1;for(o=e.length-1;0<=o;o--)e[o].showsOnCurrent||e.splice(o,1);var s=e.length;if(0<t&&t<s&&(i=!0),this.$row.attr("row-wrapped",i?1:0),i){for(var n=[],o=0;o<s;o++){var a=Math.floor(o/t);n[a]===p&&(n[a]=[]),n[a].push(e[o]),e[o].layer.attr("data-r",a).toggleClass("n2-ss-last-in-row",(o+1)%t==0||o===s-1)}var r=this.getGutter();for(o=0;o<n.length;o++){for(var l=n[o],d=0,h=0;h<l.length;h++)d+=l[h].getWidthPercentage();for(h=0;h<l.length;h++)l[h].layer.css("width","calc("+l[h].getWidthPercentage()/d*100+"% - "+(n2const.isIE||n2const.isEdge?r+1:r)+"px)")}}else{d=0;for(o=0;o<s;o++)d+=e[o].getWidthPercentage();for(o=0;o<s;o++)e[o].layer.css("width",e[o].getWidthPercentage()/d*100+"%").removeClass("n2-ss-last-in-row").attr("data-r",0);0<s&&e[s-1].layer.addClass("n2-ss-last-in-row")}this.update()}},t.prototype.getOrderedColumns=function(){return this.getSortedColumns().sort(function(t,e){return t.getRealOrder()-e.getRealOrder()})},t.prototype.getInnerAlign=function(){return this.getProperty("inneralign")},t.prototype._syncinneralign=function(){this.layer.attr("data-csstextalign",this.getInnerAlign()),this.refreshTextAlign()},t.prototype._syncfullwidth=function(){this.layer.attr("data-frontend-fullwidth",0==this.getProperty("fullwidth")?"0":"1"),this.update()},t.prototype._syncstretch=function(){this.layer.toggleClass("n2-ss-stretch-layer",1==this.getProperty("stretch"))},t.prototype._syncborderwidth=t.prototype._syncbordercolor=t.prototype._syncborderstyle=t.prototype["_syncborderstyle-hover"]=t.prototype["_syncbordercolor-hover"]=t.prototype["_syncborderwidth-hover"]=function(){this._syncborder()},t.prototype._syncborder=function(){var t=this.getProperty("borderstyle"),e=this.getProperty("bordercolor"),i=this.getProperty("borderwidth");this.addLocalStyle("normal","border",this.getBorderCSS(t,e,i));var s="",n=!1,o=this.getProperty("borderstyle-hover"),a=this.getProperty("bordercolor-hover"),r=this.getProperty("borderwidth-hover");o!==p&&o!=t&&(n=!0),a!==p&&a!=e&&(n=!0),r!==p&&r!=i&&(n=!0),n&&(o===p&&(o=t),a===p&&(a=e),r===p&&(r=i),s=this.getBorderCSS(o,a,r)),this.addLocalStyle("hover","border",s),this.update()},t.prototype.getBorderCSS=function(t,e,i){var s="";return"none"!==t&&(s+="border-color:"+N2Color.hex2rgbaCSS(e)+";",s+="border-style:"+t+";",s+="border-width:"+(i=i.split("|*|")).join("px ")+"px;"),s},t.prototype._syncborderradius=t.prototype["_syncborderradius-hover"]=function(){var t=this.getProperty("borderradius");0<=t&&this.addLocalStyle("normal","borderradius","border-radius:"+t+"px;");var e=this.getProperty("borderradius-hover");e&&e!=t&&this.addLocalStyle("hover","borderradius","border-radius:"+e+"px;")},t.prototype._syncboxshadow=t.prototype["_syncboxshadow-hover"]=function(){var t=this.getProperty("boxshadow");this.addLocalStyle("normal","boxshadow",this.getBoxShadowCSS(t.split("|*|")));var e="",i=this.getProperty("boxshadow-hover");i!==p&&i!=t&&(e=this.getBoxShadowCSS(i.split("|*|"))),this.addLocalStyle("hover","boxshadow",e)},t.prototype.getBoxShadowCSS=function(t){return 0==t[0]&&0==t[1]&&0==t[2]&&0==t[3]||0==N2Color.hex2alpha(t[4])?"":"box-shadow:"+t[0]+"px "+t[1]+"px "+t[2]+"px "+t[3]+"px "+N2Color.hex2rgbaCSS(t[4])+";"},t.prototype._synchref=t.prototype["_synchref-target"]=function(){},t.prototype._syncbgimage=t.prototype._syncbgimagex=t.prototype._syncbgimagey=t.prototype._syncbgcolor=t.prototype._syncbgcolorgradient=t.prototype._syncbgcolorgradientend=t.prototype["_syncbgcolor-hover"]=t.prototype["_syncbgcolorgradient-hover"]=t.prototype["_syncbgcolorgradientend-hover"]=function(){this._syncbgThrottled()},t.prototype._syncbgThrottled=function(){var t="",e=this.fragmentEditor.editor.generator.fill(this.getProperty("bgimage")),i="";""!=e&&(l=parseInt(this.getProperty("bgimagex")),isFinite(l)||(l=50),d=parseInt(this.getProperty("bgimagey")),isFinite(d)||(d=50),t+='URL("'+nextend.imageHelper.fixed(e)+'") '+l+"% "+d+"% / cover no-repeat",i=" "+l+"% "+d+"% / cover no-repeat");var s=this.fragmentEditor.editor.generator.fill(this.getProperty("bgcolor")),n=this.getProperty("bgcolorgradient"),o=this.fragmentEditor.editor.generator.fill(this.getProperty("bgcolorgradientend")),a=this.getBackgroundCSS(s,n,o,t,i);this.addLocalStyle("normal","bgcolor",a);var r="",e=!1,l=this.getProperty("bgcolor-hover"),d=this.getProperty("bgcolorgradient-hover"),a=this.getProperty("bgcolorgradientend-hover");l!==p&&l!=s&&(e=!0),d!==p&&d!=n&&(e=!0),a!==p&&a!=o&&(e=!0),e&&(l===p&&(l=s),d===p&&(d=n),a===p&&(a=o),r=this.getBackgroundCSS(l,d,a,t,i)),this.addLocalStyle("hover","bgcolor",r)},t.prototype.getBackgroundCSS=function(t,e,i,s,n){if(0!==N2Color.hex2alpha(t)||"off"!==e&&0!==N2Color.hex2alpha(i)){var o=""!==s?n+","+s:"";switch(e){case"horizontal":return"background:linear-gradient(to right, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"vertical":return"background:linear-gradient(to bottom, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"diagonal1":return"background:linear-gradient(45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"diagonal2":return"background:linear-gradient(135deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"off":default:return""!==s?"background: linear-gradient("+N2Color.hex2rgbaCSS(t)+", "+N2Color.hex2rgbaCSS(t)+")"+o+";":"background:"+N2Color.hex2rgbaCSS(t)+";"}}else if(""!==s)return"background:"+s+";";return""},t.prototype.getData=function(t){var e=N2Classes.ComponentCommonAbstract.prototype.getData.call(this,t);return t.itemsIncluded&&(e.cols=this.container.getData(t)),e},t.prototype.moveCol=function(t,e){this._moveCol(t,e);var i=N2Classes.History.get().addValue(this,this.historyMoveCol,[]);i&&i.setValues({oldIndex:e,newIndex:t},{oldIndex:t,newIndex:e})},t.prototype.moveColOrOrder=function(t,e){for(var i,s,n=this.container.getSortedLayers(),o=this.getSortedColumns(),a=o[t],r=o[e],l=0;l<n.length;l++)if(n[l]===a){i=l;break}for(l=0;l<n.length;l++)if(n[l]===r){s=l;break}if("desktopPortrait"===this.getMode())this.moveCol(i,s);else{var d=this.getOrderedColumns(),e=d[i];for(d.splice(i,1),d.splice(s,0,e),l=0;l<d.length;l++)d[l].setProperty("order",l+1);this.refreshUI()}},t.prototype._moveCol=function(t,e){var i=this.container.getSortedLayers();this.container.insertLayerAt(i[t],e),this.refreshUI()},t.prototype.historyMoveCol=function(t){this._moveCol(t.oldIndex,t.newIndex)},t.prototype.setColsWidth=function(t){for(var e=this.getSortedColumns(),i=0;i<t.length;i++)e[i].setProperty("colwidth",t[i].toFraction());this._syncwrapafter(),this.update(),this.refreshUI()},t.prototype.setRealColsWidth=function(t){for(var e=this.getOrderedColumns(),i=0;i<t.length;i++)e[i].setProperty("colwidth",t[i].toFraction());this._syncwrapafter(),this.update(),this.refreshUI()},t.prototype.updateColumnWidth=function(t){var e=parseInt(this.getProperty("wrapafter")),i=this.getOrderedColumns();for(o=i.length-1;0<=o;o--)i[o].showsOnCurrent||(i.splice(o,1),t.splice(o,1));var s=i.length;if(0<e&&e<s){for(var n=[],o=0;o<s;o++){var a=Math.floor(o/e);n[a]===p&&(n[a]=[]),i[o]._tempWidth=t[o],n[a].push(i[o])}var r=this.getGutter();for(o=0;o<n.length;o++){for(var l=n[o],d=0,h=0;h<l.length;h++)d+=l[h]._tempWidth;for(h=0;h<l.length;h++)l[h].layer.css("width","calc("+l[h]._tempWidth/d*100+"% - "+(n2const.isIE||n2const.isEdge?r+1:r)+"px)")}}else for(o=0;o<s;o++)i[o].layer.css("width",100*t[o]+"%");this.update()},t.prototype.activateColumn=function(t,e){this.container.getSortedLayers()[t].activate(e)},t.prototype.onChildCountChange=function(){if(!this.isDeleted&&!this.isDeleteStarted){var t=this.getSortedColumns(),e=t.length;if(e){for(var i=this.getColumns().split("+"),s=0,n=0;n<i.length;n++)s=new Fraction(i[n]).add(s);if(1!=s.valueOf())for(n=0;n<e;n++)t[n].setProperty("colwidth","1/"+e);else for(n=0;n<e;n++)t[n]._synccolwidth();this.refreshUI()}this._syncgutter()}},t.prototype.renderModeProperties=function(t){N2Classes.ComponentCommonAbstract.prototype.renderModeProperties.call(this,t),this._syncpadding(),this._syncinneralign(),this._syncgutter(),this.isActive&&this.columnsField.setRow(this)},t.prototype.highlightStructure=function(t){t=t||4e3,this.isStructureHighlighted&&(clearTimeout(this.isStructureHighlighted),this.isStructureHighlighted=!1);var e=this.getSortedColumns();this.layer.addClass("n2_layer_highlight_row_structure");for(var i=0;i<e.length;i++)e[i].layer.addClass("n2_layer_highlight_row_structure");this.isStructureHighlighted=setTimeout(function(){if(!this.isDeleted){this.layer.removeClass("n2_layer_highlight_row_structure");for(var t=0;t<e.length;t++)e[t].isDeleted||e[t].layer.removeClass("n2_layer_highlight_row_structure")}}.bind(this),t)},t.prototype.refreshUI=function(){this.isDeleteStarted||(this.isActive&&this.columnsField.setRow(this),this._syncwrapafter(),this.uiColumns.setOption("columns",this.getColumnsOrdered()))},t.prototype.getLLDroppable=function(t){if(this.getProperty("opened")){if("absolute"===t.placement.getType())return{$container:this.container.$ul,layer:this};if("col"===t.type)if(t.group===this)return{$container:this.container.$ul,layer:this}}return!1},t.prototype.getContents=function(){return this.$row},t.prototype.setPropertystylemode=function(t,e,i){this.stylemode=e,this.syncAdvancedField("bgcolor"),this.syncAdvancedField("bgcolorgradient"),this.syncAdvancedField("bgcolorgradientend"),this.syncAdvancedField("borderradius"),this.syncAdvancedField("boxshadow"),this.syncAdvancedField("borderwidth"),this.syncAdvancedField("borderstyle"),this.syncAdvancedField("bordercolor")},t.prototype.onSyncFields=function(){this.fragmentEditor.layerOptions.updateField("stylemode",this.stylemode)},t.prototype.getContextMenuItems=function(){var t=N2Classes.ComponentCommonAbstract.prototype.getContextMenuItems.call(this);return t.push({priority:55,label:n2_("Duplicate"),icon:"ssi_16 ssi_16--duplicate",action:this.duplicate.bind(this)}),t.push({priority:1e3,label:n2_("Delete"),icon:"ssi_16 ssi_16--delete",action:this.delete.bind(this),color:"red"}),t},t.prototype.getContextMenuCopySubItems=function(){var t=N2Classes.ComponentCommonAbstract.prototype.getContextMenuCopySubItems.call(this);return t.unshift({label:this.label,icon:"ssi_16 ssi_16--layer",action:function(){this.fragmentEditor.clipboard.componentCopy(this)}.bind(this)}),t},t}),N2D("SectionSlide",["LayerContainer","ComponentAbstract"],function(a,l){"use strict";function n(t){this.label=n2_("Slide"),this.type="slide",this.contextualBarPosition="center",this.baseSize=16,this.$=t.$,this.isMainGroup=!0,N2Classes.ComponentAbstract.prototype.constructor.call(this,t,!1),this.placement.allow("default"),this.layer=this.fragmentEditor.editor.getMainContainerElement().find('.n2-ss-layer[data-sstype="slide"]'),this.layerListUIManager=new N2Classes.UILayerList(this.layer,{mainContainer:this,$scrolled:a(".n2_layer_navigation_list")})}return((n.prototype=Object.create(N2Classes.ComponentAbstract.prototype)).constructor=n).prototype.getPaddingElement=function(){return this.layer},n.prototype.lateInit=function(){this.load(this.layer,!0),this.getProperty("static-slide")||(this.slideBackground=this.fragmentEditor.editor.getSlideBackground(),this.slideBackground.setRelatedSectionSlide(this))},n.getRegistryDataToFields=function(t){var e=t.fragmentEditor.editor.getAvailableDeviceModes(),i={title:a("#layerslide-title"),publish_up:a("#layerslide-publish_up"),publish_down:a("#layerslide-publish_down"),published:a("#layerslide-published"),description:a("#layerslide-description"),thumbnail:a("#layerslide-thumbnail"),"record-slides":a("#layerslide-slide-generator-slides"),thumbnailType:a("#layerslide-thumbnailType"),ligthboxImage:a("#layerslide-ligthboxImage"),"background-type":a("#layerslide-background-type"),backgroundImage:a("#layerslide-backgroundImage"),backgroundFocusX:a("#layerslide-backgroundFocusX"),backgroundFocusY:a("#layerslide-backgroundFocusY"),backgroundImageOpacity:a("#layerslide-backgroundImageOpacity"),backgroundImageBlur:a("#layerslide-backgroundImageBlur"),backgroundAlt:a("#layerslide-backgroundAlt"),backgroundTitle:a("#layerslide-backgroundTitle"),backgroundColor:a("#layerslide-backgroundColor"),backgroundGradient:a("#layerslide-backgroundGradient"),backgroundColorEnd:a("#layerslide-backgroundColorEnd"),backgroundColorOverlay:a("#layerslide-backgroundColorOverlay"),backgroundMode:a("#layerslide-backgroundMode"),href:a("#layerslide-href"),"href-target":a("#layerslide-href-target"),"slide-duration":a("#layerslide-slide-duration"),padding:a("#layerslide-padding")};i.desktopPortrait=a("#layerslide-show-desktop-portrait"),i.desktopLandscape=a("#layerslide-show-desktop-landscape"),i.tabletPortrait=a("#layerslide-show-tablet-portrait"),i.tabletLandscape=a("#layerslide-show-tablet-landscape"),i.mobilePortrait=a("#layerslide-show-mobile-portrait"),i.mobileLandscape=a("#layerslide-show-mobile-landscape"),i.backgroundVideoMp4=a("#layerslide-backgroundVideoMp4"),i.backgroundVideoOpacity=a("#layerslide-backgroundVideoOpacity"),i.backgroundVideoMuted=a("#layerslide-backgroundVideoMuted"),i.backgroundVideoLoop=a("#layerslide-backgroundVideoLoop"),i.backgroundVideoReset=a("#layerslide-backgroundVideoReset"),i.backgroundVideoMode=a("#layerslide-backgroundVideoMode");for(var s=0;s<n.externalDataToField.length;s++)i[n.externalDataToField[s].name]=a("#"+n.externalDataToField[s].id);return e.desktopLandscape||i.desktopLandscape.closest(".n2_field_radio__option").css("display","none"),e.tabletPortrait||i.tabletPortrait.closest(".n2_field_radio__option").css("display","none"),e.tabletLandscape||i.tabletLandscape.closest(".n2_field_radio__option").css("display","none"),e.mobilePortrait||i.mobilePortrait.closest(".n2_field_radio__option").css("display","none"),e.mobileLandscape||i.mobileLandscape.closest(".n2_field_radio__option").css("display","none"),t.fragmentEditor.editor.generator.registerField(i.title),t.fragmentEditor.editor.generator.registerField(i.description),t.fragmentEditor.editor.generator.registerField(i.thumbnail),t.fragmentEditor.editor.generator.registerField(i.backgroundImage),t.fragmentEditor.editor.generator.registerField(i.backgroundFocusX),t.fragmentEditor.editor.generator.registerField(i.backgroundFocusY),t.fragmentEditor.editor.generator.registerField(i.backgroundAlt),t.fragmentEditor.editor.generator.registerField(i.backgroundTitle),t.fragmentEditor.editor.generator.registerField(i.backgroundColor),t.fragmentEditor.editor.generator.registerField(i.backgroundColorEnd),t.fragmentEditor.editor.generator.registerField(i.href),t.fragmentEditor.editor.generator.registerField(i.backgroundVideoMp4),i},n.externalDataToField=[],n.addExternalDataToField=function(t){n.externalDataToField.push.apply(n.externalDataToField,t)},n.prototype.getIcon=function(){return"ssi_16 ssi_16--image"},n.prototype.addProperties=function(t){this.createProperty("title",n2_("Slide"),t),this.createProperty("publish_up","0000-00-00 00:00:00",t),this.createProperty("publish_down","0000-00-00 00:00:00",t),this.createProperty("published",1,t),this.createProperty("description","",t),this.createProperty("record-slides",5,t),this.createProperty("thumbnail","",t),this.createProperty("thumbnailType","default",t),this.createProperty("static-slide",0,t),this.createProperty("slide-duration",0,t),this.createProperty("ligthboxImage","",t);for(var e=0;e<n.externalDataToField.length;e++)this.createProperty(n.externalDataToField[e].name,n.externalDataToField[e].def,t);N2Classes.ComponentAbstract.prototype.addProperties.call(this,t),this.createProperty("href","",t),this.createProperty("href-target","",t),this.createProperty("background-type","color",t),this.createProperty("backgroundColor","ffffff00",t),this.createProperty("backgroundGradient","off",t),this.createProperty("backgroundColorEnd","ffffff00",t),this.createProperty("backgroundColorOverlay",0,t),this.createProperty("backgroundImage","",t),this.createProperty("backgroundFocusX",50,t),this.createProperty("backgroundFocusY",50,t),this.createProperty("backgroundImageOpacity",100,t),this.createProperty("backgroundImageBlur",0,t),this.createProperty("backgroundAlt","",t),this.createProperty("backgroundTitle","",t),this.createProperty("backgroundMode","default",t),this.createProperty("backgroundVideoMp4","",t),this.createProperty("backgroundVideoOpacity",100,t),this.createProperty("backgroundVideoMuted",1,t),this.createProperty("backgroundVideoLoop",1,t),this.createProperty("backgroundVideoReset",1,t),this.createProperty("backgroundVideoMode","fill",t),this.createDeviceProperty("padding",{desktopPortrait:"10|*|10|*|10|*|10"},t),this.$.on("baseSizeUpdated.contentAbstract",this._syncpadding.bind(this))},n.prototype.load=function(t,e){N2Classes.ComponentAbstract.prototype.load.call(this,t,e),this.initUI(),this._syncpadding(),this.container.startWithExistingNodes(e),this._onReady()},n.prototype.onSpacingStop=function(t,e){var i,s=this.getPadding().split("|*|");for(i in e.changed){var n=e.changed[i];switch(i){case"top":s[0]=Math.round(n);break;case"right":s[1]=Math.round(n);break;case"bottom":s[2]=Math.round(n);break;case"left":s[3]=Math.round(n)}}this.setProperty("padding",s.join("|*|")),a("#layerslide-padding").data("field").insideChange(s.join("|*|"))},n.prototype.initUI=function(){this.uiSpacing=new N2Classes.UISpacingPadding(this.getPaddingElement(),this.fragmentEditor,{stop:this.onSpacingStop.bind(this)}),this.editorUI.padding=this.uiSpacing.$handles},n.prototype.createRow=function(){this.container=new N2Classes.LayerContainer(this),this._createLayerListRow(),this.container.$ul.appendTo(this.layerRow)},n.prototype._start=function(t){this.createRow(),this.placement.start(),this.placement.setMode("default",this.originalProperties),this.animations.init(),this.setGroup(this.group),this.fragmentEditor.$.triggerHandler("layerCreated",this),this.animations.load(),t&&this.$.triggerHandler("created"),this.afterStart(t)},n.prototype.changeEditorMode=function(t){N2Classes.LayerDataStorage.prototype.changeEditorMode.call(this,t),this.container.changeEditorModes(t)},n.prototype.getLayerListParent=function(){return a(".n2_layer_navigation_list_layers")},n.prototype.setGroup=function(t){},n.prototype["_syncbackground-type"]=function(){this.slideBackground.setType(this.getProperty("background-type"))},n.prototype._syncbackgroundColor=n.prototype.syncBackgroundColor=function(){var t,e=nextend.currentEditor.generator.fill(this.getProperty("backgroundColor")),i=this.getProperty("backgroundGradient");"off"!==i&&(t=this.getProperty("backgroundColorEnd")),this.slideBackground.updateColor(e,i,t,this.getProperty("backgroundColorOverlay"))},n.prototype._syncbackgroundGradient=n.prototype.syncBackgroundColor,n.prototype._syncbackgroundColorEnd=n.prototype.syncBackgroundColor,n.prototype._syncbackgroundColorOverlay=n.prototype.syncBackgroundColor,n.prototype._syncbackgroundImage=function(t,e){var i=this.getProperty("backgroundImage");this.slideBackground.setImage(nextend.currentEditor.generator.fill(i)),this.slideBackground.setThumbnail(i,t)},n.prototype._syncbackgroundFocusX=n.prototype.syncBackgroundFocus=function(){this.slideBackground.setFocus(nextend.currentEditor.generator.fill(this.getProperty("backgroundFocusX")),nextend.currentEditor.generator.fill(this.getProperty("backgroundFocusY")))},n.prototype._syncbackgroundFocusY=n.prototype.syncBackgroundFocus,n.prototype._syncbackgroundImageOpacity=function(){this.slideBackground.setImageOpacity(this.getProperty("backgroundImageOpacity"))},n.prototype._syncbackgroundImageBlur=function(){this.slideBackground.setBlur(this.getProperty("backgroundImageBlur"))},n.prototype._syncbackgroundMode=function(){this.slideBackground.setMode(this.getProperty("backgroundMode"))},n.prototype._syncbackgroundVideoMp4=function(){this.slideBackground.setVideo()},n.prototype._syncbackgroundVideoMode=function(){this.slideBackground.setVideoMode(this.getProperty("backgroundVideoMode"))},n.prototype._syncbackgroundVideoOpacity=function(){this.slideBackground.setVideoOpacity(this.getProperty("backgroundVideoOpacity"))},n.prototype.getPadding=function(){return this.getProperty("padding")},n.prototype._syncpadding=function(){var t=this.getPadding().split("|*|").join("px ")+"px";this.getPaddingElement().css("padding",t),this.update(),this.uiSpacing&&this.uiSpacing.setOption("current",t)},n.prototype.syncShowOnDevice=function(t,e){},n.prototype.renderModeProperties=function(t){N2Classes.ComponentCommonAbstract.prototype.renderModeProperties.call(this,t),this._syncpadding()},n.prototype.getData=function(t){var e,i,s={type:this.type},n=a.extend({},this.property);for(i in this.deviceProperty)for(e in this.deviceProperty[i]){delete n[e];var o=this.deviceProperty[i][e];o!==l&&(s[i.toLowerCase()+e]=o)}for(e in n)switch(e){case"desktopPortrait":case"desktopLandscape":case"tabletPortrait":case"tabletLandscape":case"mobilePortrait":case"mobileLandscape":s[e.toLowerCase()]=n[e];break;default:s[e]=n[e]}return s.layers=this.container.getData(t),s},n.prototype.getSectionData=function(t){var e,i,s,n,o={type:this.type},a=["background-type","backgroundAlt","backgroundColor","backgroundColorEnd","backgroundColorOverlay","backgroundFocusX","backgroundFocusY","backgroundGradient","backgroundImage","backgroundImageBlur","backgroundImageOpacity","backgroundMode","backgroundTitle","backgroundVideoLoop","backgroundVideoMode","backgroundVideoMp4","backgroundVideoMuted","backgroundVideoReset","backgroundVideoOpacity","href","href-target"],r=["padding"];for(n in this.deviceProperty)for(e=0;e<r.length;e++)i=r[e],(s=this.deviceProperty[n][i])!==l&&(o[n.toLowerCase()+i]=s);for(e=0;e<a.length;e++)i=a[e],(s=this.property[i])!==l&&(o[i]=s);return o.layers=this.container.getData(t),o},n.prototype.getLLDroppable=function(t){if("absolute"===t.placement.getType()||"content"===t.type)switch(t.type){case"layer":case"row":case"content":return{$container:this.container.$ul,layer:this}}return!1},n.prototype.update=function(){},n.prototype.onChildCountChange=function(){},n.prototype.markEnter=function(t){},n.prototype.markLeave=function(t){},n.prototype.getSelf=function(){return this},n.prototype.getLLDroppables=function(t){return this.container.getLLDroppables(t)},n.prototype.getDroppables=function(t,e){return"absolute"===t?[this.getDroppable()]:this.container.getDroppables(e)},n.prototype.getDroppable=function(){return{$container:this.layer,layer:this,placement:"absolute"}},n.prototype.refreshBaseSize=function(){this.baseSize=16,this.layer.css("font-size","100%"),this.$.triggerHandler("baseSizeUpdated")},n.prototype.onResize=function(t){for(var e=this.getEverySortedLayers(),i=0;i<e.length;i++)e[i].placement.doLinearResize(t)},n.prototype.getEverySortedLayers=function(){for(var t=this.container.getChildLayersRecursive(!1),e={},i=t.length-1;0<=i;i--)t[i].property.parentid!==l&&t[i].property.parentid&&(e[t[i].property.parentid]===l&&(e[t[i].property.parentid]=[]),e[t[i].property.parentid].push(t[i]),t.splice(i,1));for(i=0;i<t.length;i++)t[i].property.id!==l&&t[i].property.id&&e[t[i].property.id]!==l&&(e[t[i].property.id].unshift(0),e[t[i].property.id].unshift(i+1),t.splice.apply(t,e[t[i].property.id]),delete e[t[i].property.id]);return t},n.prototype.getTargetGroupDefault=function(){var t=this.mainContent,e=this.fragmentEditor.getActiveLayer();return this.fragmentEditor.isCol(e)||this.fragmentEditor.isContent(e)?t=e:this.fragmentEditor.isRow(e)?t=e.container.getSortedLayers()[0]:"normal"===e.placement.getType()&&(t=e.group),t},n.prototype.getTargetGroupAbsolute=function(){return this},n.prototype.setMainContent=function(t){this.mainContent=t},n.prototype.layerDeleted=function(t){this._afterLayerDeletedDeBounced(t)},n.prototype._afterLayerDeletedDeBounced=NextendDeBounce(function(t){var e=this.fragmentEditor.getActiveLayer();e&&!e.isDeleted||this.fragmentEditor.resetActiveLayer()},50),n.prototype.delete=function(){for(var t=this.container.getSortedLayers(),e=0;e<t.length;e++)t[e].delete()},n.prototype.duplicate=function(){},n.prototype.isAbsolute=function(){return!1},n.prototype.getContextMenuCopySubItems=function(){var t=N2Classes.ComponentAbstract.prototype.getContextMenuCopySubItems.call(this);return t.push({label:n2_("Slide"),icon:"ssi_16 ssi_16--image",action:function(){this.fragmentEditor.clipboard.sectionCopy()}.bind(this)}),t},n.prototype.getContextMenuPasteSubItems=function(){var t=N2Classes.ComponentAbstract.prototype.getContextMenuPasteSubItems.call(this);return this.fragmentEditor.clipboard.sectionHasClipboard()&&t.unshift({label:n2_("Slide"),icon:"ssi_16 ssi_16--image",action:function(){this.fragmentEditor.clipboard.sectionPaste()}.bind(this)}),t},n.prototype.update=function(){this.fragmentEditor.editor.getMainContainerElement().triggerHandler("updateSize")},n}),N2D("ComponentSettings",function(r,s){"use strict";function t(t){this.fragmentEditor=t,this.componentType=s,this.placementType=s,r("html").attr("data-component","").attr("data-placement",""),this.currentForm={},this.forms={undefined:null,placement:{absolute:N2Classes.PlacementAbsolute.getRegistryDataToFields(this),normal:N2Classes.PlacementNormal.getRegistryDataToFields(this),default:{}},component:{slide:N2Classes.SectionSlide.getRegistryDataToFields(this),content:N2Classes.Content.getRegistryDataToFields(this),row:N2Classes.Row.getRegistryDataToFields(this),col:N2Classes.Col.getRegistryDataToFields(this),layer:{}},global:N2Classes.ComponentCommonAbstract.getRegistryDataToFields(this)};var e=r("#layerposition-default").data("field");e.element.on("outsideChange",function(){e.insideChange("default"),this.currentLayer.convertToAbsolute()}.bind(this));var i=r("#layerposition-absolute").data("field");i.element.on("outsideChange",function(){i.insideChange("absolute"),this.currentLayer.convertToNormal()}.bind(this))}return t.prototype.initStyleMode=function(t,i,e){for(var s=[],n=r('.n2_ss_layer_window__tab_panel[data-panel="'+t+'"] .n2_fields_layer_window[data-fieldset-type="style-mode"]').attr("data-state",""),o=0;o<e.length;o++)s.push(r(e[o]).data("field"));for(var a=0;a<s.length;a++)s[a].element.on("outsideChange",function(t){i.data("field").select.val(t.val()).trigger("change")}.bind(this,s[a].element));i.on("nextendChange",function(){var t=i.val();n.attr("data-state",t);for(var e=0;e<s.length;e++)t!==s[e].element.val()&&s[e].insideChange(t)}.bind(this)),n.find('.n2_form__table_label_field[data-style-mode-feature="reset-to-normal"] a').on("click",function(t){t.preventDefault(),this.resetStyleMode("stylemode")}.bind(this))},t.prototype.changeActiveComponent=function(t,e,i,s,n){var o=this.fragmentEditor.layerWindow.tab;switch(this.currentLayer&&"slide"===this.currentLayer.type&&o.displayTab("content"),this.currentLayer=t,r("html").attr("data-component",e).attr("data-component-sub",i),e){case"slide":o.setPanel(["slide"],["content","style"]),o.displayTab("style");break;case"content":o.setPanel(["content","common"],["content","style","animations"]);break;case"row":o.setPanel(["row","common"],["content","style","animations"]);break;case"col":o.setPanel(["column","common"],["content","style","animations"]);break;case"layer":o.setPanel(["item/"+t.item.type,"item","common"],["content","style","animations"])}this.componentType=e,this.changeActiveComponentPlacement(s),this.syncFields(n)},t.prototype.changeActiveComponentPlacement=function(t,e){r("html").attr("data-placement",t),this.placementType=t,this.syncFields(e)},t.prototype.syncFields=function(t){if("object"==typeof t){for(var e in this.currentForm=r.extend({},this.forms.global,this.forms.component[this.componentType],this.forms.placement[this.placementType]),t)t[e]!==s&&this.updateField(e,t[e]);for(var i in this.currentLayer.onSyncFields(),this.currentForm)this.currentForm[i].off(".layeroptions").on("outsideChange.layeroptions",this.activeComponentPropertyChanged.bind(this,i))}},t.prototype.onUpdateField=function(t,e,i){t.target===this.currentLayer&&this.updateField(e,i)},t.prototype.updateField=function(t,e){"function"==typeof this.currentLayer["formSet"+t]?this.currentLayer["formSet"+t](this,e):this.currentForm[t]===s||(t=this.currentForm[t].data("field"))!==s&&t.insideChange(e)},t.prototype.activeComponentPropertyChanged=function(t,e){this.currentLayer&&!this.currentLayer.isDeleted?this.updateLayerProperty(t):(t=this.currentForm[t].data("field"))!==s&&null!==t&&t.insideChange("")},t.prototype.updateLayerProperty=function(t){var e=this.currentForm[t].val();this.currentLayer.setProperty(t,e,"manager")},t.prototype.startFeatures=function(){this.layerFeatures=new N2Classes.LayerFeatures(this.forms.placement.absolute,this.fragmentEditor)},t.prototype.resetStyleMode=function(t,e){this.currentLayer.resetStyleMode(t)},t}),N2D("ItemButton",["Item"],function(o,t){"use strict";function e(){this.type="button",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.Item.prototype)).constructor=e).prototype.getLabel=function(){return n2_("Button")},e.prototype.added=function(){this.needFill=["content","class"],this.addedFont("link","font"),this.addedStyle("button","style"),this.generator.registerFields(["#item_buttoncontent","#item_buttonhref","#item_buttonclass"])},e.prototype.parseAll=function(t){t.classes="",parseInt(t.fullwidth)&&(t.classes+=" n2-ss-fullwidth"),parseInt(t.nowrap)&&(t.classes+=" n2-ss-nowrap"),N2Classes.Item.prototype.parseAll.apply(this,arguments)},e.prototype._render=function(t){var e,i=o('<div class="n2-ss-button-container n2-ow '+t.fontclass+" "+t.classes+'"></div>'),s=o('<a href="#" onclick="return false;" class="'+t.styleclass+" "+t.class+' n2-ow"></a>').appendTo(i),n=o("<div><div>"+t.content+"</div></div>").appendTo(s);!t.icon||(e=N2Classes.Icons.render(t.icon))&&(s.attr("data-iconplacement",t.iconplacement),e=o('<span class="n2i '+e.class+'" style="font-size:'+t.iconsize+'%;">'+e.ligature+"</span>"),"right"===t.iconplacement?e.css("marginLeft",t.iconspacing/100+"em").appendTo(n):e.css("marginRight",t.iconspacing/100+"em").prependTo(n)),this.$item.append(i)},e}),N2D("ItemHeading",["Item"],function(s,e){"use strict";function t(){this.type="heading",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((t.prototype=Object.create(N2Classes.Item.prototype)).constructor=t).prototype.getLabel=function(){return n2_("Heading")},t.prototype.getDefault=function(){return{href:"",font:"",style:""}},t.prototype.added=function(){this.needFill=["heading","class"],this.addedFont("hover","font"),this.addedStyle("heading","style"),this.generator.registerFields(["#item_headingheading","#item_headinghref","#item_headingclass"])},t.prototype.parseAll=function(t){t.uid=s.fn.uid(),parseInt(t.fullwidth)?t.display="block":t.display="inline-block",t.extrastyle=parseInt(t.nowrap)?"white-space: nowrap;":"",t.heading=s("<div>"+t.heading+"</div>").html().replace(/\n/g,"<br />"),t["split-text-animation-in"]===e&&(t["split-text-animation-in"]="",t["split-text-delay-in"]=0,t["split-text-animation-out"]="",t["split-text-delay-out"]=0,t["split-text-transform-origin"]="50|*|50|*|0",t["split-text-backface-visibility"]=1),t.splitTextIn=t["split-text-animation-in"],t.splitTextDelayIn=t["split-text-delay-in"]/1e3,t.splitTextOut=t["split-text-animation-out"],t.splitTextDelayOut=t["split-text-delay-out"]/1e3,t.splitTextTransformOrigin=t["split-text-transform-origin"].split("|*|").join("% ")+"%",t.splitTextBackfaceVisibility=parseInt(t["split-text-backface-visibility"])?"visible":"hidden",N2Classes.Item.prototype.parseAll.apply(this,arguments),"#"==t.href||""==t.href?(t.afontclass="",t.astyleclass=""):(t.afontclass=t.fontclass,t.fontclass="",t.astyleclass=t.styleclass,t.styleclass="")},t.prototype._render=function(t){var e=s('<div class="n2-ow"></div>'),i=s('<div id="'+t.uid+'" style="'+t.extrastyle+'"></div>').addClass("n2-ow "+t.fontclass+" "+t.styleclass+" "+t.class).css({display:t.display}).appendTo(e);"#"==t.href||""==t.href?i.html(t.heading):i.append(s('<a style="display:'+t.display+';" href="#" class="'+t.afontclass+" "+t.astyleclass+' n2-ow" onclick="return false;">'+t.heading+"</a>")),this.$item.append(e),t.splitTextIn||t.splitTextOut?new N2Classes.HeadingItemSplitTextAdmin(this.fragmentEditor.editor.frontend,t.uid,t.splitTextTransformOrigin,t.splitTextBackfaceVisibility,t.splitTextIn,t.splitTextDelayIn,t.splitTextOut,t.splitTextDelayOut):this.$item.closest(".n2-ss-layer").triggerHandler("deleteSplitText"),N2Classes.LayerNavigationTimeline.get().refreshDuration()},t}),N2D("ItemImage",["Item"],function(s,t){"use strict";function e(){this.type="image",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.Item.prototype)).constructor=e).prototype.getLabel=function(){return n2_("Image")},e.prototype.hasTextScale=function(){return!1},e.prototype.getDefault=function(){return{size:"auto|*|auto",href:"",style:""}},e.prototype.added=function(){this.needFill=["image","cssclass"],this.addedStyle("box","style"),this.generator.registerFields(["#item_imageimage","#item_imagealt","#item_imagetitle","#item_imagehref","#item_imagecssclass"])},e.prototype.parseAll=function(t){var e=t.size.split("|*|");t.width=e[0],t.height=e[1],delete t.size,N2Classes.Item.prototype.parseAll.apply(this,arguments),t.image!==this.fragmentEditor.editor.generator.fill(this.values.image)?(t.image=nextend.imageHelper.fixed(t.image),"absolute"===this.layer.placement.getType()&&this.resizeLayerToImage(nextend.imageHelper.fixed(t.image))):t.image=nextend.imageHelper.fixed(t.image)},e.prototype.fitLayer=function(){return"absolute"===this.layer.placement.getType()&&this.resizeLayerToImage(nextend.imageHelper.fixed(this.values.image)),!0},e.prototype._render=function(t){var e=s('<div class="'+t.styleclass+' n2-ss-img-wrapper n2-ss-img-crop n2-ow"></div>'),i=e;"#"!==t.href&&""!==t.href&&(i=s('<a href="#" class="n2-ow" onclick="return false;" style="display: block;background: none !important;"></a>').appendTo(e)),s('<img class="n2-ow '+t.cssclass+'" src="'+t.image+'"/>').css({display:"inline-block",maxWidth:"100%",width:t.width,height:t.height}).appendTo(i),this.$item.append(e)},e}),N2D("ItemText",["Item"],function(n,t){"use strict";function e(){this.type="text",N2Classes.Item.prototype.constructor.apply(this,arguments)}function i(t){var e=!1,i=!1,s="table|thead|tfoot|caption|col|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|form|map|area|blockquote|address|math|style|p|h[1-6]|hr|fieldset|legend|section|article|aside|hgroup|header|footer|nav|figure|figcaption|details|menu|summary";return-1===(t=t.replace(/\r\n|\r/g,"\n")+"\n").indexOf("\n")||(-1!==t.indexOf("<object")&&(t=t.replace(/<object[\s\S]+?<\/object>/g,function(t){return t.replace(/\n+/g,"")})),-1===(t=t.replace(/<[^<>]+>/g,function(t){return t.replace(/[\n\t ]+/g," ")})).indexOf("<pre")&&-1===t.indexOf("<script")||(e=!0,t=t.replace(/<(pre|script)[^>]*>[\s\S]*?<\/\1>/g,function(t){return t.replace(/\n/g,"<wp-line-break>")})),-1!==t.indexOf("<figcaption")&&(t=(t=t.replace(/\s*(<figcaption[^>]*>)/g,"$1")).replace(/<\/figcaption>\s*/g,"</figcaption>")),-1!==t.indexOf("[caption")&&(i=!0,t=t.replace(/\[caption[\s\S]+?\[\/caption\]/g,function(t){return(t=(t=t.replace(/<br([^>]*)>/g,"<wp-temp-br$1>")).replace(/<[^<>]+>/g,function(t){return t.replace(/[\n\t ]+/," ")})).replace(/\s*\n\s*/g,"<wp-temp-br />")})),t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t+="\n\n").replace(/<br \/>\s*<br \/>/gi,"\n\n")).replace(new RegExp("(<(?:"+s+")(?: [^>]*)?>)","gi"),"\n\n$1")).replace(new RegExp("(</(?:"+s+")>)","gi"),"$1\n\n")).replace(/<hr( [^>]*)?>/gi,"<hr$1>\n\n")).replace(/\s*<option/gi,"<option")).replace(/<\/option>\s*/gi,"</option>")).replace(/\n\s*\n+/g,"\n\n")).replace(/([\s\S]+?)\n\n/g,"<p>$1</p>\n")).replace(/<p>\s*?<\/p>/gi,"")).replace(new RegExp("<p>\\s*(</?(?:"+s+")(?: [^>]*)?>)\\s*</p>","gi"),"$1")).replace(/<p>(<li.+?)<\/p>/gi,"$1")).replace(/<p>\s*<blockquote([^>]*)>/gi,"<blockquote$1><p>")).replace(/<\/blockquote>\s*<\/p>/gi,"</p></blockquote>")).replace(new RegExp("<p>\\s*(</?(?:"+s+")(?: [^>]*)?>)","gi"),"$1")).replace(new RegExp("(</?(?:"+s+")(?: [^>]*)?>)\\s*</p>","gi"),"$1")).replace(/(<br[^>]*>)\s*\n/gi,"$1")).replace(/\s*\n/g,"<br />\n")).replace(new RegExp("(</?(?:"+s+")[^>]*>)\\s*<br />","gi"),"$1")).replace(/<br \/>(\s*<\/?(?:p|li|div|dl|dd|dt|th|pre|td|ul|ol)>)/gi,"$1")).replace(/(?:<p>|<br ?\/?>)*\s*\[caption([^\[]+)\[\/caption\]\s*(?:<\/p>|<br ?\/?>)*/gi,"[caption$1[/caption]")).replace(/(<(?:div|th|td|form|fieldset|dd)[^>]*>)(.*?)<\/p>/g,function(t,e,i){return i.match(/<p( [^>]*)?>/)?t:e+"<p>"+i+"</p>"}),e&&(t=t.replace(/<wp-line-break>/g,"\n")),i&&(t=t.replace(/<wp-temp-br([^>]*)>/g,"<br$1>"))),t}return((e.prototype=Object.create(N2Classes.Item.prototype)).constructor=e).prototype.getLabel=function(){return n2_("Text")},e.prototype.getDefault=function(){return{content:"","content-mobile-enabled":0,contentmobile:"","content-tablet-enabled":0,contenttablet:"",font:"",style:""}},e.prototype.added=function(){this.needFill=["content","contenttablet","contentmobile"],this.addedFont("paragraph","font"),this.addedStyle("heading","style"),this.generator.registerFields(["#item_textcontent","#item_textcontenttablet","#item_textcontentmobile"])},e.prototype.parseAll=function(t){N2Classes.Item.prototype.parseAll.apply(this,arguments),t.p=i(t.content),t.ptablet=i(t.contenttablet),t.pmobile=i(t.contentmobile)},e.prototype._render=function(t){var e,i=!1,s=!1;1===parseInt(t["content-mobile-enabled"])&&(i=!0,n('<div class="n2-ss-hide-desktopportrait n2-ss-hide-desktoplandscape n2-ss-hide-tabletportrait n2-ss-hide-tabletlandscape n2-ow n2-ow-all">'+t.pmobile+"</div>").appendTo(this.$item)),1===parseInt(t["content-tablet-enabled"])&&(s=!0,e=["n2-ss-hide-desktopportrait","n2-ss-hide-desktoplandscape"],i?(e.push("n2-ss-hide-mobileportrait"),e.push("n2-ss-hide-mobilelandscape")):i=!0,n('<div class="'+e.join(" ")+' n2-ow n2-ow-all">'+t.ptablet+"</div>").appendTo(this.$item)),e=[],i&&(e.push("n2-ss-hide-mobileportrait"),e.push("n2-ss-hide-mobilelandscape")),s&&(e.push("n2-ss-hide-tabletportrait"),e.push("n2-ss-hide-tabletlandscape")),n('<div class="'+e.join(" ")+' n2-ow n2-ow-all">'+t.p+"</div>").appendTo(this.$item),this.$item.find("p").addClass(t.fontclass+" "+t.styleclass)},e}),N2D("ItemVimeo",["Item"],function(s,i){"use strict";function t(){this.type="vimeo",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((t.prototype=Object.create(N2Classes.Item.prototype)).constructor=t).needWidth=!0,t.prototype.getLabel=function(){return"Vimeo"},t.prototype.hasTextScale=function(){return!1},t.prototype.added=function(){this.needFill=["vimeourl"],this.generator.registerField("#item_vimeovimeourl")},t.prototype.parseAll=function(e){var t,i=this.values.vimeourl!=e.vimeourl;N2Classes.Item.prototype.parseAll.apply(this,arguments),""==e.image&&(e.image="$ss3-frontend$/images/placeholder/video.png"),e.image=nextend.imageHelper.fixed(e.image),i&&""!=e.vimeourl&&(t=!1,(i=e.vimeourl.match(/https?:\/\/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/))?t=i[3]:e.vimeourl.match(/^[0-9]+$/)&&(t=e.vimeourl),t?N2Classes.AjaxHelper.getJSON("https://vimeo.com/api/v2/video/"+encodeURI(t)+".json").done(function(t){s("#item_vimeoimage").val(t[0].thumbnail_large).trigger("change")}.bind(this)).fail(function(t){0==e.privateurl&&N2Classes.Notification.error("Video not found or private.")}):N2Classes.Notification.error("The provided URL does not match any known Vimeo url or code."))},t.prototype._render=function(t){var e="";"custom"===t["aspect-ratio"]&&(e="padding-top:"+t["aspect-ratio-height"]/t["aspect-ratio-width"]*100+"%");e=s('<div class="n2_ss_video_player n2-ow-all"><div class="n2_ss_video_player__placeholder" style="'+e+'"></div></div>').attr("data-aspect-ratio",t["aspect-ratio"]).css({background:"url("+t.image+") no-repeat 50% 50%",backgroundSize:"cover"});!parseInt(t.playbutton)&&t.playbutton!==i||s('<div class="n2_ss_video_player__cover"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OCA0OCI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48Y2lyY2xlIGN4PSIyNCIgY3k9IjI0IiByPSIyNCIgZmlsbD0iIzAwMCIgb3BhY2l0eT0iLjYiLz48cGF0aCBmaWxsPSIjRkZGIiBkPSJNMTkuOCAzMmMtLjEyNCAwLS4yNDctLjAyOC0uMzYtLjA4LS4yNjQtLjExNi0uNDM2LS4zNzUtLjQ0LS42NjRWMTYuNzQ0Yy4wMDUtLjI5LjE3Ni0uNTUuNDQtLjY2Ni4yNzMtLjEyNi41OTItLjEuODQuMDdsMTAuNCA3LjI1N2MuMi4xMzIuMzIuMzU1LjMyLjU5NXMtLjEyLjQ2My0uMzIuNTk1bC0xMC40IDcuMjU2Yy0uMTQuMS0uMzEuMTUtLjQ4LjE1eiIvPjwvZz48L3N2Zz4=" /></div>').appendTo(e),this.$item.append(e)},t.prototype.fitLayer=function(){return!0},t}),N2D("ItemYoutube",["Item"],function(s,i){"use strict";function t(){this.type="youtube",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((t.prototype=Object.create(N2Classes.Item.prototype)).constructor=t).needWidth=!0,t.prototype.getLabel=function(){return"YouTube"},t.prototype.hasTextScale=function(){return!1},t.prototype.added=function(){this.needFill=["youtubeurl","image","start"],this.generator.registerFields(["#item_youtubeyoutubeurl","#item_youtubeimage","#item_youtubestart"])},t.prototype.parseAll=function(t){var e,i=this.values.youtubeurl!==t.youtubeurl;N2Classes.Item.prototype.parseAll.apply(this,arguments),""===t.image&&(t.image="$ss3-frontend$/images/placeholder/video.png"),t.image=nextend.imageHelper.fixed(t.image),!i||(t=t.youtubeurl.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/))&&(e="https://i.ytimg.com/vi/"+t[2]+"/hqdefault.jpg","{video_url}"===this.values.youtubeurl&&(e="https://i.ytimg.com/vi/{video_id}/hqdefault.jpg"),setTimeout(function(){s("#item_youtubeimage").val(e).trigger("change")},100))},t.prototype.fitLayer=function(){return!0},t.prototype._render=function(t){var e="";"custom"===t["aspect-ratio"]&&(e="padding-top:"+t["aspect-ratio-height"]/t["aspect-ratio-width"]*100+"%");e=s('<div class="n2_ss_video_player n2-ow-all"><div class="n2_ss_video_player__placeholder" style="'+e+'"></div></div>').attr("data-aspect-ratio",t["aspect-ratio"]).css({background:"url("+t.image+") no-repeat 50% 50%",backgroundSize:"cover"});!parseInt(t.playbutton)&&t.playbutton!==i||s('<div class="n2_ss_video_player__cover"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OCA0OCI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48Y2lyY2xlIGN4PSIyNCIgY3k9IjI0IiByPSIyNCIgZmlsbD0iIzAwMCIgb3BhY2l0eT0iLjYiLz48cGF0aCBmaWxsPSIjRkZGIiBkPSJNMTkuOCAzMmMtLjEyNCAwLS4yNDctLjAyOC0uMzYtLjA4LS4yNjQtLjExNi0uNDM2LS4zNzUtLjQ0LS42NjRWMTYuNzQ0Yy4wMDUtLjI5LjE3Ni0uNTUuNDQtLjY2Ni4yNzMtLjEyNi41OTItLjEuODQuMDdsMTAuNCA3LjI1N2MuMi4xMzIuMzIuMzU1LjMyLjU5NXMtLjEyLjQ2My0uMzIuNTk1bC0xMC40IDcuMjU2Yy0uMTQuMS0uMzEuMTUtLjQ4LjE1eiIvPjwvZz48L3N2Zz4=" /></div>').appendTo(e),this.$item.append(e)},t}),N2D("BgAnimationEditor",["NextendFragmentEditorControllerWithEditor"],function(i,e){function t(){this.parameters={shiftedBackgroundAnimation:0},this.$css=i("<style></style>").appendTo("head"),this.preview=i('<div class="n2_form__table_preview n2_ss_background_animation_preview"></div>').appendTo('.n2_form__table[data-field="table-background-animation-preview"]');var t=i('<div class="n2_ss_background_animation_preview__slider"></div>').appendTo(this.preview);this.bgAnimationElement=i('<div class="n2_ss_background_animation_preview__animation_container"></div>').appendTo(t);i('<div class="n2_ss_background_animation_preview__slide"></div>').append(i('<div class="n2_ss_background_animation_preview__slide_background"></div>').append(i('<div class="n2_ss_background_animation_preview__slide_background_image"></div>'))).appendTo(t).clone().appendTo(t);this.backgroundAnimations={color:"eeeeeeff"},N2Classes.NextendFragmentEditorControllerWithEditor.prototype.constructor.call(this,!1),this.slides=t.find(".n2_ss_background_animation_preview__slide"),this.slides.eq(1).css("opactiy",0),this.bgImages=t.find(".n2_ss_background_animation_preview__slide_background");var e=[nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png"),nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/video.png")];t.find(".n2_ss_background_animation_preview__slide_background_image").each(function(t){i(this).css("backgroundImage","url("+e[t]+")")}),NextendTween.set(this.bgImages,{rotationZ:1e-4}),(n2const.isIE||n2const.isEdge)&&N2Classes.Notification.error("Background animations are not available in your browser. It works if the <i>transform-style: preserve-3d</i> feature available. "),this.$colorField=i("#n2-background-animationcolor").on("nextendChange",this.changeColor.bind(this))}return((t.prototype=Object.create(N2Classes.NextendFragmentEditorControllerWithEditor.prototype)).constructor=t).prototype.loadDefaults=function(){N2Classes.NextendFragmentEditorControllerWithEditor.prototype.loadDefaults.call(this),this.type="backgroundanimation",this.current=0,this.animationProperties=!1},t.prototype.get=function(){return null},t.prototype.load=function(t,e,i,s){},t.prototype.setTabs=function(t){},t.prototype.start=function(t){t.color!==e?(this.$colorField.data("field").insideChange(t.color),this.backgroundAnimations.color=t.color):(i("#n2-tab-background-animation-form").remove(),this.$css.html(".n2-3d-side,.tile-colored-overlay{background: "+nextend.currentEditor.frontend.parameters.bgAnimationsColor+";}")),this.animationProperties&&(this.timeline?this.timeline.play():this.next())},t.prototype.changeColor=function(){this.backgroundAnimations.color=this.$colorField.val(),this.$css.html(".n2-3d-side,.tile-colored-overlay{background: "+N2Color.hex2rgbaCSS(this.backgroundAnimations.color)+";}")},t.prototype.pause=function(){this.timeline&&this.timeline.pause()},t.prototype.next=function(){this.timeline=new NextendTimeline({paused:!0,onComplete:this.ended.bind(this)});var t=this.bgImages.eq(this.current),e=this.bgImages.eq(1-this.current);n2const.isIE||n2const.isEdge?(this.timeline.to(this.slides.eq(this.current),1.5,{opacity:0},0),this.timeline.to(this.slides.eq(1-this.current),1.5,{opacity:1},0)):(this.currentAnimation=new N2Classes["SmartSliderBackgroundAnimation"+this.animationProperties.type](this,t,e,this.animationProperties,1,0),this.slides.eq(this.current).css("zIndex",2),this.slides.eq(1-this.current).css("zIndex",3),this.timeline.to(this.slides.eq(this.current),.5,{opacity:0},this.currentAnimation.getExtraDelay()),this.timeline.to(this.slides.eq(1-this.current),.5,{opacity:1},this.currentAnimation.getExtraDelay()),this.currentAnimation.postSetup()),this.current=1-this.current,this.timeline.play()},t.prototype.ended=function(){this.currentAnimation&&this.currentAnimation.ended(),this.next()},t.prototype.setAnimationProperties=function(t){var e=this.animationProperties;this.animationProperties=t,e||this.next()},t}),N2D("BgAnimationManager",["NextendVisualManagerMultipleSelection"],function(n,t){function e(){this.type="backgroundanimation",N2Classes.NextendVisualManagerMultipleSelection.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.NextendVisualManagerMultipleSelection.prototype)).constructor=e).prototype.loadDefaults=function(){N2Classes.NextendVisualManagerMultipleSelection.prototype.loadDefaults.apply(this,arguments),this.type="backgroundanimation",this.labels={visual:"Background animation",visuals:"Background animations"}},e.prototype.initController=function(){return new N2Classes.BgAnimationEditor},e.prototype.createVisual=function(t,e){return new N2Classes.NextendVisualWithSetRowMultipleSelection(t,e,this)},e.prototype.show=function(t,e){var i={},s=n("#sliderbackground-animation-color");s.length&&(i.color=s.val()),N2Classes.NextendVisualManagerMultipleSelection.prototype.show.call(this,t,e,i)},e.prototype.getAsString=function(){var t=n("#sliderbackground-animation-color");return t.length&&t.val(n("#n2-background-animationcolor").val()),N2Classes.NextendVisualManagerMultipleSelection.prototype.getAsString.call(this)},e}),N2D("PostBgAnimationEditor",["NextendFragmentEditorControllerWithEditor"],function(e,s){function t(){N2Classes.NextendFragmentEditorControllerWithEditor.prototype.constructor.call(this,!1);var t=e('<div class="n2_form__table_preview"></div>').appendTo('.n2_form__table[data-field="table-post-background-preview"]');this.bgAnimationElement=e('<div class="n2_ss_post_background_preview"></div>').appendTo(t).on("click",this.clickFocusPoint.bind(this)),this.bgImage=e('<div class="n2_ss_post_background_preview__slide"></div>').appendTo(this.bgAnimationElement),e('<img src="'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png")+'" alt="" />').appendTo(this.bgImage),e('<div class="n2-ss-slide-background-image" style="background-image:url('+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png")+')"></div>').appendTo(this.bgImage),this.transformOriginFieldX=e("#n2-post-backgroundtransformorigin-x").on("nextendChange",this.changeFocusX.bind(this)),this.transformOriginFieldY=e("#n2-post-backgroundtransformorigin-y").on("nextendChange",this.changeFocusY.bind(this))}return((t.prototype=Object.create(N2Classes.NextendFragmentEditorControllerWithEditor.prototype)).constructor=t).prototype.loadDefaults=function(){N2Classes.NextendFragmentEditorControllerWithEditor.prototype.loadDefaults.call(this),this.type="postbackgroundanimation",this.tween=null,this.animationProperties=!1,this.transformOriginX=50,this.transformOriginY=50},t.prototype.clickFocusPoint=function(t){var e=this.bgAnimationElement.offset(),i=Math.round((t.pageX-e.left)/this.bgAnimationElement.width()*100),e=Math.round((t.pageY-e.top)/this.bgAnimationElement.height()*100);this.transformOriginFieldX.data("field").insideChange(i),this.transformOriginFieldY.data("field").insideChange(e)},t.prototype.changeFocusX=function(){this.transformOriginX=this.transformOriginFieldX.val(),this.animationProperties&&this.setAnimationProperties(this.animationProperties)},t.prototype.changeFocusY=function(){this.transformOriginY=this.transformOriginFieldY.val(),this.animationProperties&&this.setAnimationProperties(this.animationProperties)},t.prototype.setImage=function(){var t,e,i;nextend.currentEditor===s||(i=nextend.currentEditor.frontend)!==s&&(this.bgImage.html(""),i.currentSlide.background.elements.image?i.currentSlide.background.elements.image.$background.clone().appendTo(this.bgImage):console.error("Background image missing"),t=this.bgAnimationElement.parent().width()-40,e=i.responsive.resizeContext.sliderWidth,i=i.responsive.resizeContext.sliderHeight,t<e&&(i=i*t/e,e=t),this.bgAnimationElement.css({width:e,height:i}))},t.prototype.get=function(){return null},t.prototype.load=function(t,e,i,s){},t.prototype.setTabs=function(t){},t.prototype.start=function(t){this.setImage(),this.transformOriginFieldX.data("field").insideChange(t[0]),this.transformOriginFieldY.data("field").insideChange(t[1])},t.prototype.pause=function(){this.tween&&this.tween.pause()},t.prototype.next=function(){var t=e.extend(!0,{},this.animationProperties);t.from.transformOrigin===s&&NextendTween.set(this.bgImage,{transformOrigin:this.transformOriginX+"% "+this.transformOriginY+"%"}),t.to.delay=.5,t.to.onComplete=this.next.bind(this),this.tween=NextendTween.fromTo(this.bgImage,t.duration,t.from,t.to)},t.prototype.setAnimationProperties=function(t){this.animationProperties=t,this.pause(),NextendTween.set(this.bgImage,{scale:1,x:0,y:0,rotationZ:1e-4,transformOrigin:"50% 50%"}),this.next()},t}),N2D("PostBgAnimationManager",["NextendVisualManagerMultipleSelection"],function(t,e){function i(){this.type="postbackgroundanimation",N2Classes.NextendVisualManagerMultipleSelection.prototype.constructor.apply(this,arguments)}return((i.prototype=Object.create(N2Classes.NextendVisualManagerMultipleSelection.prototype)).constructor=i).prototype.loadDefaults=function(){N2Classes.NextendVisualManagerMultipleSelection.prototype.loadDefaults.apply(this,arguments),this.type="postbackgroundanimation",this.labels={visual:"Ken Burns effect",visuals:"Ken Burns effects"}},i.prototype.initController=function(){return new N2Classes.PostBgAnimationEditor},i.prototype.createVisual=function(t,e){return new N2Classes.NextendVisualWithSetRowMultipleSelection(t,e,this)},i.prototype.show=function(t,e){var i=[];""!==t&&(t=t.split("|*|"),i[0]=t[0],i[1]=t[1],t=t[2]),N2Classes.NextendVisualManagerMultipleSelection.prototype.show.call(this,t,e,i)},i.prototype.getAsString=function(){return this.controller.transformOriginX+"|*|"+this.controller.transformOriginY+"|*|"+N2Classes.NextendVisualManagerMultipleSelection.prototype.getAsString.call(this)},i}),N2D("ItemAnimatedHeading",["Item"],function(r,t){"use strict";function e(){this.type="animatedHeading",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.Item.prototype)).constructor=e).prototype.getLabel=function(){return n2_("Animated heading")},e.prototype.getDefault=function(){return{font:"",style:"","font-highlight":"","style-highlight":""}},e.prototype.added=function(){this.needFill=["before-text","animated-text","after-text"],this.addedFont("highlight","font"),this.addedStyle("highlight","style"),this.generator.registerFields(["#item_animatedHeadingbefore-text","#item_animatedHeadinganimated-text","#item_animatedHeadingafter-text","#linkitem_animatedHeadinglink-1","#item_animatedHeadingclass"])},e.prototype.parseAll=function(t){t.uid=r.fn.uid(),t.display="inline-block",t.priority=2,t.class="",N2Classes.Item.prototype.parseAll.apply(this,arguments),t.afontclass="",t.astyleclass=""},e.prototype._render=function(t){var e=r('<div id="'+t.uid+'" class="n2-ss-animated-heading-wrapper n2-ow-all  '+t.fontclass+" "+t.styleclass+'"></div>'),i=t["before-text"],s=t["animated-text"].split(/\r\n|\r|\n/),n=t["after-text"],o="";if(""!==i&&(o+='<div class="n2-ss-animated-heading-before">'+i+"</div> "),s.length){"#"===t.href||""===t.href?o+="<div ":o+='<a href="#" ',o+='class="n2-highlighted n2-ss-animated-heading-i" data-animation-type="'+t.type+'" data-color="'+N2Color.hex2rgbaCSS(t.color)+'" data-color2="'+t.color2+'" data-animate-width="'+t["animate-width"]+'" data-delay="'+t.delay+'" data-speed="'+t.speed+'" data-show-duration="'+t["show-duration"]+'" data-loop="'+t.loop+'">',o+='<div class="n2-ss-animated-heading-i2">';for(var a=0;a<s.length;a++)o+='<div class="n2-ss-animated-heading-i-text">'+s[a]+"</div>";o+="</div>","#"===t.href||""===t.href?o+="</div>":o+="</a>"}""!==n&&(o+=' <div class="n2-ss-animated-heading-after">'+n+"</div>"),e.html(o),this.$item.append(e),new N2Classes.AnimatedHeadingItemAdmin(e.find(".n2-ss-animated-heading-i").get(0),this.fragmentEditor.editor.frontend)},e}),N2D("ItemArea",["Item"],function(i,t){"use strict";function e(){this.type="area",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.Item.prototype)).constructor=e).needWidth=!0,e.needHeight=!0,e.prototype.getLabel=function(){return n2_("Area")},e.prototype.hasTextScale=function(){return!1},e.prototype.parseAll=function(t){t.width=parseInt(t.width),t.height=parseInt(t.height),0<t.width?t.width+="px":t.width="100%",0<t.height?t.height+="px":t.height="100%",t.colora=N2Color.hex2rgbaCSS(t.color),t.color2a=N2Color.hex2rgbaCSS(t.color2),t.borderWidth=t.borderWidth.split("|*|"),t.borderColora=N2Color.hex2rgbaCSS(t.borderColor),t.borderRadius=t.borderRadius+"px"},e.prototype.fitLayer=function(){return!0},e.prototype._render=function(t){var e=i('<div class="n2-ow" style="box-sizing: border-box;'+t.css+'"></div>').css({width:t.width,height:t.height,backgroundColor:t.colora,borderWidth:t.borderWidth.join("px ")+"px",borderStyle:t.borderStyle,borderColor:t.borderColora,borderRadius:t.borderRadius});switch(t.gradient){case"horizontal":e.css("background","linear-gradient(to right, "+t.colora+" 0%,"+t.color2a+" 100%)");break;case"vertical":e.css("background","linear-gradient(to bottom, "+t.colora+" 0%,"+t.color2a+" 100%)");break;case"diagonal1":e.css("background","linear-gradient(45deg, "+t.colora+" 0%,"+t.color2a+" 100%)");break;case"diagonal2":e.css("background","linear-gradient(135deg, "+t.colora+" 0%,"+t.color2a+" 100%)")}this.$item.append(e)},e}),N2D("ItemAudio",["Item"],function(o,t){"use strict";function e(){this.type="audio",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.Item.prototype)).constructor=e).prototype.getLabel=function(){return n2_("Audio")},e.prototype.hasTextScale=function(){return!1},e.prototype.added=function(){this.needFill=["audio_mp3"],this.generator.registerField("#item_videovideo_mp4")},e.prototype._render=function(t){var e,i="#"+t.color2,s=N2Color.hex2rgbaCSS(t.color2+"33"),n=o('<div class="n2-ss-item-audio-bar n2-ow n2-ow-all" data-state="paused" data-volume="1"></div>');parseInt(t.show)?(n.css("background-color",N2Color.hex2rgbaCSS(t.color)),parseInt(t.fullwidth)||n.css({display:"inline-flex",verticalAlign:"top"}),o('<div class="n2-ss-item-audio-play"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="'+i+'" d="M20 15.99c0 .41-.21.772-.52.967l-6.867 4.87c-.003 0-.006.002-.01.004l-.003.004c-.158.1-.342.156-.54.156-.585 0-1.06-.504-1.06-1.125v-9.752c0-.622.475-1.126 1.06-1.126.198 0 .382.058.54.157l.004.002.01.006 6.865 4.868c.31.196.52.556.52.97z"/></svg></div>').appendTo(n),o('<div class="n2-ss-item-audio-pause"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="'+i+'" d="M17 22V10h4v12h-4zm-6-12h4v12h-4V10z"/></svg></div>').appendTo(n),parseInt(t["show-progress"])&&(e=o('<div class="n2-ss-item-audio-progress-container"></div>').appendTo(n),e=o('<div class="n2-ss-item-audio-progress" style="background-color:'+s+';"></div>').appendTo(e),o('<div class="n2-ss-item-audio-progress-playhead" style="width:50%;background-color:'+i+';"></div>').appendTo(e)),parseInt(t["show-time"])&&o('<div class="n2-ss-item-audio-time" style="color:'+i+';">01:35 / 03:10</div>').appendTo(n),parseInt(t["show-volume"])&&(o('<div class="n2-ss-item-audio-unmute"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="'+i+'" d="M15 22h-1l-4-4H9c-.45 0-1-.527-1-1v-3c0-.474.55-1 1-1h1l4-4h1v13z"/></div>').appendTo(n),o('<div class="n2-ss-item-audio-mute"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path fill="'+i+'" d="M15 22h-1l-4-4H9c-.45 0-1-.527-1-1v-3c0-.474.55-1 1-1h1l4-4h1v13zm3.147-1.954l-.06.002c-.215 0-.423-.09-.577-.25l-.11-.116c-.286-.3-.32-.776-.078-1.117.612-.865.935-1.892.935-2.968 0-1.158-.367-2.244-1.06-3.14-.266-.342-.24-.837.055-1.148l.11-.115c.162-.172.38-.265.618-.25.23.012.446.126.592.313.963 1.236 1.472 2.737 1.472 4.34 0 1.49-.45 2.912-1.3 4.106-.143.2-.36.324-.597.342zm3.38 2.65c-.15.183-.363.293-.59.303H20.9c-.215 0-.423-.09-.577-.25l-.107-.114c-.3-.314-.32-.817-.048-1.158 1.32-1.644 2.045-3.733 2.045-5.88 0-2.236-.778-4.387-2.19-6.058-.285-.34-.27-.853.034-1.174l.107-.112c.16-.168.365-.26.603-.252.225.006.438.11.587.287C23.06 10.303 24 12.9 24 15.596c0 2.595-.878 5.116-2.474 7.1z"/></svg></div>').appendTo(n),t=o('<div class="n2-ss-item-audio-volume-container"></div>').appendTo(n),t=o('<div class="n2-ss-item-audio-volume" style="background-color:'+s+';"></div>').appendTo(t),o('<div class="n2-ss-item-audio-volumehead" style="background-color:'+i+';"></div>').appendTo(t))):n.css("color",i).html("Audio layer"),this.$item.append(n)},e}),N2D("ItemCaption",["Item"],function(s,t){"use strict";function e(){this.type="caption",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.Item.prototype)).constructor=e).prototype.getLabel=function(){return n2_("Caption")},e.prototype.added=function(){this.needFill=["content","description","image"],this.addedFont("paragraph","fonttitle"),this.addedFont("paragraph","font"),this.generator.registerFields(["#item_captionimage","#item_captioncontent","#item_captionhref"])},e.prototype.parseAll=function(t){t.uid=s.fn.uid(),t.colora=N2Color.hex2rgbaCSS(t.color),t.colorhex=t.color.substr(0,6);var e=t.animation.split("|*|");t.mode=e[0],t.direction=e[1],t.scale=parseInt(e[2]),N2Classes.Item.prototype.parseAll.apply(this,arguments),t.image!=this.fragmentEditor.editor.generator.fill(this.values.image)&&"absolute"==this.layer.placement.getType()&&this.resizeLayerToImage(nextend.imageHelper.fixed(t.image)),t.image=nextend.imageHelper.fixed(t.image)},e.prototype.fitLayer=function(){return"absolute"==this.layer.placement.getType()&&this.resizeLayerToImage(nextend.imageHelper.fixed(this.values.image)),!0},e.prototype._render=function(t){var e=s('<div id="'+t.uid+'" class="n2-ss-item-caption n2-ow"></div>').append(s('<div class="n2-ss-img-wrapper n2-ss-img-crop n2-ow"></div>').append('<img src="'+t.image+'" class="n2-ow"/>')),i=s('<div class="n2-ss-item-caption-content n2-ow" data-verticalalign="'+t.verticalalign+'"></div>').css({background:t.colora}).appendTo(e);t.content&&i.append('<div class="'+t.fonttitleclass+' n2-div-h4 n2-ow">'+t.content+"</div>"),t.description&&i.append('<p class="'+t.fontclass+' n2-ow">'+t.description+"</p>"),this.$item.append(e),new N2Classes.FrontendItemCaption(this.fragmentEditor.editor.frontend,t.uid,t.mode,t.direction,t.scale)},e}),N2D("ItemCirclecounter",["Item"],function(p,t){"use strict";function e(){this.type="circlecounter",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.Item.prototype)).constructor=e).prototype.getLabel=function(){return n2_("Circle counter")},e.prototype.added=function(){this.needFill=["label"],this.addedFont("simple","font"),this.addedFont("simple","fontlabel"),this.generator.registerField("#item_circlecounterlabel")},e.prototype._render=function(t){t.value=parseInt(t.value),t.min=Math.min(0,t.value),t.strokewidth=parseInt(t.strokewidth),t.size=Math.max(parseInt(t.size),t.strokewidth+1),t.startvalue=Math.max(parseInt(t.startvalue),t.min),t.total=Math.max(Math.max(parseInt(t.total),t.startvalue),t.value);var e=(Math.min(t.startvalue,t.total)-t.min)/(t.total-t.min),i=(Math.min(t.value,t.total)-t.min)/(t.total-t.min),s=p('<div class="n2-ss-item-circlecounter-counting-div '+t.fontclass+' n2-ow"></div>'),n=t.size/2,o=(t.size-t.strokewidth)/2,a=Math.PI*o*2,r=(1-e)*a,l='<svg class="svg" viewBox="0 0 '+t.size+" "+t.size+'" style="width:'+t.size+"px;height:"+t.size+'px;" preserveAspectRatio="xMinYMin meet">';l+='<circle class="fl-bar-bg" r="'+o+'" cx="'+n+'" cy="'+n+'" stroke="#'+t.color.substr(0,6)+'" stroke-opacity="'+N2Color.hex2alpha(t.color)+'" stroke-width="'+t.strokewidth+'" stroke-dashoffset="0" stroke-dasharray="'+a+'" fill="transparent"></circle>',l+='<circle class="fl-bar" r="'+o+'" cx="'+n+'" cy="'+n+'" stroke="#'+t.color2.substr(0,6)+'" stroke-opacity="'+N2Color.hex2alpha(t.color2)+'" stroke-width="'+t.strokewidth+'" stroke-dasharray="'+a+'" stroke-dashoffset="'+r+'" transform="rotate(-90 '+n+" "+n+')" fill="transparent"></circle>';var d=p('<div class="n2-ow n2-ss-item-circlecounter-svg-container">'+(l+="</svg>")+"</div>").css({width:t.size}),l=p('<div class="n2-ow n2-ss-item-circlecounter-svg-overlay"></div>').appendTo(d);s.appendTo(l);d.find("circle").eq(1);if(this.$item.append(d),t.label){var h=p('<div class="'+t.fontlabelclass+' n2-ow">'+t.label+"</div>");switch(t.labelplacement){case"before":h.insertBefore(d);break;case"innerbefore":h.insertBefore(s);break;case"innerafter":h.insertAfter(s);break;default:h.insertAfter(d)}}0==t.animationduration&&this.$item.closest(".n2-ss-layer").triggerHandler("deleteCounter"),new N2Classes.CounterItemAdmin(this.fragmentEditor.editor.frontend,d,{name:"circlecounter",c:a,counting:".n2-ss-item-circlecounter-counting-div",display:"circle:eq(1)",displayMode:"circle",delay:t.animationdelay,duration:t.animationduration,fromPercent:e,min:t.min,post:t.post,pre:t.pre,toPercent:i,total:t.total}),N2Classes.LayerNavigationTimeline.get().refreshDuration()},e}),N2D("ItemCounter",["Item"],function(o,t){"use strict";function e(){this.type="counter",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.Item.prototype)).constructor=e).prototype.getLabel=function(){return n2_("Counter")},e.prototype.added=function(){this.needFill=["label","value","startvalue"],this.addedFont("simple","font"),this.addedFont("simple","fontlabel"),this.generator.registerField("#item_counterlabel"),this.generator.registerField("#item_countervalue"),this.generator.registerField("#item_counterstartvalue")},e.prototype._render=function(t){t.value=parseInt(t.value),t.min=Math.min(0,t.value),t.startvalue=Math.max(parseInt(t.startvalue),t.min),t.total=Math.max(Math.max(100,t.startvalue),t.value);var e,i=(Math.min(t.startvalue,t.total)-t.min)/(t.total-t.min),s=(Math.min(t.value,t.total)-t.min)/(t.total-t.min),n=o('<div><div class="n2-ss-item-counter-counting-div '+t.fontclass+' n2-ow">'+t.pre+100*s+t.post+"</div></div>");this.$item.append(n),t.label&&(e=o('<div class="'+t.fontlabelclass+' n2-ow">'+t.label+"</div>"),"before"===t.labelplacement?e.insertBefore(n):e.insertAfter(n)),0==t.animationduration&&this.$item.closest(".n2-ss-layer").triggerHandler("deleteCounter"),new N2Classes.CounterItemAdmin(this.fragmentEditor.editor.frontend,n,{name:"counter",counting:".n2-ss-item-counter-counting-div",displayMode:!1,delay:t.animationdelay,duration:t.animationduration,fromPercent:i,min:t.min,post:t.post,pre:t.pre,toPercent:s,total:t.total}),N2Classes.LayerNavigationTimeline.get().refreshDuration()},e}),N2D("ItemHighlightedHeading",["Item"],function(a,r){"use strict";function l(){this.type="highlightedHeading",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((l.prototype=Object.create(N2Classes.Item.prototype)).constructor=l).svg={},l.prototype.getLabel=function(){return n2_("Highlighted heading")},l.prototype.getDefault=function(){return{font:"",style:"","font-highlight":"","style-highlight":""}},l.prototype.added=function(){this.needFill=["before-text","highlighted-text","after-text"],this.addedFont("highlight","font"),this.addedStyle("highlight","style"),this.generator.registerFields(["#item_highlightedHeadingbefore-text","#item_highlightedHeadinghighlighted-text","#item_highlightedHeadingafter-text","#item_highlightedHeadinghref"])},l.prototype.parseAll=function(t){t.uid=a.fn.uid(),t.display="inline-block",t.priority=2,t.class="",N2Classes.Item.prototype.parseAll.apply(this,arguments),t.afontclass="",t.astyleclass=""},l.prototype._render=function(t){var e=a('<div id="'+t.uid+'" class="n2-ss-highlighted-heading-wrapper  '+t.fontclass+" "+t.styleclass+'"></div>'),i=t["before-text"],s=t["highlighted-text"],n=t["after-text"],o="";""!==i&&(o+='<div class="n2-ss-highlighted-heading-before">'+i+"</div>"),""!==s&&(i="",l.svg[t.type]!==r&&(i=l.svg[t.type],o+="<style>"+("div#n2-ss-0 #"+t.uid+" svg path{stroke: #"+t.color.substr(0,6)+";stroke-opacity: "+N2Color.hex2alpha(t.color)+";stroke-width: "+t.width+"px;}")+"</style>"),"#"===t.href||""===t.href?o+="<div ":o+='<a href="#" ',o+='class="n2-highlighted n2-ss-highlighted-heading-highlighted n2-ow" data-highlight="'+t.type+'" data-animate="'+t.animate+'" data-delay="'+t.delay+'" data-duration="'+t.duration+'" data-loop="'+t.loop+'" data-loop-delay="'+t["loop-delay"]+'" data-front="'+t.front+'"><div class="n2-ss-highlighted-heading-highlighted-text">'+s+"</div>"+i,"#"===t.href||""===t.href?o+="</div>":o+="</a>"),""!==n&&(o+='<div class="n2-ss-highlighted-heading-after">'+n+"</div>"),e.html(o),this.$item.append(e),new N2Classes.HighlightedHeadingItemAdmin(e.find(".n2-ss-highlighted-heading-highlighted").get(0),this.fragmentEditor.editor.frontend),N2Classes.LayerNavigationTimeline.get().refreshDuration()},l}),N2D("ItemHtml",["Item"],function(i,t){"use strict";function e(){this.type="html",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.Item.prototype)).constructor=e).prototype.getLabel=function(){return n2_("HTML")},e.prototype.hasTextScale=function(){return!1},e.prototype.added=function(){this.needFill=["html"],this.generator.registerField("#item_htmlhtml")},e.prototype._render=function(t){var e=i('<div class="n2-notow">').css("text-align",t.textalign).html(t.html);t.css.trim()&&e.append('<style type="text/css">'+t.css+"</style>"),this.$item.append(e)},e}),N2D("ItemList",["Item"],function(n,t){"use strict";function e(){this.type="list",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.Item.prototype)).constructor=e).prototype.getLabel=function(){return n2_("List")},e.prototype.added=function(){this.needFill=["content"],this.addedFont("list","font"),this.addedStyle("heading","liststyle"),this.addedStyle("heading","itemstyle"),this.generator.registerField("#item_listcontent")},e.prototype._render=function(t){for(var e=n('<ol class="'+t.liststyleclass+" "+t.fontclass+' n2-ow" style="list-style-type: '+t.type+'"></ol>'),i=t.content.split("\n"),s=0;s<i.length;s++)e.append('<li class="'+t.itemstyleclass+'">'+i[s]+"</li>");this.$item.append(e)},e}),N2D("ItemIcon2",["Item"],function(s,t){"use strict";function e(){this.type="icon2",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.Item.prototype)).constructor=e).prototype.getLabel=function(){return n2_("Icon")},e.prototype.added=function(){this.addedStyle("box","style")},e.prototype.parseAll=function(t){t.uid=s.fn.uid();var e=N2Classes.Icons.render(t.icon);e?(t.ligature=e.ligature,t.iconclass=e.class):(t.ligature=n2_("Icon not found"),t.iconclass=""),N2Classes.Item.prototype.parseAll.apply(this,arguments)},e.prototype._render=function(t){var e=s('<span class="n2i '+t.styleclass+" "+t.uid+" "+t.iconclass+'">'+t.ligature+"</span>").css("fontSize",t.size/16*100+"%"),i=window.nextend.pre+" ."+t.uid+"{color:"+N2Color.hex2rgbaCSS(t.color)+";}";0<N2Color.hex2alpha(t.colorhover)&&(i+=window.nextend.pre+" ."+t.uid+":HOVER{color:"+N2Color.hex2rgbaCSS(t.colorhover)+";}"),e.append("<style>"+i+"</style>"),this.$item.append(e)},e}),N2D("ItemIframe",["Item"],function(e,t){"use strict";function i(){this.type="iframe",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((i.prototype=Object.create(N2Classes.Item.prototype)).constructor=i).needWidth=!0,i.needHeight=!0,i.prototype.getLabel=function(){return n2_("Iframe")},i.prototype.hasTextScale=function(){return!1},i.prototype.added=function(){this.needFill=["url"],this.generator.registerField("#item_iframeurl")},i.prototype.parseAll=function(t){var e=t.size.split("|*|");t.width=e[0],t.height=e[1],delete t.size,N2Classes.Item.prototype.parseAll.apply(this,arguments)},i.prototype._render=function(t){t=e('<iframe sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin" src="'+t.url+'" class="n2-ow" width="'+t.width+'" height="'+t.height+'" style="border:0;min-height:50px;"></iframe>');this.$item.append(t)},i}),N2D("ItemImagearea",["Item"],function(e,t){"use strict";function i(){this.type="imagearea",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((i.prototype=Object.create(N2Classes.Item.prototype)).constructor=i).needWidth=!0,i.needHeight=!0,i.prototype.getLabel=function(){return n2_("Image area")},i.prototype.hasTextScale=function(){return!1},i.prototype.added=function(){this.needFill=["image"],this.generator.registerFields(["#item_imageareaimage","#item_imageareahref"])},i.prototype.parseAll=function(t){N2Classes.Item.prototype.parseAll.apply(this,arguments),t.image=nextend.imageHelper.fixed(t.image)},i.prototype.fitLayer=function(){return!0},i.prototype._render=function(t){t=e('<div class="n2-ow"></div>').css({display:"inline-block",verticalAlign:"top",width:"100%",height:"100%",background:"url("+t.image+") no-repeat",backgroundSize:t.fillmode,backgroundPosition:t.positionx+"% "+t.positiony+"%"});this.$item.append(t)},i}),N2D("ItemImagebox",["Item"],function(o,t){"use strict";function e(){this.type="imagebox",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.Item.prototype)).constructor=e).prototype.getLabel=function(){return n2_("Image box")},e.prototype.added=function(){this.needFill=["image","heading","description"],this.addedFont("hover","fonttitle"),this.addedFont("paragraph","fontdescription"),this.addedStyle("box","style"),this.generator.registerFields(["#item_imageboximage","#item_imageboximagealt","#item_imageboxheading","#item_imageboxdescription","#item_imageboxhref"])},e.prototype.parseAll=function(t){t.classes="",parseInt(t.fullwidth)&&(t.classes+=" n2-ss-fullwidth"),N2Classes.Item.prototype.parseAll.apply(this,arguments)},e.prototype._render=function(t){var e,i=o('<div class="n2-ss-item-imagebox-container n2-ow-all '+t.classes+'" data-layout="'+t.layout+'" data-csstextalign="'+t.inneralign+'"></div>').addClass(t.styleclass),s=o('<div class="n2-ss-item-imagebox-image n2-ow"></div>').appendTo(i),n=o('<div class="n2-ss-item-imagebox-content n2-ow"></div>').css("padding",t.padding.split("|*|").join("px ")+"px").appendTo(i);"left"!==t.layout&&"right"!==t.layout||i.attr("data-verticalalign",t.verticalalign),t.icon&&"icon"===t.imagetype?(e=N2Classes.Icons.render(t.icon),o('<i class="n2i '+e.class+'">'+e.ligature+"</i>").css({fontSize:t.iconsize/16*100+"%",color:N2Color.hex2rgbaCSS(t.iconcolor)}).appendTo(s)):t.image?(e=o('<img src="'+nextend.imageHelper.fixed(t.image)+'" />').appendTo(s),("top"===t.layout||"bottom"===t.layout?e:s).css({maxWidth:t.imagewidth+"%"})):s.remove(),t.heading&&o('<div class="n2-ow '+t.fonttitleclass+'">'+t.heading+"</div>").appendTo(n),t.description&&o('<div class="n2-ow '+t.fontdescriptionclass+'">'+t.description+"</div>").appendTo(n),this.$item.append(i)},e}),N2D("ItemInput",["Item"],function(i,t){"use strict";function e(){this.type="input",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.Item.prototype)).constructor=e).prototype.getLabel=function(){return n2_("Input")},e.prototype.getDefault=function(){return{font:"",style:""}},e.prototype.added=function(){this.needFill=["placeholder","buttonlabel","class"],this.addedStyle("heading","style"),this.addedFont("simple","inputfont"),this.addedStyle("heading","inputstyle"),this.addedFont("hover","buttonfont"),this.addedStyle("heading","buttonstyle"),this.generator.registerFields(["#item_inputname","#item_inputplaceholder","#item_inputbuttonlabel","#item_inputaction","#item_inputparameters","#item_inputclass"])},e.prototype._render=function(t){var e=i('<div class="n2-ss-item-input-form '+t.styleclass+" "+t.class+' n2-ow"></div>');e.append('<div class="n2-input n2-ow '+t.inputfontclass+" "+t.inputstyleclass+'">'+t.placeholder+"</div>"),""!=t.buttonlabel.trim()&&e.append('<div class="n2-form-button n2-ow '+t.buttonfontclass+" "+t.buttonstyleclass+'">'+t.buttonlabel+"</div>"),this.$item.append(e)},e}),N2D("ItemProgressbar",["Item"],function(r,t){"use strict";function e(){this.type="progressbar",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.Item.prototype)).constructor=e).prototype.getLabel=function(){return n2_("Progress bar")},e.prototype.added=function(){this.needFill=["label"],this.addedFont("simple","font"),this.addedFont("simple","fontlabel"),this.generator.registerField("#item_progressbarlabel")},e.prototype._render=function(t){t.value=parseInt(t.value),t.min=Math.min(0,t.value),t.startvalue=Math.max(parseInt(t.startvalue),t.min),t.total=Math.max(Math.max(parseInt(t.total),t.startvalue),t.value);var e=(Math.min(t.startvalue,t.total)-t.min)/(t.total-t.min),i=(Math.min(t.value,t.total)-t.min)/(t.total-t.min),e=t.total!==t.min?(i=(Math.min(t.value,t.total)-t.min)/(t.total-t.min),0==t.animationduration?i:(Math.min(t.startvalue,t.total)-t.min)/(t.total-t.min)):i=t.animationduration=0,s=r('<div class="n2-ow n2-ss-item-progressbar-container"></div>'),n=r('<div class="n2-ow n2-ss-item-progressbar"></div>').css({backgroundColor:N2Color.hex2rgbaCSS(t.color)}).appendTo(s),n=r('<div class="n2-ow n2-ss-item-progressbar-inner"></div>').css({backgroundColor:N2Color.hex2rgbaCSS(t.color2),width:100*e+"%"}).appendTo(n),o=r('<div class="n2-ss-item-progressbar-counting '+t.fontclass+' n2-ow"></div>').html(t.pre+(t.min+e*(t.total-t.min)).toFixed(0)+t.post).appendTo(n);if(t.label){var a=r('<div class="n2-ss-item-progressbar-label n2-ow '+t.fontlabelclass+'">'+t.label+"</div>");switch(t.labelplacement){case"before":a.prependTo(s);break;case"over":a.insertBefore(o);break;default:a.appendTo(s)}}this.$item.append(s),0==t.animationduration&&this.$item.closest(".n2-ss-layer").triggerHandler("deleteCounter"),new N2Classes.CounterItemAdmin(this.fragmentEditor.editor.frontend,s,{name:"progressbar",counting:".n2-ss-item-progressbar-counting",display:".n2-ss-item-progressbar-inner",displayMode:"width",delay:t.animationdelay,duration:t.animationduration,fromPercent:e,min:t.min,post:t.post,pre:t.pre,toPercent:i,total:t.total}),N2Classes.LayerNavigationTimeline.get().refreshDuration()},e}),N2D("ItemTransition",["Item"],function(s,t){"use strict";function e(){this.type="transition",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.Item.prototype)).constructor=e).prototype.getLabel=function(){return n2_("Transition")},e.prototype.hasTextScale=function(){return!1},e.prototype.added=function(){this.needFill=["image","image2"],this.generator.registerFields(["#item_transitionimage","#item_transitionimage2","#item_transitionalt","#item_transitionalt2","#linkitem_transitionlink-1"])},e.prototype.parseAll=function(t){t.uid=s.fn.uid(),N2Classes.Item.prototype.parseAll.apply(this,arguments);var e=t.image;t.image=nextend.imageHelper.fixed(t.image),t.image2=nextend.imageHelper.fixed(t.image2),e!=this.fragmentEditor.editor.generator.fill(this.values.image)&&"absolute"==this.layer.placement.getType()&&this.resizeLayerToImage(nextend.imageHelper.fixed(t.image))},e.prototype._render=function(t){var e=s('<div id="'+t.uid+'" class="n2-ss-item-transition n2-ow"></div>'),i=e;""!=t.href&&"#"!=t.href&&(i=s('<a href="#" onclick="return false;" class="n2-ow"></a>').appendTo(e));i=s('<div class="n2-ss-item-transition-inner n2-ss-img-wrapper n2-ow"></div>').appendTo(i);s('<img src="'+t.image+'" class="n2-ss-item-transition-image1 n2-ow" />').appendTo(i),s('<img src="'+t.image2+'" class="n2-ss-item-transition-image2 n2-ow" />').appendTo(i),this.$item.append(e),new N2Classes.FrontendItemTransition(this.fragmentEditor.editor.frontend,t.uid,t.animation)},e.prototype.fitLayer=function(){return"absolute"==this.layer.placement.getType()&&this.resizeLayerToImage(nextend.imageHelper.fixed(this.values.image)),!0},e}),N2D("ItemVideo",["Item"],function(s,t){"use strict";function e(){this.type="video",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.Item.prototype)).constructor=e).needWidth=!0,e.prototype.getLabel=function(){return n2_("Video")},e.prototype.hasTextScale=function(){return!1},e.prototype.added=function(){this.needFill=["video_mp4"],this.generator.registerField("#item_videovideo_mp4")},e.prototype.fitLayer=function(){return!0},e.prototype.parseAll=function(t){var e,i;this.values.video_mp4!==t.video_mp4&&(e=nextend.imageHelper.fixed(t.video_mp4),i=s.Deferred(),(t=document.createElement("video")).addEventListener("loadedmetadata",function(){var t=this.videoHeight,e=this.videoWidth;i.resolve({height:t,width:e})},!1),t.src=e,i.done(function(t){var e=s("#item_videoaspect-ratio_select"),i=t.width/t.height;i==16/9?setTimeout(function(){e.val("16:9").trigger("change")},100):1.6==i?setTimeout(function(){e.val("16:10").trigger("change")},100):i==4/3?setTimeout(function(){e.val("4:3").trigger("change")},100):setTimeout(function(){e.val("custom").trigger("change"),s("#item_videoaspect-ratio-width").val(t.width).trigger("change"),s("#item_videoaspect-ratio-height").val(t.height).trigger("change")},100)}.bind(this)))},e.prototype._render=function(t){var e="";"custom"===t["aspect-ratio"]&&(e="padding-top:"+t["aspect-ratio-height"]/t["aspect-ratio-width"]*100+"%");t=s('<div class="n2_ss_video_player n2-ss-item-content n2-ss-item-video-container n2-ow-all"><div class="n2_ss_video_player__placeholder" style="'+e+'"></div></div>').attr("data-aspect-ratio",t["aspect-ratio"]).css({background:"url("+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/video.png")+") no-repeat 50% 50%",backgroundSize:"cover"});this.$item.append(t)},e}),N2D("BackendLayerAnimationController",["Historical"],function(n,s){"use strict";var o={repeatable:0,startDelay:0,endDelay:0,loopRepeatSelfOnly:0,inPlayEvent:"",loopPlayEvent:"",loopPauseEvent:"",loopStopEvent:"",outPlayEvent:""};function t(t){this.ready=n.Deferred(),this._loaded=!1,this.active=!1,this.layer=t}return N2Classes.Historical(t),t.prototype.onReadyListener=function(t){this.ready.done(t)},t.prototype.init=function(){var t,e,i;this.layerNavigationTimeline=N2Classes.LayerNavigationTimeline.get(),this.sidebar=this.layer.layerRow,this.contentArea=n('<div class="n2_timeline_layer"></div>'),this.content=n('<div class="n2_timeline_layer__animations"></div>').data("layer",this.layer).appendTo(this.contentArea),this.layer.container!==s&&(this.containerArea=n('<div class="n2_timeline_layer__children"></div>').appendTo(this.contentArea)),this.getTargetTimelineContainer().append(this.contentArea),this.layer.layer.on({"n2-ss-activate":function(){this.content.addClass("n2_timeline_layer__animations--active")}.bind(this),"n2-ss-deactivate":function(){this.content.removeClass("n2_timeline_layer__animations--active")}.bind(this),opened:function(){this.contentArea.removeClass("n2_timeline_layer--closed")}.bind(this),closed:function(){this.contentArea.addClass("n2_timeline_layer--closed")}.bind(this)}),this.layer.isAnimatable&&(t=n('<div class="n2_timeline_animation_group" data-group="in"></div>').appendTo(this.content),e=n('<div class="n2_timeline_animation_group" data-group="loop"></div>').appendTo(this.content),i=n('<div class="n2_timeline_animation_group" data-group="out"></div>').appendTo(this.content),this.structure={in:{holders:[n('<div class="n2_timeline_animation_group__row" data-row="1"></div>').appendTo(t),n('<div class="n2_timeline_animation_group__row" data-row="2"></div>').appendTo(t)],length:0},loop:{holders:[n('<div class="n2_timeline_animation_group__row" data-row="1"></div>').appendTo(e),n('<div class="n2_timeline_animation_group__row" data-row="2"></div>').appendTo(e)],length:0},out:{holders:[n('<div class="n2_timeline_animation_group__row" data-row="1"></div>').appendTo(i),n('<div class="n2_timeline_animation_group__row" data-row="2"></div>').appendTo(i)],length:0}},n('<div data-n2tip="'+n2_("Add animation")+'" class="n2_layer_navigation_list_layer__title_action n2_layer_navigation_list_layer__title_action--add-animation"><i class="ssi_16 ssi_16--animation"></i></div>').on("click",function(t){N2Classes.WindowManager.actionPrevent("ComponentRowActivate"),this.layer.activate(!0),n('.n2_ss_layer_window .n2_ss_layer_window__tab_button[data-related-tab="animations"]').trigger("click"),n('.n2_ss_layer_window .n2_container_animation__button[data-related-tab="in"]').triggerHandler("click"),this.layer.fragmentEditor.layerNavigation.interaction.detachFromLayerWindow()}.bind(this)).insertBefore(this.layer.$layerRowActions.find(".n2_layer_navigation_list_layer__title_action:last-child")),n('<div data-n2tip="'+n2_("Remove animations")+'" class="n2_layer_navigation_list_layer__title_action n2_layer_navigation_list_layer__title_action--remove-animation"><i class="ssi_16 ssi_16--clearanimation"></i></div>').on("click",function(){N2Classes.WindowManager.actionPrevent("ComponentRowActivate"),this.layer.activate(!0),this.deleteEveryGroup()}.bind(this)).insertBefore(this.layer.$layerRowActions.find(".n2_layer_navigation_list_layer__title_action:last-child")),nextend.tooltip.add(this.layer.layerRow)),this.layer.$.on({"layerDeleted.animations":this.deleted.bind(this)})},t.prototype.onSelfChange=function(){for(var t in this.animationTypes)this.animationTypes[t].setSelf(this.self.animationTypes[t])},t.prototype.load=function(){if(this.layer.isAnimatable&&!1===this._loaded){var t,e=this.layer.layer.data("animv2");this.data={},n.extend(this.data,o);try{e!==s&&("object"!=typeof e&&(e=n.parseJSON(e)),n.extend(this.data,e))}catch(t){}for(t in this.animationTypes={basic:new N2Classes.TimelineAnimationBasic(this),reveal:new N2Classes.TimelineAnimationReveal(this)},this.animationTypes)this.animationTypes[t].start(this.data[t]),delete this.data[t];this._loaded=!0,this.onUpdate(),this.ready.resolve()}},t.prototype.deleted=function(){this.contentArea.remove(),this.layer.$.off(".animations")},t.prototype.syncRow=function(t,e){t!==s?this.contentArea.insertBefore(t.animations.contentArea):this.getTargetTimelineContainer().append(this.contentArea)},t.prototype.getTargetTimelineContainer=function(){return this.layer.isMainGroup?this.layerNavigationTimeline.contentContainer:this.layer.group.animations.containerArea},t.prototype.onUpdate=function(){this.renderRepeatable(this.data.repeatable),this.renderStartDelay(this.data.startDelay),this.renderEndDelay(this.data.endDelay),this.content.toggleClass("n2_timeline_layer__animations--has-animation",!!(this.structure.in.length||this.structure.loop.length||this.structure.out.length)),this.layer.updateAnimations();var t=Math.max(Math.max(Math.max(1,this.structure.in.length),this.structure.loop.length),this.structure.out.length);this.content.attr("data-rows",t),this.layer.layerTitle.attr("data-rows",t),this.fixTimelineTotalDuration()},t.prototype.getEditor=function(t){return!!this.structure[t].primary&&this.structure[t].primary.getEditor()},t.prototype.loadData=function(t){var e,i;for(e in this.structure)this.structure[e].primary&&this.structure[e].primary.remove();for(e in this.data=n.extend(!0,{},o,t),this.animationTypes)this.data[e]!==s&&(i=this.data[e],delete this.data[e],this.animationTypes[e].loadData(i));this.onUpdate()},t.prototype.replaceGroupData=function(t,e){this.animationTypes[e.type].replaceGroupDataWithPreset(t,e)},t.prototype.setData=function(t,e){var i;this.data[t]!==s&&this.data[t]!==e&&((i=N2Classes.History.get().addValue(this,this.historySetData,[t]))&&i.setValues(this.data[t],e),this._setData(t,e))},t.prototype.historySetData=function(t,e){this._setData(e,t)},t.prototype._setData=function(t,e){this.data[t]=e,this.onUpdate()},t.prototype.getAnimationsCode=function(){if(!1===this._loaded)return this.layer.layer.data("animv2");var t=this.getData();return JSON.stringify(t)},t.prototype.getData=function(){var t,e=n.extend({},this.data);for(t in this.animationTypes){var i=this.animationTypes[t].getData(!0);!1!==i&&(e[t]=i)}var s=nextend.deepDiff.map(e,o);return n.isEmptyObject(s)?"":s},t.prototype.hasAnimation=function(){for(var t in this.animationTypes)if(this.animationTypes[t].hasAnimation())return!0;return!1},t.prototype.fixTimelineTotalDuration=function(){this.layerNavigationTimeline.refreshDuration()},t.prototype.addPrimaryAnimation=function(t,e){this.structure[t].primary!==s&&this.structure[t].primary.remove(),e.setHolder(this.structure[t].holders[0]),this.structure[t].primary=e,this.structure[t].length++},t.prototype.removePrimaryAnimation=function(t,e){this.structure[t].primary&&this.structure[t].primary===e&&(delete this.structure[t].primary,this.structure[t].length--,this.onUpdate())},t.prototype.addExtraAnimation=function(t,e,i){this.structure[t][e],this.structure[t].length++,this.structure[t][e]=this,i.bar.bar.appendTo(this.structure[t].holders[1]),this.onUpdate()},t.prototype.removeExtraAnimation=function(t,e,i){delete this.structure[t][e],this.structure[t].length--,this.onUpdate()},t.prototype.deleteEveryGroup=function(){this.setData("startDelay",0),this.setData("endDelay",0),this.removeGroup("in"),this.removeGroup("loop"),this.removeGroup("out"),this.onUpdate()},t.prototype.removeGroup=function(t){this.structure[t].primary&&this.structure[t].primary.remove()},t.prototype.createUIStartDelay=function(){this.$startDelayContainer===s&&(this.$startDelayContainer=n('<div class="n2_timeline_animation_repeat n2_timeline_animation_repeat--start"></div>').prependTo(this.content),new N2Classes.UIDraggableDelay(this.$startDelayContainer,{drag:function(t,e){e.currentData.width=this.layerNavigationTimeline.normalizeOffsetX(e.currentData.width);e=this.layerNavigationTimeline.offsetXToDuration(e.currentData.width);.15<=e?this.$startDelayContainer.text(1e3*e):this.$startDelayContainer.text("")}.bind(this),stop:function(t,e){e=this.layerNavigationTimeline.offsetXToDuration(e.currentData.width);this.setData("startDelay",e)}.bind(this)}))},t.prototype.createUIEndDelay=function(){this.$endDelayContainer===s&&(this.$endDelayContainer=n('<div class="n2_timeline_animation_repeat n2_timeline_animation_repeat--end"></div>').appendTo(this.content),new N2Classes.UIDraggableDelay(this.$endDelayContainer,{drag:function(t,e){e.currentData.width=this.layerNavigationTimeline.normalizeOffsetX(e.currentData.width);e=this.layerNavigationTimeline.offsetXToDuration(e.currentData.width);.15<=e?this.$endDelayContainer.text(1e3*e):this.$endDelayContainer.text("")}.bind(this),stop:function(t,e){e=this.layerNavigationTimeline.offsetXToDuration(e.currentData.width);this.setData("endDelay",e)}.bind(this)}))},t.prototype.renderRepeatable=function(t){t&&(this.createUIStartDelay(),this.createUIEndDelay()),this.content.toggleClass("n2_timeline_layer__animations--repeated",!!t)},t.prototype.renderStartDelay=function(t){this.$startDelayContainer!==s&&(this.$startDelayContainer.width(this.layerNavigationTimeline.durationToOffsetX(t)),.15<=t?this.$startDelayContainer.text(1e3*t):this.$startDelayContainer.text(""))},t.prototype.renderEndDelay=function(t){this.$endDelayContainer!==s&&(this.$endDelayContainer.width(this.layerNavigationTimeline.durationToOffsetX(t)),.15<=t?this.$endDelayContainer.text(1e3*t):this.$endDelayContainer.text(""))},t.prototype.clearDeviceSpecific=function(t){this.animationTypes&&this.animationTypes.basic.clearDeviceSpecific(t)},t}),N2D("LayerWindowAnimationEditor",["TimelineAnimationBasicEditor"],function(d,i){"use strict";function t(t){for(var e in this.$presetsList={in:!1,loop:!1,out:!1},this.presets=d.extend({in:{},loop:{},out:{}},window.ss3LayerAnimationPresets),delete window.ss3LayerAnimationPresets,this.currentEditor=!1,this.insideUpdate=!1,this.timeline=null,this.animationManager=t,this.currentTab=0,this.$container=d('.n2_container_animation[data-field="animation-animation"]'),this.$buttons=this.$container.find("> .n2_container_animation__buttons > .n2_container_animation__button").on("click",this.showTab.bind(this)),this.$tabs=this.$container.find("> .n2_container_animation__tabs > .n2_container_animation__tab"),this.$buttons.eq(0).triggerHandler("click"),this.tabsDict={in:{index:0,$tab:this.$tabs.eq(0)},loop:{index:1,$tab:this.$tabs.eq(1)},out:{index:2,$tab:this.$tabs.eq(2)},events:{index:3,$tab:this.$tabs.eq(3)}},this.activeLayer=null,this.animationManager.fragmentEditor.$.on("activeLayerChanged",this.loadDataForLayer.bind(this)),this.editors={basic:new N2Classes.TimelineAnimationBasicEditor(this),reveal:new N2Classes.TimelineAnimationRevealEditor(this)},this.globalForm={inPlayEvent:{input:d("#layerin-play-event"),set:function(t){this.input.data("field").insideChange(t)},get:function(){return this.input.val()}},outPlayEvent:{input:d("#layerout-play-event"),set:function(t){this.input.data("field").insideChange(t)},get:function(){return this.input.val()}},loopPlayEvent:{input:d("#layerloop-play-event"),set:function(t){this.input.data("field").insideChange(t)},get:function(){return this.input.val()}},loopPauseEvent:{input:d("#layerloop-pause-event"),set:function(t){this.input.data("field").insideChange(t)},get:function(){return this.input.val()}},loopStopEvent:{input:d("#layerloop-stop-event"),set:function(t){this.input.data("field").insideChange(t)},get:function(){return this.input.val()}},repeatable:{input:d("#layerrepeatable"),set:function(t){this.input.data("field").insideChange(t)},get:function(){return parseInt(this.input.val())}},startDelay:{input:d("#layerstart-delay"),set:function(t){this.input.data("field").insideChange(1e3*t)},get:function(){return parseInt(this.input.val())/1e3}},endDelay:{input:d("#layerend-delay"),set:function(t){this.input.data("field").insideChange(1e3*t)},get:function(){return parseInt(this.input.val())/1e3}},loopRepeatSelfOnly:{input:d("#layerloop-repeat-self-only"),set:function(t){this.input.data("field").insideChange(t)},get:function(){return parseInt(this.input.val())}}},this.globalForm)this.globalForm[e].input.on("outsideChange.n2-editor",function(t,e){this.insideUpdate=!0,this.activeLayer.animations.setData(t,this.globalForm[t].get()),this.insideUpdate=!1}.bind(this,e));d("body").on("timelinePlay",this.previewCancel.bind(this))}return t.prototype.showTab=function(t){t.preventDefault();var e=d(t.currentTarget),t=e.data("related-tab");this.currentTab!==t&&(this.$buttons.removeClass("n2_container_animation__button--active"),this.$tabs.removeClass("n2_container_animation__tab--active"),e.addClass("n2_container_animation__button--active"),this.$tabs.filter('[data-tab="'+t+'"]').addClass("n2_container_animation__tab--active"),this.currentTab=t,this.updateCurrentTab())},t.prototype.loadDataForLayer=function(){var t;"animations"===this.animationManager.fragmentEditor.layerWindow.tab.getActiveTabName()&&(t=this.animationManager.getActiveLayer(),this.activeLayer!==t&&(this.activeLayer=t,this.updateCurrentTab()))},t.prototype.updateEventsTab=function(){var t,e=this.activeLayer.animations;for(t in e.data)this.globalForm[t]!==i&&this.globalForm[t].get()!==e.data[t]&&this.globalForm[t].set(e.data[t])},t.prototype.updateCurrentTab=function(){var t,e,i;this.activeLayer&&!this.insideUpdate&&("events"===this.currentTab?this.updateEventsTab():(t=this.tabsDict[this.currentTab].$tab,e=this.currentTab,i=this.activeLayer.animations,this.onBeforeClearAnimationsTab(),t.empty(),(i=i.getEditor(e))?(this.currentEditor=i).display(t):(this.previewCancel(),this.getPresetList(e).appendTo(t))))},t.prototype.onBeforeClearAnimationsTab=function(){if(this.currentEditor)this.currentEditor.close(),this.currentEditor=!1;else for(var t in this.$presetsList)this.$presetsList[t]&&this.$presetsList[t].detach()},t.prototype.getPresetList=function(t){if(!1===this.$presetsList[t]){var e,i,s=this.presets[t],n=d('<div class="n2_layer_window_animations_presets"></div>'),o=d('<div class="n2_layer_window_animations_presets__buttons"></div>').appendTo(n),a=0;for(i in s){e=d('<div class="n2_layer_window_animations_presets__presets"></div>').appendTo(n),d('<div class="n2_layer_window_animations_presets__button"><i class="ssi_24 '+s[i].icon+'"></i><div class="n2_layer_window_animations_presets__button_label">'+s[i].label+"</div></div>").data("ul",e).attr("data-group",i).on("click",function(){var t=d(this),e=t.parent(),i=e.data("active");i&&(i.removeClass("n2_layer_window_animations_presets__button--active"),i.data("ul").removeClass("n2_layer_window_animations_presets__presets--active")),e.data("active",t),t.addClass("n2_layer_window_animations_presets__button--active"),t.data("ul").addClass("n2_layer_window_animations_presets__presets--active")}).appendTo(o);for(var r=0;r<s[i].a.length;r++){var l=s[i].a;d('<div class="n2_layer_window_animations_presets__preset"></div>').appendTo(e).on({mouseenter:this.previewPlay.bind(this,t,l[r]),mouseleave:this.previewCancel.bind(this),click:this.replaceWithPreset.bind(this,t,l[r])}).text(l[r].name)}a++}if(1===a)e.addClass("n2_layer_window_animations_presets__presets--active"),o.remove();else for(o.find(".n2_layer_window_animations_presets__button:eq(0)").triggerHandler("click");a%4!=0;a++)d("<div></div>").appendTo(o);this.$presetsList[t]=n}return this.$presetsList[t]},t.prototype.previewPlay=function(t,e){this.editors[e.type]!==i&&(this.previewEditor=this.editors[e.type],this.previewEditor.previewPreset(t,d.extend(!0,{},e)))},t.prototype.previewCancel=function(){this.previewEditor&&(this.previewEditor.previewCancel(),this.previewEditor=!1)},t.prototype.replaceWithPreset=function(t,e,i){i.preventDefault(),this.previewCancel(),this.activeLayer.animations.replaceGroupData(t,d.extend(!0,{},e))},t.prototype.update=function(t){t===this.activeLayer&&this.updateCurrentTab()},t}),N2D("LayerNavigationTimeline",function(s,t){"use strict";function i(t,e){this.fragmentEditor=t,this.layerNavigation=e,this.oneSecWidth=200,this.oneSecMs=1e3,this.fps=20,this.pxToFrame=this.oneSecWidth/this.fps,e.$layerNavigation.addClass("n2_layer_navigation--has_timeline"),this.$timeline=s('<div class="n2_timeline"></div>').appendTo(e.$layerNavigation),this.$timelineInner=s('<div class="n2_timeline__inner_pane"></div>').appendTo(this.$timeline),(i.instance=this).initTimeFrame(),this.contentContainer=s('<div class="n2_timeline_layers"></div>').appendTo(this.$timelineInner),this._extendTimeFrame(0),this.initCurrentTimeIndicator(),this.timelineControl=new N2Classes.TimelineControl(this),this.layerWindowEditor=new N2Classes.LayerWindowAnimationEditor(this),this.layerNavigation.addScrollPane(this.$timeline),this.layerNavigation.scrollBarHeight=n2const.getScrollbarSize(),this.onResize(),s(window).on("resize",this.onResize.bind(this))}return i.get=function(){return i.instance},i.prototype.onResize=function(){this.slideCTI.height(this.layerNavigation.$layerNavigation.height()-n2const.getScrollbarSize()-3)},i.prototype.durationToOffsetX=function(t){return t*this.oneSecWidth},i.prototype.offsetXToDuration=function(t){return t/this.oneSecWidth},i.prototype.normalizeOffsetX=function(t){return Math.round(t/this.pxToFrame)*this.pxToFrame},i.prototype.getActiveLayer=function(){return this.fragmentEditor.getActiveLayer()},i.prototype.initTimeFrame=function(){this.timeMarker=s('<div class="n2_timeline__time_frames"></div>').appendTo(this.$timelineInner),s('<div class="n2_timeline__time_frames_overlay"></div>').append('<svg><defs><symbol id="n2-timeline-big"><rect y="2" width="1" height="46" fill="currentColor" /></symbol><symbol id="n2-timeline-medium"><rect y="38" width="1" height="10" fill="currentColor" /></symbol><symbol id="n2-timeline-small"><rect y="43" width="1" height="5" fill="currentColor" /></symbol></defs><pattern id="n2-timeline-pattern" viewBox="0 0 200 48" width="200" height="48" patternUnits="userSpaceOnUse"><use xlink:href="#n2-timeline-big" x="0" /><use xlink:href="#n2-timeline-small" x="10" /><use xlink:href="#n2-timeline-medium" x="20" /><use xlink:href="#n2-timeline-small" x="30" /><use xlink:href="#n2-timeline-medium" x="40" /><use xlink:href="#n2-timeline-small" x="50" /><use xlink:href="#n2-timeline-medium" x="60" /><use xlink:href="#n2-timeline-small" x="70" /><use xlink:href="#n2-timeline-medium" x="80" /><use xlink:href="#n2-timeline-small" x="90" /><use xlink:href="#n2-timeline-medium" x="100" /><use xlink:href="#n2-timeline-small" x="110" /><use xlink:href="#n2-timeline-medium" x="120" /><use xlink:href="#n2-timeline-small" x="130" /><use xlink:href="#n2-timeline-medium" x="140" /><use xlink:href="#n2-timeline-small" x="150" /><use xlink:href="#n2-timeline-medium" x="160" /><use xlink:href="#n2-timeline-small" x="170" /><use xlink:href="#n2-timeline-medium" x="180" /><use xlink:href="#n2-timeline-small" x="190" /></pattern><rect fill="url(#n2-timeline-pattern)" width="100%" height="100%"/></svg>').appendTo(this.timeMarker).on("mousedown",function(t){var e=this.offsetXToDuration(t.pageX-s(t.currentTarget).offset().left-21);this.disablePreviewModeWidthCTI(e)||this.setCTI(e),this.slideCTI.trigger(t),s(document).one("mouseup",function(t){this.timelineControl.unHold(),this.slideCTI.trigger(t)}.bind(this))}.bind(this))},i.prototype.refreshDuration=NextendDeBounce(function(){this._extendTimeFrame(this.getMinimumSlideDuration())},200),i.prototype._extendTimeFrame=function(t){t=Math.floor(t)+1;var e=this.timeMarker.find(".n2_timeline__one_second"),i=e.length;for(t<10&&(t=10),t<i&&(e.slice(t).remove(),i=t);i<=t;i++)s('<div class="n2_timeline__one_second">'+i+"s</div>").appendTo(this.timeMarker);this.$timelineInner.css("width",i*this.oneSecWidth+21).removeClass("n2_timeline__inner_pane--calculate-duration"),nextend.triggerResize()},i.prototype.getMinimumSlideDuration=function(){return this.$timelineInner.addClass("n2_timeline__inner_pane--calculate-duration"),this.offsetXToDuration(this.$timeline[0].scrollWidth-20)},i.prototype.initCurrentTimeIndicator=function(){this.slideCTI=s('<div class="n2_timeline__cti"><div class="n2_timeline__cti_dot"></div></div>').appendTo(this.timeMarker),new N2Classes.UIDraggable(this.slideCTI,{axis:"x",cursor:"ew-resize",start:function(t,e){this.timelineControl.enterPreviewMode(),this.timelineControl.pause(),this.slideDurationPx=this.timelineControl.timeline.totalDuration()*this.oneSecWidth}.bind(this),drag:function(t,e){e.position.left=Math.max(e.position.left,-.05*this.oneSecWidth),e.position.left=Math.min(e.position.left,this.slideDurationPx),this.setCTI(this.offsetXToDuration(e.position.left))}.bind(this),stop:function(t,e){this.timelineControl.unHold(),this.disablePreviewModeWidthCTI(this.offsetXToDuration(e.position.left)),delete this.slideDurationPx}.bind(this)})},i.prototype.disablePreviewModeWidthCTI=function(t){return(null==t||t<0)&&this.timelineControl.exitPreviewMode()},i.prototype.setCTI=function(t){this.timelineControl.setPosition(Math.max(0,t)),this.timelineControl.hold()},i.prototype.appendRow=function(t,e){(t.group.isMainGroup?this.contentContainer:t.group.animations.contentArea).append(e)},i}),N2D("TimelineAnimationAbstract",["Historical"],function(t,i){"use strict";function e(t,e){this.needBar===i&&(this.needBar=!0),this.layerNavigationTimeline=N2Classes.LayerNavigationTimeline.get(),this.data=t,this.group=e,this.needBar&&(this.bar=new N2Classes.TimelineBar(this,this.getBarOptions()),this.bar.renderDelay(this.data.delay),this.bar.renderDuration(this.data.duration))}return N2Classes.Historical(e),e.prototype.getBarOptions=function(){return{class:"n2_timeline_animation_bar n2_timeline_animation_bar--"+this.group,draggable:!0,resizable:!0,draggableEnd:function(t,e){this.setDelay(e.delay),this.fixTimelineTotalDuration()}.bind(this),resizableStop:function(t,e){this.setDelay(e.delay),this.setDuration(e.duration),this.fixTimelineTotalDuration()}.bind(this),click:this.click.bind(this)}},e.prototype.getBar=function(){return this.bar.bar},e.prototype.click=function(t){},e.prototype.getDelay=function(){return this.data.delay},e.prototype.setDelay=function(t){this.setData("delay",t)},e.prototype.setDuration=function(t){this.setData("duration",t)},e.prototype.animationChanged=function(){this.needBar&&(this.bar.renderDelay(this.data.delay),this.bar.renderDuration(this.data.duration),this.fixTimelineTotalDuration())},e.prototype.whenDeleted=function(){this.needBar&&this.bar.remove()},e.prototype.fixTimelineTotalDuration=function(){this.animationType.fixTimelineTotalDuration()},e}),N2D("TimelineAnimationExtra",["TimelineAnimationAbstract"],function(n,o){"use strict";function t(t,e,i,s){this.layer=t,this.name=e,this.group=i,this.options=n.extend({label:!1,delay:0,duration:0,setDelay:o,setDuration:o,click:o},s),this.bar=new N2Classes.TimelineBar(this,{label:this.options.label,class:"n2_timeline_animation_bar n2_timeline_animation_bar--extra",draggable:"function"==typeof this.options.setDelay,resizable:"function"==typeof this.options.setDuration,click:this.click.bind(this),draggableEnd:this.draggableEnd.bind(this),resizableStop:this.resizableStop.bind(this)}),this.bar.renderDelay(this.options.delay),this.bar.renderDuration(this.options.duration),this.setController(t.animations)}return t.prototype.setController=function(t){this.controller=t,this.controller.addExtraAnimation(this.group,this.name,this)},t.prototype.getName=function(){return this.name},t.prototype.getGroup=function(){return this.group},t.prototype.getDelay=function(){return this.options.delay},t.prototype.draggableEnd=function(t,e){this.layer.activate(),"function"==typeof this.options.setDelay&&this.options.setDelay.call(this,e.delay)},t.prototype.resizableStop=function(t,e){this.layer.activate(),"function"==typeof this.options.setDelay&&this.options.setDelay.call(this,e.delay),"function"==typeof this.options.setDuration&&this.options.setDuration.call(this,e.duration)},t.prototype.click=function(t){"function"==typeof this.options.click?(this.layer.activate(),this.options.click.call(this,t)):this.layer.activate(t)},t.prototype.remove=function(){this.bar.remove(),delete this.bar,this.controller.removeExtraAnimation(this.group,this.name,this)},t}),N2D("TimelineBar",function(i,s){function t(t,e){this.options=i.extend({label:!1,class:"",draggable:!1,resizable:!1,draggableEnd:s,resizableStop:s,click:s},e),this.animation=t,this.layerNavigationTimeline=N2Classes.LayerNavigationTimeline.get(),this.delay=i('<div class="n2_timeline_animation_bar__delay"></div>'),this.duration=i('<div class="n2_timeline_animation_bar__duration"></div>'),!1!==this.options.label&&this.duration.html(this.options.label),this.bar=i('<div class="'+this.options.class+'"></div>').data("animation",this).append(this.delay).append(this.duration),this.options.draggable&&new N2Classes.UIDraggableBar(this.bar,{drag:function(t,e){e.currentData.margin=this.layerNavigationTimeline.normalizeOffsetX(e.currentData.margin),this.renderDelay(this.layerNavigationTimeline.offsetXToDuration(e.currentData.margin))}.bind(this),stop:function(t,e){N2Classes.WindowManager.actionPrevent("ComponentRowActivate");e=this.layerNavigationTimeline.offsetXToDuration(e.currentData.margin);this.renderDelay(e),this.fire("draggableEnd",t,{delay:e})}.bind(this)}),this.options.resizable&&new N2Classes.UIResizeBar(this.bar,{resize:function(t,e){var i=this.layerNavigationTimeline.normalizeOffsetX(e.currentData.margin),s=e.currentData.margin-i;e.currentData.margin=i,e.currentData.width=this.layerNavigationTimeline.normalizeOffsetX(e.currentData.width+s),this.renderDelay(this.layerNavigationTimeline.offsetXToDuration(e.currentData.margin)),this.renderDuration(this.layerNavigationTimeline.offsetXToDuration(e.currentData.width))}.bind(this),stop:function(t,e){N2Classes.WindowManager.actionPrevent("ComponentRowActivate");var i=this.layerNavigationTimeline.offsetXToDuration(e.currentData.margin),e=this.layerNavigationTimeline.offsetXToDuration(e.currentData.width);this.renderDelay(i),this.renderDuration(e),this.fire("resizableStop",t,{delay:i,duration:e})}.bind(this)}),this.bar.on("click",this.fire.bind(this,"click"))}return t.prototype.renderDelay=function(t){this.bar.css("marginLeft",this.layerNavigationTimeline.durationToOffsetX(t)),this.delay.toggleClass("n2_timeline_animation_bar__delay--small",t<.15).text(Math.round(t*this.layerNavigationTimeline.oneSecMs))},t.prototype.renderDuration=function(t){this.bar.css({width:this.layerNavigationTimeline.durationToOffsetX(t)}),!1===this.options.label?this.duration.text(Math.round(t*this.layerNavigationTimeline.oneSecMs)):"function"==typeof this.options.label&&this.duration.text(this.options.label.call(this,t))},t.prototype.remove=function(){this.bar.remove()},t.prototype.detach=function(){this.bar.detach()},t.prototype.fire=function(t,e,i){"function"==typeof this.options[t]&&this.options[t].call(this,e,i)},t}),N2D("TimelineControl",function(n,t){"use strict";var o=0,a=1,e=2,i=3,s=4;function r(t){this.status=0,this.layerNavigationTimeline=t,this.fragmentEditor=t.fragmentEditor,this.$overlay=n('<div class="n2_timeline_overlay_playing"></div>').appendTo("body").on("mousedown",function(t){this.exitPreviewMode()}.bind(this)),this.$playButton=n(".n2_timeline_control_play_pause").on({click:this.onPlayButton.bind(this)}),n(window).on("keydown",function(t){"INPUT"===t.target.tagName||"TEXTAREA"===t.target.tagName||t.target.isContentEditable||(0===t.keyCode||32===t.keyCode?this.onPlayButton(t):27===t.keyCode&&this.onStopButton(t))}.bind(this)),n(".n2_timeline_layers").on("mousedown",this.exitPreviewMode.bind(this,!1))}return r.prototype.isActivated=function(){return this.status!==o},r.prototype.onStopButton=function(t){t.preventDefault(),t.stopPropagation(),this.status!==o&&this.exitPreviewMode()},r.prototype.onPlayButton=function(t){t.preventDefault(),n("body").triggerHandler("timelinePlay"),setTimeout(function(){switch(this.status){case o:this.enterPreviewMode(),this.play();break;case a:this.play();break;case i:this.exitPreviewMode()}}.bind(this),100)},r.prototype.enterPreviewMode=function(){if(this.status===o){n("body").addClass("n2_body--timeline-preview");var t=this.fragmentEditor.editor.getHorizontalRatio(),e=this.fragmentEditor.editor.getVerticalRatio();this.animations=this.fragmentEditor.mainContainer.createLayerAnimations(t,e),this.timeline=new NextendTimeline({paused:1,onComplete:function(){0<this.timeline.totalDuration()&&this.timeline.restart()}.bind(this)});for(var i=0;i<this.animations.length;i++){var s=this.animations[i];this.timeline.add(s.timeline,0),s.timeline.paused(!1)}t=this.timeline.totalDuration(),e={left:N2Classes.LayerNavigationTimeline.get().durationToOffsetX(t),ease:"linear"};this.timeline.fromTo(this.layerNavigationTimeline.slideCTI,t,{left:0},e,0),this.status=a}},r.prototype.exitPreviewMode=function(t){if(this.status!==o){t&&(t.preventDefault(),t.stopPropagation()),this.status===i&&this.pause();for(var e=0;e<this.animations.length;e++)this.animations[e].resetToEditor();this.timeline.kill(),n("body").removeClass("n2_body--timeline-preview"),this.layerNavigationTimeline.slideCTI.css("left",-10),this.status=o}},r.prototype.play=function(){return this.status===a&&(this.status=i,this.$playButton.addClass("n2_timeline_control_play_pause--playing"),this.timeline.play(),!0)},r.prototype.pause=function(){return this.status===i&&(this.status=a,this.$playButton.removeClass("n2_timeline_control_play_pause--playing"),this.timeline.pause(),!0)},r.prototype.hold=function(){this.status===a?this.status=e:this.status===i&&(this.status=s,this.timeline.pause())},r.prototype.unHold=function(){this.status===e?this.status=a:this.status===s&&(this.status=i,this.timeline.play())},r.prototype.setPosition=function(t){this.enterPreviewMode(),this.timeline.seek(t)},r}),N2D("TimelineAnimationGroupAbstract",["Historical"],function(n,s){function t(t,e,i,s){this.animationType=t,this.group=e,this.defaults=i,this.data=n.extend(!0,{},i,s)}return N2Classes.Historical(t),t.prototype.remove=function(){},t.prototype.setHolder=function(t){this.$holder=t},t.prototype.getData=function(t){var e=n.extend(!0,{},this.data);return t?nextend.deepDiff.map(e,this.defaults):e},t.prototype.setData=function(t,e){var i;this.data[t]!==s&&this.data[t]!==e&&((i=N2Classes.History.get().addValue(this,this.historySetData,[t]))&&i.setValues(this.data[t],e),this._setData(t,e))},t.prototype.historySetData=function(t,e){this._setData(e,t)},t.prototype._setData=function(t,e){this.data[t]=e,"function"==typeof this["onChange_"+t]&&this["onChange_"+t](e),this.editorGroup&&this.editorGroup.outsideChange(t,e)},t}),N2D("TimelineAnimationTypeAbstract",["Historical"],function(i,s){"use strict";function t(t){for(var e in this.controller=t,this.layer=t.layer,this.groups=this.groups||{},this.defaults={},this.groups)this.defaults[e]=!1}return N2Classes.Historical(t),t.prototype.start=function(t){for(var e in this.data=i.extend({},this.defaults,t),this.data)this.createGroup(e,this.data[e])},t.prototype.fixTimelineTotalDuration=function(){this.controller.fixTimelineTotalDuration()},t.prototype.loadData=function(t){for(var e in this.data=i.extend({},this.defaults,t),this.groups)this.replaceGroupData(e,this.data[e])},t.prototype.hasAnimation=function(t){if(t!==s)return!!this.groups[t];for(var e in this.groups)if(this.groups[e])return!0;return!1},t.prototype.replaceGroupDataWithPreset=function(t,e){this.replaceGroupData(t,e)},t.prototype.replaceGroupData=function(t,e){!1===this.groups[t]?this.createGroup(t,e,!0):this.getGroup(t).replace(e)},t.prototype.getGroup=function(t){return this.groups[t]},t.prototype.createGroup=function(t,e,i){return!1},t.prototype.onGroupNotAnimated=function(t){this.groups[t.group]=!1,this.controller.removePrimaryAnimation(t.group,t)},t.prototype.getData=function(t){var e,i=!1,s={};for(e in this.groups)this.groups[e]&&(s[e]=this.groups[e].getData(t),i=!0);return!!i&&s},t.prototype.onGroupAnimated=function(t){this.groups[t.group]=t,this.controller.addPrimaryAnimation(t.group,t)},t.prototype.onSelfChange=function(){for(var t in this.groups)this.groups[t]&&this.groups[t].setSelf(this.getSelf().groups[t])},t}),N2D("TimelineAnimationBasic",["TimelineAnimationTypeAbstract"],function(t,e){"use strict";function i(){this.groups={in:!1,loop:!1,out:!1},N2Classes.TimelineAnimationTypeAbstract.apply(this,arguments)}return((i.prototype=Object.create(N2Classes.TimelineAnimationTypeAbstract.prototype)).constructor=i).prototype.createGroup=function(t,e,i){if(!1!==e)switch(t){case"in":return new N2Classes.TimelineAnimationBasicGroupIn(this,e,i);case"loop":return new N2Classes.TimelineAnimationBasicGroupLoop(this,e,i);case"out":return new N2Classes.TimelineAnimationBasicGroupOut(this,e,i)}return!1},i.prototype.clearDeviceSpecific=function(t){for(var e in this.groups)this.groups[e]&&this.groups[e].clearDeviceSpecific(t)},i}),N2D("TimelineAnimationBasicEditor",function(o,t){"use strict";var e=null;function i(t){(e=this).animationEditor=t,this.animationManager=t.animationManager,this.$container=o('<div class="n2_layer_window_animations_editor"></div>'),this.editorKeyFrame=new N2Classes.TimelineAnimationBasicEditorKeyFrame(this),this.groups={in:new N2Classes.TimelineAnimationBasicEditorGroupIn(this),loop:new N2Classes.TimelineAnimationBasicEditorGroupLoop(this),out:new N2Classes.TimelineAnimationBasicEditorGroupOut(this)},this.$heading=o('<div class="n2_layer_window_animations_editor__title"></div>').appendTo(this.$container),this.$headingButtonsLeft=o('<div class="n2_layer_window_animations_editor__title_left"></div>').appendTo(this.$heading),this.$buttonPlay=o('<div class="n2_layer_window_animations_editor__button_play"><i class="ssi_16 ssi_16--play"></i></div>').on("click",function(){this.toggleTimeline()}.bind(this)).appendTo(this.$headingButtonsLeft),o('<div class="n2_layer_window_animations_editor__label">'+n2_("Layer Animation - Basic")+"</div>").appendTo(this.$heading),this.$headingButtonsRight=o('<div class="n2_layer_window_animations_editor__title_right"></div>').appendTo(this.$heading),this.$buttonSettings=o('<div class="n2_layer_window_animations_editor__button_settings"><i class="ssi_16 ssi_16--cog"></i></div>').on("click",function(t){t.preventDefault();t=!this.$container.hasClass("n2_layer_window_animations_editor--settings");this.$container.toggleClass("n2_layer_window_animations_editor--settings",t),this.$buttonSettings.toggleClass("n2_layer_window_animations_editor__button_settings--active",t)}.bind(this)).appendTo(this.$headingButtonsRight),o('<div class="n2_layer_window_animations_editor__button_delete"><i class="ssi_16 ssi_16--delete"></i></div>').on("click",function(t){t.preventDefault(),this.activatedGroupEditor.activatedAnimationGroup.remove()}.bind(this)).appendTo(this.$headingButtonsRight),this.$keyFramesContainer=o('<div class="n2_layer_window_animations_editor_basic"></div>').appendTo(this.$container),new N2Classes.UISortable(this.$keyFramesContainer,{axis:"y",helper:"clone_hide",forcePlaceholderSize:!0,items:".n2_layer_window_animations_editor_basic__keyframe",handle:".n2_layer_window_animations_editor_basic__keyframe_label",beforestart:function(t,e){this.$keyFramesContainer.css("height",this.$keyFramesContainer.height()),e.currentItem.hasClass("n2_layer_window_animations_editor_basic__keyframe--active")&&this.$keyFramesContainer.addClass("n2_layer_window_animations_editor_basic__keyframe--sort")}.bind(this),start:function(t,e){e.item.data("index",e.item.index())}.bind(this),stop:function(t,e){var i=e.item.data("index"),e=e.item.index();i!==e&&this.activatedGroupEditor.moveKeyFrame(i,e),this.$keyFramesContainer.css("height",""),this.$keyFramesContainer.removeClass("n2_layer_window_animations_editor_basic__keyframe--sort")}.bind(this)}),o('<div class="n2_layer_window_animations_editor_basic__button_add_keyframe">'+n2_("Add keyframe")+"</div>").on("click",function(t){this.activatedGroupEditor.createKeyFrame()}.bind(this)).appendTo(o('<div class="n2_layer_window_animations_editor_basic__add_keyframe"></div>').appendTo(this.$container)),this.fragmentEditor=this.animationManager.fragmentEditor,this.editorSlide=this.fragmentEditor.editor,this.editorSlide.getFrontendElement().on("SliderDeviceOrientation",this.onChangeDeviceOrientation.bind(this)),this.editorKeyFrame.setDevice(this.editorSlide.getDeviceMode()),o("body").on("timelinePlay",this.previewCancel.bind(this))}return i.get=function(){return e},i.prototype.onChangeDeviceOrientation=function(){this.editorKeyFrame.setDevice(this.editorSlide.getDeviceMode())},i.prototype.activateWithGroup=function(t){this.activatedGroupEditor=this.groups[t.group],this.groups[t.group].activate(t)},i.prototype.display=function(t){this.activatedGroupEditor.display(),this.$container.appendTo(t),this.$heading.off("singlepreview").on({"mouseleave.singlepreview":this.destroyTimeline.bind(this)})},i.prototype.toggleTimeline=function(){this.timeline?this.destroyTimeline():this.preview().play()},i.prototype.close=function(){this.editorKeyFrame.close(),this.activatedGroupEditor.close(),this.$keyFramesContainer.children().detach(),this.$container.detach()},i.prototype.destroyTimeline=function(){this.timeline&&(o("body").removeClass("n2-ss-animation-play-single"),this.timeline.destroy()),this.timeline=null,this.$buttonPlay.removeClass("n2_layer_window_animations_editor__button_play--active")},i.prototype.previewPreset=function(t,e){return this.preview(e,t).play(),this.destroyTimeline.bind(this)},i.prototype.preview=function(t,e){t=t||this.activatedGroupEditor.activatedAnimationGroup.getData(),e=e||this.activatedGroupEditor.group,this.destroyTimeline(),this.$buttonPlay.addClass("n2_layer_window_animations_editor__button_play--active"),o("body").addClass("n2-ss-animation-play-single");var i=this.animationManager.getActiveLayer().layer,s=i,n=s.data("animatableselector");return n&&(s=s.find(n)),this.timeline=new N2Classes.TimelineAnimationBasicEditorPreview(this,i,s,e,t),this.timeline},i.prototype.previewCancel=function(){this.destroyTimeline()},i}),N2D("TimelineAnimationBasicEditorGroup",function(t,i){function e(t,e){for(var i in this.editor=t,this.editorKeyFrame=t.editorKeyFrame,this.group=e,this.fields=this.fields||{},this.fields)this.fields[i].input.on("outsideChange.n2-editor",this.changeGlobalInlineField.bind(this,i))}return e.prototype.outsideChange=function(t,e){this.fields[t]!==i&&this.fields[t].get()!==e&&this.fields[t].set(e)},e.prototype.changeGlobalInlineField=function(t,e){this.activatedAnimationGroup.setData(t,this.fields[t].get()),this.editor.preview().playOnce()},e.prototype.activate=function(t){(this.activatedAnimationGroup=t).connectEditor(this)},e.prototype.close=function(){this.$form.detach(),this.activatedAnimationGroup.close(),delete this.activatedAnimationGroup},e.prototype.display=function(){for(var t in this.$form.insertAfter(this.editor.$heading),this.fields)this.fields[t].get()!==this.activatedAnimationGroup.data[t]&&this.fields[t].set(this.activatedAnimationGroup.data[t]);for(var e=0;e<this.activatedAnimationGroup.keyFrames.length;e++)this.addKeyFrame(this.activatedAnimationGroup.keyFrames[e]);this.activatedAnimationGroup.activateFirstKeyFrame()},e.prototype.addKeyFrame=function(t){t.getEditorElement().appendTo(this.editor.$keyFramesContainer)},e.prototype.insertKeyFrame=function(t,e){--e;e<0?t.getEditorElement().prependTo(this.editor.$keyFramesContainer):t.getEditorElement().insertAfter(this.activatedAnimationGroup.keyFrames[e].getEditorElement())},e.prototype.reAppendKeyFrames=function(){for(var t=this.activatedAnimationGroup.keyFrames.length-1;0<=t;t--)this.activatedAnimationGroup.keyFrames[t].getEditorElement().prependTo(this.editor.$keyFramesContainer)},e.prototype.activateKeyFrame=function(t){this.editorKeyFrame.activate(t)},e.prototype.createKeyFrame=function(){this.activatedAnimationGroup.addEmptyKeyFrame()},e.prototype.setKeyFrameCount=function(t){this.editor.$keyFramesContainer.toggleClass("n2_layer_window_animations_editor_basic--single-keyframe",1===t)},e.prototype.moveKeyFrame=function(t,e){this.activatedAnimationGroup.moveKeyFrame(t,e)},e}),N2D("TimelineAnimationBasicEditorKeyFrame",function(i,n){function t(t){for(var e in this.editor=t,this.$form=i('.n2_fields_layer_window[data-field="fieldset-layer-window-layer-animation-basic-form"]').detach(),this.fields={duration:{input:this.$form.find("#layer-anim-duration"),set:function(t){this.field.insideChange(Math.round(1e3*t))},get:function(){return this.input.val()/1e3}},delay:{input:this.$form.find("#layer-anim-delay"),set:function(t){this.field.insideChange(Math.round(1e3*t))},get:function(){return this.input.val()/1e3}},ease:{input:this.$form.find("#layer-anim-ease"),set:function(t){this.field.insideChange(t)},get:function(){return this.input.val()}},opacity:{input:this.$form.find("#layer-anim-opacity"),set:function(t){this.field.insideChange(Math.round(100*t))},get:function(){return this.input.val()/100}},n2blur:{input:this.$form.find("#layer-anim-n2blur"),set:function(t){this.field.insideChange(t)},get:function(){return this.input.val()}},x:{isDeviceSpecific:!0,input:this.$form.find("#layer-anim-x"),set:function(t){this.field.insideChange(t)},get:function(){return this.input.val()}},y:{isDeviceSpecific:!0,input:this.$form.find("#layer-anim-y"),set:function(t){this.field.insideChange(t)},get:function(){return this.input.val()}},z:{input:this.$form.find("#layer-anim-z"),set:function(t){this.field.insideChange(t)},get:function(){return this.input.val()}},rotationX:{input:this.$form.find("#layer-anim-rotationX"),set:function(t){this.field.insideChange(t)},get:function(){return this.input.val()}},rotationY:{input:this.$form.find("#layer-anim-rotationY"),set:function(t){this.field.insideChange(t)},get:function(){return this.input.val()}},rotationZ:{input:this.$form.find("#layer-anim-rotationZ"),set:function(t){this.field.insideChange(t)},get:function(){return this.input.val()}},scaleX:{input:this.$form.find("#layer-anim-scaleX"),set:function(t){this.field.insideChange(Math.round(100*t))},get:function(){return this.input.val()/100}},scaleY:{input:this.$form.find("#layer-anim-scaleY"),set:function(t){this.field.insideChange(Math.round(100*t))},get:function(){return this.input.val()/100}},skewX:{input:this.$form.find("#layer-anim-skew"),set:function(t){this.field.insideChange(Math.round(t))},get:function(){return Math.round(this.input.val())}}},this.fields)this.fields[e].field=this.fields[e].input.data("field"),this.fields[e].input.on("outsideChange.n2-editor",this.changeInlineField.bind(this,e))}return t.prototype.setDevice=function(t){if(this.device=t,this._editedKeyFrame!==n){var e,i=this._editedKeyFrame;for(e in this.fields){var s=i.get(e,!!this.fields[e].isDeviceSpecific&&this.device);this.fields[e].get()!==s&&this.fields[e].set(s)}}},t.prototype.changeInlineField=function(t,e){this._editedKeyFrame.setData(t,this.fields[t].get(),!!this.fields[t].isDeviceSpecific&&this.device),this.editor.preview().playOnce()},t.prototype.outsideChange=function(t,e,i){i!==n&&i!==this.device||this.fields[t]===n||this.fields[t].get()===e||this.fields[t].set(e)},t.prototype.activate=function(t){if(this._editedKeyFrame!==t){for(var e in this.close(),this._editedKeyFrame=t,this._editedKeyFrame.connectEditor(this),this.fields){var i=t.get(e,!!this.fields[e].isDeviceSpecific&&this.device);this.fields[e].get()!==i&&this.fields[e].set(i)}this.$form.appendTo(t.getEditorElement()),this.$form.parent().addClass("n2_layer_window_animations_editor_basic__keyframe--active")}},t.prototype.close=function(){this.$form.parent().removeClass("n2_layer_window_animations_editor_basic__keyframe--active"),this.$form.detach(),this._editedKeyFrame&&(this._editedKeyFrame.close(),delete this._editedKeyFrame)},t}),N2D("TimelineAnimationBasicEditorPreview",function(d,e){"use strict";var r={opacity:1,x:0,y:0,z:0,rotationX:0,rotationY:0,rotationZ:0,scaleX:1,scaleY:1,skewX:0,n2blur:0};function t(t,e,i,s,n){this.editor=t,this.timeline=null,this.device=this.editor.animationManager.fragmentEditor.editor.getDeviceMode(),this.isAbsolute="absolute"===e.data("pm"),this.preview=i,this.group=s,this.currentVisual=n.keyFrames,this.transformOrigin=n.transformOrigin||"50|*|50|*|0",this.specialZero=n.specialZero||0,this.isAbsolute?(this.horizontalRatio=t.animationManager.fragmentEditor.getResponsiveRatioHorizontal(),this.verticalRatio=t.animationManager.fragmentEditor.getResponsiveRatioVertical()):(this.horizontalRatio=1,this.verticalRatio=1),this.startValues=d.extend({},r),this.createTimeline()}return t.prototype.setStartValues=function(t){d.extend(this.startValues,t),delete this.startValues.duration,delete this.startValues.delay,delete this.startValues.ease},t.prototype.createTimeline=function(){this.timeline&&this.timeline.pause(0),this.timeline=new NextendTimeline({paused:1});var t=[];d.extend(!0,t,this.currentVisual);for(var e=0;e<t.length;e++)t[e]=d.extend({duration:.8,delay:0,ease:"easeOutCubic",opacity:1,x:0,y:0,z:0,rotationX:0,rotationY:0,rotationZ:0,scaleX:1,scaleY:1,skewX:0,n2blur:0},t[e]),.5<t[e].delay&&(t[e].delay=.5);switch(this.group){case"in":this.buildTimelineIn(this.timeline,this.preview.get(0),t);break;case"loop":this.buildTimelineLoop(this.timeline,this.preview.get(0),t);break;case"out":this.buildTimelineOut(this.timeline,this.preview.get(0),t);break;default:console.log(this.group+" animation is not supported!")}NextendTween.set(this.preview.get(0),{clearProps:"transformOrigin"}),NextendTween.set(this.preview.get(0),d.extend({transformOrigin:this.transformOrigin.split("|*|").join("% ")+"px"},this.startValues)),0<this.timeline.totalDuration()&&this.timeline.set({},{},"+=1.5")},t.prototype.play=function(){0<this.timeline.totalDuration()&&(this.timeline.eventCallback("onComplete",function(){this.timeline.play(0,!1)}.bind(this)),this.timeline.play())},t.prototype.playOnce=function(){this.timeline.eventCallback("onComplete",function(){this.editor.destroyTimeline()}.bind(this)),this.timeline.play()},t.prototype.destroy=function(){this.timeline&&(this.timeline.pause(),this.repeatTimeout&&clearTimeout(this.repeatTimeout),this.timeline.progress(1,!0),NextendTween.set(this.preview.get(0),{opacity:1,x:0,y:0,z:0,rotationX:0,rotationY:0,rotationZ:0,scaleX:1,scaleY:1,skewX:0,n2blur:0})),this.timeline=null},t.prototype.adjustKeyFrameWithDevice=function(t){return"desktopPortrait"!==this.device&&t[this.device]!==e&&(t[this.device].x!==e&&(t.x=t[this.device].x),t[this.device].y!==e&&(t.y=t[this.device].y)),delete t.desktopLandscape,delete t.tabletLandscape,delete t.tabletPortrait,delete t.mobileLandscape,delete t.mobilePortrait,t},t.prototype.setCurrentZero=function(t){NextendTween.set(t,d.extend({},this.currentZero))},t.prototype.buildTimelineIn=function(t,e,i){this.currentZero=r,this.specialZero&&0<i.length&&(this.currentZero=this.adjustKeyFrameWithDevice(i.pop()),delete this.currentZero.name,this.currentZero.x=this.currentZero.x*this.horizontalRatio,this.currentZero.y=this.currentZero.y*this.verticalRatio,this.currentZero.rotationX=-this.currentZero.rotationX,this.currentZero.rotationY=-this.currentZero.rotationY,this.currentZero.rotationZ=-this.currentZero.rotationZ,this.setCurrentZero(e),this.setStartValues(this.currentZero));var s=0,n=this._buildAnimationChainIn(i,this.currentZero);if(0<n.length){for(var o=0;o<n.length;o++)t.to(e,n[o].duration,n[o].to,s),s+=n[o].duration+n[o].to.delay;this.setStartValues(n[0].from)}},t.prototype._buildAnimationChainIn=function(t,e){for(var i=[{from:e}],s=t.length-1;0<=s;s--){var n=this.adjustKeyFrameWithDevice(t[s]),o=n.delay,a=n.duration,r=n.ease;delete n.delay,delete n.duration,delete n.ease,delete n.name;var l=i[0].from;n.x=-n.x*this.horizontalRatio,n.y=-n.y*this.verticalRatio,n.z=-n.z,n.rotationX=-n.rotationX,n.rotationY=-n.rotationY,n.rotationZ=-n.rotationZ,i.unshift({duration:a,from:n,to:d.extend({},l,{ease:r,delay:o})})}return i.pop(),i},t.prototype.buildTimelineLoop=function(t,e,i){var s=this._buildAnimationChainLoop(i);if(0<s.length){for(var n=0;n<s.length;n++)t.to(e,s[n].duration,s[n].to);this.setStartValues(s[0].from)}},t.prototype._buildAnimationChainLoop=function(t){for(var e=0;e<t.length;e++)t[e]=this.adjustKeyFrameWithDevice(t[e]);if(delete t[0].name,1===t.length){var i,s=t[0];if((i=d.extend({},r)).duration=s.duration,i.ease=s.ease,(360==s.rotationX||360==s.rotationY||360==s.rotationZ)&&1==s.opacity&&0==s.x&&0==s.y&&0==s.z&&1==s.scaleX&&1==s.scaleY&&0==s.skewX&&0==s.n2blur)return[{duration:t[0].duration,from:d.extend({},r),to:t[0]}];t.unshift(i)}var n=[{duration:t[e=0].duration,to:t[e]}];for(e++;e<t.length;e++){var o=(i=t[e]).duration;delete i.duration,delete i.name;var a=d.extend({},n[n.length-1].to);delete a.delay,delete a.ease,i.x=i.x*this.horizontalRatio,i.y=i.y*this.verticalRatio,n.push({duration:o,from:a,to:i})}return n.push({duration:n[0].duration,from:d.extend({},n[n.length-1].to),to:d.extend({},n[0].to)}),n.shift(),n},t.prototype.buildTimelineOut=function(t,e,i){var s=0,n=this._buildAnimationChainOut(i);if(0<n.length){for(var o=0;o<n.length;o++)t.to(e,n[o].duration,n[o].to,s),s+=n[o].duration+n[o].to.delay;this.setStartValues(n[0].from)}},t.prototype._buildAnimationChainOut=function(t){for(var e=[{to:r}],i=0;i<t.length;i++){var s=this.adjustKeyFrameWithDevice(t[i]),n=s.duration;delete s.duration,delete s.name;var o=d.extend({},e[e.length-1].to);delete o.delay,delete o.ease,s.x=s.x*this.horizontalRatio,s.y=s.y*this.verticalRatio,e.push({duration:n,from:o,to:s})}return e.shift(),e},t}),N2D("TimelineAnimationBasicEditorGroupIn",["TimelineAnimationBasicEditorGroup"],function(e,t){function i(t){this.$form=e('.n2_fields_layer_window[data-field="fieldset-layer-window-layer-animation-basic-form-in"]').detach(),N2Classes.FormTipManager.add(this.$form),this.fields={specialZero:{input:this.$form.find("#layerbasic-in-special-zero"),set:function(t){this.input.data("field").insideChange(parseInt(t)?1:0)},get:function(){return parseInt(this.input.val())?1:0}},transformOrigin:{input:this.$form.find("#layerbasic-in-transformorigin"),set:function(t){this.input.data("field").insideChange(t)},get:function(){return this.input.val()}}},N2Classes.TimelineAnimationBasicEditorGroup.call(this,t,"in")}return(i.prototype=Object.create(N2Classes.TimelineAnimationBasicEditorGroup.prototype)).constructor=i}),N2D("TimelineAnimationBasicEditorGroupLoop",["TimelineAnimationBasicEditorGroup"],function(e,t){function i(t){this.$form=e('.n2_fields_layer_window[data-field="fieldset-layer-window-layer-animation-basic-form-loop"]').detach(),N2Classes.FormTipManager.add(this.$form),this.fields={repeatCount:{input:this.$form.find("#layerbasic-loop-repeat-count"),set:function(t){this.input.val(parseInt(t))},get:function(){return parseInt(this.input.val())}},repeatStartDelay:{input:this.$form.find("#layerbasic-loop-repeat-start-delay"),set:function(t){this.input.val(Math.round(1e3*parseFloat(t)))},get:function(){return parseInt(this.input.val())/1e3}},transformOrigin:{input:this.$form.find("#layerbasic-loop-transformorigin"),set:function(t){this.input.data("field").insideChange(t)},get:function(){return this.input.val()}}},N2Classes.TimelineAnimationBasicEditorGroup.call(this,t,"loop")}return(i.prototype=Object.create(N2Classes.TimelineAnimationBasicEditorGroup.prototype)).constructor=i}),N2D("TimelineAnimationBasicEditorGroupOut",["TimelineAnimationBasicEditorGroup"],function(e,t){function i(t){this.$form=e('.n2_fields_layer_window[data-field="fieldset-layer-window-layer-animation-basic-form-out"]').detach(),N2Classes.FormTipManager.add(this.$form),this.fields={transformOrigin:{input:this.$form.find("#layerbasic-out-transformorigin"),set:function(t){this.input.data("field").insideChange(t)},get:function(){return this.input.val()}}},N2Classes.TimelineAnimationBasicEditorGroup.call(this,t,"out")}return(i.prototype=Object.create(N2Classes.TimelineAnimationBasicEditorGroup.prototype)).constructor=i}),N2D("TimelineAnimationBasicGroup",["TimelineAnimationGroupAbstract"],function(o,i){"use strict";function t(t,e,i,s,n){N2Classes.TimelineAnimationGroupAbstract.call(this,t,e,i,s),n=n||!1,this.keyFrames=[],this.load(),n&&N2Classes.History.get().addSimple(this,this._remove,this.historyResurrect,[this.getData(!0),o.extend([],this.keyFrames)])}return((t.prototype=Object.create(N2Classes.TimelineAnimationGroupAbstract.prototype)).constructor=t).prototype.onSelfChange=function(){for(var t=0;t<this.keyFrames.length;t++)this.keyFrames[t].setSelf(this.self.keyFrames[t])},t.prototype.load=function(){if(0<this.data.keyFrames.length){this.animationType.onGroupAnimated(this);for(var t=0;t<this.data.keyFrames.length;t++)this.addKeyFrameByData(this.data.keyFrames[t])}delete this.data.keyFrames,this.animationType.controller.onUpdate()},t.prototype.addEmptyKeyFrame=function(){var t=this._addEmptyKeyFrame();N2Classes.History.get().addSimple(this,this._removeHistoricalKeyFrame,this._addHistoricalKeyFrame,[t]),t.activate()},t.prototype._addEmptyKeyFrame=function(){var t=this.addKeyFrameByData({});return this.editorGroup&&this.editorGroup.addKeyFrame(t),t},t.prototype._removeHistoricalKeyFrame=function(t){(t=t.getSelf())._remove(this.keyFrames.length-1)},t.prototype._addHistoricalKeyFrame=function(t){var e=this._addEmptyKeyFrame();t.setSelf(e)},t.prototype.addKeyFrameByData=function(t){var e=new N2Classes.BasicTimelineKeyFrame(this,t,this.group),t=e.getBar();return this.$holder.append(t),this.keyFrames.push(e),this.onUpdateKeyFrame(),e},t.prototype.insertAnimation=function(t,e){var i=new N2Classes.BasicTimelineKeyFrame(this,t,this.group),s=i.getBar(),t=e-1;return t<0?this.$holder.prepend(s):s.insertAfter(this.keyFrames[t].getBar()),this.editorGroup&&this.editorGroup.insertKeyFrame(i,e),this.keyFrames.splice(e,0,i),this.onUpdateKeyFrame(),i},t.prototype.remove=function(){N2Classes.History.get().addSimple(this,this.historyResurrect,this._remove,[this.getData(!0),o.extend([],this.keyFrames)]),this._remove()},t.prototype._remove=function(){this.clear(),this.data=o.extend({},this.defaults),this.animationType.onGroupNotAnimated(this)},t.prototype.historyResurrect=function(t,e){this.data=o.extend(!0,{},this.defaults,t),this.load();for(var i=0;i<this.keyFrames.length;i++)e[i].setSelf(this.keyFrames[i])},t.prototype.clear=function(){for(var t=0;t<this.keyFrames.length;t++)this.keyFrames[t].whenDeleted();this.keyFrames=[]},t.prototype.replace=function(t){this.remove(),this._replace(t),N2Classes.History.get().addSimple(this,this._remove,this.historyResurrect,[this.getData(!0),o.extend([],this.keyFrames)])},t.prototype._replace=function(t){for(var e in this.data=o.extend(!0,{},this.data,t),this.data)this.defaults[e]===i&&delete this.data[e];this.load()},t.prototype.getEditor=function(){var t=N2Classes.TimelineAnimationBasicEditor.get();return t.activateWithGroup(this),t},t.prototype.hasAnimation=function(){return!!this.keyFrames.length},t.prototype.getData=function(t){var e=o.extend(!0,{},this.data);e.keyFrames=[];for(var i=0;i<this.keyFrames.length;i++)e.keyFrames.push(this.keyFrames[i].getData(t));return t?nextend.deepDiff.map(e,this.defaults):e},t.prototype.edit=function(t,e){this.animationType.layer.activate(t),o('.n2_ss_layer_window .n2_ss_layer_window__tab_button[data-related-tab="animations"]').trigger("click"),o('.n2_ss_layer_window .n2_container_animation__button[data-related-tab="'+this.group+'"]').triggerHandler("click"),e?this.activateKeyFrame(e):this.activateFirstKeyFrame()},t.prototype.connectEditor=function(t){this.editorGroup=t,this.editorGroup.setKeyFrameCount(this.keyFrames.length)},t.prototype.close=function(){delete this.editorGroup},t.prototype.activateKeyFrame=function(t){this.editorGroup.activateKeyFrame(t)},t.prototype.activateFirstKeyFrame=function(){this.activateKeyFrame(this.keyFrames[0])},t.prototype.removeKeyFrameByIndex=function(t){0<=t&&(this.keyFrames.splice(t,1),this.onUpdateKeyFrame())},t.prototype.getKeyFrameIndex=function(t){return this.keyFrames.indexOf(t)},t.prototype.onUpdateKeyFrame=function(){this.editorGroup&&this.editorGroup.setKeyFrameCount(this.keyFrames.length),this.animationType.fixTimelineTotalDuration()},t.prototype.moveKeyFrame=function(t,e){this._moveKeyFrame(t,e);var i=N2Classes.History.get().addValue(this,this.historyMoveKeyFrame,[]);i&&i.setValues({oldIndex:e,newIndex:t},{oldIndex:t,newIndex:e})},t.prototype.historyMoveKeyFrame=function(t){this._moveKeyFrame(t.oldIndex,t.newIndex)},t.prototype._moveKeyFrame=function(t,e){var i=this.keyFrames[t];this.keyFrames.splice(t,1),this.keyFrames.splice(e,0,i),this.editorGroup&&this.editorGroup.reAppendKeyFrames();for(var s=0;s<this.keyFrames.length;s++)this.keyFrames[s].needBar&&this.$holder.append(this.keyFrames[s].getBar())},t.prototype.clearDeviceSpecific=function(t){for(var e=0;e<this.keyFrames.length;e++)this.keyFrames[e].clearDeviceSpecific(t)},t}),N2D("TimelineAnimationBasicGroupIn","TimelineAnimationBasicGroup",function(t,e){"use strict";function i(t,e,i){N2Classes.TimelineAnimationBasicGroup.prototype.constructor.call(this,t,"in",{specialZero:0,transformOrigin:"50|*|50|*|0",keyFrames:[]},e,i),this.specialZeroInChanged()}return((i.prototype=Object.create(N2Classes.TimelineAnimationBasicGroup.prototype)).constructor=i).prototype.specialZeroInChanged=function(){this.specialZeroKeyFrame!==e&&(this.specialZeroKeyFrame.setSpecialZero(!1),delete this.specialZeroKeyFrame),this.isLayerSpecialZero()&&(this.specialZeroKeyFrame=this.keyFrames[this.keyFrames.length-1],this.specialZeroKeyFrame.setSpecialZero(!0)),this.animationType.fixTimelineTotalDuration()},i.prototype.isLayerSpecialZero=function(){return this.data.specialZero},i.prototype.onChange_specialZero=function(t){this.specialZeroInChanged()},i.prototype._addEmptyKeyFrame=function(){var t=N2Classes.TimelineAnimationBasicGroup.prototype._addEmptyKeyFrame.apply(this,arguments);return this.specialZeroInChanged(),t},i.prototype._moveKeyFrame=function(){N2Classes.TimelineAnimationBasicGroup.prototype._moveKeyFrame.apply(this,arguments),this.specialZeroInChanged()},i}),N2D("TimelineAnimationBasicGroupLoop","TimelineAnimationBasicGroup",function(t,e){"use strict";function i(t,e,i){this.dummyAnimation=null,N2Classes.TimelineAnimationBasicGroup.prototype.constructor.call(this,t,"loop",{repeatCount:0,repeatStartDelay:0,transformOrigin:"50|*|50|*|0",keyFrames:[]},e,i)}return((i.prototype=Object.create(N2Classes.TimelineAnimationBasicGroup.prototype)).constructor=i).prototype.addKeyFrameByData=function(t){t=new N2Classes.BasicTimelineKeyFrameLoop(this,t,this.group);return this.keyFrames.push(t),this.onUpdateKeyFrame(),t},i.prototype.insertAnimation=function(t,e){t=new N2Classes.BasicTimelineKeyFrameLoop(this,t,this.group);return this.keyFrames.splice(e,0,t),this.onUpdateKeyFrame(),t},i.prototype._remove=function(){this.dummyAnimation&&this.dummyAnimation.whenDeleted(),N2Classes.TimelineAnimationBasicGroup.prototype._remove.apply(this,arguments)},i.prototype.historyResurrect=function(){N2Classes.TimelineAnimationBasicGroup.prototype.historyResurrect.apply(this,arguments),this.refreshBar()},i.prototype.refreshBar=function(){var t;0<this.keyFrames.length&&(null===this.dummyAnimation&&(this.dummyAnimation=new N2Classes.BasicTimelineAnimationLoopDummy(this)),t=this.dummyAnimation.getBar(),this.$holder.append(t),this.dummyAnimation.refresh())},i.prototype.onChange_repeatStartDelay=function(t){this.dummyAnimation.setRepeatStartDelay(t)},i.prototype.onChange_repeatCount=function(){this.dummyAnimation.refresh()},i.prototype.onUpdateKeyFrame=function(){this.refreshBar(),N2Classes.TimelineAnimationBasicGroup.prototype.onUpdateKeyFrame.call(this)},i}),N2D("BasicTimelineAnimationLoopDummy",["TimelineAnimationAbstract"],function(t,e){"use strict";function i(t){this.basicGroup=t,N2Classes.TimelineAnimationAbstract.prototype.constructor.call(this,{duration:0,delay:0},"loop")}return((i.prototype=Object.create(N2Classes.TimelineAnimationAbstract.prototype)).constructor=i).prototype.setDelay=function(t){this.basicGroup.setData("repeatStartDelay",t)},i.prototype.getDelay=function(){return this.basicGroup.data.repeatStartDelay},i.prototype.refresh=function(){var t=this.basicGroup.data,e=this.basicGroup.keyFrames.length;if(0!==e){var i=0,s=0;if(1===e)var n=this.basicGroup.keyFrames[0].getData(),s=360!=n.rotationX&&360!=n.rotationY&&360!=n.rotationZ||1!=n.opacity||0!=n.x||0!=n.y||0!=n.z||1!=n.scaleX||1!=n.scaleY||0!=n.skewX||0!=n.n2blur?2*(n.duration+n.delay):n.duration+n.delay;else{i=this.basicGroup.keyFrames[e-1].getData().duration;for(var o=0;o<e;o++){var a=this.basicGroup.keyFrames[o].getData();s+=a.duration+a.delay}}0!==t.repeatCount&&(s*=t.repeatCount),this.data.duration=s+i,this.data.delay=t.repeatStartDelay,this.animationChanged()}else this.bar.bar.detach()},i.prototype.renderDuration=function(t){t=0===this.basicGroup.data.repeatCount?n2_("Loop"):Math.round(t*this.layerNavigationTimeline.oneSecMs);this.duration.html(t)},i.prototype.getBarOptions=function(){var t=N2Classes.TimelineAnimationAbstract.prototype.getBarOptions.call(this);return t.resizable=!1,delete t.resizableStop,t.label=function(t){t=0===this.basicGroup.data.repeatCount?n2_("Loop"):Math.round(t*this.layerNavigationTimeline.oneSecMs);return t}.bind(this),t},i.prototype.whenDeleted=function(){this.bar.detach()},i.prototype.setRepeatStartDelay=function(t){this.data.delay=t,this.animationChanged()},i.prototype.fixTimelineTotalDuration=function(){this.basicGroup.animationType.fixTimelineTotalDuration()},i.prototype.click=function(t){t.stopPropagation(),this.basicGroup.edit(t)},i}),N2D("TimelineAnimationBasicGroupOut","TimelineAnimationBasicGroup",function(t,e){"use strict";function i(t,e,i){N2Classes.TimelineAnimationBasicGroup.prototype.constructor.call(this,t,"out",{transformOrigin:"50|*|50|*|0",keyFrames:[]},e,i)}return(i.prototype=Object.create(N2Classes.TimelineAnimationBasicGroup.prototype)).constructor=i}),N2D("BasicTimelineKeyFrame",["TimelineAnimationAbstract"],function(s,i){"use strict";function t(t,e,i){this.basicGroup=t,this.group=i,this.$editorElement=!1,this.isSpecialZero=!1,N2Classes.TimelineAnimationAbstract.prototype.constructor.call(this,s.extend(!0,{},N2Classes.BasicTimelineKeyFrame.defaults,e),i)}return((t.prototype=Object.create(N2Classes.TimelineAnimationAbstract.prototype)).constructor=t).defaults={duration:.8,delay:0,ease:"easeOutCubic",opacity:1,x:0,y:0,z:0,rotationX:0,rotationY:0,rotationZ:0,scaleX:1,scaleY:1,skewX:0,n2blur:0,desktopLandscape:{},tabletLandscape:{},tabletPortrait:{},mobileLandscape:{},mobilePortrait:{}},t.prototype.setData=function(t,e,i){var s,n=this.data;i&&"desktopPortrait"!==i&&(n=this.data[i]),n[t]!==e&&((s=N2Classes.History.get().addValue(this,this.historySetData,[t,i]))&&s.setValues(n[t],e),this._setData(n,t,e,i))},t.prototype.historySetData=function(t,e,i){var s=this.data;i&&"desktopPortrait"!==i&&(s=this.data[i]),this._setData(s,e,t,i)},t.prototype._setData=function(t,e,i,s){t[e]=i,this.animationChanged(),this.editorKeyFrame&&this.editorKeyFrame.outsideChange(e,i,s),this.$editorElement&&this.updateKeyFrameLabel()},t.prototype.get=function(t,e){return(e&&"desktopPortrait"!==e&&this.data[e][t]!==i?this.data[e]:this.data)[t]},t.prototype.clearDeviceSpecific=function(t){this.setData("x",i,t),this.setData("y",i,t)},t.prototype.getOptimizedData=function(){return nextend.deepDiff.map(s.extend(!0,{},this.data),N2Classes.BasicTimelineKeyFrame.defaults)},t.prototype.getData=function(t){return t?nextend.deepDiff.map(s.extend(!0,{},this.data),N2Classes.BasicTimelineKeyFrame.defaults):s.extend(!0,{},this.data)},t.prototype.connectEditor=function(t){this.editorKeyFrame=t},t.prototype.close=function(){this.editorKeyFrame&&delete this.editorKeyFrame},t.prototype.getEditorElement=function(){var t;return!1===this.$editorElement&&(this.$editorElement=s('<div class="n2_layer_window_animations_editor_basic__keyframe"></div>'),t=s('<div class="n2_layer_window_animations_editor_basic__keyframe_title"></div>').on("click",this.activate.bind(this)).appendTo(this.$editorElement),this.$keyFrameLabel=s('<div class="n2_layer_window_animations_editor_basic__keyframe_label"></div>').appendTo(t),this.updateKeyFrameLabel(),s('<div class="n2_layer_window_animations_editor_basic__keyframe_delete"><i class="ssi_16 ssi_16--delete"></i></div>').on("click",function(t){t.preventDefault(),t.stopPropagation(),this.remove()}.bind(this)).appendTo(t)),this.$editorElement},t.prototype.updateKeyFrameLabel=function(){var t,e=this.getOptimizedData(),i=[];for(t in delete e.duration,delete e.delay,delete e.ease,e)switch(typeof e[t]){case"string":case"number":i.push(t+": "+e[t])}this.$keyFrameLabel.text((this.isSpecialZero?n2_("Special Zero")+" - ":"")+(i.length?i.join(" | "):n2_("Keyframe")))},t.prototype.whenDeleted=function(){this.editorKeyFrame&&(this.editorKeyFrame.close(),delete this.editorKeyFrame),!1!==this.$editorElement&&this.$editorElement.remove(),N2Classes.TimelineAnimationAbstract.prototype.whenDeleted.call(this)},t.prototype.activate=function(){this.basicGroup.activateKeyFrame(this)},t.prototype.click=function(t){N2Classes.WindowManager.actionPrevent("ComponentRowActivate"),this.basicGroup.edit(t,this)},t.prototype.fixTimelineTotalDuration=function(){this.basicGroup.animationType.fixTimelineTotalDuration()},t.prototype.remove=function(){var t;1<this.basicGroup.keyFrames.length&&(t=this.basicGroup.getKeyFrameIndex(this),this._remove(t),-1!==t&&N2Classes.History.get().addSimple(this,this.historyResurrect,this._remove,[t,this.getData(!0)]))},t.prototype._remove=function(t){var e=!!this.editorKeyFrame;this.whenDeleted(),-1!==t&&this.basicGroup.removeKeyFrameByIndex(t),e&&this.basicGroup.activateFirstKeyFrame()},t.prototype.historyResurrect=function(t,e){t=this.basicGroup.insertAnimation(e,t);this.setSelf(t)},t.prototype.setSpecialZero=function(t){(this.isSpecialZero=t)?this.getBar().css("display","none"):this.getBar().css("display",""),this.$editorElement&&this.updateKeyFrameLabel()},t}),N2D("BasicTimelineKeyFrameLoop",["BasicTimelineKeyFrame"],function(t,e){"use strict";function i(t,e,i){this.needBar=!1,N2Classes.BasicTimelineKeyFrame.prototype.constructor.apply(this,arguments)}return((i.prototype=Object.create(N2Classes.BasicTimelineKeyFrame.prototype)).constructor=i).prototype.animationChanged=function(){this.basicGroup.dummyAnimation.refresh()},i}),N2D("TimelineAnimationReveal",["TimelineAnimationTypeAbstract"],function(t,e){"use strict";function i(){this.groups={in:!1,out:!1},N2Classes.TimelineAnimationTypeAbstract.apply(this,arguments)}return((i.prototype=Object.create(N2Classes.TimelineAnimationTypeAbstract.prototype)).constructor=i).prototype.replaceGroupDataWithPreset=function(t,e){this.replaceGroupData(t,e.data)},i.prototype.createGroup=function(t,e,i){return!1!==e&&new N2Classes.TimelineAnimationRevealGroup(this,t,e,i)},i}),N2D("TimelineAnimationRevealGroup",["TimelineAnimationGroupAbstract","TimelineAnimationAbstract"],function(i,s){"use strict";function t(t,e,i,s){N2Classes.TimelineAnimationGroupAbstract.call(this,t,e,{from:"top",fromease:"easeOutCubic",to:"bottom",toease:"easeOutCubic",content:"",duration:2,delay:0,color:"ffffff"},i),s=s||!1,N2Classes.TimelineAnimationAbstract.prototype.constructor.call(this,this.data,e),this.load(),s&&N2Classes.History.get().addSimple(this,this._remove,this.historyResurrect,[this.getData(!0)])}for(var e in(t.prototype=Object.create(N2Classes.TimelineAnimationGroupAbstract.prototype)).constructor=t,N2Classes.TimelineAnimationAbstract.prototype)t.prototype[e]=N2Classes.TimelineAnimationAbstract.prototype[e];return t.prototype.setHolder=function(t){(this.$holder=t).append(this.getBar())},t.prototype.getEditor=function(){var t=N2Classes.TimelineAnimationRevealEditor.get();return t.activateWithGroup(this),t},t.prototype.load=function(){this.animationChanged(),this.animationType.onGroupAnimated(this),this.animationType.controller.onUpdate()},t.prototype.remove=function(){N2Classes.History.get().addSimple(this,this.historyResurrect,this._remove,[this.getData(!0)]),this._remove()},t.prototype._remove=function(){this.data=i.extend({},this.defaults),this.whenDeleted(),this.animationType.onGroupNotAnimated(this)},t.prototype.historyResurrect=function(t){this.data=i.extend(!0,{},this.defaults,t),this.load()},t.prototype.replace=function(t){this.remove(),!1!==t&&(this._replace(t),N2Classes.History.get().addSimple(this,this._remove,this.historyResurrect,[this.getData(!0)]))},t.prototype._replace=function(t){for(var e in this.data=i.extend(!0,{},this.data,t),this.data)this.defaults[e]===s&&delete this.data[e];this.load()},t.prototype.onChange_duration=function(){this.animationChanged()},t.prototype.onChange_delay=function(){this.animationChanged()},t.prototype.connectEditor=function(t){this.editorGroup=t},t.prototype.click=function(t){t.stopPropagation(),this.edit(t)},t.prototype.edit=function(t){this.animationType.layer.activate(t),i('.n2_ss_layer_window .n2_ss_layer_window__tab_button[data-related-tab="animations"]').trigger("click"),i('.n2_ss_layer_window .n2_container_animation__button[data-related-tab="'+this.group+'"]').triggerHandler("click")},t.prototype.whenDeleted=function(){this.bar.detach()},t.prototype.getData=function(t){return i.extend(!0,{},this.data)},t}),N2D("TimelineAnimationRevealEditor",function(i,s){"use strict";var n=null;function t(t){for(var e in(n=this).animationEditor=t,this.animationManager=t.animationManager,this.$container=i('<div class="n2_layer_window_animations_editor"></div>'),this.$heading=i('<div class="n2_layer_window_animations_editor__title"></div>').on({"mouseleave.singlepreview":this.destroyTimeline.bind(this)}).appendTo(this.$container),this.$headingButtonsLeft=i('<div class="n2_layer_window_animations_editor__title_left"></div>').appendTo(this.$heading),this.$buttonPlay=i('<div class="n2_layer_window_animations_editor__button_play"><i class="ssi_16 ssi_16--play"></i></div>').on("click",function(t){this.toggleTimeline()}.bind(this)).appendTo(this.$headingButtonsLeft),i('<div class="n2_layer_window_animations_editor__label">'+n2_("Layer Animation - Reveal")+"</div>").appendTo(this.$heading),this.$headingButtonsRight=i('<div class="n2_layer_window_animations_editor__title_right"></div>').appendTo(this.$heading),i('<div class="n2_layer_window_animations_editor__button_delete"><i class="ssi_16 ssi_16--delete"></i></div>').on("click",function(t){this.activatedAnimationGroup.remove()}.bind(this)).appendTo(this.$headingButtonsRight),this.$form=i('.n2_fields_layer_window[data-field="fieldset-layer-window-layer-animation-reveal-form"]').appendTo(this.$container),this.fields={from:{input:this.$form.find("#layer-reveal-from"),$select:this.$form.find("#layer-reveal-from_select"),set:function(t){this.input.data("field").insideChange(t)},get:function(){return this.input.val()}},fromease:{input:this.$form.find("#layer-reveal-from-ease"),set:function(t){this.input.data("field").insideChange(t)},get:function(){return this.input.val()}},to:{input:this.$form.find("#layer-reveal-to"),$select:this.$form.find("#layer-reveal-to_select"),set:function(t){this.input.data("field").insideChange(t)},get:function(){return this.input.val()}},toease:{input:this.$form.find("#layer-reveal-to-ease"),set:function(t){this.input.data("field").insideChange(t)},get:function(){return this.input.val()}},content:{input:this.$form.find("#layer-reveal-content"),set:function(t){this.input.data("field").insideChange(t)},get:function(){return this.input.val()}},duration:{input:this.$form.find("#layer-reveal-duration"),set:function(t){this.input.val(parseInt(1e3*t))},get:function(){return this.input.val()/1e3}},delay:{input:this.$form.find("#layer-reveal-delay"),set:function(t){this.input.val(parseInt(1e3*t))},get:function(){return this.input.val()/1e3}},color:{input:this.$form.find("#layer-reveal-color"),set:function(t){this.input.data("field").insideChange(t)},get:function(){return this.input.val()}}},this.fields)this.fields[e].input.on("outsideChange.n2-editor",this.changeInlineField.bind(this,e));i("body").on("timelinePlay",this.previewCancel.bind(this))}return t.get=function(){return n},t.prototype.activateWithGroup=function(t){if(this.activatedAnimationGroup!==t){switch(this.close(),this.activatedAnimationGroup=t,this.activatedAnimationGroup.connectEditor(this),t.group){case"in":this.fields.from.$select.find('option[value="no"]').removeAttr("disabled");break;case"out":this.fields.from.$select.find('option[value="no"]').attr("disabled","disabled")}for(var e in this.fields)this.fields[e].get()!==t.data[e]&&this.fields[e].set(t.data[e])}},t.prototype.display=function(t){this.$container.appendTo(t)},t.prototype.close=function(){this.$container.detach()},t.prototype.changeInlineField=function(t,e){this.activatedAnimationGroup.setData(t,this.fields[t].get()),this.preview().playOnce()},t.prototype.outsideChange=function(t,e){this.fields[t]!==s&&this.fields[t].get()!==e&&this.fields[t].set(e)},t.prototype.toggleTimeline=function(){this.timeline?this.destroyTimeline():this.preview().play()},t.prototype.destroyTimeline=function(){this.timeline&&(i("body").removeClass("n2-ss-animation-play-single"),this.timeline.destroy()),this.timeline=null,this.$buttonPlay.removeClass("n2_layer_window_animations_editor__button_play--active")},t.prototype.previewPreset=function(t,e){return this.preview(e,t).play(),this.destroyTimeline.bind(this)},t.prototype.preview=function(t,e){return t=t&&t.data?t.data:this.activatedAnimationGroup.getData(),e=e||this.activatedAnimationGroup.group,this.destroyTimeline(),this.$buttonPlay.addClass("n2_layer_window_animations_editor__button_play--active"),i("body").addClass("n2-ss-animation-play-single"),this.timeline=new N2Classes.TimelineAnimationRevealPreview(this,this.animationManager.getActiveLayer().layer,e,t),this.timeline},t.prototype.previewCancel=function(){this.destroyTimeline()},t}),N2D("TimelineAnimationRevealPreview",function(i,t){"use strict";var s={from:"top",fromease:"easeOutCubic",to:"bottom",toease:"easeOutCubic",content:"",duration:2,delay:0,color:"ffffff"};function e(t,e,i,s){this.editor=t,this.group=i;t=e.data("animatableselector");switch(this.$animatableElement=t?e.find(t):e,this.$revealedElements=this.$animatableElement.find(".n2-ss-layer-content,.n2-ss-layer-row,.n2-ss-item,.n2-ss-item-content").eq(0),this.timeline=new NextendTimeline({paused:!0}),this[i]=this._initGroup(i,s),i){case"in":this.extendTimelineIn(this.timeline);break;case"out":this.extendTimelineOut(this.timeline)}0<this.timeline.totalDuration()&&this.timeline.set({},{},"+=1.5")}return e.prototype.play=function(){0<this.timeline.totalDuration()&&(this.timeline.eventCallback("onComplete",function(){this.timeline.play(0,!1)}.bind(this)),this.timeline.play())},e.prototype.playOnce=function(){this.timeline.eventCallback("onComplete",function(){this.editor.destroyTimeline()}.bind(this)),this.timeline.play()},e.prototype.destroy=function(){this.timeline.pause(),this.repeatTimeout&&clearTimeout(this.repeatTimeout),this.timeline.progress(1,!0),this[this.group].$clip.remove(),NextendTween.set(this.$revealedElements,{clearProps:"transform, opacity"}),this.$revealedElements.removeAttr("data-force-hidden")},e.prototype._initGroup=function(t,e){return{$revealedElements:this.$revealedElements,options:i.extend({},s,e),$clip:i('<div class="n2-ss-reveal-clip"></div>').appendTo(this.$animatableElement)}},e.prototype.extendTimelineIn=function(t){N2Classes.FrontendLayerAnimationsRevealAnimation.in(t,this.in)},e.prototype.extendTimelineOut=function(t){N2Classes.FrontendLayerAnimationsRevealAnimation.out(t,this.out)},e}),N2D("SmartSliderAdminWidgetArrowImage",function(s,t){function e(){}return e.renderStyle=function(t,e){if("sliderwidget-arrow-style"===t){var t=s("<div></div>"),e=s("<div></div>").css("display","inline-block").addClass(e.styleClassName).appendTo(t),i=s('<img style="display: block;" />').appendTo(e),e=s("#sliderwidget-arrow-previous-image").val();return e?i.attr("src",nextend.imageHelper.fixed(e)):s("#sliderwidget-arrow-previous").data("field").getCurrentImage(s("#sliderwidget-arrow-previous-color").val()).done(function(t){i.attr("src",t)}),t}},e}),N2D("SmartSliderAdminWidgetAutoplayImage",function(s,t){function e(){}return e.renderStyle=function(t,e){if("sliderwidget-autoplay-style"===t){var t=s("<div></div>").css("display","inline-block").addClass(e.styleClassName),i=s('<img style="display: block;" />').appendTo(t),e=s("#sliderwidget-autoplay-play-image").val();return e?i.attr("src",nextend.imageHelper.fixed(e)):s("#sliderwidget-autoplay-play").data("field").getCurrentImage(s("#sliderwidget-autoplay-play-color").val()).done(function(t){i.attr("src",t)}),t}},e}),N2D("SmartSliderAdminWidgetBarHorizontal",function(s,t){function e(){}return e.renderStyle=function(t,e){if("sliderwidget-bar-style"===t){var i=s("#sliderwidget-bar-separator").val(),t=s("<div></div>").css({width:"100%",boxSizing:"border-box"}).addClass(e.styleClassName);return s("<span>Slide title</span>").addClass(e.fontClassName).attr("href","#").appendTo(t),s("<span>"+i+"Slide description which is longer than the title</span>").addClass(e.fontClassName2).appendTo(t),t}},e.renderFont=function(t,e){var i;return"sliderwidget-bar-font-title"===t?(i=s("<div></div>").css({width:"100%",boxSizing:"border-box"}).addClass(e.styleClassName),s("<span>Slide title</span>").addClass(e.fontClassName).attr("href","#").appendTo(i),i):"sliderwidget-bar-font-description"===t?(i=s("<div></div>").css({width:"100%",boxSizing:"border-box"}).addClass(e.styleClassName),s("<span>Slide description which is longer than the title</span>").addClass(e.fontClassName).attr("href","#").appendTo(i),i):void 0},e}),N2D("SmartSliderAdminWidgetBulletTransition",function(s,t){function e(){}return e.renderStyle=function(t,e){var i;return"sliderwidget-bullet-style"===t?(i=s("<div></div>").css("display","inline-block").addClass(e.styleClassName2),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName).appendTo(i),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName+" n2-active").appendTo(i),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName).appendTo(i)):"sliderwidget-bullet-bar"===t&&(i=s("<div></div>").css("display","inline-block").addClass(e.styleClassName),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName2).appendTo(i),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName2+" n2-active").appendTo(i),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName2).appendTo(i)),i},e}),N2D("SmartSliderAdminWidgetBulletThumbnail",function(i,t){function e(){}return e.renderStyle=function(t,e){if("sliderwidget-bullet-thumbnail-style"===t){e=i("<div></div>").css("display","inline-block").addClass(e.styleClassName);return i("<div></div>").css({width:i("#sliderwidget-bullet-thumbnail-width").val()+"px",height:i("#sliderwidget-bullet-thumbnail-height").val()+"px",overflow:"hidden",background:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png")+'")',"background-size":"cover"}).appendTo(e),e}},e}),N2D("SmartSliderAdminWidgetThumbnailBasic",function(a,t){function e(){}return e.renderStyle=function(t,e){var i,s,n=a("#sliderwidget-thumbnail-width").val(),o=a("#sliderwidget-thumbnail-height").val();return"sliderwidget-thumbnail-style-bar"===t?(i=a("<div></div>").css({overflow:"hidden",width:2.5*n+"px"}).addClass(e.styleClassName),s=a("<div></div>").css("width","200%").appendTo(i),a("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png")+'")'}).addClass(e.styleClassName2).appendTo(s),a("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/video.png")+'")'}).addClass(e.styleClassName2+" n2-active").appendTo(s),a("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png")+'")'}).addClass(e.styleClassName2).appendTo(s),i):"sliderwidget-thumbnail-style-slides"===t?(i=a("<div></div>").css({overflow:"hidden",width:"480px"}).addClass(e.styleClassName2),s=a("<div></div>").css("width","200%").appendTo(i),a("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png")+'")'}).addClass(e.styleClassName).appendTo(s),a("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/video.png")+'")'}).addClass(e.styleClassName+" n2-active").appendTo(s),a("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png")+'")'}).addClass(e.styleClassName).appendTo(s),i):"sliderwidget-thumbnail-title-style"===t?a("<span>Slide title</span>").addClass(e.styleClassName+" "+e.fontClassName):void 0},e.renderFont=function(t,e){return"sliderwidget-thumbnail-title-font"===t?a("<span>Slide title</span>").addClass(e.styleClassName+" "+e.fontClassName):"sliderwidget-thumbnail-description-font"===t?a("<span>Slide description with long long text...</span>").addClass(e.styleClassName+" "+e.fontClassName):void 0},e}),N2D("SmartSliderAdminWidgetArrowImage",function(s,t){function e(){}return e.renderStyle=function(t,e){if("sliderwidget-arrow-style"===t){var t=s("<div></div>"),e=s("<div></div>").css("display","inline-block").addClass(e.styleClassName).appendTo(t),i=s('<img style="display: block;" />').appendTo(e),e=s("#sliderwidget-arrow-previous-image").val();return e?i.attr("src",nextend.imageHelper.fixed(e)):s("#sliderwidget-arrow-previous").data("field").getCurrentImage(s("#sliderwidget-arrow-previous-color").val()).done(function(t){i.attr("src",t)}),t}},e}),N2D("SmartSliderAdminWidgetAutoplayImage",function(s,t){function e(){}return e.renderStyle=function(t,e){if("sliderwidget-autoplay-style"===t){var t=s("<div></div>").css("display","inline-block").addClass(e.styleClassName),i=s('<img style="display: block;" />').appendTo(t),e=s("#sliderwidget-autoplay-play-image").val();return e?i.attr("src",nextend.imageHelper.fixed(e)):s("#sliderwidget-autoplay-play").data("field").getCurrentImage(s("#sliderwidget-autoplay-play-color").val()).done(function(t){i.attr("src",t)}),t}},e}),N2D("SmartSliderAdminWidgetBarHorizontal",function(s,t){function e(){}return e.renderStyle=function(t,e){if("sliderwidget-bar-style"===t){var i=s("#sliderwidget-bar-separator").val(),t=s("<div></div>").css({width:"100%",boxSizing:"border-box"}).addClass(e.styleClassName);return s("<span>Slide title</span>").addClass(e.fontClassName).attr("href","#").appendTo(t),s("<span>"+i+"Slide description which is longer than the title</span>").addClass(e.fontClassName2).appendTo(t),t}},e.renderFont=function(t,e){var i;return"sliderwidget-bar-font-title"===t?(i=s("<div></div>").css({width:"100%",boxSizing:"border-box"}).addClass(e.styleClassName),s("<span>Slide title</span>").addClass(e.fontClassName).attr("href","#").appendTo(i),i):"sliderwidget-bar-font-description"===t?(i=s("<div></div>").css({width:"100%",boxSizing:"border-box"}).addClass(e.styleClassName),s("<span>Slide description which is longer than the title</span>").addClass(e.fontClassName).attr("href","#").appendTo(i),i):void 0},e}),N2D("SmartSliderAdminWidgetBulletTransition",function(s,t){function e(){}return e.renderStyle=function(t,e){var i;return"sliderwidget-bullet-style"===t?(i=s("<div></div>").css("display","inline-block").addClass(e.styleClassName2),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName).appendTo(i),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName+" n2-active").appendTo(i),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName).appendTo(i)):"sliderwidget-bullet-bar"===t&&(i=s("<div></div>").css("display","inline-block").addClass(e.styleClassName),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName2).appendTo(i),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName2+" n2-active").appendTo(i),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName2).appendTo(i)),i},e}),N2D("SmartSliderAdminWidgetBulletThumbnail",function(i,t){function e(){}return e.renderStyle=function(t,e){if("sliderwidget-bullet-thumbnail-style"===t){e=i("<div></div>").css("display","inline-block").addClass(e.styleClassName);return i("<div></div>").css({width:i("#sliderwidget-bullet-thumbnail-width").val()+"px",height:i("#sliderwidget-bullet-thumbnail-height").val()+"px",overflow:"hidden",background:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png")+'")',"background-size":"cover"}).appendTo(e),e}},e}),N2D("SmartSliderAdminWidgetThumbnailBasic",function(a,t){function e(){}return e.renderStyle=function(t,e){var i,s,n=a("#sliderwidget-thumbnail-width").val(),o=a("#sliderwidget-thumbnail-height").val();return"sliderwidget-thumbnail-style-bar"===t?(i=a("<div></div>").css({overflow:"hidden",width:2.5*n+"px"}).addClass(e.styleClassName),s=a("<div></div>").css("width","200%").appendTo(i),a("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png")+'")'}).addClass(e.styleClassName2).appendTo(s),a("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/video.png")+'")'}).addClass(e.styleClassName2+" n2-active").appendTo(s),a("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png")+'")'}).addClass(e.styleClassName2).appendTo(s),i):"sliderwidget-thumbnail-style-slides"===t?(i=a("<div></div>").css({overflow:"hidden",width:"480px"}).addClass(e.styleClassName2),s=a("<div></div>").css("width","200%").appendTo(i),a("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png")+'")'}).addClass(e.styleClassName).appendTo(s),a("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/video.png")+'")'}).addClass(e.styleClassName+" n2-active").appendTo(s),a("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png")+'")'}).addClass(e.styleClassName).appendTo(s),i):"sliderwidget-thumbnail-title-style"===t?a("<span>Slide title</span>").addClass(e.styleClassName+" "+e.fontClassName):void 0},e.renderFont=function(t,e){return"sliderwidget-thumbnail-title-font"===t?a("<span>Slide title</span>").addClass(e.styleClassName+" "+e.fontClassName):"sliderwidget-thumbnail-description-font"===t?a("<span>Slide description with long long text...</span>").addClass(e.styleClassName+" "+e.fontClassName):void 0},e}),N2D("SmartSliderAdminWidgetArrowGrow",function(s,t){function e(){}return e.renderStyle=function(t,e){if("sliderwidget-arrow-style"===t){var e=s("<div></div>").css("display","inline-block").addClass(e.styleClassName),i=s('<img style="display: block;" />').appendTo(e);return s("#sliderwidget-arrow-previous").data("field").getCurrentImage(s("#sliderwidget-arrow-previous-color").val()).done(function(t){i.attr("src",t)}),e}},e.renderFont=function(t,e){if("sliderwidget-arrow-font"===t){t=s("<div></div>").addClass(e.fontClassName);return s("<a>Slide title</a>").css({"line-height":"48px",display:"inline-block"}).attr("href","#").addClass(e.styleClassName).click(function(){return!1}).appendTo(t),t}},e}),N2D("SmartSliderAdminWidgetArrowReveal",function(i,t){function e(){}return e.renderFont=function(t,e){if("sliderwidget-arrow-title-font"===t){e=i("<div></div>").addClass(e.fontClassName);return i("<a>"+n2_("Slide title")+"</a>").attr("href","#").click(function(){return!1}).appendTo(e),e}},e}),N2D("SmartSliderAdminWidgetArrowText",function(s,t){function e(){}return e.renderStyle=function(t,e){if("sliderwidget-arrow-style"===t){var i=s("#sliderwidget-arrow-previous-label").val(),t=s("<div></div>").addClass(e.fontClassName);return s("<a>"+i+"</a>").addClass(e.styleClassName).attr("href","#").click(function(t){return!1}).appendTo(t),t}},e.renderFont=function(t,e){if("sliderwidget-arrow-font"===t){var i=s("#sliderwidget-arrow-previous-label").val(),t=s("<div></div>").addClass(e.fontClassName);return s("<a>"+i+"</a>").addClass(e.styleClassName).attr("href","#").click(function(t){return!1}).appendTo(t),t}},e}),N2D("SmartSliderAdminWidgetBarVertical",function(s,t){function e(){}return e.renderStyle=function(t,e){if("sliderwidget-bar-style"===t){t=s("<div></div>").css("width","300px").addClass(e.styleClassName);return s("<div>Slide title</div>").addClass(e.fontClassName).appendTo(t),s("<div>Slide description which is longer than the title</div>").addClass(e.fontClassName2).appendTo(t),t}},e.renderFont=function(t,e){var i;return"sliderwidget-bar-font-title"===t?(i=s("<div></div>").css("width","300px").addClass(e.styleClassName),s("<span>Slide title</span>").addClass(e.fontClassName).appendTo(i),i):"sliderwidget-bar-font-description"===t?(i=s("<div></div>").css("width","300px").addClass(e.styleClassName),s("<span>Slide description which is longer than the title</span>").addClass(e.fontClassName).appendTo(i),i):void 0},e}),N2D("SmartSliderAdminWidgetBulletNumbers",function(s,t){function e(){}return e.renderStyle=function(t,e){var i;return"sliderwidget-bullet-style"===t?(i=s("<div></div>").css("display","inline-block").addClass(e.styleClassName2),s("<div>1</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName+" "+e.fontClassName).appendTo(i),s("<div>2</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName+" "+e.fontClassName+" n2-active").appendTo(i),s("<div>3</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName+" "+e.fontClassName).appendTo(i),s("<div>4</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName+" "+e.fontClassName).appendTo(i),i):"sliderwidget-bullet-bar"===t?(i=s("<div></div>").css("display","inline-block").addClass(e.styleClassName),s("<div>1</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName2+" "+e.fontClassName).appendTo(i),s("<div>2</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName2+" "+e.fontClassName+" n2-active").appendTo(i),s("<div>3</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName2+" "+e.fontClassName).appendTo(i),s("<div>4</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName2+" "+e.fontClassName).appendTo(i),i):void 0},e.renderFont=function(t,e){if("sliderwidget-bullet-font"===t){t=s("<div></div>").css("display","inline-block").addClass(e.styleClassName2);return s("<div>1</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName+" "+e.fontClassName).appendTo(t),s("<div>2</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName+" "+e.fontClassName+" n2-active").appendTo(t),s("<div>3</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName+" "+e.fontClassName).appendTo(t),s("<div>4</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName+" "+e.fontClassName).appendTo(t),t}},e}),N2D("SmartSliderAdminWidgetBulletText",function(s,t){function e(){}return e.renderStyle=function(t,e){var i;return"sliderwidget-bullet-style"===t?(i=s("<div></div>").css("display","inline-block").addClass(e.styleClassName2),s("<div>Nextendweb</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName+" "+e.fontClassName).appendTo(i),s("<div>Smart Slider</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName+" "+e.fontClassName+" n2-active").appendTo(i),s("<div>Accordion Menu</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName+" "+e.fontClassName).appendTo(i),s("<div>Features</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName+" "+e.fontClassName).appendTo(i),i):"sliderwidget-bullet-bar"===t?(i=s("<div></div>").css("display","inline-block").addClass(e.styleClassName),s("<div>Nextendweb</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName2+" "+e.fontClassName).appendTo(i),s("<div>Smart Slider</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName2+" "+e.fontClassName+" n2-active").appendTo(i),s("<div>Accordion Menu</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName2+" "+e.fontClassName).appendTo(i),s("<div>Features</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName2+" "+e.fontClassName).appendTo(i),i):void 0},e.renderFont=function(t,e){if("sliderwidget-bullet-font"===t){t=s("<div></div>").css("display","inline-block").addClass(e.styleClassName2);return s("<div>Nextendweb</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName+" "+e.fontClassName).appendTo(t),s("<div>Smart Slider</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName+" "+e.fontClassName+" n2-active").appendTo(t),s("<div>Accordion Menu</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName+" "+e.fontClassName).appendTo(t),s("<div>Features</div>").css({display:"inline-block",verticalAlign:"top"}).addClass(e.styleClassName+" "+e.fontClassName).appendTo(t),t}},e}),N2D("SmartSliderAdminWidgetFullScreenImage",function(s,t){function e(){}return e.renderStyle=function(t,e){if("sliderwidget-fullscreen-style"===t){var t=s("<div></div>").css("display","inline-block").addClass(e.styleClassName),i=s('<img style="display: block;" />').appendTo(t),e=s("#sliderwidget-fullscreen-tonormal-image").val();return""!==e?i.attr("src",nextend.imageHelper.fixed(e)):s("#sliderwidget-fullscreen-tonormal").data("field").getCurrentImage(s("#sliderwidget-fullscreen-tonormal-color").val()).done(function(t){i.attr("src",t)}),t}},e}),N2D("SmartSliderAdminWidgetIndicatorPie",function(n,t){function e(){}return e.renderStyle=function(t,e){if("sliderwidget-indicator-style"===t){var i=parseInt(n("#sliderwidget-indicator-size").val()),s=parseInt(n("#sliderwidget-indicator-thickness").val()),t=n("#sliderwidget-indicator-bar").val(),e=n("<div></div>").css("display","inline-block").addClass(e.styleClassName);n('<svg><circle cx="'+(i+4)/2+'" cy="'+(i+4)/2+'" r="'+(2-s/100)*i/4+'" stroke-width="'+i/2*s/100+'" stroke="#'+t.substr(0,6)+'" stroke-opacity="'+N2Color.hex2alpha(t)+'" fill="none"></circle></svg>').css({display:"block"}).attr({height:i+4,width:i+4}).appendTo(e);return e}},e}),N2D("smartslider-backend");